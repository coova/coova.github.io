<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Chilli] Coova-Chilli Multi Tenanency Mode
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:chilli%40coova.org?Subject=Re%3A%20%5BChilli%5D%20Coova-Chilli%20Multi%20Tenanency%20Mode&In-Reply-To=%3C02dc01ce054c%24ef5d5e10%24ce181a30%24%40cabocom.cv%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002135.html">
   <LINK REL="Next"  HREF="002137.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Chilli] Coova-Chilli Multi Tenanency Mode</H1>
    <B>Luis Ferreira</B> 
    <A HREF="mailto:chilli%40coova.org?Subject=Re%3A%20%5BChilli%5D%20Coova-Chilli%20Multi%20Tenanency%20Mode&In-Reply-To=%3C02dc01ce054c%24ef5d5e10%24ce181a30%24%40cabocom.cv%3E"
       TITLE="[Chilli] Coova-Chilli Multi Tenanency Mode">lferreira at cabocom.cv
       </A><BR>
    <I>Thu Feb  7 16:05:21 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="002135.html">[Chilli] Coova-Chilli Multi Tenanency Mode
</A></li>
        <LI>Next message: <A HREF="002137.html">[Chilli] Coova-Chilli Multi Tenanency Mode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2136">[ date ]</a>
              <a href="thread.html#2136">[ thread ]</a>
              <a href="subject.html#2136">[ subject ]</a>
              <a href="author.html#2136">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello everyone,

 

1. It could be related to iptable locking, because I've got a bit of success
if I add &quot;sleep 5&quot; on /etc/init.d/chilli after starting each vlan. It's not
100% win, but at least the success rate increased.

 

2. The iptables file located at v /usr/local/var/run/chilli.tun0.sh is it
generated every time chilli boots? Is it executed on chilli process startup?
Could that be the issue? Not giving enough time for the OS to write the
file, and ask it to run the script? If it's that, that would explain why is
a sporadic problem happening on multi chilli, because is starting several
chilli processes as fast as the machine is capable of.

 

 

 

Atentamente,

Luis Ferreira

Director T&#233;cnico

Cabocom S.A.

 

-----Mensagem original-----
De: Petr &#352;tetiar [mailto:<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">ynezz at true.cz</A>] 
Enviada: quinta-feira, 7 de Fevereiro de 2013 05:35
Para: Robert White
Cc: Luis Ferreira; <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli at coova.org</A>
Assunto: Re: [Chilli] Coova-Chilli Multi Tenanency Mode

 

Robert White &lt; &lt;mailto:<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">rwhite at globalgossip.net</A>&gt; <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">rwhite at globalgossip.net</A>&gt;
[2013-02-07 13:40:21]:

 

&gt;<i> All rules from up.sh except the following seem to get created:
</I>
&gt;<i> 
</I>
&gt;<i> ipt_in -p tcp -m tcp --dport $UAMPORT --dst $ADDR -j ACCEPT
</I>
 

And sometimes some other rules :)

 

&gt;<i> It seems to only ever happen in multi-instance environments so maybe 
</I>
&gt;<i> it is something to do with iptables locking and not allowing the 
</I>
&gt;<i> insertion of the rule while another instance is trying to do the same?
</I>I'm not sure.

 

Yes, maybe something like that, I didn't investigated it in the detail
either.

I've added simple locking into the coova-chilli init.d script and added
wildcard system wide iptables rules like &quot;-i tun+&quot; and it improved a lot.

 

-- ynezz

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.coova.org/pipermail/chilli/attachments/20130207/051fd4f7/attachment.html">http://lists.coova.org/pipermail/chilli/attachments/20130207/051fd4f7/attachment.html</A>&gt;
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002135.html">[Chilli] Coova-Chilli Multi Tenanency Mode
</A></li>
	<LI>Next message: <A HREF="002137.html">[Chilli] Coova-Chilli Multi Tenanency Mode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2136">[ date ]</a>
              <a href="thread.html#2136">[ thread ]</a>
              <a href="subject.html#2136">[ subject ]</a>
              <a href="author.html#2136">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">More information about the Chilli
mailing list</a><br>
</body></html>
