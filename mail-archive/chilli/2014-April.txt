From phyo.w.soe at frontiir.net  Thu Apr  3 08:23:59 2014
From: phyo.w.soe at frontiir.net (Phyo Wai Soe)
Date: Thu, 3 Apr 2014 08:23:59 +0000 (UTC)
Subject: [Chilli] Showing clients' connections in kernel module mode
In-Reply-To: <1845692808.819424.1396498438876.JavaMail.root@frontiir.net>
Message-ID: <1947464235.821290.1396513439054.JavaMail.root@frontiir.net>

Hello Everyone,

We are running Coova in kernel mode on Ubuntu 12.04 64-bit (kernel - 3.2.0-58-generic). I would like to find out if /proc/net/coova/chilli lists all clients (authenticated and unauthenticated) like chilli_query list. Steffen Dettmer in this mailing list once replied to me and said /proc/net... lists only authenticated clients but in our installation, it shows both types (state=0 for unauthenticated). For example -

mac=08-00-27-E3-0F-FF src=10.99.0.200 state=0 bin=0 bout=0 pin=0 pout=0
mac=09-AA-34-C3-78-BC src=10.99.0.200 state=1 bin=0 bout=0 pin=0 pout=0

So, I would like to find out if others are seeing the same thing or not. Do you think something is wrong? Will it effect any functionality? I found kcoova.c is writing to that /proc/net... file but only when clients authenticate/log out. I am baffled how the unauthenticated clients got into that file. I tried it on 32 and 64 bit systems but the result is the same.

Thanks for any help or advice.

Regards,
Phyo Wai Soe


From baguio.ivan at yahoo.com  Thu Apr  3 09:13:07 2014
From: baguio.ivan at yahoo.com (Ivan dominic Baguio)
Date: Thu, 3 Apr 2014 17:13:07 +0800 (SGT)
Subject: [Chilli] Session id formula
Message-ID: <1396516387.586.YahooMailNeo@web192702.mail.sg3.yahoo.com>

Hello,

Does anyone know how the sessionid is generated by chilli? I did some testing and found out that the session id is not unique, and could repeat at some point when there are enough logins.

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140403/4b244e15/attachment.html>

From sales at sanitycomputers.com.au  Fri Apr  4 02:21:07 2014
From: sales at sanitycomputers.com.au (Sanity Computers)
Date: Fri, 4 Apr 2014 12:21:07 +1000
Subject: [Chilli] uamaliasip
Message-ID: <00d001cf4fac$8a164c00$9e42e400$@sanitycomputers.com.au>

 

Hi all, We use Open-mesh ng firmware (chilli 1.2.8)  and also Robin r3182
firmware (chilli 1.2.5).

When entering the uamaliasip 1.0.0.1 as a logged in user there is a redirect
to the uam homepage.

 

When chilli sees this address my understanding is it changes the return url
to res=already in NG but in Robin it changes too res=notyet. 

 

Can anyone point me in the right direction to where/how this is set in Robin
or chilli 1.2.5?

 

Regards

Jim

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140404/0f4183f4/attachment.html>

From steffen.dettmer at nomadrail.com  Fri Apr  4 08:27:43 2014
From: steffen.dettmer at nomadrail.com (Steffen Dettmer)
Date: Fri, 4 Apr 2014 08:27:43 +0000
Subject: [Chilli] Showing clients' connections in kernel module mode
In-Reply-To: <1947464235.821290.1396513439054.JavaMail.root@frontiir.net>
References: <1845692808.819424.1396498438876.JavaMail.root@frontiir.net>
 <1947464235.821290.1396513439054.JavaMail.root@frontiir.net>
Message-ID: <13183b3ee9fe4a6090ebfc0ea649e315@AM3PR05MB323.eurprd05.prod.outlook.com>

Hi,

could it be that it lists clients that were but are not authorized
anymore (logout, timeout...)?

Steffen

* Phyo Wai Soe
> We are running Coova in kernel mode on Ubuntu 12.04 64-bit
> (kernel - 3.2.0-58-generic). I would like to find out if
> /proc/net/coova/chilli lists all clients (authenticated and
> unauthenticated) like chilli_query list. Steffen Dettmer in
> this mailing list once replied to me and said /proc/net...
> lists only authenticated clients but in our installation, it
> shows both types (state=0 for unauthenticated). For example -
>
> mac=08-00-27-E3-0F-FF src=10.99.0.200 state=0 bin=0 bout=0
> pin=0 pout=0 mac=09-AA-34-C3-78-BC src=10.99.0.200 state=1
> bin=0 bout=0 pin=0 pout=0

From phyo.w.soe at frontiir.net  Fri Apr  4 10:39:35 2014
From: phyo.w.soe at frontiir.net (Phyo Wai Soe)
Date: Fri, 4 Apr 2014 10:39:35 +0000 (UTC)
Subject: [Chilli] Showing clients' connections in kernel module mode
In-Reply-To: <13183b3ee9fe4a6090ebfc0ea649e315@AM3PR05MB323.eurprd05.prod.outlook.com>
References: <1845692808.819424.1396498438876.JavaMail.root@frontiir.net>
 <1947464235.821290.1396513439054.JavaMail.root@frontiir.net>
 <13183b3ee9fe4a6090ebfc0ea649e315@AM3PR05MB323.eurprd05.prod.outlook.com>
Message-ID: <1251888116.831206.1396607975287.JavaMail.root@frontiir.net>

Hi Steffen,

It(/proc/net/coova/chilli) is showing clients that have not been authenticated as well as clients who were authenticated and then logged out with state=0. I believe it doesn't effect the functionality of Coova though. I think I can change xt_coova.c to not show clients that haven't been authenticated yet. 

Thank you.

Regards,
Phyo Wai Soe


----- Original Message -----
From: "Steffen Dettmer" <steffen.dettmer at nomadrail.com>
To: "Phyo Wai Soe" <phyo.w.soe at frontiir.net>, chilli at coova.org
Sent: Friday, April 4, 2014 2:57:43 PM
Subject: AW: Showing clients' connections in kernel module mode

Hi,

could it be that it lists clients that were but are not authorized
anymore (logout, timeout...)?

Steffen

* Phyo Wai Soe
> We are running Coova in kernel mode on Ubuntu 12.04 64-bit
> (kernel - 3.2.0-58-generic). I would like to find out if
> /proc/net/coova/chilli lists all clients (authenticated and
> unauthenticated) like chilli_query list. Steffen Dettmer in
> this mailing list once replied to me and said /proc/net...
> lists only authenticated clients but in our installation, it
> shows both types (state=0 for unauthenticated). For example -
>
> mac=08-00-27-E3-0F-FF src=10.99.0.200 state=0 bin=0 bout=0
> pin=0 pout=0 mac=09-AA-34-C3-78-BC src=10.99.0.200 state=1
> bin=0 bout=0 pin=0 pout=0

From eric at craftti.com.br  Fri Apr  4 12:44:05 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Fri, 4 Apr 2014 09:44:05 -0300
Subject: [Chilli] Can I use SMD5-passwords with coova chilli?
Message-ID: <CAF+USJ65+yv7W74AcEViFhw4aEnO8H4kgVfDEZd7ET8e5QG3gA@mail.gmail.com>

Hi Guys,

I was reading about how to setup freeradius to operate with salted md5 and
I couldn't get the clear picture. In case of storing the user password as
SMD5, would coova need to know the salt to properly send the password to
the radius server?

Is anyone using coova with SMD5 to share his toughs on it?

Thanks in advance,

--
Eric Chaves
(11) 98139-9880
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140404/fa758111/attachment.html>

From claus at stjerno.dk  Mon Apr  7 11:49:38 2014
From: claus at stjerno.dk (=?iso-8859-1?Q?Claus_Stjern=F8?=)
Date: Mon, 7 Apr 2014 13:49:38 +0200
Subject: [Chilli] COA Support
Message-ID: <02ce01cf5257$745343c0$5cf9cb40$@stjerno.dk>

Hi,

 

I have been looking at the COA support that is build into Coova but I can?t
find a list of supported actions.

Is there a list of what features Coova support via COA or is it only POD
(Packet Of Disconnect) that is supported?

 

Thanks in advance.

 

Claus

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140407/76635103/attachment.html>

From tr23101 at yahoo.com  Mon Apr  7 12:53:55 2014
From: tr23101 at yahoo.com (Tariq Ramadan)
Date: Mon, 7 Apr 2014 05:53:55 -0700 (PDT)
Subject: [Chilli] Running with kmod
Message-ID: <1396875235.50368.YahooMailNeo@web161702.mail.bf1.yahoo.com>

Hello

I've compiled and set up coovachilli --with-nfcoova on ubuntu successfully. But I can not run properly. I think there's a kind of routing problem with the interfaces. I tried to set up as David described here: http://lists.coova.org/pipermail/chilli/2010-April/001239.html?

At this configuration client is getting IP, then trying to resolve and getting dns request result, and redirecting the browser to the uamurl, but page is not displaying properly(getting connection reset response)
If I remove the network route of tun0(11.1.0.0/24) here, the client can continue to reach and display the uampage, then login and access to the internet. But this time dns resolving and redirection doesn't work.

My configuration:

cmdsocket ? ? ? /var/run/chilli.eth1.sock
unixipc ? ? ? ? chilli.eth1.ipc
pidfile ? ? ? ? /var/run/chilli.eth1.pid
net10.1.0.0/255.255.255.0
uamlisten11.1.0.1
uamport ? ? ? ? 3100
dhcpifeth1
uamallowed"10.0.0.0/8,11.0.0.0/8"
uamanydns
kname "chilli"
dhcplisten "10.1.0.1"
domain "lan"
dns1 "208.67.222.222"
dns2 "8.8.8.8"

radiusserver1"localhost"
radiusserver2"localhost"
radiussecret"testing123"
radiusauthport? 1812
radiusacctport? 1813
uamserver"http://11.1.0.1/login/login.php"
radiusnasid"nas-10"
papalwaysok
macauth
usestatusfile "/etc/chilli/eth1/status.dat"
uamaliasname "chilli"
adminupdatefile "/etc/chilli/eth1/local.conf"
uamsecret "testing123"

dhcpstart 10
dhcpend 239
lease 3600
dhcpnotidle
seskeepalive
logfacility 22

WAN side - eth0 : 192.168.0.88 (def gw:192.168.0.1)
LAN side - eth1 : 10.1.0.1
tun0: 11.1.0.1

iptables output:
Chain INPUT (policy ACCEPT)

target ? ? prot opt source ? ? ? ? ? ? ? destination? ? ? ? ?

Chain FORWARD (policy DROP)
target ? ? prot opt source ? ? ? ? ? ? ? destination? ? ? ? ?
ACCEPT ? ? all? --? 0.0.0.0/0? ? ? ? ? ? 0.0.0.0/0? ? ? ? ? ?
ACCEPT ? ? all? --? 0.0.0.0/0? ? ? ? ? ? 0.0.0.0/0? ? ? ? ? ?
ACCEPT ? ? all? --? 0.0.0.0/0? ? ? ? ? ? 0.0.0.0/0 ? ? ? ? ? coova: name: chilli side: dest
ACCEPT ? ? all? --? 0.0.0.0/0? ? ? ? ? ? 0.0.0.0/0 ? ? ? ? ? coova: name: chilli side: source?

Chain OUTPUT (policy ACCEPT)
target ? ? prot opt source ? ? ? ? ? ? ? destination


route -n output:

Kernel IP routing table
Destination ? ? Gateway ? ? ? ? Genmask ? ? ? ? Flags Metric Ref? ? Use Iface
0.0.0.0 ? ? ? ? 192.168.0.1 ? ? 0.0.0.0 ? ? ? ? UG? ? 100? ? 0? ? ? ? 0 eth0
10.0.0.0? ? ? ? 0.0.0.0 ? ? ? ? 255.0.0.0 ? ? ? U ? ? 0? ? ? 0? ? ? ? 0 eth1
11.1.0.0? ? ? ? 0.0.0.0 ? ? ? ? 255.255.255.0 ? U ? ? 0? ? ? 0? ? ? ? 0 tun0
192.168.0.0 ? ? 0.0.0.0 ? ? ? ? 255.255.255.0 ? U ? ? 0? ? ? 0? ? ? ? 0 eth0


Can anyone help me?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140407/1064e280/attachment.html>

From andrew at polkaspots.com  Mon Apr  7 13:23:36 2014
From: andrew at polkaspots.com (andrew@PolkaSpots.com)
Date: Mon, 07 Apr 2014 14:23:36 +0100
Subject: [Chilli] Chilli starting multiple times
Message-ID: <5342A6D8.4080708@polkaspots.com>

Hi guys,

Im using chilli 1.2.9
So, I have chilli set-up on an OpenWRT unifi.
I am also using a pid monitoring service to check if chilli is crashing 
on me for some reason, and that will restart it.
For some reason, that pidmon doesn?t work properly, and start sometimes 
coova multiple times.
So I end up having tun0 tun1 tun2 and so on.
Is there any way or any things that I can specify in chilli , not to 
start multiple instances?

Cheers,
Andrew
---------------------------------------------------------------------------------------

The information contained in this email and its attachments is confidential and may be the subject of legal, professional or other privilege. It is intended only for the named addressees and may not be disclosed to anyone else without consent from PolkaSpots Limited. If you are not the named addressee you must not use, disclose, distribute, copy, print or rely on the contents of this email and should destroy it immediately. Whilst PolkaSpots Limited takes care to protect its systems from electronic virus attack or other harmful event, the firm gives no warranty that this email message (including any attachments to it) is free of any virus or other harmful matter and accepts no responsibility for any loss or damage resulting from the recipient receiving, opening or using it. If you need any further information, please contact the originator of this message on +44 (0)20 7183 1471.

PolkaSpots is a limited company registered in the UK (registered number 05508105). Registered Office: 204 Buspace Studios, Conlan Street, London W10 5AP

Website: www.polkaspots.com
WiFi Hotspot Blog: www.polkaspots.com/blog

---------------------------------------------------------------------------------------



From bojan at gajba.net  Mon Apr  7 15:40:11 2014
From: bojan at gajba.net (Bojan Pogacar)
Date: Mon, 07 Apr 2014 17:40:11 +0200
Subject: [Chilli] include conected SSID in UAM string on openWRT
Message-ID: <5342C6DB.90006@gajba.net>

Hello!

Is it possible to include conected SSID in UAM string? If not, is there 
some other way to determine which SSID custmer chose? Throught VLAN ID?

Best regards, Bojan


From jbglaw at getslash.de  Mon Apr  7 16:08:35 2014
From: jbglaw at getslash.de (Jan-Benedict Glaw)
Date: Mon, 7 Apr 2014 18:08:35 +0200
Subject: [Chilli] Clients with dhcp'ed IP addresses from a different DHCP
	server
Message-ID: <20140407160835.GF4834@pluto.office.getslash.de>

Hi!

I just thought about putting a Chilli instance into a network that was
not connected to the internet until now. That is, there's already a
DHCP server and other management stuff that's authoritative right now.

  Will a Chilli instance accept these clients, after DHCP replies
(from the already-existing DHCP server) would set the Chilli server as
their default gateway?

  From a first glance, the only way I found prividing somewhat
externally defined IP addresses is to send the through the Radius
server, which doesn't fit here too well...

MfG, JBG

-- 
Getslash GmbH, Bahnhofstra?e 16, 59302 Oelde
Tel: +49-2522-834349-5    Fax:   +49-2522-834349-1
http://www.getslash.de    Mobil: +49-152-33822499
Sitz der Gesellschaft: Oelde
Handelsregister: Amtsgericht M?nster, HRB 11911
Ust-Id-Nr.: DE 815060326
Gesch?ftsf?hrung: Andre Peitz, Tobias Hanisch
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 836 bytes
Desc: Digital signature
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140407/91648bd8/attachment-0001.pgp>

From tr23101 at yahoo.com  Mon Apr  7 18:23:14 2014
From: tr23101 at yahoo.com (Tariq Ramadan)
Date: Mon, 7 Apr 2014 11:23:14 -0700 (PDT)
Subject: [Chilli] CoovaChilli Kernel Mode issue
In-Reply-To: <1896015655.107091.1386329013880.JavaMail.root@frontiir.net>
References: <1561245260.281382.1385376623746.JavaMail.root@frontiir.net>
 <1547615330.282248.1385378564547.JavaMail.root@frontiir.net>
 <CACkgH70r=f46RvoS4oMzjVhMS8bN7MKCO71gUBYMCyWaaZ93aQ@mail.gmail.com>
 <1983365293.330957.1385606680205.JavaMail.root@frontiir.net>
 <CADao4CpUxeaSj1Q7iDuN1Wo=Of6EZzCPK7Fb7PQX7k5UXJD=2Q@mail.gmail.com>
 <826889934.520.1385638567614.JavaMail.root@frontiir.net>
 <89dfc8d931a2452488b0c5a4d03406e1@AM3PR05MB323.eurprd05.prod.outlook.com>
 <1896015655.107091.1386329013880.JavaMail.root@frontiir.net>
Message-ID: <1396894994.91678.YahooMailNeo@web161704.mail.bf1.yahoo.com>

Hi,
I also have the similar problem which I wrote today:?http://lists.coova.org/pipermail/chilli/2014-April/002657.html?
I tried the patches on 3 december(http://lists.coova.org/pipermail/chilli/2013-December/002489.html), but it doesn't change. Have you solved your problem?

Thanks.

On Friday, December 6, 2013 1:20 PM, Phyo Wai Soe <phyo.w.soe at frontiir.net> wrote:
 
Hi Steffen,

Your reply does give me some comfort :) . I have tried almost all the things you suggested. When we analyzed traffics on tun0 and eth0 of clients and the server with Wireshark, we saw some fishy things that may or may not indicate issues. Other possible sources of failure we are looking at are the kernel version we are using (Ubuntu 12.04) and the fact that we are running them on virtual machines. Maybe all they are needing are the patches you suggested on 3 Dec :)

Thanks.

Regards,
Phyo Wai Soe


----- Original Message -----
From: "Steffen Dettmer" <steffen.dettmer at nomadrail.com>
To: "Phyo Wai Soe" <phyo.w.soe at frontiir.net>, chilli at coova.org
Sent: Wednesday, December 4, 2013 11:18:00 PM
Subject: RE: CoovaChilli Kernel Mode issue

Hi,

because it seems no one knew how to solve, I try to add my
experiences, but unfortunately I can only say that I had a very
similar situation and didn't solve it.

> Phyo Wai Soe, November 28, 2013 12:36 PM
> I saw your mails to the list regarding the redir error message
> and hoped I could get some clues. So far, I am still stuck :(
> In my case, when I see redir_read messages in the server's
> syslog, it normally means that clients see "The connection was
> reset" error in their browsers and can't go anywhere. They
> don't even see the "redirecting" message with the animated
> circle (www/wait.gif).

I did some performance tests with kernel mode Coova (but not
using the original Coova Portal), but I also was not able to get
the redirects working. To progress, I manually authorized test
clients using chilli_query command line commands, as you did :)

> I tried different config settings. If I make HS_UAMLISTEN
> address in the same range as HS_NETWORK, clients do see
> redirection/login pages but that's all.

I think, following Davids annoucement mail, in main.conf "net"
should be e.g. in 10.1.1.0 and uamlisten e.g. 11.1.1.0. The up.sh
script generates different iptables rules; I think in your case
the traffic to the login page could even be passing by coova.

> I don't see any record in /proc/net/coova/chilli (which should
> happen if the kernel module mode is on)

I think only authorized clients appear here.

> or issue authorize, log out, etc., commands on the server with
> chilli_query. It's as if the commands don't have any effect on
> the clients.

I simply manually called chilli_query on shell command line to
authenticate my clients, then they appeared in the /proc file
output. I think this is expected: Coova handles all
non-authorized traffic. Sorry that I don't know why it is not
working for the redirects.

> However, if I make HS_UAMLISTEN address to be on
> another network range like David mentioned, clients get that
> connection reset error. But /proc/net/coova/chilli is populated
> and if I manually authorize a client, he/she can browse the
> web.

Do the counters of the -m coova firewall rules increase (e.g.
iptables-save -c)? If so, I think this proves the kernel module
is working (it matches packets, which then are routed by the
kernel). Maybe verify with "killall -STOP chilli", but I didn't
try.

> It's possible that there is a config problem or the NAT
> between UAMLISTEN and DHCPLISTEN has a issue. I am trying out
> all possible things I can think of but so far, I am not getting
> it right.

The portal I used responded with a redirect - to the current URL.
I thought it could be cause by the fact, that the client network
is within 10/8 as a "default" config may assume, but from 11/8,
because Coova performs some SNAT (?) of unauthorized clients. I
think you already tried, traced and verified that. Maybe it helps
to use a browser debugger like Firebug and check "Network" to see
what happens or even better tcpdump -w + Wireshark the traffic;
maybe the redirect works, but not the portal as in my case?

Sorry that I couldn't help you, but at least you know you are not
the only one who had such an issue :-)

Regards,
Steffen

_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140407/78de1e4e/attachment.html>

From tr23101 at yahoo.com  Mon Apr  7 20:56:05 2014
From: tr23101 at yahoo.com (Tariq Ramadan)
Date: Mon, 7 Apr 2014 13:56:05 -0700 (PDT)
Subject: [Chilli] Running with kmod
In-Reply-To: <1396875235.50368.YahooMailNeo@web161702.mail.bf1.yahoo.com>
References: <1396875235.50368.YahooMailNeo@web161702.mail.bf1.yahoo.com>
Message-ID: <1396904165.22272.YahooMailNeo@web161701.mail.bf1.yahoo.com>

And here's the debug output, when redirection fails:

Apr? 7 23:50:37 ubuntu coova-chilli[25086]: dns.c: 187: It was a dns record type: 1 class: 1
Apr? 7 23:50:37 ubuntu coova-chilli[25086]: dns.c: 187: It was a dns record type: 1 class: 1
Apr? 7 23:50:37 ubuntu coova-chilli[25086]: dns.c: 187: It was a dns record type: 1 class: 1
Apr? 7 23:50:37 ubuntu coova-chilli[25086]: dns.c: 187: It was a dns record type: 1 class: 1
Apr? 7 23:50:37 ubuntu coova-chilli[25086]: dns.c: 194: DNS: www.google.com
Apr? 7 23:50:37 ubuntu coova-chilli[25086]: dns.c: 187: It was a dns record type: 1 class: 1
Apr? 7 23:50:37 ubuntu coova-chilli[25086]: dns.c: 187: It was a dns record type: 1 class: 1
Apr? 7 23:50:37 ubuntu coova-chilli[25086]: dns.c: 187: It was a dns record type: 1 class: 1
Apr? 7 23:50:37 ubuntu coova-chilli[25086]: dns.c: 187: It was a dns record type: 1 class: 1
Apr? 7 23:50:37 ubuntu coova-chilli[25086]: dns.c: 187: It was a dns record type: 1 class: 1
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: dhcp.c: 5060: Layer2 PROT: 0x86dd dropped
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: dhcp.c: 3555: chopping off trailer length 6
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: dhcp.c: 3593: Not for our MAC or broadcast: 08-00-27-78-5A-6D
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: dhcp.c: 3555: chopping off trailer length 6
Apr? 7 23:50:38 ubuntu coova-chilli[25380]: redir.c: 2103: The path:?
Apr? 7 23:50:38 ubuntu coova-chilli[25380]: redir.c: 2413: -->> Setting userurl=[http://www.google.com/]
Apr? 7 23:50:38 ubuntu coova-chilli[25380]: redir.c: 3962: redir_accept: Original request host=www.google.com
Apr? 7 23:50:38 ubuntu coova-chilli[25380]: redir.c: 4071: ---->>> resetting challenge: b7d65709eded1854be6b1e50e106cb73
Apr? 7 23:50:38 ubuntu coova-chilli[25380]: redir.c: 987: redir_wispr2_reply
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: chilli.c: 379: caught 17 via selfpipe
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: chilli.c: 310: child 25380 terminated
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: chilli.c: 135: Freed child process 25380 [[redir]]
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: dhcp.c: 3555: chopping off trailer length 6
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: dhcp.c: 3555: chopping off trailer length 6
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: dhcp.c: 3555: chopping off trailer length 6
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: dhcp.c: 3593: Not for our MAC or broadcast: 08-00-27-78-5A-6D
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: dhcp.c: 3555: chopping off trailer length 6
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: dhcp.c: 3555: chopping off trailer length 6
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: dhcp.c: 3593: Not for our MAC or broadcast: 08-00-27-78-5A-6D
Apr? 7 23:50:38 ubuntu coova-chilli[25382]: redir.c: 2103: The path: www/coova.html
Apr? 7 23:50:38 ubuntu coova-chilli[25382]: redir.c: 2398: Serving file coova.html
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: dhcp.c: 3593: Not for our MAC or broadcast: 08-00-27-78-5A-6D
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: dhcp.c: 3555: chopping off trailer length 6
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: chilli.c: 379: caught 17 via selfpipe
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: chilli.c: 310: child 25382 terminated
Apr? 7 23:50:38 ubuntu coova-chilli[25086]: chilli.c: 135: Freed child process 25382 [[redir]]
Apr? 7 23:50:39 ubuntu coova-chilli[25381]: redir.c: 2020: 104 (Connection reset by peer) redir_read(0) failed!
Apr? 7 23:50:39 ubuntu coova-chilli[25381]: redir.c: 3383: Error calling get_req. Terminating -1
Apr? 7 23:50:39 ubuntu coova-chilli[25086]: dhcp.c: 3555: chopping off trailer length 6
Apr? 7 23:50:39 ubuntu coova-chilli[25086]: chilli.c: 379: caught 17 via selfpipe
Apr? 7 23:50:39 ubuntu coova-chilli[25086]: chilli.c: 310: child 25381 terminated
Apr? 7 23:50:39 ubuntu coova-chilli[25086]: chilli.c: 135: Freed child process 25381 [[redir]]
Apr? 7 23:50:41 ubuntu coova-chilli[25086]: dhcp.c: 5060: Layer2 PROT: 0x86dd dropped

On Monday, April 7, 2014 3:53 PM, Tariq Ramadan <tr23101 at yahoo.com> wrote:
 
Hello

I've compiled and set up coovachilli --with-nfcoova on ubuntu successfully. But I can not run properly. I think there's a kind of routing problem with the interfaces. I tried to set up as David described here: http://lists.coova.org/pipermail/chilli/2010-April/001239.html?

At this configuration client is getting IP, then trying to resolve and getting dns request result, and redirecting the browser to the uamurl, but page is not displaying properly(getting connection reset response)
If I remove the network route of tun0(11.1.0.0/24) here, the client can continue to reach and display the uampage, then login and access to the internet. But this time dns resolving and redirection doesn't work.

My configuration:

cmdsocket ? ? ? /var/run/chilli.eth1.sock
unixipc ? ? ? ? chilli.eth1.ipc
pidfile ? ? ? ? /var/run/chilli.eth1.pid
net10.1.0.0/255.255.255.0
uamlisten11.1.0.1
uamport ? ? ? ? 3100
dhcpifeth1
uamallowed"10.0.0.0/8,11.0.0.0/8"
uamanydns
kname "chilli"
dhcplisten "10.1.0.1"
domain "lan"
dns1 "208.67.222.222"
dns2 "8.8.8.8"

radiusserver1"localhost"
radiusserver2"localhost"
radiussecret"testing123"
radiusauthport? 1812
radiusacctport? 1813
uamserver"http://11.1.0.1/login/login.php"
radiusnasid"nas-10"
papalwaysok
macauth
usestatusfile "/etc/chilli/eth1/status.dat"
uamaliasname "chilli"
adminupdatefile "/etc/chilli/eth1/local.conf"
uamsecret "testing123"

dhcpstart 10
dhcpend 239
lease 3600
dhcpnotidle
seskeepalive
logfacility 22

WAN side - eth0 : 192.168.0.88 (def gw:192.168.0.1)
LAN side - eth1 : 10.1.0.1
tun0: 11.1.0.1

iptables output:
Chain INPUT (policy ACCEPT)

target ? ? prot opt source ? ? ? ? ? ? ? destination? ? ? ? ?

Chain FORWARD (policy DROP)
target ? ? prot opt source ? ? ? ? ? ? ? destination? ? ? ? ?
ACCEPT ? ? all? --? 0.0.0.0/0? ? ? ? ? ? 0.0.0.0/0? ? ? ? ? ?
ACCEPT ? ? all? --? 0.0.0.0/0? ? ? ? ? ? 0.0.0.0/0? ? ? ? ? ?
ACCEPT ? ? all? --? 0.0.0.0/0? ? ? ? ? ? 0.0.0.0/0 ? ? ? ? ? coova: name: chilli side: dest
ACCEPT ? ? all? --? 0.0.0.0/0? ? ? ? ? ? 0.0.0.0/0 ? ? ? ? ? coova: name: chilli side: source?

Chain OUTPUT (policy ACCEPT)
target ? ? prot opt source ? ? ? ? ? ? ? destination


route -n output:

Kernel IP routing table
Destination ? ? Gateway ? ? ? ? Genmask ? ? ? ? Flags Metric Ref? ? Use Iface
0.0.0.0 ? ? ? ? 192.168.0.1 ? ? 0.0.0.0 ? ? ? ? UG? ? 100? ? 0? ? ? ? 0 eth0
10.0.0.0? ? ? ? 0.0.0.0 ? ? ? ? 255.0.0.0 ? ? ? U ? ? 0? ? ? 0? ? ? ? 0 eth1
11.1.0.0? ? ? ? 0.0.0.0 ? ? ? ? 255.255.255.0 ? U ? ? 0? ? ? 0? ? ? ? 0 tun0
192.168.0.0 ? ? 0.0.0.0 ? ? ? ? 255.255.255.0 ? U ? ? 0? ? ? 0? ? ? ? 0 eth0


Can anyone help me?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140407/4745a92b/attachment-0001.html>

From phyo.w.soe at frontiir.net  Tue Apr  8 02:57:42 2014
From: phyo.w.soe at frontiir.net (Phyo Wai Soe)
Date: Tue, 8 Apr 2014 02:57:42 +0000 (UTC)
Subject: [Chilli] CoovaChilli Kernel Mode issue
In-Reply-To: <1396894994.91678.YahooMailNeo@web161704.mail.bf1.yahoo.com>
References: <1561245260.281382.1385376623746.JavaMail.root@frontiir.net>
 <CACkgH70r=f46RvoS4oMzjVhMS8bN7MKCO71gUBYMCyWaaZ93aQ@mail.gmail.com>
 <1983365293.330957.1385606680205.JavaMail.root@frontiir.net>
 <CADao4CpUxeaSj1Q7iDuN1Wo=Of6EZzCPK7Fb7PQX7k5UXJD=2Q@mail.gmail.com>
 <826889934.520.1385638567614.JavaMail.root@frontiir.net>
 <89dfc8d931a2452488b0c5a4d03406e1@AM3PR05MB323.eurprd05.prod.outlook.com>
 <1896015655.107091.1386329013880.JavaMail.root@frontiir.net>
 <1396894994.91678.YahooMailNeo@web161704.mail.bf1.yahoo.com>
Message-ID: <28706947.855546.1396925862687.JavaMail.root@frontiir.net>

Hi Tariq,

We think that the issue arises from packet duplication between kernel and user space modules. The fact that so many of us are having the issue probably mean that the issue exists and packet routing rules need to be revised. I hope the next version of Coova addresses this.

Regards,
Phyo Wai Soe


----- Original Message -----
From: "Tariq Ramadan" <tr23101 at yahoo.com>
To: "Phyo Wai Soe" <phyo.w.soe at frontiir.net>, "Steffen Dettmer" <steffen.dettmer at nomadrail.com>
Cc: chilli at coova.org
Sent: Tuesday, April 8, 2014 12:53:14 AM
Subject: Re: [Chilli] CoovaChilli Kernel Mode issue

Hi,
I also have the similar problem which I wrote today:?http://lists.coova.org/pipermail/chilli/2014-April/002657.html?
I tried the patches on 3 december(http://lists.coova.org/pipermail/chilli/2013-December/002489.html), but it doesn't change. Have you solved your problem?

Thanks.

On Friday, December 6, 2013 1:20 PM, Phyo Wai Soe <phyo.w.soe at frontiir.net> wrote:
 
Hi Steffen,

Your reply does give me some comfort :) . I have tried almost all the things you suggested. When we analyzed traffics on tun0 and eth0 of clients and the server with Wireshark, we saw some fishy things that may or may not indicate issues. Other possible sources of failure we are looking at are the kernel version we are using (Ubuntu 12.04) and the fact that we are running them on virtual machines. Maybe all they are needing are the patches you suggested on 3 Dec :)

Thanks.

Regards,
Phyo Wai Soe


----- Original Message -----
From: "Steffen Dettmer" <steffen.dettmer at nomadrail.com>
To: "Phyo Wai Soe" <phyo.w.soe at frontiir.net>, chilli at coova.org
Sent: Wednesday, December 4, 2013 11:18:00 PM
Subject: RE: CoovaChilli Kernel Mode issue

Hi,

because it seems no one knew how to solve, I try to add my
experiences, but unfortunately I can only say that I had a very
similar situation and didn't solve it.

> Phyo Wai Soe, November 28, 2013 12:36 PM
> I saw your mails to the list regarding the redir error message
> and hoped I could get some clues. So far, I am still stuck :(
> In my case, when I see redir_read messages in the server's
> syslog, it normally means that clients see "The connection was
> reset" error in their browsers and can't go anywhere. They
> don't even see the "redirecting" message with the animated
> circle (www/wait.gif).

I did some performance tests with kernel mode Coova (but not
using the original Coova Portal), but I also was not able to get
the redirects working. To progress, I manually authorized test
clients using chilli_query command line commands, as you did :)

> I tried different config settings. If I make HS_UAMLISTEN
> address in the same range as HS_NETWORK, clients do see
> redirection/login pages but that's all.

I think, following Davids annoucement mail, in main.conf "net"
should be e.g. in 10.1.1.0 and uamlisten e.g. 11.1.1.0. The up.sh
script generates different iptables rules; I think in your case
the traffic to the login page could even be passing by coova.

> I don't see any record in /proc/net/coova/chilli (which should
> happen if the kernel module mode is on)

I think only authorized clients appear here.

> or issue authorize, log out, etc., commands on the server with
> chilli_query. It's as if the commands don't have any effect on
> the clients.

I simply manually called chilli_query on shell command line to
authenticate my clients, then they appeared in the /proc file
output. I think this is expected: Coova handles all
non-authorized traffic. Sorry that I don't know why it is not
working for the redirects.

> However, if I make HS_UAMLISTEN address to be on
> another network range like David mentioned, clients get that
> connection reset error. But /proc/net/coova/chilli is populated
> and if I manually authorize a client, he/she can browse the
> web.

Do the counters of the -m coova firewall rules increase (e.g.
iptables-save -c)? If so, I think this proves the kernel module
is working (it matches packets, which then are routed by the
kernel). Maybe verify with "killall -STOP chilli", but I didn't
try.

> It's possible that there is a config problem or the NAT
> between UAMLISTEN and DHCPLISTEN has a issue. I am trying out
> all possible things I can think of but so far, I am not getting
> it right.

The portal I used responded with a redirect - to the current URL.
I thought it could be cause by the fact, that the client network
is within 10/8 as a "default" config may assume, but from 11/8,
because Coova performs some SNAT (?) of unauthorized clients. I
think you already tried, traced and verified that. Maybe it helps
to use a browser debugger like Firebug and check "Network" to see
what happens or even better tcpdump -w + Wireshark the traffic;
maybe the redirect works, but not the portal as in my case?

Sorry that I couldn't help you, but at least you know you are not
the only one who had such an issue :-)

Regards,
Steffen

_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli

From steffen.dettmer at nomadrail.com  Wed Apr  9 07:39:53 2014
From: steffen.dettmer at nomadrail.com (Steffen Dettmer)
Date: Wed, 9 Apr 2014 07:39:53 +0000
Subject: [Chilli] CoovaChilli Kernel Mode issue
In-Reply-To: <1396894994.91678.YahooMailNeo@web161704.mail.bf1.yahoo.com>
References: <1561245260.281382.1385376623746.JavaMail.root@frontiir.net>
 <1547615330.282248.1385378564547.JavaMail.root@frontiir.net>
 <CACkgH70r=f46RvoS4oMzjVhMS8bN7MKCO71gUBYMCyWaaZ93aQ@mail.gmail.com>
 <1983365293.330957.1385606680205.JavaMail.root@frontiir.net>
 <CADao4CpUxeaSj1Q7iDuN1Wo=Of6EZzCPK7Fb7PQX7k5UXJD=2Q@mail.gmail.com>
 <826889934.520.1385638567614.JavaMail.root@frontiir.net>
 <89dfc8d931a2452488b0c5a4d03406e1@AM3PR05MB323.eurprd05.prod.outlook.com>
 <1896015655.107091.1386329013880.JavaMail.root@frontiir.net>
 <1396894994.91678.YahooMailNeo@web161704.mail.bf1.yahoo.com>
Message-ID: <565bcb3960454a3c8c0d6a6f615c4d35@AMSPR05MB328.eurprd05.prod.outlook.com>

Hi,

no, I didn't look any further, so far the performance gain seemed not big enough to satisfy the efforts. Coova still captures all traffic in user land, it is only the "sending" that is "moved" to kernel. I didn't see a way to configure around this (Linux raw captures get traffic regardless of firewall rules, also tried a few other things).
About the redirect, I think there is some missing bit, either in configuration, in Chilli or the used Portal; the latter could not know about the 10/8 vs. 11/8 NAT "trick" that is used in this setup. After checking HTTP traffic (to see what really happens) I think this (portal) is where I would start looking.

Steffen

Von: Tariq Ramadan [mailto:tr23101 at yahoo.com]
Gesendet: Montag, 7. April 2014 20:23
An: Phyo Wai Soe; Steffen Dettmer
Cc: chilli at coova.org
Betreff: Re: [Chilli] CoovaChilli Kernel Mode issue

Hi,
I also have the similar problem which I wrote today: http://lists.coova.org/pipermail/chilli/2014-April/002657.html
I tried the patches on 3 december(http://lists.coova.org/pipermail/chilli/2013-December/002489.html), but it doesn't change. Have you solved your problem?

Thanks.

On Friday, December 6, 2013 1:20 PM, Phyo Wai Soe <phyo.w.soe at frontiir.net<mailto:phyo.w.soe at frontiir.net>> wrote:
Hi Steffen,

Your reply does give me some comfort :) . I have tried almost all the things you suggested. When we analyzed traffics on tun0 and eth0 of clients and the server with Wireshark, we saw some fishy things that may or may not indicate issues. Other possible sources of failure we are looking at are the kernel version we are using (Ubuntu 12.04) and the fact that we are running them on virtual machines. Maybe all they are needing are the patches you suggested on 3 Dec :)

Thanks.

Regards,
Phyo Wai Soe

----- Original Message -----
From: "Steffen Dettmer" <steffen.dettmer at nomadrail.com<mailto:steffen.dettmer at nomadrail.com>>
To: "Phyo Wai Soe" <phyo.w.soe at frontiir.net<mailto:phyo.w.soe at frontiir.net>>, chilli at coova.org<mailto:chilli at coova.org>
Sent: Wednesday, December 4, 2013 11:18:00 PM
Subject: RE: CoovaChilli Kernel Mode issue

Hi,

because it seems no one knew how to solve, I try to add my
experiences, but unfortunately I can only say that I had a very
similar situation and didn't solve it.

> Phyo Wai Soe, November 28, 2013 12:36 PM
> I saw your mails to the list regarding the redir error message
> and hoped I could get some clues. So far, I am still stuck :(
> In my case, when I see redir_read messages in the server's
> syslog, it normally means that clients see "The connection was
> reset" error in their browsers and can't go anywhere. They
> don't even see the "redirecting" message with the animated
> circle (www/wait.gif).

I did some performance tests with kernel mode Coova (but not
using the original Coova Portal), but I also was not able to get
the redirects working. To progress, I manually authorized test
clients using chilli_query command line commands, as you did :)

> I tried different config settings. If I make HS_UAMLISTEN
> address in the same range as HS_NETWORK, clients do see
> redirection/login pages but that's all.

I think, following Davids annoucement mail, in main.conf "net"
should be e.g. in 10.1.1.0 and uamlisten e.g. 11.1.1.0. The up.sh
script generates different iptables rules; I think in your case
the traffic to the login page could even be passing by coova.

> I don't see any record in /proc/net/coova/chilli (which should
> happen if the kernel module mode is on)

I think only authorized clients appear here.

> or issue authorize, log out, etc., commands on the server with
> chilli_query. It's as if the commands don't have any effect on
> the clients.

I simply manually called chilli_query on shell command line to
authenticate my clients, then they appeared in the /proc file
output. I think this is expected: Coova handles all
non-authorized traffic. Sorry that I don't know why it is not
working for the redirects.

> However, if I make HS_UAMLISTEN address to be on
> another network range like David mentioned, clients get that
> connection reset error. But /proc/net/coova/chilli is populated
> and if I manually authorize a client, he/she can browse the
> web.

Do the counters of the -m coova firewall rules increase (e.g.
iptables-save -c)? If so, I think this proves the kernel module
is working (it matches packets, which then are routed by the
kernel). Maybe verify with "killall -STOP chilli", but I didn't
try.

> It's possible that there is a config problem or the NAT
> between UAMLISTEN and DHCPLISTEN has a issue. I am trying out
> all possible things I can think of but so far, I am not getting
> it right.

The portal I used responded with a redirect - to the current URL.
I thought it could be cause by the fact, that the client network
is within 10/8 as a "default" config may assume, but from 11/8,
because Coova performs some SNAT (?) of unauthorized clients. I
think you already tried, traced and verified that. Maybe it helps
to use a browser debugger like Firebug and check "Network" to see
what happens or even better tcpdump -w + Wireshark the traffic;
maybe the redirect works, but not the portal as in my case?

Sorry that I couldn't help you, but at least you know you are not
the only one who had such an issue :-)

Regards,
Steffen

_______________________________________________
Chilli mailing list
Chilli at coova.org<mailto:Chilli at coova.org>
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140409/d1efcc51/attachment.html>

From steffen.dettmer at nomadrail.com  Wed Apr  9 07:44:56 2014
From: steffen.dettmer at nomadrail.com (Steffen Dettmer)
Date: Wed, 9 Apr 2014 07:44:56 +0000
Subject: [Chilli] CoovaChilli Kernel Mode issue
In-Reply-To: <28706947.855546.1396925862687.JavaMail.root@frontiir.net>
References: <1561245260.281382.1385376623746.JavaMail.root@frontiir.net>
 <CACkgH70r=f46RvoS4oMzjVhMS8bN7MKCO71gUBYMCyWaaZ93aQ@mail.gmail.com>
 <1983365293.330957.1385606680205.JavaMail.root@frontiir.net>
 <CADao4CpUxeaSj1Q7iDuN1Wo=Of6EZzCPK7Fb7PQX7k5UXJD=2Q@mail.gmail.com>
 <826889934.520.1385638567614.JavaMail.root@frontiir.net>
 <89dfc8d931a2452488b0c5a4d03406e1@AM3PR05MB323.eurprd05.prod.outlook.com>
 <1896015655.107091.1386329013880.JavaMail.root@frontiir.net>
 <1396894994.91678.YahooMailNeo@web161704.mail.bf1.yahoo.com>
 <28706947.855546.1396925862687.JavaMail.root@frontiir.net>
Message-ID: <490b4be4f02948a8a5398b50feaa80b0@AMSPR05MB328.eurprd05.prod.outlook.com>

Hi,

Duplication of packets related to the redirect? Normally I would assume they shouldn't matter, because the redirect is HTTP via TCP and TCP shouldn't have any issue with packet duplication.

What indications did you found for duplication?

Also I think I verified that the kernel module does not forward such unauthorized traffic, for the kernel each packet sent by Coova on the tun should be a new packet, so I don't think firewall state (conntrack or such) is a hot candidate, either...

Steffen

-----Urspr?ngliche Nachricht-----
Von: Phyo Wai Soe [mailto:phyo.w.soe at frontiir.net] 
Gesendet: Dienstag, 8. April 2014 04:58
An: Tariq Ramadan
Cc: Steffen Dettmer; chilli at coova.org
Betreff: Re: [Chilli] CoovaChilli Kernel Mode issue

Hi Tariq,

We think that the issue arises from packet duplication between kernel and user space modules. The fact that so many of us are having the issue probably mean that the issue exists and packet routing rules need to be revised. I hope the next version of Coova addresses this.

Regards,
Phyo Wai Soe


----- Original Message -----
From: "Tariq Ramadan" <tr23101 at yahoo.com>
To: "Phyo Wai Soe" <phyo.w.soe at frontiir.net>, "Steffen Dettmer" <steffen.dettmer at nomadrail.com>
Cc: chilli at coova.org
Sent: Tuesday, April 8, 2014 12:53:14 AM
Subject: Re: [Chilli] CoovaChilli Kernel Mode issue

Hi,
I also have the similar problem which I wrote today:?http://lists.coova.org/pipermail/chilli/2014-April/002657.html
I tried the patches on 3 december(http://lists.coova.org/pipermail/chilli/2013-December/002489.html), but it doesn't change. Have you solved your problem?

Thanks.

On Friday, December 6, 2013 1:20 PM, Phyo Wai Soe <phyo.w.soe at frontiir.net> wrote:
 
Hi Steffen,

Your reply does give me some comfort :) . I have tried almost all the things you suggested. When we analyzed traffics on tun0 and eth0 of clients and the server with Wireshark, we saw some fishy things that may or may not indicate issues. Other possible sources of failure we are looking at are the kernel version we are using (Ubuntu 12.04) and the fact that we are running them on virtual machines. Maybe all they are needing are the patches you suggested on 3 Dec :)

Thanks.

Regards,
Phyo Wai Soe


----- Original Message -----
From: "Steffen Dettmer" <steffen.dettmer at nomadrail.com>
To: "Phyo Wai Soe" <phyo.w.soe at frontiir.net>, chilli at coova.org
Sent: Wednesday, December 4, 2013 11:18:00 PM
Subject: RE: CoovaChilli Kernel Mode issue

Hi,

because it seems no one knew how to solve, I try to add my experiences, but unfortunately I can only say that I had a very similar situation and didn't solve it.

> Phyo Wai Soe, November 28, 2013 12:36 PM I saw your mails to the list 
> regarding the redir error message and hoped I could get some clues. So 
> far, I am still stuck :( In my case, when I see redir_read messages in 
> the server's syslog, it normally means that clients see "The 
> connection was reset" error in their browsers and can't go anywhere. 
> They don't even see the "redirecting" message with the animated circle 
> (www/wait.gif).

I did some performance tests with kernel mode Coova (but not using the original Coova Portal), but I also was not able to get the redirects working. To progress, I manually authorized test clients using chilli_query command line commands, as you did :)

> I tried different config settings. If I make HS_UAMLISTEN address in 
> the same range as HS_NETWORK, clients do see redirection/login pages 
> but that's all.

I think, following Davids annoucement mail, in main.conf "net"
should be e.g. in 10.1.1.0 and uamlisten e.g. 11.1.1.0. The up.sh script generates different iptables rules; I think in your case the traffic to the login page could even be passing by coova.

> I don't see any record in /proc/net/coova/chilli (which should happen 
> if the kernel module mode is on)

I think only authorized clients appear here.

> or issue authorize, log out, etc., commands on the server with 
> chilli_query. It's as if the commands don't have any effect on the 
> clients.

I simply manually called chilli_query on shell command line to authenticate my clients, then they appeared in the /proc file output. I think this is expected: Coova handles all non-authorized traffic. Sorry that I don't know why it is not working for the redirects.

> However, if I make HS_UAMLISTEN address to be on another network range 
> like David mentioned, clients get that connection reset error. But 
> /proc/net/coova/chilli is populated and if I manually authorize a 
> client, he/she can browse the web.

Do the counters of the -m coova firewall rules increase (e.g.
iptables-save -c)? If so, I think this proves the kernel module is working (it matches packets, which then are routed by the kernel). Maybe verify with "killall -STOP chilli", but I didn't try.

> It's possible that there is a config problem or the NAT between 
> UAMLISTEN and DHCPLISTEN has a issue. I am trying out all possible 
> things I can think of but so far, I am not getting it right.

The portal I used responded with a redirect - to the current URL.
I thought it could be cause by the fact, that the client network is within 10/8 as a "default" config may assume, but from 11/8, because Coova performs some SNAT (?) of unauthorized clients. I think you already tried, traced and verified that. Maybe it helps to use a browser debugger like Firebug and check "Network" to see what happens or even better tcpdump -w + Wireshark the traffic; maybe the redirect works, but not the portal as in my case?

Sorry that I couldn't help you, but at least you know you are not the only one who had such an issue :-)

Regards,
Steffen

_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli

From phyo.w.soe at frontiir.net  Wed Apr  9 09:14:43 2014
From: phyo.w.soe at frontiir.net (Phyo Wai Soe)
Date: Wed, 9 Apr 2014 09:14:43 +0000 (UTC)
Subject: [Chilli] CoovaChilli Kernel Mode issue
In-Reply-To: <490b4be4f02948a8a5398b50feaa80b0@AMSPR05MB328.eurprd05.prod.outlook.com>
References: <1561245260.281382.1385376623746.JavaMail.root@frontiir.net>
 <CADao4CpUxeaSj1Q7iDuN1Wo=Of6EZzCPK7Fb7PQX7k5UXJD=2Q@mail.gmail.com>
 <826889934.520.1385638567614.JavaMail.root@frontiir.net>
 <89dfc8d931a2452488b0c5a4d03406e1@AM3PR05MB323.eurprd05.prod.outlook.com>
 <1896015655.107091.1386329013880.JavaMail.root@frontiir.net>
 <1396894994.91678.YahooMailNeo@web161704.mail.bf1.yahoo.com>
 <28706947.855546.1396925862687.JavaMail.root@frontiir.net>
 <490b4be4f02948a8a5398b50feaa80b0@AMSPR05MB328.eurprd05.prod.outlook.com>
Message-ID: <1035147984.877048.1397034883534.JavaMail.root@frontiir.net>

Hi Steffen,

We did tcpdumps on the Coova's tunnel interface and on clients. We found many duplicate acknowledgements and "TCP Previous segment lost" messages before the server sent reset packets to the client.

20:50:26.524474 IP 192.168.99.2.34415 > 192.168.99.1.3990: Flags [S], seq 2120304631, win 14600, options [mss 1460,sackOK,TS val 14568535 ecr 0,nop,wscale 3], length 0
20:50:26.524499 IP 192.168.99.1.3990 > 192.168.99.2.34415: Flags [S.], seq 3365942092, ack 2120304632, win 14480, options [mss 1460,sackOK,TS val 3557659 ecr 14568535,nop,wscale 3], length 0
20:50:26.529791 IP 192.168.99.2.34415 > 192.168.99.1.3990: Flags [.], ack 1, win 1825, options [nop,nop,TS val 14568535 ecr 3557659], length 0
20:50:26.530550 IP 192.168.99.2.34415 > 192.168.99.1.3990: Flags [.], ack 1, win 1825, options [nop,nop,TS val 14568535 ecr 3557659], length 0
20:50:26.531265 IP 192.168.99.2.34416 > 192.168.99.1.3990: Flags [S], seq 2564554410, win 14600, options [mss 1460,sackOK,TS val 14568536 ecr 0,nop,wscale 3], length 0
20:50:26.531286 IP 192.168.99.1.3990 > 192.168.99.2.34416: Flags [S.], seq 1593443429, ack 2564554411, win 14480, options [mss 1460,sackOK,TS val 3557661 ecr 14568536,nop,wscale 3], length 0
20:50:26.531548 IP 192.168.99.2.34416 > 192.168.99.1.3990: Flags [.], ack 933068581, win 1825, options [nop,nop,TS val 14568536 ecr 3557660], length 0
20:50:26.531563 IP 192.168.99.1.3990 > 192.168.99.2.34416: Flags [R], seq 2526512010, win 0, length 0
20:50:26.532146 IP 192.168.99.2.34416 > 192.168.99.1.3990: Flags [P.], seq 1:683, ack 933068581, win 1825, options [nop,nop,TS val 14568537 ecr 3557660], length 682
20:50:26.532158 IP 192.168.99.1.3990 > 192.168.99.2.34416: Flags [R], seq 2526512010, win 0, length 0

Regards,
Phyo Wai Soe


----- Original Message -----
From: "Steffen Dettmer" <steffen.dettmer at nomadrail.com>
To: "Phyo Wai Soe" <phyo.w.soe at frontiir.net>, "Tariq Ramadan" <tr23101 at yahoo.com>
Cc: chilli at coova.org
Sent: Wednesday, April 9, 2014 2:14:56 PM
Subject: AW: [Chilli] CoovaChilli Kernel Mode issue

Hi,

Duplication of packets related to the redirect? Normally I would assume they shouldn't matter, because the redirect is HTTP via TCP and TCP shouldn't have any issue with packet duplication.

What indications did you found for duplication?

Also I think I verified that the kernel module does not forward such unauthorized traffic, for the kernel each packet sent by Coova on the tun should be a new packet, so I don't think firewall state (conntrack or such) is a hot candidate, either...

Steffen

-----Urspr?ngliche Nachricht-----
Von: Phyo Wai Soe [mailto:phyo.w.soe at frontiir.net] 
Gesendet: Dienstag, 8. April 2014 04:58
An: Tariq Ramadan
Cc: Steffen Dettmer; chilli at coova.org
Betreff: Re: [Chilli] CoovaChilli Kernel Mode issue

Hi Tariq,

We think that the issue arises from packet duplication between kernel and user space modules. The fact that so many of us are having the issue probably mean that the issue exists and packet routing rules need to be revised. I hope the next version of Coova addresses this.

Regards,
Phyo Wai Soe


----- Original Message -----
From: "Tariq Ramadan" <tr23101 at yahoo.com>
To: "Phyo Wai Soe" <phyo.w.soe at frontiir.net>, "Steffen Dettmer" <steffen.dettmer at nomadrail.com>
Cc: chilli at coova.org
Sent: Tuesday, April 8, 2014 12:53:14 AM
Subject: Re: [Chilli] CoovaChilli Kernel Mode issue

Hi,
I also have the similar problem which I wrote today:?http://lists.coova.org/pipermail/chilli/2014-April/002657.html
I tried the patches on 3 december(http://lists.coova.org/pipermail/chilli/2013-December/002489.html), but it doesn't change. Have you solved your problem?

Thanks.

On Friday, December 6, 2013 1:20 PM, Phyo Wai Soe <phyo.w.soe at frontiir.net> wrote:
 
Hi Steffen,

Your reply does give me some comfort :) . I have tried almost all the things you suggested. When we analyzed traffics on tun0 and eth0 of clients and the server with Wireshark, we saw some fishy things that may or may not indicate issues. Other possible sources of failure we are looking at are the kernel version we are using (Ubuntu 12.04) and the fact that we are running them on virtual machines. Maybe all they are needing are the patches you suggested on 3 Dec :)

Thanks.

Regards,
Phyo Wai Soe


----- Original Message -----
From: "Steffen Dettmer" <steffen.dettmer at nomadrail.com>
To: "Phyo Wai Soe" <phyo.w.soe at frontiir.net>, chilli at coova.org
Sent: Wednesday, December 4, 2013 11:18:00 PM
Subject: RE: CoovaChilli Kernel Mode issue

Hi,

because it seems no one knew how to solve, I try to add my experiences, but unfortunately I can only say that I had a very similar situation and didn't solve it.

> Phyo Wai Soe, November 28, 2013 12:36 PM I saw your mails to the list 
> regarding the redir error message and hoped I could get some clues. So 
> far, I am still stuck :( In my case, when I see redir_read messages in 
> the server's syslog, it normally means that clients see "The 
> connection was reset" error in their browsers and can't go anywhere. 
> They don't even see the "redirecting" message with the animated circle 
> (www/wait.gif).

I did some performance tests with kernel mode Coova (but not using the original Coova Portal), but I also was not able to get the redirects working. To progress, I manually authorized test clients using chilli_query command line commands, as you did :)

> I tried different config settings. If I make HS_UAMLISTEN address in 
> the same range as HS_NETWORK, clients do see redirection/login pages 
> but that's all.

I think, following Davids annoucement mail, in main.conf "net"
should be e.g. in 10.1.1.0 and uamlisten e.g. 11.1.1.0. The up.sh script generates different iptables rules; I think in your case the traffic to the login page could even be passing by coova.

> I don't see any record in /proc/net/coova/chilli (which should happen 
> if the kernel module mode is on)

I think only authorized clients appear here.

> or issue authorize, log out, etc., commands on the server with 
> chilli_query. It's as if the commands don't have any effect on the 
> clients.

I simply manually called chilli_query on shell command line to authenticate my clients, then they appeared in the /proc file output. I think this is expected: Coova handles all non-authorized traffic. Sorry that I don't know why it is not working for the redirects.

> However, if I make HS_UAMLISTEN address to be on another network range 
> like David mentioned, clients get that connection reset error. But 
> /proc/net/coova/chilli is populated and if I manually authorize a 
> client, he/she can browse the web.

Do the counters of the -m coova firewall rules increase (e.g.
iptables-save -c)? If so, I think this proves the kernel module is working (it matches packets, which then are routed by the kernel). Maybe verify with "killall -STOP chilli", but I didn't try.

> It's possible that there is a config problem or the NAT between 
> UAMLISTEN and DHCPLISTEN has a issue. I am trying out all possible 
> things I can think of but so far, I am not getting it right.

The portal I used responded with a redirect - to the current URL.
I thought it could be cause by the fact, that the client network is within 10/8 as a "default" config may assume, but from 11/8, because Coova performs some SNAT (?) of unauthorized clients. I think you already tried, traced and verified that. Maybe it helps to use a browser debugger like Firebug and check "Network" to see what happens or even better tcpdump -w + Wireshark the traffic; maybe the redirect works, but not the portal as in my case?

Sorry that I couldn't help you, but at least you know you are not the only one who had such an issue :-)

Regards,
Steffen

_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli

From steffen.dettmer at nomadrail.com  Wed Apr  9 10:12:36 2014
From: steffen.dettmer at nomadrail.com (Steffen Dettmer)
Date: Wed, 9 Apr 2014 10:12:36 +0000
Subject: [Chilli] CoovaChilli Kernel Mode issue
In-Reply-To: <1035147984.877048.1397034883534.JavaMail.root@frontiir.net>
References: <1561245260.281382.1385376623746.JavaMail.root@frontiir.net>
 <CADao4CpUxeaSj1Q7iDuN1Wo=Of6EZzCPK7Fb7PQX7k5UXJD=2Q@mail.gmail.com>
 <826889934.520.1385638567614.JavaMail.root@frontiir.net>
 <89dfc8d931a2452488b0c5a4d03406e1@AM3PR05MB323.eurprd05.prod.outlook.com>
 <1896015655.107091.1386329013880.JavaMail.root@frontiir.net>
 <1396894994.91678.YahooMailNeo@web161704.mail.bf1.yahoo.com>
 <28706947.855546.1396925862687.JavaMail.root@frontiir.net>
 <490b4be4f02948a8a5398b50feaa80b0@AMSPR05MB328.eurprd05.prod.outlook.com>
 <1035147984.877048.1397034883534.JavaMail.root@frontiir.net>
Message-ID: <d3e6d76ab1534774bd1fbdac3bca9161@AMSPR05MB328.eurprd05.prod.outlook.com>

* Phyo Wai Soe [mailto:phyo.w.soe at frontiir.net]:
> Hi Steffen,
>
> We did tcpdumps on the Coova's tunnel interface and on clients. We found many duplicate acknowledgements and "TCP Previous segment lost" messages before the server sent reset packets to the client.

Hi,

thanks for the information! I don't understand the traces, same
packets look really strange, don't they?

> 20:50:26.524474 IP 192.168.99.2.34415 > 192.168.99.1.3990: Flags [S], seq 2120304631, win 14600, options [mss 1460,sackOK,TS val 14568535 ecr 0,nop,wscale 3], length 0
> 20:50:26.524499 IP 192.168.99.1.3990 > 192.168.99.2.34415: Flags [S.], seq 3365942092, ack 2120304632, win 14480, options [mss 1460,sackOK,TS val 3557659 ecr 14568535,nop,wscale 3], length 0
> 20:50:26.529791 IP 192.168.99.2.34415 > 192.168.99.1.3990: Flags [.], ack 1, win 1825, options [nop,nop,TS val 14568535 ecr 3557659], length 0
> 20:50:26.530550 IP 192.168.99.2.34415 > 192.168.99.1.3990: Flags [.], ack 1, win 1825, options [nop,nop,TS val 14568535 ecr 3557659], length 0

Yeah, this looks like a duplication... The timing is interesting, 0.7 ms.
In order of magnitude of a LAN, seems to bit too long for a local
package duplication effect.

looks like a working connection without any data (yet).
The ack of #3 and #4 are adjusted by tcpdump and look good.

Then the second connection on the new port:

> 20:50:26.531265 IP 192.168.99.2.34416 > 192.168.99.1.3990: Flags [S], seq 2564554410, win 14600, options [mss 1460,sackOK,TS val 14568536 ecr 0,nop,wscale 3], length 0
> 20:50:26.531286 IP 192.168.99.1.3990 > 192.168.99.2.34416: Flags [S.], seq 1593443429, ack 2564554411, win 14480, options [mss 1460,sackOK,TS val 3557661 ecr 14568536,nop,wscale 3], length 0
> 20:50:26.531548 IP 192.168.99.2.34416 > 192.168.99.1.3990: Flags [.], ack 933068581, win 1825, options [nop,nop,TS val 14568536 ecr 3557660], length 0

this looks odd, the ack number seems not to match anything, from
the client, 0.26ms (half the time as before) after the SYNACK.

> 20:50:26.531563 IP 192.168.99.1.3990 > 192.168.99.2.34416: Flags [R], seq 2526512010, win 0, length 0

This sequence number also is out of order (out of any receive
window we saw) but has no ACK set, as it is not part of an
established connection. Strange.

> 20:50:26.532146 IP 192.168.99.2.34416 > 192.168.99.1.3990: Flags [P.], seq 1:683, ack 933068581, win 1825, options [nop,nop,TS val 14568537 ecr 3557660], length 682
> 20:50:26.532158 IP 192.168.99.1.3990 > 192.168.99.2.34416: Flags [R], seq 2526512010, win 0, length 0

Interesting timing, 0.02ms, or maybe duplication after 0.59ms.

Do you know an explanation for all that?

Steffen


From phyo.w.soe at frontiir.net  Wed Apr  9 10:36:25 2014
From: phyo.w.soe at frontiir.net (Phyo Wai Soe)
Date: Wed, 9 Apr 2014 10:36:25 +0000 (UTC)
Subject: [Chilli] CoovaChilli Kernel Mode issue
In-Reply-To: <d3e6d76ab1534774bd1fbdac3bca9161@AMSPR05MB328.eurprd05.prod.outlook.com>
References: <1561245260.281382.1385376623746.JavaMail.root@frontiir.net>
 <89dfc8d931a2452488b0c5a4d03406e1@AM3PR05MB323.eurprd05.prod.outlook.com>
 <1896015655.107091.1386329013880.JavaMail.root@frontiir.net>
 <1396894994.91678.YahooMailNeo@web161704.mail.bf1.yahoo.com>
 <28706947.855546.1396925862687.JavaMail.root@frontiir.net>
 <490b4be4f02948a8a5398b50feaa80b0@AMSPR05MB328.eurprd05.prod.outlook.com>
 <1035147984.877048.1397034883534.JavaMail.root@frontiir.net>
 <d3e6d76ab1534774bd1fbdac3bca9161@AMSPR05MB328.eurprd05.prod.outlook.com>
Message-ID: <515015870.877538.1397039785022.JavaMail.root@frontiir.net>

Hi Steffen,

We think that the kernel is sending packets in parallel with the user space and the client is acknowledging them. When Coova user space program receives those duplicate ACKs, it resets the connection. I have a more complete dump that I attached with this email. You can analyze that and perhaps come up with a solution, if one is necessary :) 

Thanks.

client is 172.99.99.2. server - DHCP Listen 172.99.99.1, UAM listen 192.168.99.1

Regards,
Phyo Wai Soe


----- Original Message -----
From: "Steffen Dettmer" <steffen.dettmer at nomadrail.com>
To: "Phyo Wai Soe" <phyo.w.soe at frontiir.net>
Cc: "Tariq Ramadan" <tr23101 at yahoo.com>, chilli at coova.org
Sent: Wednesday, April 9, 2014 4:42:36 PM
Subject: AW: AW: [Chilli] CoovaChilli Kernel Mode issue

* Phyo Wai Soe [mailto:phyo.w.soe at frontiir.net]:
> Hi Steffen,
>
> We did tcpdumps on the Coova's tunnel interface and on clients. We found many duplicate acknowledgements and "TCP Previous segment lost" messages before the server sent reset packets to the client.

Hi,

thanks for the information! I don't understand the traces, same
packets look really strange, don't they?

> 20:50:26.524474 IP 192.168.99.2.34415 > 192.168.99.1.3990: Flags [S], seq 2120304631, win 14600, options [mss 1460,sackOK,TS val 14568535 ecr 0,nop,wscale 3], length 0
> 20:50:26.524499 IP 192.168.99.1.3990 > 192.168.99.2.34415: Flags [S.], seq 3365942092, ack 2120304632, win 14480, options [mss 1460,sackOK,TS val 3557659 ecr 14568535,nop,wscale 3], length 0
> 20:50:26.529791 IP 192.168.99.2.34415 > 192.168.99.1.3990: Flags [.], ack 1, win 1825, options [nop,nop,TS val 14568535 ecr 3557659], length 0
> 20:50:26.530550 IP 192.168.99.2.34415 > 192.168.99.1.3990: Flags [.], ack 1, win 1825, options [nop,nop,TS val 14568535 ecr 3557659], length 0

Yeah, this looks like a duplication... The timing is interesting, 0.7 ms.
In order of magnitude of a LAN, seems to bit too long for a local
package duplication effect.

looks like a working connection without any data (yet).
The ack of #3 and #4 are adjusted by tcpdump and look good.

Then the second connection on the new port:

> 20:50:26.531265 IP 192.168.99.2.34416 > 192.168.99.1.3990: Flags [S], seq 2564554410, win 14600, options [mss 1460,sackOK,TS val 14568536 ecr 0,nop,wscale 3], length 0
> 20:50:26.531286 IP 192.168.99.1.3990 > 192.168.99.2.34416: Flags [S.], seq 1593443429, ack 2564554411, win 14480, options [mss 1460,sackOK,TS val 3557661 ecr 14568536,nop,wscale 3], length 0
> 20:50:26.531548 IP 192.168.99.2.34416 > 192.168.99.1.3990: Flags [.], ack 933068581, win 1825, options [nop,nop,TS val 14568536 ecr 3557660], length 0

this looks odd, the ack number seems not to match anything, from
the client, 0.26ms (half the time as before) after the SYNACK.

> 20:50:26.531563 IP 192.168.99.1.3990 > 192.168.99.2.34416: Flags [R], seq 2526512010, win 0, length 0

This sequence number also is out of order (out of any receive
window we saw) but has no ACK set, as it is not part of an
established connection. Strange.

> 20:50:26.532146 IP 192.168.99.2.34416 > 192.168.99.1.3990: Flags [P.], seq 1:683, ack 933068581, win 1825, options [nop,nop,TS val 14568537 ecr 3557660], length 682
> 20:50:26.532158 IP 192.168.99.1.3990 > 192.168.99.2.34416: Flags [R], seq 2526512010, win 0, length 0

Interesting timing, 0.02ms, or maybe duplication after 0.59ms.

Do you know an explanation for all that?

Steffen

-------------- next part --------------
A non-text attachment was scrubbed...
Name: tun0svr2.pcap
Type: application/octet-stream
Size: 5659 bytes
Desc: not available
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140409/5b23b296/attachment-0001.obj>

From baguio.ivan at yahoo.com  Wed Apr  9 14:18:41 2014
From: baguio.ivan at yahoo.com (Ivan dominic Baguio)
Date: Wed, 9 Apr 2014 22:18:41 +0800 (SGT)
Subject: [Chilli] Chilli SSL Redirect on OpenWrt
Message-ID: <1397053121.28133.YahooMailNeo@web192701.mail.sg3.yahoo.com>

Heya folks!

I just installed coova chilli 1.2.9 in an openwrt router. Im running openwrt 12.09 attitude adjustment. I have configured everything well, everything is good. However, I noticed that when I go to a HTTPS website, chilli does not redirect me to the UAMSERVER, whereas if the connection is HTTP, redirection works awesome!

I did my homework, and searched for solutions, and found this one to be the best solution (http://www.linkedin.com/groups/Hello-All-help-https-redirection-158903.S.199271963). But im not sure how this would work on Openwrt. Im hoping that someone has already encountered this problem and would be kind enough to share a solution. Thanks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140409/cace7284/attachment.html>

From ben at gowasabi.net  Wed Apr  9 18:05:19 2014
From: ben at gowasabi.net (Ben West)
Date: Wed, 9 Apr 2014 13:05:19 -0500
Subject: [Chilli] Chilli SSL Redirect on OpenWrt
In-Reply-To: <1397053121.28133.YahooMailNeo@web192701.mail.sg3.yahoo.com>
References: <1397053121.28133.YahooMailNeo@web192701.mail.sg3.yahoo.com>
Message-ID: <CADSh-SN8yMv8E6AqNEPGtmZMwNP+jG9Pdvf0ngBjXZFUP5fQKg@mail.gmail.com>

I believe an underlying limitation to redirecting captured port 443
sessions to a portal via chilli, even to a portal over SSL, is that the
client's browser will probably throw up warnings or not follow the
redirection at all.  I.e. the browser you're using to test such redirection
may be silently rejecting it.  Maybe try different browsers to see if the
behavior changes, or if you get detailed errors/warnings.

Indeed, I've seen such warnings occasionally appear even when using a
captive portal on a properly configured instance of Ubiquiti UniFi AP
controller.

SSL is designed specifically to detect and warn about man-in-the-middle
interference, which is exactly what coovachilli would need to do to
redirect HTTPS sessions.

P.S. Do be sure that the instance OpenSSL you're using does not suffer from
the Heartbleed exploit: http://heartbleed.com .  Some browsers may soon
receive security updates that cause them reject connections to those SSL
services where this vulnerability is detected.



On Wed, Apr 9, 2014 at 9:18 AM, Ivan dominic Baguio
<baguio.ivan at yahoo.com>wrote:

> Heya folks!
>
> I just installed coova chilli 1.2.9 in an openwrt router. Im running
> openwrt 12.09 attitude adjustment. I have configured everything well,
> everything is good. However, I noticed that when I go to a HTTPS website,
> chilli does not redirect me to the UAMSERVER, whereas if the connection is
> HTTP, redirection works awesome!
>
> I did my homework, and searched for solutions, and found this one to be
> the best solution (
> http://www.linkedin.com/groups/Hello-All-help-https-redirection-158903.S.199271963).
> But im not sure how this would work on Openwrt. Im hoping that someone has
> already encountered this problem and would be kind enough to share a
> solution. Thanks.
>
>
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>


-- 
Ben West
http://gowasabi.net
ben at gowasabi.net
314-246-9434
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140409/b34c1ec2/attachment.html>

From lferreira at cabocom.cv  Sun Apr 13 20:57:49 2014
From: lferreira at cabocom.cv (Luis Ferreira)
Date: Sun, 13 Apr 2014 19:57:49 -0100
Subject: [Chilli] Compile options list
Message-ID: <006401cf575b$09111a70$1b334f50$@cabocom.cv>

Hi,

 

I've been for a couple of time now to try to find out an updated compile
options list for current Chilli source.

The only thing that I found out is on http://coova.org/CoovaChilli/Building,
but is extremely outdated.

 

Luis

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140413/b5f36415/attachment.html>

From xoneca at gmail.com  Sun Apr 13 22:05:41 2014
From: xoneca at gmail.com (Xabier Oneca -- xOneca)
Date: Mon, 14 Apr 2014 00:05:41 +0200
Subject: [Chilli] Compile options list
In-Reply-To: <006401cf575b$09111a70$1b334f50$@cabocom.cv>
References: <006401cf575b$09111a70$1b334f50$@cabocom.cv>
Message-ID: <CACkgH718TQ2cn6xeWcAoU=Ag_i0r1CnRwOUG2-E4_xGQctz8Gg@mail.gmail.com>

Hello Luis,

> I?ve been for a couple of time now to try to find out an updated compile
options list for current Chilli source.
>
> The only thing that I found out is on
http://coova.org/CoovaChilli/Building, but is extremely outdated.

You can get a list of build options for your downloaded sources if you run:

  ./configure --help

It will print a list of options similar of that on coova.org.

HTH,

Xabier Oneca_,,_
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140414/b9b0f4a8/attachment.html>

From ben at gowasabi.net  Mon Apr 14 01:11:00 2014
From: ben at gowasabi.net (Ben West)
Date: Sun, 13 Apr 2014 20:11:00 -0500
Subject: [Chilli] Compile options list
In-Reply-To: <006401cf575b$09111a70$1b334f50$@cabocom.cv>
References: <006401cf575b$09111a70$1b334f50$@cabocom.cv>
Message-ID: <CADSh-SP658t6RkF4V2Des-PWGGR9XYAtuneFNpKy8ZQN3PzPtw@mail.gmail.com>

Here are build options selected by the OpenWRT trunk packaging script:

./configure --target=mips-openwrt-linux --host=mips-openwrt-linux
--build=i686-linux-gnu --program-prefix= --program-suffix= --prefix=/usr
--exec-prefix=/usr --bindir=/usr/bin --sbindir=/usr/sbin
--libexecdir=/usr/lib --sysconfdir=/etc --datadir=/usr/share
--localstatedir=/var --mandir=/usr/man --infodir=/usr/info --disable-nls
--enable-chilliredir --disable-dnslog --disable-miniportal
--disable-useragent --disable-uamdomainfile --without-matrixssl
--with-cyaxssl --without-openssl

Here is the output of ./configure --help from the tarball that OpenWRT
trunk integrates:

`configure' configures coova-chilli 1.3.0 to adapt to many kinds of systems.

Usage: ./configure [OPTION]... [VAR=VALUE]...

To assign environment variables (e.g., CC, CFLAGS...), specify them as
VAR=VALUE.  See below for descriptions of some of the useful variables.

Defaults for the options are specified in brackets.

Configuration:
  -h, --help              display this help and exit
      --help=short        display options specific to this package
      --help=recursive    display the short help of all the included
packages
  -V, --version           display version information and exit
  -q, --quiet, --silent   do not print `checking ...' messages
      --cache-file=FILE   cache test results in FILE [disabled]
  -C, --config-cache      alias for `--cache-file=config.cache'
  -n, --no-create         do not create output files
      --srcdir=DIR        find the sources in DIR [configure dir or `..']

Installation directories:
  --prefix=PREFIX         install architecture-independent files in PREFIX
                          [/usr/local]
  --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
                          [PREFIX]

By default, `make install' will install all the files in
`/usr/local/bin', `/usr/local/lib' etc.  You can specify
an installation prefix other than `/usr/local' using `--prefix',
for instance `--prefix=$HOME'.

For better control, use the options below.

Fine tuning of the installation directories:
  --bindir=DIR            user executables [EPREFIX/bin]
  --sbindir=DIR           system admin executables [EPREFIX/sbin]
  --libexecdir=DIR        program executables [EPREFIX/libexec]
  --sysconfdir=DIR        read-only single-machine data [PREFIX/etc]
  --sharedstatedir=DIR    modifiable architecture-independent data
[PREFIX/com]
  --localstatedir=DIR     modifiable single-machine data [PREFIX/var]
  --libdir=DIR            object code libraries [EPREFIX/lib]
  --includedir=DIR        C header files [PREFIX/include]
  --oldincludedir=DIR     C header files for non-gcc [/usr/include]
  --datarootdir=DIR       read-only arch.-independent data root
[PREFIX/share]
  --datadir=DIR           read-only architecture-independent data
[DATAROOTDIR]
  --infodir=DIR           info documentation [DATAROOTDIR/info]
  --localedir=DIR         locale-dependent data [DATAROOTDIR/locale]
  --mandir=DIR            man documentation [DATAROOTDIR/man]
  --docdir=DIR            documentation root [DATAROOTDIR/doc/coova-chilli]
  --htmldir=DIR           html documentation [DOCDIR]
  --dvidir=DIR            dvi documentation [DOCDIR]
  --pdfdir=DIR            pdf documentation [DOCDIR]
  --psdir=DIR             ps documentation [DOCDIR]

Program names:
  --program-prefix=PREFIX            prepend PREFIX to installed program
names
  --program-suffix=SUFFIX            append SUFFIX to installed program
names
  --program-transform-name=PROGRAM   run sed PROGRAM on installed program
names

System types:
  --build=BUILD     configure for building on BUILD [guessed]
  --host=HOST       cross-compile to build programs to run on HOST [BUILD]

Optional Features:
  --disable-option-checking  ignore unrecognized --enable/--with options
  --disable-FEATURE       do not include FEATURE (same as
--enable-FEATURE=no)
  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
  --disable-dependency-tracking  speeds up one-time build
  --enable-dependency-tracking   do not reject slow dependency extractors
  --enable-shared[=PKGS]  build shared libraries [default=yes]
  --enable-static[=PKGS]  build static libraries [default=yes]
  --enable-fast-install[=PKGS]
                          optimize for fast installation [default=yes]
  --disable-libtool-lock  avoid locking (might break parallel builds)
  --disable-chilliquery   Disable chilli_query
  --disable-leakybucket   disable use of leaky bucket shaping
  --disable-uamanyip      disable use of uamanyip
  --disable-uamuiport     disable use of uamuiport
  --disable-accounting-onoff
                          disable use of Accounting-On and Accounting-Off
  --disable-tap           Disable support for tap interface (tun only)
  --disable-tcpreset      Disable support for TCP reset of filtered
                          connections
  --disable-radproxy      Disable support RADIUS (EAP) Proxy
  --disable-json          Disable support for JSON
  --disable-debug         Disable debugging messages
  --disable-dhcpradius    Disable support DHCP/RADIUS integration
  --enable-gardenaccounting
                          Enable walled garden accounting
  --enable-gardenext      Enable extended walled garden features
  --enable-inspect        Enable inspect feature in cmdsock
  --disable-coa           Disable CoA RADIUS support
  --enable-dhcpopt        Enable support for DHCP option setting
  --enable-debug2         Enable verbose debugging
  --enable-sessgarden     Enable support for session-based walled garden
  --enable-chillixml      Enable use of chillixml
  --enable-proxyvsa       Enable support for VSA attribute proxy
  --enable-dnslog         Enable support to log DNS name queries
  --enable-ipwhitelist    Enable file based IP white list
  --enable-uamdomainfile  Enable loading of mass uamdomains from file
  --enable-redirdnsreq    Enable the sending of a DNS query on redirect
  --disable-ieee8021q     disable support for IEEE 802.1Q
  --enable-largelimits    Enable larger limits for use with non-embedded
                          systems
  --enable-binstatusfile  Enable support for binary status file
  --enable-statusfile     Enable support for status file
  --enable-chilliproxy    Enable support for HTTP AAA Proxy
  --enable-multiroute     Enable support for multiple routes
  --enable-multilan       Enable support for multiple LANs
  --enable-chilliradsec   Enable support for RadSec AAA Proxy
  --enable-chilliredir    Enable support for Redir server
  --enable-chilliscript   Enable support for chilli_script helper
  --enable-cluster        Enable support for clustering
  --enable-sessionstate   Enable extended use of the
ChilliSpot-Session-State
                          attribute
  --enable-sessionid      Enable the use of the ChilliSpot-Session-Id
                          attribute
  --enable-apsessionid    Enable the use of the ChilliSpot-AP-Session-Id
                          attribute
  --disable-chillispotconfig
                          Disable the use of the ChilliSpot-Config attribute
  --enable-mdns           Enable support for MDNS
  --enable-netbios        Enable support for NetBIOS
  --enable-ieee8023       Enable support for IEEE 802.3 Ethernet
  --enable-pppoe          Enable support for PPPoE
  --enable-l2tpppp        Enable support for L2TP/PPP Tunneling
  --enable-eapol          Enable support for EAPOL
  --enable-miniportal     Enable support Coova miniportal
  --enable-miniconfig     Enable support minimal cmdline config
  --enable-ewtapi         Enable support for CoovaEWT API
  --enable-libjson        Enable support for libjson
  --enable-ssdp           Enable support for Simple Service Discovery
Protocol
  --enable-layer3         Enable support for Layer3 only operation
  --enable-modules        Enable dynamically loadable modules (experimental)
  --enable-extadmvsa      Enable admin-user VSA attribute support
  --enable-redirinject    Enable Redir content-injection support
  --enable-netnat         Enable net interface nat (experimental)
  --enable-useragent      Enable recording user-agent
  --enable-acceptlanguage Enable recording Accept-Language
  --enable-location       Enable Location Awareness
  --enable-config=file

Optional Packages:
  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
  --with-pic[=PKGS]       try to use only PIC/non-PIC objects [default=use
                          both]
  --with-gnu-ld           assume the C compiler uses GNU ld [default=no]
  --with-sysroot=DIR Search for dependent libraries within DIR
                        (or the compiler's sysroot if not specified).
  --with-openssl          enable support for openssl
  --with-matrixssl        enable support for matrixssl
  --with-cyassl           enable support for cyassl
  --with-matrixssl-cli    enable matrixssl client use
  --with-nfqueue          enable support for netfilter_queue
  --with-avl              enable support for avl library
  --with-nfcoova          enable support for coova netfilter module
  --without-sfhash        enable SuperFashHash use
  --with-lookup3          enable Jenkins lookup3 use
  --with-patricia         enable Patricia use
  --without-ipv6          enable IPv6
  --with-pcap             enable support for pcap
  --with-curl             enable support for curl
  --with-mmap             enable support for mmap
  --with-poll             enable support for poll
  --with-ipc-msg          enable support for msgsnd/msgrcv SV IPC

Some influential environment variables:
  CC          C compiler command
  CFLAGS      C compiler flags
  LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
              nonstandard directory <lib dir>
  LIBS        libraries to pass to the linker, e.g. -l<library>
  CPPFLAGS    (Objective) C/C++ preprocessor flags, e.g. -I<include dir> if
              you have headers in a nonstandard directory <include dir>
  CPP         C preprocessor

Use these variables to override the choices made by `configure' or to help
it to find libraries and programs with nonstandard names/locations.



On Sun, Apr 13, 2014 at 3:57 PM, Luis Ferreira <lferreira at cabocom.cv> wrote:

> Hi,
>
>
>
> I've been for a couple of time now to try to find out an updated compile
> options list for current Chilli source.
>
> The only thing that I found out is on
> http://coova.org/CoovaChilli/Building, but is extremely outdated.
>
>
>
> Luis
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>


-- 
Ben West
http://gowasabi.net
ben at gowasabi.net
314-246-9434
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140413/73c9d774/attachment-0001.html>

From alexandre.rubert at gmail.com  Mon Apr 14 08:16:56 2014
From: alexandre.rubert at gmail.com (Alexandre Rubert)
Date: Mon, 14 Apr 2014 10:16:56 +0200
Subject: [Chilli] Problem with proxy
Message-ID: <CAO+TAh0FZ125xM3NSPWc-7FwFRaT7Ub6edy1K95hHEcrqctrHw@mail.gmail.com>

Hello,
I installed coova on a debian in network with proxy. I configured my user
session with HTTP_PROXY but coova doesn't work. Is there an option in coova
to set http_proxy for all clients requests ?
Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140414/b076ffbd/attachment.html>

From lferreira at cabocom.cv  Mon Apr 14 19:36:08 2014
From: lferreira at cabocom.cv (Luis Ferreira)
Date: Mon, 14 Apr 2014 18:36:08 -0100
Subject: [Chilli] Chilli box only 1 LAN
Message-ID: <00c901cf5818$cae1aa80$60a4ff80$@cabocom.cv>

Hi,

 

Is it possible to put chilli running on a machine with only one LAN card?

 

i.e: Input(Web) is Untagged LAN and output (Subscriber) VLAN10 tagged

 

Regards,

Luis

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140414/f0fb3be0/attachment.html>

From john.paul at wanadoo.fr  Mon Apr 14 23:24:58 2014
From: john.paul at wanadoo.fr (John Paul)
Date: Tue, 15 Apr 2014 01:24:58 +0200
Subject: [Chilli] Chilli box only 1 LAN
In-Reply-To: <00c901cf5818$cae1aa80$60a4ff80$@cabocom.cv>
References: <00c901cf5818$cae1aa80$60a4ff80$@cabocom.cv>
Message-ID: <73560991.xi3vSzp2RU@antec>

Hi,
I don't think so.

Regards,
JP

On Monday, April 14, 2014 06:36:08 PM Luis Ferreira wrote:


Hi,
 
Is it possible to put chilli running on a machine with only one LAN card?
 
i.e: Input(Web) is Untagged LAN and output (Subscriber) VLAN10 tagged
 
Regards,
Luis


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140415/dc0a4f4f/attachment.html>

From steffen.dettmer at nomadrail.com  Tue Apr 15 07:18:40 2014
From: steffen.dettmer at nomadrail.com (Steffen Dettmer)
Date: Tue, 15 Apr 2014 07:18:40 +0000
Subject: [Chilli] Chilli box only 1 LAN
In-Reply-To: <00c901cf5818$cae1aa80$60a4ff80$@cabocom.cv>
References: <00c901cf5818$cae1aa80$60a4ff80$@cabocom.cv>
Message-ID: <4a52eaba32d3456c90a74c7bf656b7b9@AM3PR05MB323.eurprd05.prod.outlook.com>

Hi,

on Linux, are two interfaces (e.g. eth0 and eth0.10), so I think it should work (using eth0.10 as HS_LANIF).

Steffen

Von: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] Im Auftrag von Luis Ferreira
Gesendet: Montag, 14. April 2014 21:36
An: chilli at coova.org
Betreff: [Chilli] Chilli box only 1 LAN

Hi,

Is it possible to put chilli running on a machine with only one LAN card?

i.e: Input(Web) is Untagged LAN and output (Subscriber) VLAN10 tagged

Regards,
Luis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140415/522066c6/attachment.html>

From john.paul at wanadoo.fr  Tue Apr 15 07:48:35 2014
From: john.paul at wanadoo.fr (John Paul)
Date: Tue, 15 Apr 2014 09:48:35 +0200
Subject: [Chilli] Chilli box only 1 LAN
In-Reply-To: <4a52eaba32d3456c90a74c7bf656b7b9@AM3PR05MB323.eurprd05.prod.outlook.com>
References: <00c901cf5818$cae1aa80$60a4ff80$@cabocom.cv>
 <4a52eaba32d3456c90a74c7bf656b7b9@AM3PR05MB323.eurprd05.prod.outlook.com>
Message-ID: <2032850.e0s8nd2zsy@antec>

Hi,
Steffen, eth0.10 is an "alias" on eth0, it's a common way to set multiple IP on a single 
net card.
As I remember, once chilli is launched, it builds a tunnel between LAN and WAN cards. 
May am I wrong, but it's not possible to build a tunnel on virtual interface (eg. eth0:1).

John

On Tuesday, April 15, 2014 07:18:40 AM Steffen Dettmer wrote:


Hi,
 
on Linux, are two interfaces (e.g. eth0 and eth0.10), so I think it should work (using 
eth0.10 as HS_LANIF).
 
Steffen
 
*Von:* chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] *Im Auftrag von 
*Luis Ferreira

*Gesendet:* Montag, 14. April 2014 21:36

*An:* chilli at coova.org

*Betreff:* [Chilli] Chilli box only 1 LAN
 
Hi,
 
Is it possible to put chilli running on a machine with only one LAN card?
 
i.e: Input(Web) is Untagged LAN and output (Subscriber) VLAN10 tagged
 
Regards,
Luis 


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140415/1a904ff3/attachment.html>

From steffen.dettmer at nomadrail.com  Tue Apr 15 08:59:21 2014
From: steffen.dettmer at nomadrail.com (Steffen Dettmer)
Date: Tue, 15 Apr 2014 08:59:21 +0000
Subject: [Chilli] Chilli box only 1 LAN
In-Reply-To: <2032850.e0s8nd2zsy@antec>
References: <00c901cf5818$cae1aa80$60a4ff80$@cabocom.cv>
 <4a52eaba32d3456c90a74c7bf656b7b9@AM3PR05MB323.eurprd05.prod.outlook.com>
 <2032850.e0s8nd2zsy@antec>
Message-ID: <f46ac09764d845c3960de1931a574cd3@AM3PR05MB323.eurprd05.prod.outlook.com>

Hi John!

* John Paul:
> * Steffen:
> > on Linux, are two interfaces (e.g. eth0 and eth0.10), so I
> > think it should work (using eth0.10 as HS_LANIF).
> >
> Steffen, eth0.10 is an "alias" on eth0, it's a common way to set
> multiple IP on a single net card.
> As I remember, once chilli is launched, it builds a tunnel
> between LAN and WAN cards. May am I wrong, but it's not possible
> to build a tunnel on virtual interface (eg. eth0:1).

Yes, "eth0:0" is called an alias interface and was used in the past to
support multiple IP addresses (ifconfig eth0:0 <ip> up),
but "eth0.10" (dot instead of colon) is a VLAN
(ip link add link eth0 name eth0.10 type vlan id 10).

You are right that Coova won't work on alias interfaces like
"eth0:0", but it does work on VLAN interfaces like "eth0.10".

Steffen


From maxxer at ufficyo.com  Tue Apr 15 10:00:09 2014
From: maxxer at ufficyo.com (Lorenzo Milesi)
Date: Tue, 15 Apr 2014 12:00:09 +0200 (CEST)
Subject: [Chilli] Problem with proxy
In-Reply-To: <CAO+TAh0FZ125xM3NSPWc-7FwFRaT7Ub6edy1K95hHEcrqctrHw@mail.gmail.com>
References: <CAO+TAh0FZ125xM3NSPWc-7FwFRaT7Ub6edy1K95hHEcrqctrHw@mail.gmail.com>
Message-ID: <641964516.6813.1397556009810.JavaMail.zimbra@yetopen.it>

Probably 

HS_POSTAUTH_PROXY=192.168.182.1 
HS_POSTAUTH_PROXYPORT=8080 

----- Messaggio originale -----

> Da: "Alexandre Rubert" <alexandre.rubert at gmail.com>
> A: Chilli at coova.org
> Inviato: Luned?, 14 aprile 2014 10:16:56
> Oggetto: [Chilli] Problem with proxy

> Hello,
> I installed coova on a debian in network with proxy. I configured my user
> session with HTTP_PROXY but coova doesn't work. Is there an option in coova
> to set http_proxy for all clients requests ?
> Thanks

> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli

-- 
Lorenzo Milesi - lorenzo.milesi at yetopen.it 

YetOpen S.r.l. - http://www.yetopen.it/ 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140415/1a91c97a/attachment.html>

From maltara86 at gmail.com  Tue Apr 15 12:17:45 2014
From: maltara86 at gmail.com (Maria Lizarazo)
Date: Tue, 15 Apr 2014 07:17:45 -0500
Subject: [Chilli] Problem with proxy
In-Reply-To: <CABTDJHBFmcuRhmmBb=Vi1t633AgoL5s18XN0gx7KNq72G6Np-Q@mail.gmail.com>
References: <CABTDJHBFmcuRhmmBb=Vi1t633AgoL5s18XN0gx7KNq72G6Np-Q@mail.gmail.com>
Message-ID: <CABTDJHA4t5FcqsQUGJq-9dnnkrc=Ahb30KtDO3mwEaC9WGeftw@mail.gmail.com>

>
> Message: 1
> Date: Tue, 15 Apr 2014 12:00:09 +0200 (CEST)
> From: Lorenzo Milesi <maxxer at ufficyo.com>
> To: Chilli at coova.org
> Subject: Re: [Chilli] Problem with proxy
> Message-ID: <641964516.6813.1397556009810.JavaMail.zimbra at yetopen.it>
> Content-Type: text/plain; charset="utf-8"

Those parameters only work for authenticated clients. Do you need to apply
the proxy variable before the captive portal?

> Probably
>
> HS_POSTAUTH_PROXY=192.168.182.1
> HS_POSTAUTH_PROXYPORT=8080
>
> ----- Messaggio originale -----
>
> > Da: "Alexandre Rubert" <alexandre.rubert at gmail.com>
> > A: Chilli at coova.org
> > Inviato: Luned?, 14 aprile 2014 10:16:56
> > Oggetto: [Chilli] Problem with proxy
>
> > Hello,
> > I installed coova on a debian in network with proxy. I configured my
user
> > session with HTTP_PROXY but coova doesn't work. Is there an option in
coova
> > to set http_proxy for all clients requests ?
> > Thanks
>
> > _______________________________________________
> > Chilli mailing list
> > Chilli at coova.org
> > http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
> --
> Lorenzo Milesi - lorenzo.milesi at yetopen.it
>
> YetOpen S.r.l. - http://www.yetopen.it/
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
http://lists.coova.org/pipermail/chilli/attachments/20140415/1a91c97a/attachment-0001.html
>
>
> ------------------------------
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
> End of Chilli Digest, Vol 53, Issue 15
> **************************************
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140415/b740d46c/attachment.html>

From alexandre.rubert at gmail.com  Tue Apr 15 15:04:58 2014
From: alexandre.rubert at gmail.com (Alexandre Rubert)
Date: Tue, 15 Apr 2014 17:04:58 +0200
Subject: [Chilli] Problem with proxy
In-Reply-To: <CABTDJHA4t5FcqsQUGJq-9dnnkrc=Ahb30KtDO3mwEaC9WGeftw@mail.gmail.com>
References: <CABTDJHBFmcuRhmmBb=Vi1t633AgoL5s18XN0gx7KNq72G6Np-Q@mail.gmail.com>
 <CABTDJHA4t5FcqsQUGJq-9dnnkrc=Ahb30KtDO3mwEaC9WGeftw@mail.gmail.com>
Message-ID: <CAO+TAh0EYyYj01-OX7x_RrEm32hz1iB_+MFNCYN7-i3QMRU29A@mail.gmail.com>

I configured http_proxy env variable so coova managed to search all
uamallowed and uamdomain but clients are not automaticaly connected to the
proxy. I don't want to configure all clients.
Le 15 avr. 2014 14:23, "Maria Lizarazo" <maltara86 at gmail.com> a ?crit :

>
> >
> > Message: 1
> > Date: Tue, 15 Apr 2014 12:00:09 +0200 (CEST)
> > From: Lorenzo Milesi <maxxer at ufficyo.com>
> > To: Chilli at coova.org
> > Subject: Re: [Chilli] Problem with proxy
> > Message-ID: <641964516.6813.1397556009810.JavaMail.zimbra at yetopen.it>
> > Content-Type: text/plain; charset="utf-8"
>
> Those parameters only work for authenticated clients. Do you need to apply
> the proxy variable before the captive portal?
>
> > Probably
> >
> > HS_POSTAUTH_PROXY=192.168.182.1
> > HS_POSTAUTH_PROXYPORT=8080
> >
> > ----- Messaggio originale -----
> >
> > > Da: "Alexandre Rubert" <alexandre.rubert at gmail.com>
> > > A: Chilli at coova.org
> > > Inviato: Luned?, 14 aprile 2014 10:16:56
> > > Oggetto: [Chilli] Problem with proxy
> >
> > > Hello,
> > > I installed coova on a debian in network with proxy. I configured my
> user
> > > session with HTTP_PROXY but coova doesn't work. Is there an option in
> coova
> > > to set http_proxy for all clients requests ?
> > > Thanks
> >
> > > _______________________________________________
> > > Chilli mailing list
> > > Chilli at coova.org
> > > http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> >
> > --
> > Lorenzo Milesi - lorenzo.milesi at yetopen.it
> >
> > YetOpen S.r.l. - http://www.yetopen.it/
> > -------------- next part --------------
> > An HTML attachment was scrubbed...
> > URL: <
> http://lists.coova.org/pipermail/chilli/attachments/20140415/1a91c97a/attachment-0001.html
> >
> >
> > ------------------------------
> >
> > _______________________________________________
> > Chilli mailing list
> > Chilli at coova.org
> > http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> >
> >
> > End of Chilli Digest, Vol 53, Issue 15
> > **************************************
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140415/4f34197a/attachment.html>

From baguio.ivan at yahoo.com  Wed Apr 16 13:04:13 2014
From: baguio.ivan at yahoo.com (Ivan dominic Baguio)
Date: Wed, 16 Apr 2014 21:04:13 +0800 (SGT)
Subject: [Chilli] chilli HTTPS JSON interface
Message-ID: <1397653453.39391.YahooMailNeo@web192703.mail.sg3.yahoo.com>

Hi all!

I was just wondering if it is possible to access the chilli JSON interface via HTTPS.

Cheers
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140416/0d29eb28/attachment.html>

From maltara86 at gmail.com  Wed Apr 16 14:17:07 2014
From: maltara86 at gmail.com (Maria Lizarazo)
Date: Wed, 16 Apr 2014 09:17:07 -0500
Subject: [Chilli] Problem with proxy
Message-ID: <CABTDJHA_Jc=7eNfBnvw1VkvePiFgHApXV0nn0X9sDVRZ+TwGVQ@mail.gmail.com>

>
> ------------------------------
>
> Message: 2
> Date: Tue, 15 Apr 2014 17:04:58 +0200
> From: Alexandre Rubert <alexandre.rubert at gmail.com>
> To: chilli at coova.org
> Subject: Re: [Chilli] Problem with proxy
> Message-ID:
>         <
> CAO+TAh0EYyYj01-OX7x_RrEm32hz1iB_+MFNCYN7-i3QMRU29A at mail.gmail.com>
> Content-Type: text/plain; charset="utf-8"
>

 I've been trying to setup a redirection that would "bypass" the proxy and
redirect the unauthenticated clients to the captive portal. The proxy is
properly configurated, but if I enable it the clients don't get redirected.
If I disable it, the clients get redirected as usual.
I believe it is something between the connection of the proxy and coova,
but I haven't figured it out yet.

>
> I configured http_proxy env variable so coova managed to search all
> uamallowed and uamdomain but clients are not automaticaly connected to the
> proxy. I don't want to configure all clients.
> Le 15 avr. 2014 14:23, "Maria Lizarazo" <maltara86 at gmail.com> a ?crit :
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140416/5d0e40cc/attachment.html>

From james at purple.so  Tue Apr 22 13:38:22 2014
From: james at purple.so (james at purple.so)
Date: Tue, 22 Apr 2014 14:38:22 +0100
Subject: [Chilli] Multiple processes spawned - problem?
Message-ID: <0d4301cf5e30$2214bfa0$663e3ee0$@purple.so>

Good afternoon all

 

On monitoring a customer's router that is having problems with people
logging in through Coova, we've noticed that there are often more than one
/usr/sbin/chilli processes running at the same time. Does Coova span more
processes itself automatically, or is there some configuration issue? We are
in layer 2 mode and not running multi-tenancy etc.

 

When Coova starts up its ok, just one process, but after a few people log on
and get to the splash page etc that's when more processes appear to show up.

Thanks

James

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140422/6f023594/attachment.html>

From techkidghana at gmail.com  Tue Apr 22 16:33:05 2014
From: techkidghana at gmail.com (Bill Dorsey Jobs)
Date: Tue, 22 Apr 2014 16:33:05 +0000
Subject: [Chilli] Logout with radclient
Message-ID: <CAKSqJ6iPTc7RJi8Smw5sV+FrwWsuUcPsH8AE5jjONn73UYB5=w@mail.gmail.com>

Hello Guys,

I am using radclient to logout users with the command below

echo "User-Name='{username}'" | radclient -x {localhost}:{port} disconnect
radiusSecret

this works fine except that the port number changes from time to time and i
have to manually edit the port number for the logout mechanism to work
everytime.

Could you please tell, if its possible to set a static port number or if
that is not possible, a better way to logout users where NAS informs
freeradius to logout a user?

I will appreciate it.

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140422/987ef643/attachment.html>

From lferreira at cabocom.cv  Tue Apr 22 23:38:50 2014
From: lferreira at cabocom.cv (Luis Ferreira)
Date: Tue, 22 Apr 2014 22:38:50 -0100
Subject: [Chilli] load balancing
Message-ID: <013f01cf5e84$05ef8130$11ce8390$@cabocom.cv>

Hi everyone,

 

Is it possible to setup coova to give different gateway to costumers. Like
having 2 gateways and for each subscriber authenticated, it is designated
one of the gateways, balancing that way several connections.

 

 

Regards,

Luis

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140422/1463fced/attachment.html>

From loic.soulas at openevents.fr  Thu Apr 24 09:35:43 2014
From: loic.soulas at openevents.fr (Loic SOULAS)
Date: Thu, 24 Apr 2014 11:35:43 +0200
Subject: [Chilli] status none
Message-ID: <4A35FD60-36D0-4C3E-A0C6-5291579D7FDC@openevents.fr>

Hello,

We encountered an issue with coova chilli 1.2.9 ( under Debian wheezy 7.4).
Some people get troubles when attempting to connect to the hotspot/portal
When we run the command chilli_query list on the server, we se that some connections are pending with status ? none ?.
In this case we have to run chilli_query logout <mac address> in order to make the DNAT status work for those connections.

Could you please explain us what does the ? none ? status means, and what are the circumstances that can make this problem happen?


Regards,
Lo?c



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140424/1c011a90/attachment.html>

From alexander.szlezak at unwired.at  Thu Apr 24 10:07:35 2014
From: alexander.szlezak at unwired.at (Alexander Szlezak)
Date: Thu, 24 Apr 2014 12:07:35 +0200
Subject: [Chilli] status none
In-Reply-To: <4A35FD60-36D0-4C3E-A0C6-5291579D7FDC@openevents.fr>
References: <4A35FD60-36D0-4C3E-A0C6-5291579D7FDC@openevents.fr>
Message-ID: <5358E267.8050100@unwired.at>

Hi Loic,

To my knowledge, "none" users occur if chilli recognizes a client on 
layer2 (arp/mac address level), but no dhcp ack packet was received, 
thus the client has no layer3 connectivity. Usually in our setup this is 
due to bad wifi reception, packets lost on the way from the access point 
to our central chilli controler etc.  We're not 100  % sure though if 
other reasons exist and we have reason to assue that sometimes, if our 
chilli controller runs havoc, none users exist.

best,
Alexander


Am 24.04.14 11:35, schrieb Loic SOULAS:
> Hello,
>
> We encountered an issue with coova chilli 1.2.9 ( under Debian wheezy 
> 7.4).
> Some people get troubles when attempting to connect to the hotspot/portal
> When we run the command chilli_query list on the server, we se that 
> some connections are pending with status ? none ?.
> In this case we have to run chilli_query logout <mac address> in order 
> to make the DNAT status work for those connections.
>
> Could you please explain us what does the ? none ? status means, and 
> what are the circumstances that can make this problem happen?
>
>
> Regards,
> Lo?c
>
>
>
>
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli

-- 
Follow us on Twitter @
http://twitter.com/unwirednetworks
_____________________________________________________
Mag. Alexander Szlezak          Unwired Networks GmbH
Gesch?ftsf?hrer

+43 660 1350410
alexander.szlezak at unwired.at           www.unwired.at
twitter.com/unwirednetworks

Rechnungsadresse                        B?roanschrift
Reischergasse 6/2                  Gonzagagasse 11/25
1130 Vienna, Austria         A-1010 Vienna, Austria

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140424/68f77621/attachment.html>

From Liam.Dennehy at paperlinx.com  Thu Apr 24 10:39:29 2014
From: Liam.Dennehy at paperlinx.com (Dennehy, Liam)
Date: Thu, 24 Apr 2014 11:39:29 +0100
Subject: [Chilli] miniportal: wwwsh wrapper not receiving POST via stdin for
	login.chi
Message-ID: <6239A24C38D2594FB682374DF81215834B2E826B0A@GBDCCCR01.PaperlinX-EU.Local>

Hi all

I've been trying to figure out how to get this issue solved for some time, hopefully this is the right forum.

I'm running CoovaChilli on OpenWRT Barrier Breaker (trunk). The miniportal's wwwsh wrapper does not seem to have the client's POST response to login.chi either in stdin or as a shell variable which haserl is expecting to see when handling login.chi. As a result, the connection is terminated as soon as login.chi fails, citing a lack of input.

A packet trace shows POST data in the client's submission of 106 bytes, and a shell variable CONTENT_LENGTH inside the wwwsh image also 106 bytes, but the actual POST data is neither in stdin nor any shell variable. From my limited knowledge of C I can't see how this is ever submitted to the execv calling _options.wwwbin, so I have no idea where else to look.

All other functions appear to be working fine - DHCP, DNS forwarding, even opening the status.chi page and authenticating there passes to RADIUS just fine (that script has no stdin requirement apparently).

This is the last piece before I declare everything functional and can start rollout, and I've kept all my changes ready to publish to upstream to both OpenWRT and anyone else so I'm keen to get this solved.

Liam Dennehy
PaperlinX Europe


________________________________
This email is privileged and confidential and is intended only for those to whom it is addressed. If you are not the intended recipient then any disclosure, dissemination, copying or use of the information is strictly prohibited. If you have received this email in error, please notify this office immediately by return email.

Before opening any attachments please make sure they have been checked for viruses and defects.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140424/a3014a2f/attachment.html>

From loic.soulas at openevents.fr  Thu Apr 24 12:16:08 2014
From: loic.soulas at openevents.fr (Loic SOULAS)
Date: Thu, 24 Apr 2014 14:16:08 +0200
Subject: [Chilli] status none
In-Reply-To: <5358E267.8050100@unwired.at>
References: <4A35FD60-36D0-4C3E-A0C6-5291579D7FDC@openevents.fr>
 <5358E267.8050100@unwired.at>
Message-ID: <F0739678-5233-4083-8053-F017499C6A08@openevents.fr>

Hi Alexander

thanks for your help,
even if there is bad wifi reception, is it normal that the client still gets the none status in return when he tries to reconnect,
because when we do chilli_query logout <mac address> and retry to connect the client it succeeds.

regards
Lo?c


Le 24 avr. 2014 ? 12:07, Alexander Szlezak <alexander.szlezak at unwired.at> a ?crit :

> Hi Loic,
> 
> To my knowledge, "none" users occur if chilli recognizes a client on layer2 (arp/mac address level), but no dhcp ack packet was received, thus the client has no layer3 connectivity. Usually in our setup this is due to bad wifi reception, packets lost on the way from the access point to our central chilli controler etc.  We're not 100  % sure though if other reasons exist and we have reason to assue that sometimes, if our chilli controller runs havoc, none users exist. 
> 
> best,
> Alexander
> 
> 
> Am 24.04.14 11:35, schrieb Loic SOULAS:
>> Hello,
>> 
>> We encountered an issue with coova chilli 1.2.9 ( under Debian wheezy 7.4).
>> Some people get troubles when attempting to connect to the hotspot/portal
>> When we run the command chilli_query list on the server, we se that some connections are pending with status ? none ?.
>> In this case we have to run chilli_query logout <mac address> in order to make the DNAT status work for those connections.
>> 
>> Could you please explain us what does the ? none ? status means, and what are the circumstances that can make this problem happen?
>> 
>> 
>> Regards,
>> Lo?c
>> 
>> 
>> 
>> 
>> 
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> 
> -- 
> Follow us on Twitter @
> http://twitter.com/unwirednetworks
> _____________________________________________________
> Mag. Alexander Szlezak          Unwired Networks GmbH
> Gesch?ftsf?hrer
> 
> +43 660 1350410
> alexander.szlezak at unwired.at           www.unwired.at
> twitter.com/unwirednetworks
> 
> Rechnungsadresse                        B?roanschrift
> Reischergasse 6/2                  Gonzagagasse 11/25
> 1130 Vienna, Austria         A-1010 Vienna, Austria 
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140424/752bbb22/attachment.html>

From bojan at gajba.net  Thu Apr 24 13:47:11 2014
From: bojan at gajba.net (Bojan Pogacar)
Date: Thu, 24 Apr 2014 15:47:11 +0200
Subject: [Chilli] status none
In-Reply-To: <535912F2.7080009@gajba.net>
References: <535912F2.7080009@gajba.net>
Message-ID: <535915DF.5000908@gajba.net>

Hello!

I have simmilar problems sometimes.

I get this when I do chilli_query list

00-50-FC-D2-53-C6 0.0.0.0 none 53590fe60000000d 0 - 0/0 0/0 0/0 0/0 0 0
0/0 0/0 -

BUT, in that case MAC address in that output is WRONG. The corrct one is 
00-50-FC-D2-53-9A and client computer also releases IP to 169...., but 
gateway and netmask stay correct.

Client can reconnect if I do ipconfig /renew on client computer.

Regards.




Dne 24.4.2014 14:16, pi?e Loic SOULAS:
> Hi Alexander
>
> thanks for your help,
> even if there is bad wifi reception, is it normal that the client still
> gets the none status in return when he tries to reconnect,
> because when we do chilli_query logout <mac address> and retry to
> connect the client it succeeds.
>
> regards
> Lo?c
>
>
> Le 24 avr. 2014 ? 12:07, Alexander Szlezak <alexander.szlezak at unwired.at
> <mailto:alexander.szlezak at unwired.at>> a ?crit :
>
>> Hi Loic,
>>
>> To my knowledge, "none" users occur if chilli recognizes a client on
>> layer2 (arp/mac address level), but no dhcp ack packet was received,
>> thus the client has no layer3 connectivity. Usually in our setup this
>> is due to bad wifi reception, packets lost on the way from the access
>> point to our central chilli controler etc.  We're not 100  % sure
>> though if other reasons exist and we have reason to assue that
>> sometimes, if our chilli controller runs havoc, none users exist.
>>
>> best,
>> Alexander
>>
>>
>> Am 24.04.14 11:35, schrieb Loic SOULAS:
>>> Hello,
>>>
>>> We encountered an issue with coova chilli 1.2.9 ( under Debian wheezy
>>> 7.4).
>>> Some people get troubles when attempting to connect to the hotspot/portal
>>> When we run the command chilli_query list on the server, we se that
>>> some connections are pending with status ? none ?.
>>> In this case we have to run chilli_query logout <mac address> in
>>> order to make the DNAT status work for those connections.
>>>
>>> Could you please explain us what does the ? none ? status means, and
>>> what are the circumstances that can make this problem happen?
>>>
>>>
>>> Regards,
>>> Lo?c
>>>
>>>
>>>
>>>
>>>
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>
>> --
>> Follow us on Twitter @
>> http://twitter.com/unwirednetworks
>> _____________________________________________________
>> Mag. Alexander Szlezak          Unwired Networks GmbH
>> Gesch?ftsf?hrer
>>
>> +43 660 1350410
>> alexander.szlezak at unwired.at            www.unwired.at
>> twitter.com/unwirednetworks  <http://twitter.com/unwirednetworks>
>>
>> Rechnungsadresse                        B?roanschrift
>> Reischergasse 6/2                  Gonzagagasse 11/25
>> 1130 Vienna, Austria         A-1010 Vienna, Austria
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org <mailto:Chilli at coova.org>
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>

-- 
Lep pozdrav,

Bojan Poga?ar
GSM: 031 262 535



From james at purple.so  Tue Apr 29 07:05:56 2014
From: james at purple.so (james at purple.so)
Date: Tue, 29 Apr 2014 08:05:56 +0100
Subject: [Chilli] CoovaChilli uam secret / RADIUS secret causing random
	corrupt user passwords
Message-ID: <09bc01cf6379$78617800$69246800$@purple.so>

Hi All

We have a random problem that keeps showing up.

We have CoovaChilli configured to use a uam secret and radius secret as
normal, but randomly, we will have a user who tried to log on be rejected by
our FreeRADIUS server because of what appears to be a garbage/corrupt
password. Looking online this indicates that either the shared secret or
uamsecret is incorrect, but they are definitely correct, and all others
users can log on 99% of this time, so it's just random.

We can even have one user rejected and then another one who logs on straight
after with no issue, so the secrets must be correct.

Looking in our radius logs shows the garbage password, like:

User / Pass / Reply / Date
myusername / B=C2=D4=D0=0B=F9=EB=C8d=7E=A3=C0=E6=7CY=FAF=95=D6= /
Access-Reject / 2014-04-28 21:03:51
myusername2 / =04=DFH4:J=C9z=C8=8A=3D=82=C1=C9=DA2W=8D=19=60=3CN /
Access-Reject / 2014-04-28 21:03:52

Normal login show the expected password.

Can anyone shed any further light?

Thanks

James



From lferreira at cabocom.cv  Tue Apr 29 10:01:04 2014
From: lferreira at cabocom.cv (Luis Ferreira)
Date: Tue, 29 Apr 2014 09:01:04 -0100
Subject: [Chilli] CoovaChilli uam secret / RADIUS secret causing
	random	corrupt user passwords
In-Reply-To: <09bc01cf6379$78617800$69246800$@purple.so>
References: <09bc01cf6379$78617800$69246800$@purple.so>
Message-ID: <042001cf6391$f05eb4e0$d11c1ea0$@cabocom.cv>

Hi James,

What you are experiencing is not a random error. When you see that on radius
log, it means a wrong CHAP Challenge.
With us, it happens when a subscriber opens 2 login pages, but try to make
the login with the 1th one. For chilli and Radius, the correct CHAP
challenge is the second one (most recent for that IP), meaning that the
request being sent is not "readable/decrypted" by radius. 
Check with the subscriber for several login pages being open, background
software that might use port 80 (causing login pages to popup), etc...


Luis Ferreira


-----Mensagem original-----
De: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] Em nome de
james at purple.so
Enviada: 29 de abril de 2014 06:06
Para: chilli at coova.org
Assunto: [Chilli] CoovaChilli uam secret / RADIUS secret causing random
corrupt user passwords

Hi All

We have a random problem that keeps showing up.

We have CoovaChilli configured to use a uam secret and radius secret as
normal, but randomly, we will have a user who tried to log on be rejected by
our FreeRADIUS server because of what appears to be a garbage/corrupt
password. Looking online this indicates that either the shared secret or
uamsecret is incorrect, but they are definitely correct, and all others
users can log on 99% of this time, so it's just random.

We can even have one user rejected and then another one who logs on straight
after with no issue, so the secrets must be correct.

Looking in our radius logs shows the garbage password, like:

User / Pass / Reply / Date
myusername / B=C2=D4=D0=0B=F9=EB=C8d=7E=A3=C0=E6=7CY=FAF=95=D6= /
Access-Reject / 2014-04-28 21:03:51
myusername2 / =04=DFH4:J=C9z=C8=8A=3D=82=C1=C9=DA2W=8D=19=60=3CN /
Access-Reject / 2014-04-28 21:03:52

Normal login show the expected password.

Can anyone shed any further light?

Thanks

James


_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


From maxxer at ufficyo.com  Tue Apr 29 15:20:19 2014
From: maxxer at ufficyo.com (Lorenzo Milesi)
Date: Tue, 29 Apr 2014 17:20:19 +0200 (CEST)
Subject: [Chilli] OpenWRT and redirssl
In-Reply-To: <702870183.4688.1398784617487.JavaMail.zimbra@yetopen.it>
Message-ID: <2099711209.4695.1398784819222.JavaMail.zimbra@yetopen.it>

Hi.
Anyone is using redirssl on embedded devices?
Apparently neither OpenWRT and DDWRT do compile their Coova packages with openssl, thus redirssl not working.

Any package available around?
thanks
-- 
Lorenzo Milesi - lorenzo.milesi at yetopen.it

YetOpen S.r.l. - http://www.yetopen.it/


From lferreira at cabocom.cv  Tue Apr 29 20:28:54 2014
From: lferreira at cabocom.cv (Luis Ferreira)
Date: Tue, 29 Apr 2014 19:28:54 -0100
Subject: [Chilli] Dev Help
Message-ID: <048201cf63e9$a5ad46c0$f107d440$@cabocom.cv>

Hi everyone,

 

I would like your opinion on how to develop on CoovaChilli. Was it developed
using vi or nano, or was developed using some IDE like eclipse, Kdevelop,
etc.

What are the advises that I can get from you gurus that program on the
source.

 

 

Regards,

Luis

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140429/f02f1b1a/attachment.html>

From james at purple.so  Tue Apr 29 21:29:13 2014
From: james at purple.so (james at purple.so)
Date: Tue, 29 Apr 2014 22:29:13 +0100
Subject: [Chilli] CoovaChilli uam secret / RADIUS secret causing
Message-ID: <0ac601cf63f2$11e7e7c0$35b7b740$@purple.so>

Hi Luis

Thanks very much for your reply.

Yes, I had thought this may be the issue, but I assumed that coova does not
re-generate a new challenge for every HTTP request a client makes. To test,
I opened 10 tabs in my browser, and 5 tabs in another browser, and the
"challenge" value in the URL was the same across them all. We notice the
challenge does change after around 10 minutes though (it must time out)...

We've recently modified the coova code to generate the challenge based on
something more unique to the user (their mac address, plus a secret, then
hashed), rather than what coova uses by default (a 16 character string from
/dev/random), so now, the challenge is unique per client MAC, and therefore
no matter what sessions they have open it will always be the same
"challenge". Does that make sense? Even if they return in 1 hour, the
challenge is the same, and only we know what the challenge is made up from
on our external splash page side.

But, I think coova should ensure that the same challenge is given to the
same client MAC, as without it, it's near impossible to know which challenge
to use at the correct one when encrypting the password to send back to coova
for the login (we use an external splash page).

What are your thoughts?

Thanks

James



From lferreira at cabocom.cv  Tue Apr 29 21:59:23 2014
From: lferreira at cabocom.cv (Luis Ferreira)
Date: Tue, 29 Apr 2014 20:59:23 -0100
Subject: [Chilli] CoovaChilli uam secret / RADIUS secret causing
In-Reply-To: <0ac601cf63f2$11e7e7c0$35b7b740$@purple.so>
References: <0ac601cf63f2$11e7e7c0$35b7b740$@purple.so>
Message-ID: <049001cf63f6$4bda0e00$e38e2a00$@cabocom.cv>

This is by design to increase security on a CHAP.

Imagine the following:
In your design, I could sniff the network traffic, and knowing account
password (a subscriber), the computer mac and the generated hash, I could
possibly reverse engineer to get your radius secret.
Then, with the radius secret, I could sniff for other accounts password,
since I could see the MAC, secret and encrypted hash, or even worst things.

But obviously while true and possible, I don't know up to what point someone
will spend his time doing that (except me on a booring weekend :) )

Luis


-----Mensagem original-----
De: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] Em nome de
james at purple.so
Enviada: 29 de abril de 2014 20:29
Para: chilli at coova.org
Assunto: Re: [Chilli] CoovaChilli uam secret / RADIUS secret causing

Hi Luis

Thanks very much for your reply.

Yes, I had thought this may be the issue, but I assumed that coova does not
re-generate a new challenge for every HTTP request a client makes. To test,
I opened 10 tabs in my browser, and 5 tabs in another browser, and the
"challenge" value in the URL was the same across them all. We notice the
challenge does change after around 10 minutes though (it must time out)...

We've recently modified the coova code to generate the challenge based on
something more unique to the user (their mac address, plus a secret, then
hashed), rather than what coova uses by default (a 16 character string from
/dev/random), so now, the challenge is unique per client MAC, and therefore
no matter what sessions they have open it will always be the same
"challenge". Does that make sense? Even if they return in 1 hour, the
challenge is the same, and only we know what the challenge is made up from
on our external splash page side.

But, I think coova should ensure that the same challenge is given to the
same client MAC, as without it, it's near impossible to know which challenge
to use at the correct one when encrypting the password to send back to coova
for the login (we use an external splash page).

What are your thoughts?

Thanks

James


_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


From lferreira at cabocom.cv  Tue Apr 29 22:16:35 2014
From: lferreira at cabocom.cv (Luis Ferreira)
Date: Tue, 29 Apr 2014 21:16:35 -0100
Subject: [Chilli] Static DHCP Leases
Message-ID: <049101cf63f8$b139ace0$13ad06a0$@cabocom.cv>

Hi again,

 

Can I use option "-ethers" for static MAC Address and IP Address mapping?

 

I've got some devices that need to run on DHCP client mode (impossible to
place static IP).

Will this work?

 

If yes, how is the supposed to be the file structure?

 

Luis

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140429/4cc2a047/attachment.html>

From james at purple.so  Wed Apr 30 07:02:55 2014
From: james at purple.so (james at purple.so)
Date: Wed, 30 Apr 2014 08:02:55 +0100
Subject: [Chilli] CoovaChilli uam secret / RADIUS secret causing
Message-ID: <0afd01cf6442$36fbe250$a4f3a6f0$@purple.so>

Hi Luis

Thanks again for your reply.

I am aware of the necessity to keep the secret random and want to do so but
there isn't any consistency between when coova generates a new challenge for
the same MAC.

As mentioned, I have most users who are ok, but say out of 10,000 logins a
day there are several hundred rejects because the CHAP challenge was
incorrect. By incorrect I mean when they hit our splash page and we generate
the CHAP response from the incoming challenge in the URL string, when we
send the login back to coova, coova has sometimes generated a different
challenge for that client because some other HTTP request went out from a
background app/service.

With the more increasing use of smartphones, inevitably as soon as the user
connects to an SSID there are many background apps/processes that try to get
to the Internet, so it's rather difficult to generate the correct response
if its changed.

It does seem to be random, as in my previous post I mentioned I opened up
multiple tabs/windows/programs and coova used the same challenge for that
session, but this isn't happening all the time.

Using CHAP is great, but when it means the fundamental part of the login
process breaks, it involves user complaints and headache (as you can
imagine).

Not sure of the best route to take...

Thanks

James 



-----Original Message-----
From: James Wood [mailto:james.wood at purplewifi.net] 
Sent: 29 April 2014 22:29
To: 'chilli at coova.org'
Subject: RE: [Chilli] CoovaChilli uam secret / RADIUS secret causing

Hi Luis

Thanks very much for your reply.

Yes, I had thought this may be the issue, but I assumed that coova does not
re-generate a new challenge for every HTTP request a client makes. To test,
I opened 10 tabs in my browser, and 5 tabs in another browser, and the
"challenge" value in the URL was the same across them all. We notice the
challenge does change after around 10 minutes though (it must time out)...

We've recently modified the coova code to generate the challenge based on
something more unique to the user (their mac address, plus a secret, then
hashed), rather than what coova uses by default (a 16 character string from
/dev/random), so now, the challenge is unique per client MAC, and therefore
no matter what sessions they have open it will always be the same
"challenge". Does that make sense? Even if they return in 1 hour, the
challenge is the same, and only we know what the challenge is made up from
on our external splash page side.

But, I think coova should ensure that the same challenge is given to the
same client MAC, as without it, it's near impossible to know which challenge
to use at the correct one when encrypting the password to send back to coova
for the login (we use an external splash page).

What are your thoughts?

Thanks

James



From lferreira at cabocom.cv  Wed Apr 30 14:03:57 2014
From: lferreira at cabocom.cv (Luis Ferreira)
Date: Wed, 30 Apr 2014 13:03:57 -0100
Subject: [Chilli] CoovaChilli uam secret / RADIUS secret causing
In-Reply-To: <0afd01cf6442$36fbe250$a4f3a6f0$@purple.so>
References: <0afd01cf6442$36fbe250$a4f3a6f0$@purple.so>
Message-ID: <04cf01cf647d$088b24e0$19a16ea0$@cabocom.cv>

What you are telling me is indeed something that happen also with us.

 Normally, we just tell the client to close all windows and open only one.

But on the other hand, having a proper solution for this would be nice. Your
workaround was implementing a fixed challenge being sent by chilli. While
knowing of the security flaw, I would say that it is actually a good
workaround on that issue.

Would it be possible to share the code change on coova source, so that I
could try it here? 

Luis 


-----Mensagem original-----
De: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] Em nome de
james at purple.so
Enviada: 30 de abril de 2014 06:03
Para: chilli at coova.org
Assunto: Re: [Chilli] CoovaChilli uam secret / RADIUS secret causing

Hi Luis

Thanks again for your reply.

I am aware of the necessity to keep the secret random and want to do so but
there isn't any consistency between when coova generates a new challenge for
the same MAC.

As mentioned, I have most users who are ok, but say out of 10,000 logins a
day there are several hundred rejects because the CHAP challenge was
incorrect. By incorrect I mean when they hit our splash page and we generate
the CHAP response from the incoming challenge in the URL string, when we
send the login back to coova, coova has sometimes generated a different
challenge for that client because some other HTTP request went out from a
background app/service.

With the more increasing use of smartphones, inevitably as soon as the user
connects to an SSID there are many background apps/processes that try to get
to the Internet, so it's rather difficult to generate the correct response
if its changed.

It does seem to be random, as in my previous post I mentioned I opened up
multiple tabs/windows/programs and coova used the same challenge for that
session, but this isn't happening all the time.

Using CHAP is great, but when it means the fundamental part of the login
process breaks, it involves user complaints and headache (as you can
imagine).

Not sure of the best route to take...

Thanks

James 



-----Original Message-----
From: James Wood [mailto:james.wood at purplewifi.net]
Sent: 29 April 2014 22:29
To: 'chilli at coova.org'
Subject: RE: [Chilli] CoovaChilli uam secret / RADIUS secret causing

Hi Luis

Thanks very much for your reply.

Yes, I had thought this may be the issue, but I assumed that coova does not
re-generate a new challenge for every HTTP request a client makes. To test,
I opened 10 tabs in my browser, and 5 tabs in another browser, and the
"challenge" value in the URL was the same across them all. We notice the
challenge does change after around 10 minutes though (it must time out)...

We've recently modified the coova code to generate the challenge based on
something more unique to the user (their mac address, plus a secret, then
hashed), rather than what coova uses by default (a 16 character string from
/dev/random), so now, the challenge is unique per client MAC, and therefore
no matter what sessions they have open it will always be the same
"challenge". Does that make sense? Even if they return in 1 hour, the
challenge is the same, and only we know what the challenge is made up from
on our external splash page side.

But, I think coova should ensure that the same challenge is given to the
same client MAC, as without it, it's near impossible to know which challenge
to use at the correct one when encrypting the password to send back to coova
for the login (we use an external splash page).

What are your thoughts?

Thanks

James


_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


