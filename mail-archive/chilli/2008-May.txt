From ml at t-b-o-h.net  Thu May  1 19:13:59 2008
From: ml at t-b-o-h.net (Tuc at T-B-O-H.NET)
Date: Thu, 1 May 2008 15:13:59 -0400 (EDT)
Subject: Bypass Chilli using alternate IPs?
Message-ID: <200805011913.m41JDxui088417@himinbjorg.tucs-beachin-obx-house.com>

Hi,

	I'll start out saying this is a Chillispot problem on DD-WRT. 
Unfortunately, support on the DD-WRT forum is generally lacking, so I
come to you hoping that since this is a branch you'll be able to understand
and suggest a change for me. If not, I certaininly understand.

	On a sample DD-WRT router, I have the chilli.conf to be :

radiusserver1 EXAMPLE.IP.ADDRESS.HERE
radiusserver2 EXAMPLE.IP.ADDRESS.HERE
radiussecret TMCQgnAW3f9g31
dhcpif br0
uamserver http://www.example.com/cgi-bin/UAM/uam.cgi
dns1 EXAMPLE.IP.ADDRESS.HERE
uamsecret aERP68Fi3d9gkh0
uamallowed www.paypal.com,www.paypalobjects.com,www.seabreezeconnections.com
radiusnasid SBC-2064
radiuslisten 192.168.50.13

	and :

# ifconfig br0
br0       Link encap:Ethernet  HWaddr 00:16:01:D1:90:3A  
          inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:6981 errors:0 dropped:0 overruns:0 frame:0
          TX packets:7444 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:690194 (674.0 KiB)  TX bytes:5253782 (5.0 MiB)

 # ifconfig tun0
tun0      Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
          inet addr:192.168.182.1  P-t-P:192.168.182.1  Mask:255.255.255.0
          UP POINTOPOINT RUNNING  MTU:1500  Metric:1
          RX packets:5706 errors:0 dropped:0 overruns:0 frame:0
          TX packets:7222 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:10 
          RX bytes:555035 (542.0 KiB)  TX bytes:5097966 (4.8 MiB)

# ifconfig vlan1
vlan1     Link encap:Ethernet  HWaddr 00:16:01:D1:90:3B  
          inet addr:192.168.50.13  Bcast:192.168.50.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:263049 errors:0 dropped:0 overruns:0 frame:0
          TX packets:128066 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:31820918 (30.3 MiB)  TX bytes:11358988 (10.8 MiB)


	We've found out that if you MANUALLY set your IP to be in the 192.168.1.X
range, set 192.168.1.1 as the gateway, and set your own DNS servers.... You can
surf w/o authenticating... Which is a VERY bad thing...

	Is there a way to stop this? (Additional information provided if
necessary.)

			Thanks, Tuc


From contact at sriviere.info  Fri May  2 07:37:29 2008
From: contact at sriviere.info (=?ISO-8859-1?Q?SR_Infosyst=E8mes?=)
Date: Fri, 02 May 2008 09:37:29 +0200
Subject: Bypass Chilli using alternate IPs?
In-Reply-To: <200805011913.m41JDxui088417@himinbjorg.tucs-beachin-obx-house.com>
References: <200805011913.m41JDxui088417@himinbjorg.tucs-beachin-obx-house.com>
Message-ID: <481AC4B9.5090700@sriviere.info>

> 	I'll start out saying this is a Chillispot problem on DD-WRT. 
> Unfortunately, support on the DD-WRT forum is generally lacking, so I
> come to you hoping that since this is a branch you'll be able to understand
> and suggest a change for me. If not, I certaininly understand.

I don't really understand if your final goal is to get direct access to 
the AP firmware (to log traces, ntp setting, modify parameters in the 
same time Chilli is running, etc...) and I don't use DD-WRT...

But the information below works very well for me (and could be useful 
for others, I personaly have a lot of problems when setting my first 
Chilli network (lack of network knowledge, not related with Chilli 
itself which is really easy to use) :


WLAN---eth0---PC(radius+chilli)---eth1---WIFI (AP1, AP2, AP3,...)

interface
-------------------------
auto lo
iface lo inet loopback

auto eth0
iface eth0 inet static
network 192.168.0.0
netmask 255.255.255.0
address 192.168.0.251
gateway 192.168.0.254

auto eth1
iface eth1 inet static
network 192.168.2.0
netmask 255.255.255.0
address 192.168.2.251
-------------------------

chilli
-------------------------
...
dhcpif          eth1
net             192.168.1.0/24
dynip           192.168.1.0/24
dhcpstart       2
...
uamserver https://192.168.1.1/wua/
uamhomepage http://192.168.1.1/wua/index.html
...
-------------------------

So, the tun0 192.168.1.x network is declared at the top of the real 
(hardware) eth1 192.168.2.x network

Connected to eth1 you have :

- 192.168.1.x (wifi from chilli)
- 192.168.2.x (AP maintenance and logs)

Inside the AP, I declared :

AP IP (number "n") : 192.168.2.n
IP Mask : 255.255.255.0
Gateway : 192.168.1.1

I can now redirect AP logs and use NTP for accurate datetime in logs 
(using additional iptables settings related to eth1/192.168.2.251), and 
modify AP parameters while Chilli is running, even update firmware via 
FTP. Very useful.


-- 
LA SOLUTION ? vos probl?mes INFORMATIQUES

SR Infosyst?mes
15, rue du Temple
17310 St Pierre d'Ol?ron
Ile d'Ol?ron - France

Mobile : 06 89 29 88 44
Fixe :   09 54 10 55 60 (appel local)
Fax :    05 46 36 30 59
Site :   www.sriviere.info
Email :  contact at sriviere.info
Skype :  stephane.riviere

Certificat X509 : disponible sur le site


From wlan at mac.com  Fri May  2 18:19:37 2008
From: wlan at mac.com (wlan at mac.com)
Date: Fri, 02 May 2008 20:19:37 +0200
Subject: Messages
In-Reply-To: <81B2B4AE03A22D4490CD35A0F20F89E003996F41@thsvml00.togewa.com>
References: <81B2B4AE03A22D4490CD35A0F20F89E003996F41@thsvml00.togewa.com>
Message-ID: <1362E6EE-B62F-45A8-A505-53A18E3F1338@mac.com>

Hmm.. The permission denied is suspicious... you are starting the  
service as root? When you are having problems, how many tun devices  
do you see in an ifconfig? Similarly, do you see multiple instances  
of chilli running when you ps|grep chilli?

David

On Apr 30, 2008, at 11:35 AM, Urech Bruno wrote:

>
> Hi all
>
> Yesterday i found out that since last Thursday, April 24, 2008 all  
> 10 minutes the following message is written in the messages log on / 
> var/log of my Ubuntu 7.04:
>
> Apr 27 07:50:01 test2 coova-chilli[16589]: ChilliSpot 1.0.8.  
> Copyright 2002-2005 Mondru AB. Licensed under GPL. Copyright  
> 2006-2007 David Bird <dbird at acm.org>. Licensed under GPL. See  
> http://www.chillispot.org/ & http://coova.org/ for details
>
> In the syslog is additionally mentionned, that there is a problem  
> with the tun device:
>
> Apr 30 06:40:01 test2 coova-chilli[17716]: ChilliSpot 1.0.8.  
> Copyright 2002-2005 Mondru AB. Licensed under GPL. Copyright  
> 2006-2007 David Bird <dbird at acm.org>. Licensed under GPL. See  
> http://www.chillispot.org/ & http://coova.org/ for details.
> Apr 30 06:40:01 test2 coova-chilli[17716]: tun.c: 631: 13  
> (Permission denied) open() failed
> Apr 30 06:40:01 test2 coova-chilli[17716]: chilli.c: 3238: Failed  
> to create tun
> Apr 30 06:50:01 test2 coova-chilli[17776]: tun.c: 631: 13  
> (Permission denied) open() failed
> Apr 30 06:50:01 test2 coova-chilli[17776]: chilli.c: 3238: Failed  
> to create tun
>
> As the chilli service hung, last Friday - the subscribers did  
> receive an IP address, but were no longer redirected to the login  
> page, i tried to restart the chilli service. But as chilli restart  
> did not work, i tried also out the following:  chilli restart;  
> chilli condrestart; chilli reload, as written wen just giving  
> chilli and enter: start|stop|restart|condrestart|status|reload| 
> radconfig . After each of them, the chilli seamed to be running,  
> but the redirection only worked after a restart of the whole  
> server. After restarting, the chilli service was up and the  
> subscribers where redirected again, as usually, but only  
> submentioned messages appear.
>
> Can somebody imagine and describe, what i do wrong, where this  
> messages are from, how and what occures and how can i remove them?
>
> Thank you
>
> Yours
>
> Bruni
>
> <messages.extract>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4



From gunther.mayer at googlemail.com  Sat May  3 16:54:36 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Sat, 03 May 2008 18:54:36 +0200
Subject: Bypass Chilli using alternate IPs?
In-Reply-To: <200805011913.m41JDxui088417@himinbjorg.tucs-beachin-obx-house.com>
References: <200805011913.m41JDxui088417@himinbjorg.tucs-beachin-obx-house.com>
Message-ID: <481C98CC.9040303@gmail.com>

Tuc at T-B-O-H.NET wrote:
> Hi,
>
> 	I'll start out saying this is a Chillispot problem on DD-WRT. 
> Unfortunately, support on the DD-WRT forum is generally lacking, so I
> come to you hoping that since this is a branch you'll be able to understand
> and suggest a change for me. If not, I certaininly understand.
>
> 	On a sample DD-WRT router, I have the chilli.conf to be :
>
> radiusserver1 EXAMPLE.IP.ADDRESS.HERE
> radiusserver2 EXAMPLE.IP.ADDRESS.HERE
> radiussecret TMCQgnAW3f9g31
> dhcpif br0
> uamserver http://www.example.com/cgi-bin/UAM/uam.cgi
> dns1 EXAMPLE.IP.ADDRESS.HERE
> uamsecret aERP68Fi3d9gkh0
> uamallowed www.paypal.com,www.paypalobjects.com,www.seabreezeconnections.com
> radiusnasid SBC-2064
> radiuslisten 192.168.50.13
>
> 	and :
>
> # ifconfig br0
> br0       Link encap:Ethernet  HWaddr 00:16:01:D1:90:3A  
>           inet addr:192.168.1.1  Bcast:192.168.1.255  Mask:255.255.255.0
>           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
>           RX packets:6981 errors:0 dropped:0 overruns:0 frame:0
>           TX packets:7444 errors:0 dropped:0 overruns:0 carrier:0
>           collisions:0 txqueuelen:0 
>           RX bytes:690194 (674.0 KiB)  TX bytes:5253782 (5.0 MiB)
>
>  # ifconfig tun0
> tun0      Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  
>           inet addr:192.168.182.1  P-t-P:192.168.182.1  Mask:255.255.255.0
>           UP POINTOPOINT RUNNING  MTU:1500  Metric:1
>           RX packets:5706 errors:0 dropped:0 overruns:0 frame:0
>           TX packets:7222 errors:0 dropped:0 overruns:0 carrier:0
>           collisions:0 txqueuelen:10 
>           RX bytes:555035 (542.0 KiB)  TX bytes:5097966 (4.8 MiB)
>
> # ifconfig vlan1
> vlan1     Link encap:Ethernet  HWaddr 00:16:01:D1:90:3B  
>           inet addr:192.168.50.13  Bcast:192.168.50.255  Mask:255.255.255.0
>           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
>           RX packets:263049 errors:0 dropped:0 overruns:0 frame:0
>           TX packets:128066 errors:0 dropped:0 overruns:0 carrier:0
>           collisions:0 txqueuelen:0 
>           RX bytes:31820918 (30.3 MiB)  TX bytes:11358988 (10.8 MiB)
>
>
> 	We've found out that if you MANUALLY set your IP to be in the 192.168.1.X
> range, set 192.168.1.1 as the gateway, and set your own DNS servers.... You can
> surf w/o authenticating... Which is a VERY bad thing...
>
> 	Is there a way to stop this? (Additional information provided if
> necessary.)
>   
I ran across this issue years ago. Your problem is that you have two lan 
interfaces, the tun0 one (192.168.182.1/24) and the br0 one. Nothing 
stops your box from routing stuff through br0 (the surfing w/o 
authenticating). One way to avoid that is to have no ip active on br0 
but DD-WRT doesn't allow you enough control to do that iirc. But here's 
a simple fix: Put

iptables -I FORWARD -i br0 -j DROP

in your firwall commands and nobody will be able to do that anymore.

In future, please use coova-ap, it's infinitely better, fully open 
source and less evil than DD-WRT ;-) well, don't want to start a thread 
on dd-wrt vs the rest here...

Gunther


From ml at t-b-o-h.net  Sat May  3 17:13:37 2008
From: ml at t-b-o-h.net (Tuc at T-B-O-H.NET)
Date: Sat, 3 May 2008 13:13:37 -0400 (EDT)
Subject: Bypass Chilli using alternate IPs?
In-Reply-To: <481C98CC.9040303@gmail.com>
Message-ID: <200805031713.m43HDc8c046857@himinbjorg.tucs-beachin-obx-house.com>

> I ran across this issue years ago. Your problem is that you have two lan 
> interfaces, the tun0 one (192.168.182.1/24) and the br0 one. Nothing 
> stops your box from routing stuff through br0 (the surfing w/o 
> authenticating). One way to avoid that is to have no ip active on br0 
> but DD-WRT doesn't allow you enough control to do that iirc. But here's 
> a simple fix: Put
> 
> iptables -I FORWARD -i br0 -j DROP
> 
> in your firwall commands and nobody will be able to do that anymore.
>
	Thanks. I will definitely look into that as a solution. I
do appreciate your confirming what I discovered AFTER I looked into
things. I'm also at a disadvantage due to the fact I was at the site
(700 miles from me) with proper equipment for 6 months and asked the
owner to test,test,test,test,test. When he signed off on it, I left
everything there so I don't have a test unit. Oddly, right after I
left came the "I never mentioned while you were here, but........."
items, of which this is one.
> 
> In future, please use coova-ap, it's infinitely better, fully open 
> source and less evil than DD-WRT ;-) well, don't want to start a thread 
> on dd-wrt vs the rest here...
> 
	I've contacted Brainslayer about this already. His answer back
in Jan mentioned something about bugs (I'm not sure the details, might
have to do with the next part), and that its not "big endian and 
arm/xscale safe". 

	I'd package up something myself, but because I need to turn
this over to another individual who isn't as proficient as I am, it
has to be something community supported and upgrades always
available. So "rolling my own" as it were isn't an option. I'm also
a consultant (Uncollected payment as of yet) so while I can state
what I would do given my prior experience and the level of quality
I would want the service to be, he and his pocket are making the
final decisions. 

		Thanks, Tuc


From gunther.mayer at googlemail.com  Sat May  3 19:05:58 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Sat, 03 May 2008 21:05:58 +0200
Subject: macallowlocal with uamanyip doesn't work
In-Reply-To: <480D9DB6.9060508@gmail.com>
References: <480D9DB6.9060508@gmail.com>
Message-ID: <481CB796.1010703@gmail.com>

Hi,

Seeing that nobody replied to this one I started digging into the code 
myself and found that the required routes weren't set up at all for 
macallowlocal or even macauth cases for that matter. I whipped up a 
patch against 1.0.11 to address this and came up with a route_add/delete 
helper function that cb_dhcp_request (once before each return statement) 
and cb_dhcp_disconnect (where the route deletion code sits) call. If 
anybody is interested in that patch I'm happy to send them on.

I tried to port it to svn r167 but I realised that David has already 
done something very similar with the net_add_route/net_del_route macros. 
However, it still doesn't work as the current place where the route 
addition sits (dhcp_set_addrs) isn't called when macallow or macauth are 
active. I'm gonna code this up along the lines of my 1.0.11 patch and 
submit it if nobody objects to this.

By the way, what is the reason for the

#warning fix this
    /*XXX: todo! net_delete_route(&tuntap(tun)); */

in tun.c? If we correctly delete routes in cb_dhcp_disconnect I don't 
see a reason why the tun code also needs to do this - when we take down 
the interface all static routes will go with it.

Gunther

Gunther Mayer wrote:
> Hi again,
>
> I realised today that static ip (misconfigured) clients that are 
> supposed to be given access with uamanyip don't have ANY sort of 
> connection when they are additionally macallowed with the 
> macallowlocal option. I noticed this problem with both 1.0.11 and 
> latest svn and neither a debug nor a debugfacility 255 would give me 
> any clues to why this wouldn't work.
>
> To reproduce:
>
>    1. Pick a hotspot client, configure its static IP with totally
>       random ip settings (static ip, gateway within subnet and any
>       usable dns, preferably with uamanydns)
>    2. Turn on uamanyip on the chilli box with suitable statip subnet
>       and restart chilli
>    3. Back on the client you'll see that it'll get redirected to the
>       portal page as expected and can even ping, ssh or whatever the
>       chilli box when using its dhcplisten ip address
>    4. Now add "macallowed <client mac address>" together with the
>       "macallowlocal" option into chilli.conf and restart chilli
>    5. The client now has no access whatsoever, no Internet access,
>       cannot ping the chilli box, nothing. A tcpdump on the chilli box
>       shows the packets coming in from the client but no response ever
>       coming in
>
> While I'm pretty sure this time there aren't any dodgy firewall rules 
> messing up my setup I'd like somebody to confirm this problem and then 
> perhaps fix it?
>
> Gunther
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080503/a33778ca/attachment.htm>

From gunther.mayer at googlemail.com  Sat May  3 19:16:25 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Sat, 03 May 2008 21:16:25 +0200
Subject: uamanyip patch
In-Reply-To: <D9CD97E1-9EC0-463F-A76D-68558A9E8211@silverserver.at>
References: <47F55510.5060806@gmail.com> <D9CD97E1-9EC0-463F-A76D-68558A9E8211@silverserver.at>
Message-ID: <481CBA09.8050604@gmail.com>

lc wrote:
> Hi,
>
> This is an interesting point. I use a different subnet to have access 
> to access points on the chilli network. So I think the suggested 
> uamanyipignorelan option would be excellent if the network to be 
> ignored could be defined.
I rewrote my previous patch which wasn't working too well and submitted 
the now tested and working version as r168. As originally advertised it 
ignores (i.e. doesn't spoof) all arp requests within chilli's own 
subnet. I'm busy rolling this out to a couple of live sites but I don't 
expect any issues as I've tested it quite substantially, it's a very 
minor patch as well.

Regarding an option to specify such a subnet to ignore, I've started on 
a customisable "noarp <subnet>,<subnet>,..." option but gave up soon 
after I realised just how many source files need to be changed in order 
to add a new option. I don't have time right now for such an extensive 
patch but I'm willing to assist anyone who does.
>
> Am 04.04.2008 um 00:07 schrieb Gunther Mayer:
>
>> Hi David,
>>
>> I've recently tried out the uamanyip option in coova and was very 
>> pleased at how well it works. I want to use it all the time in future 
>> across our network to simplify troubleshooting, should save a couple 
>> of support calls ;-)
>>
>> However, I found a very annoying side effect of uamanyip: It spoofs 
>> ARP requests for just about anything. While that's the point of 
>> uamanyip, it makes it impossible to have other devices such as access 
>> points that you have to access for management purposes on the chilli 
>> network. Say chilli listens on 192.168.182.1 and there's another 
>> access point with static ip 192.168.182.2 (of course not part of the 
>> dynip range) to increase wireless coverage. As soon as anybody tries 
>> to ping or otherwise access 192.168.182.2 because chilli will 
>> immediately claim it through arp before the real device has a chance 
>> to answer - it creates a race condition. Putting such devices on 
>> entirely different subnets makes no difference as their ip's will be 
>> stolen too. The only though somewhat ugly way I found around that was 
>> to clear the arp cache on my client and then force a mapping with arp 
>> -s.
>>
>> So, I thought wouldn't it be cool to let chilli ignore arp requests 
>> for anything other than itself but only on its own subnet. Anything 
>> else will still be caught and spoofed as usual. Hence I came up with 
>> the below patch, I created it against 1.0.11-stable but applying it 
>> to svn (r161) proved trivial, as it's a very short patch.
>>
>> I think this should be done by default as it allows devices on the 
>> chilli subnet to talk to each other properly (of course for real 
>> isolation one would use something like ebtables or a/p isolation). 
>> But of course the patch could be extended to make this optional 
>> (uamanyipignorelan?) if people wanted to keep the current behaviour. 
>> Thoughts?
>>
>> Gunther
>>
>> Index: dhcp.c
>> ===================================================================
>> --- dhcp.c      (revision 161)
>> +++ dhcp.c      (working copy)
>> @@ -2595,6 +2595,14 @@
>>      return 0; /* Only reply if he asked for his router address */
>>    }
>>  }
>> +  else if ((taraddr.s_addr != options.dhcplisten.s_addr) &&
>> +        ((conn->hisip.s_addr & conn->hismask.s_addr) ==
>> +        (reqaddr.s_addr & conn->hismask.s_addr))) {
>> +    /* when uamanyip is on we should ignore arp requests that ARE 
>> within our subnet except of course the ones for ourselves*/
>> +    if (options.debug)
>> +      log_dbg("ARP: request for ip other than us within our 
>> subnet(uamanyip on), ignoring");
>> +    return 0;
>> +  }
>>  conn->lasttime = mainclock;
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>



From gunther.mayer at googlemail.com  Sat May  3 19:24:20 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Sat, 03 May 2008 21:24:20 +0200
Subject: Addressing APIPA/IPv4LL issues with uamanyip
Message-ID: <481CBBE4.60500@gmail.com>

Hi guys,

In my quest to test and improve uamanyip even more I discovered another 
quirk: Clients who are using APIPA/IPv4LL addresses (in 169.254.0.0/16) 
such as all MAC's, Windows PC's, ubuntu etc. who were forced to use one 
through some sort of temporary LAN/WLAN failure or nas reboot, will not 
be able to connect at all through chilli.

Reason: such clients typically have no default gateway set (if their 
IPv4LL implementation is rfc 3927 compliant, Windows XP at least is) 
which would render uamanyip useless. Even worse, when they do request a 
dynamic ip via dhcp which they do periodically in the background, chilli 
would just reassign them the same defunct IPv4LL address that they had 
before until chilli restarts or the nas reboots.

I've addressed this with a very simple patch below that refuses all 
"dhcp" requests in the 196.254.0.0/16 subnet. I have tested it and it 
does work (no connections allocated for such a client, subsequent dhcp 
request works properly), however I thought I'd run it by this list first.

Gunther

P.S.: There's also an unrelated bit in there addressing the logging of 
macallowlocal clients which I think improves record keeping

Index: chilli.c
===================================================================
--- chilli.c    (revision 168)
+++ chilli.c    (working copy)
@@ -49,6 +49,10 @@
 /*static int do_timeouts = 1;*/
 static int do_sighup = 0;

+/* some IPv4LL/APIPA(rfc 3927) specific stuff for uamanyip */
+struct in_addr ipv4ll_ip;
+struct in_addr ipv4ll_mask;
+
 /* Forward declarations */
 static int acct_req(struct app_conn_t *conn, uint8_t status_type);

@@ -2573,6 +2577,16 @@
     return -1;
   }

+  /* if uamanyip is on we have to filter out which ip's are allowed */
+  if (options.uamanyip && addr && addr->s_addr) {
+    if ((addr->s_addr & ipv4ll_mask.s_addr) == ipv4ll_ip.s_addr) {
+      /* clients with an IPv4LL ip normally have no default gw 
assigned, rendering uamanyip useless
+      They must rather get a proper dynamic ip via dhcp */
+      log_dbg("IPv4LL/APIPA address requested, ignoring");
+      return -1;
+    }
+  }
+
   appconn->reqip.s_addr = addr->s_addr; /* Save for MAC auth later */

   /* If IP address is allready allocated: Fill it in */
@@ -2598,6 +2612,11 @@
     if (options.macallowlocal) {
       upprot_getip(appconn, &appconn->reqip, 0);/**/
       dnprot_accept(appconn);
+      log_info("Granted MAC=%.2X-%.2X-%.2X-%.2X-%.2X-%.2X with IP=%s 
access without radius auth" ,
+                    conn->hismac[0], conn->hismac[1],
+                    conn->hismac[2], conn->hismac[3],
+                    conn->hismac[4], conn->hismac[5],
+                    inet_ntoa(appconn->hisip));
     } else {
       macauth_radius(appconn, dhcp_pkt, dhcp_len);
     }
@@ -3521,6 +3540,10 @@
   }
   */

+  /* setup IPv4LL/APIPA network ip and mask for uamanyip exception */
+  inet_aton("169.254.0.0", &ipv4ll_ip);
+  inet_aton("255.255.0.0", &ipv4ll_mask);
+
   if (options.debug)
     log_dbg("Waiting for client request...");



From cfinnegan at csc.com.au  Sun May  4 23:56:44 2008
From: cfinnegan at csc.com.au (Ciaran Finnegan)
Date: Mon, 5 May 2008 10:56:44 +1100
Subject: Bypass Chilli using alternate IPs?
Message-ID: <OFCA25743F.008389C4-ONCA25743F.008389C4-CA25743F.008389C4@csc.com>

Return Receipt
                                                                           
   Your       Re: Bypass Chilli using alternate IPs?                       
   document:                                                               
                                                                           
   was        Ciaran Finnegan/GIS/CSC                                      
   received                                                                
   by:                                                                     
                                                                           
   at:        05/05/2008 10:56:44 AM ZE10                                  
                                                                           






From wlan at mac.com  Mon May  5 08:31:53 2008
From: wlan at mac.com (wlan at mac.com)
Date: Mon, 5 May 2008 10:31:53 +0200
Subject: uamanyip patch
In-Reply-To: <481CBA09.8050604@gmail.com>
References: <47F55510.5060806@gmail.com> <D9CD97E1-9EC0-463F-A76D-68558A9E8211@silverserver.at> <481CBA09.8050604@gmail.com>
Message-ID: <3F0F4C38-D5DB-49F5-9364-5D1A13BA5F94@mac.com>

Hi Gunther,

Thanks for that. And, sorry for the delay in replying -- I was  
traveling. As for the options, the procedure is as follows:

- Add the option to cmdline.ggo - use an existing option as an example
- Run "gengetopt -C < cmdline.ggo" to generate the cmdline.[ch] files
- Add your data structures for your option in options.h's struct  
options_t
- Do your mapping of gengetopt option to options_t in options.c's  
process_options()
(careful with memory here, and note the "reconfiguring" sections --  
some stuff _only_ happens at startup)
- Now you have your option data in the global options structure.

I know... it's a bit of a process. It's because Chilli has always  
used gengetopt -- which is nice, but also very repetitive code and  
limiting in certain ways.

For this option, you could take uamallowed as your template -- taking  
a string and parsing out networks.

David


On May 3, 2008, at 9:16 PM, Gunther Mayer wrote:

> lc wrote:
>> Hi,
>>
>> This is an interesting point. I use a different subnet to have  
>> access to access points on the chilli network. So I think the  
>> suggested uamanyipignorelan option would be excellent if the  
>> network to be ignored could be defined.
> I rewrote my previous patch which wasn't working too well and  
> submitted the now tested and working version as r168. As originally  
> advertised it ignores (i.e. doesn't spoof) all arp requests within  
> chilli's own subnet. I'm busy rolling this out to a couple of live  
> sites but I don't expect any issues as I've tested it quite  
> substantially, it's a very minor patch as well.
>
> Regarding an option to specify such a subnet to ignore, I've  
> started on a customisable "noarp <subnet>,<subnet>,..." option but  
> gave up soon after I realised just how many source files need to be  
> changed in order to add a new option. I don't have time right now  
> for such an extensive patch but I'm willing to assist anyone who does.
>>
>> Am 04.04.2008 um 00:07 schrieb Gunther Mayer:
>>
>>> Hi David,
>>>
>>> I've recently tried out the uamanyip option in coova and was very  
>>> pleased at how well it works. I want to use it all the time in  
>>> future across our network to simplify troubleshooting, should  
>>> save a couple of support calls ;-)
>>>
>>> However, I found a very annoying side effect of uamanyip: It  
>>> spoofs ARP requests for just about anything. While that's the  
>>> point of uamanyip, it makes it impossible to have other devices  
>>> such as access points that you have to access for management  
>>> purposes on the chilli network. Say chilli listens on  
>>> 192.168.182.1 and there's another access point with static ip  
>>> 192.168.182.2 (of course not part of the dynip range) to increase  
>>> wireless coverage. As soon as anybody tries to ping or otherwise  
>>> access 192.168.182.2 because chilli will immediately claim it  
>>> through arp before the real device has a chance to answer - it  
>>> creates a race condition. Putting such devices on entirely  
>>> different subnets makes no difference as their ip's will be  
>>> stolen too. The only though somewhat ugly way I found around that  
>>> was to clear the arp cache on my client and then force a mapping  
>>> with arp -s.
>>>
>>> So, I thought wouldn't it be cool to let chilli ignore arp  
>>> requests for anything other than itself but only on its own  
>>> subnet. Anything else will still be caught and spoofed as usual.  
>>> Hence I came up with the below patch, I created it against 1.0.11- 
>>> stable but applying it to svn (r161) proved trivial, as it's a  
>>> very short patch.
>>>
>>> I think this should be done by default as it allows devices on  
>>> the chilli subnet to talk to each other properly (of course for  
>>> real isolation one would use something like ebtables or a/p  
>>> isolation). But of course the patch could be extended to make  
>>> this optional (uamanyipignorelan?) if people wanted to keep the  
>>> current behaviour. Thoughts?
>>>
>>> Gunther
>>>
>>> Index: dhcp.c
>>> ===================================================================
>>> --- dhcp.c      (revision 161)
>>> +++ dhcp.c      (working copy)
>>> @@ -2595,6 +2595,14 @@
>>>      return 0; /* Only reply if he asked for his router address */
>>>    }
>>>  }
>>> +  else if ((taraddr.s_addr != options.dhcplisten.s_addr) &&
>>> +        ((conn->hisip.s_addr & conn->hismask.s_addr) ==
>>> +        (reqaddr.s_addr & conn->hismask.s_addr))) {
>>> +    /* when uamanyip is on we should ignore arp requests that  
>>> ARE within our subnet except of course the ones for ourselves*/
>>> +    if (options.debug)
>>> +      log_dbg("ARP: request for ip other than us within our  
>>> subnet(uamanyip on), ignoring");
>>> +    return 0;
>>> +  }
>>>  conn->lasttime = mainclock;
>>>
>>> -------------------------------------------------------------------- 
>>> -
>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>> For additional commands, e-mail: chilli-help at coova.org
>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From BrunoRobert.Urech at comfone.com  Mon May  5 08:46:53 2008
From: BrunoRobert.Urech at comfone.com (Urech Bruno)
Date: Mon, 5 May 2008 10:46:53 +0200
Subject: Messages
In-Reply-To: <1362E6EE-B62F-45A8-A505-53A18E3F1338@mac.com>
References: <81B2B4AE03A22D4490CD35A0F20F89E003996F41@thsvml00.togewa.com> <1362E6EE-B62F-45A8-A505-53A18E3F1338@mac.com>
Message-ID: <81B2B4AE03A22D4490CD35A0F20F89E003A82194@thsvml00.togewa.com>

Hi David

The problem is persistent, as soon as Chilli is started (and it is
started automatically with the server's boot). 
The chilli service is started as root, yes. There is only one tun device
(tun0) and it seems to be configured correctly. 
Also is only 1 instance of Chilli in the ps | grep chilli viewable.

I really do not know, what went wrong do you have any proposal?

Thank you for the assistance

Best regards

Bruno



-----Original Message-----
From: wlan at mac.com [mailto:wlan at mac.com] 
Sent: Freitag, 2. Mai 2008 20:20
To: Coova Mailinglist
Subject: Re: Messages

Hmm.. The permission denied is suspicious... you are starting the
service as root? When you are having problems, how many tun devices do
you see in an ifconfig? Similarly, do you see multiple instances of
chilli running when you ps|grep chilli?

David

On Apr 30, 2008, at 11:35 AM, Urech Bruno wrote:

>
> Hi all
>
> Yesterday i found out that since last Thursday, April 24, 2008 all  
> 10 minutes the following message is written in the messages log on / 
> var/log of my Ubuntu 7.04:
>
> Apr 27 07:50:01 test2 coova-chilli[16589]: ChilliSpot 1.0.8.  
> Copyright 2002-2005 Mondru AB. Licensed under GPL. Copyright  
> 2006-2007 David Bird <dbird at acm.org>. Licensed under GPL. See  
> http://www.chillispot.org/ & http://coova.org/ for details
>
> In the syslog is additionally mentionned, that there is a problem  
> with the tun device:
>
> Apr 30 06:40:01 test2 coova-chilli[17716]: ChilliSpot 1.0.8.  
> Copyright 2002-2005 Mondru AB. Licensed under GPL. Copyright  
> 2006-2007 David Bird <dbird at acm.org>. Licensed under GPL. See  
> http://www.chillispot.org/ & http://coova.org/ for details.
> Apr 30 06:40:01 test2 coova-chilli[17716]: tun.c: 631: 13  
> (Permission denied) open() failed
> Apr 30 06:40:01 test2 coova-chilli[17716]: chilli.c: 3238: Failed  
> to create tun
> Apr 30 06:50:01 test2 coova-chilli[17776]: tun.c: 631: 13  
> (Permission denied) open() failed
> Apr 30 06:50:01 test2 coova-chilli[17776]: chilli.c: 3238: Failed  
> to create tun
>
> As the chilli service hung, last Friday - the subscribers did  
> receive an IP address, but were no longer redirected to the login  
> page, i tried to restart the chilli service. But as chilli restart  
> did not work, i tried also out the following:  chilli restart;  
> chilli condrestart; chilli reload, as written wen just giving  
> chilli and enter: start|stop|restart|condrestart|status|reload| 
> radconfig . After each of them, the chilli seamed to be running,  
> but the redirection only worked after a restart of the whole  
> server. After restarting, the chilli service was up and the  
> subscribers where redirected again, as usually, but only  
> submentioned messages appear.
>
> Can somebody imagine and describe, what i do wrong, where this  
> messages are from, how and what occures and how can i remove them?
>
> Thank you
>
> Yours
>
> Bruni
>
> <messages.extract>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4


---------------------------------------------------------------------
To unsubscribe, e-mail: chilli-unsubscribe at coova.org
For additional commands, e-mail: chilli-help at coova.org
Wiki: http://coova.org/wiki/index.php/CoovaChilli
Forum: http://coova.org/phpBB3/viewforum.php?f=4



From wlan at mac.com  Mon May  5 08:57:14 2008
From: wlan at mac.com (wlan at mac.com)
Date: Mon, 5 May 2008 10:57:14 +0200
Subject: Addressing APIPA/IPv4LL issues with uamanyip
In-Reply-To: <481CBBE4.60500@gmail.com>
References: <481CBBE4.60500@gmail.com>
Message-ID: <14137EDD-6CC2-4313-A822-15EC10C6CECF@mac.com>

Hi Gunther,

This is a great fix -- cheers!

I agree that chilli shouldn't be considering these addresses as  
'configured'...

David


On May 3, 2008, at 9:24 PM, Gunther Mayer wrote:

> Hi guys,
>
> In my quest to test and improve uamanyip even more I discovered  
> another quirk: Clients who are using APIPA/IPv4LL addresses (in  
> 169.254.0.0/16) such as all MAC's, Windows PC's, ubuntu etc. who  
> were forced to use one through some sort of temporary LAN/WLAN  
> failure or nas reboot, will not be able to connect at all through  
> chilli.
>
> Reason: such clients typically have no default gateway set (if  
> their IPv4LL implementation is rfc 3927 compliant, Windows XP at  
> least is) which would render uamanyip useless. Even worse, when  
> they do request a dynamic ip via dhcp which they do periodically in  
> the background, chilli would just reassign them the same defunct  
> IPv4LL address that they had before until chilli restarts or the  
> nas reboots.
>
> I've addressed this with a very simple patch below that refuses all  
> "dhcp" requests in the 196.254.0.0/16 subnet. I have tested it and  
> it does work (no connections allocated for such a client,  
> subsequent dhcp request works properly), however I thought I'd run  
> it by this list first.
>
> Gunther
>
> P.S.: There's also an unrelated bit in there addressing the logging  
> of macallowlocal clients which I think improves record keeping
>
> Index: chilli.c
> ===================================================================
> --- chilli.c    (revision 168)
> +++ chilli.c    (working copy)
> @@ -49,6 +49,10 @@
> /*static int do_timeouts = 1;*/
> static int do_sighup = 0;
>
> +/* some IPv4LL/APIPA(rfc 3927) specific stuff for uamanyip */
> +struct in_addr ipv4ll_ip;
> +struct in_addr ipv4ll_mask;
> +
> /* Forward declarations */
> static int acct_req(struct app_conn_t *conn, uint8_t status_type);
>
> @@ -2573,6 +2577,16 @@
>     return -1;
>   }
>
> +  /* if uamanyip is on we have to filter out which ip's are  
> allowed */
> +  if (options.uamanyip && addr && addr->s_addr) {
> +    if ((addr->s_addr & ipv4ll_mask.s_addr) == ipv4ll_ip.s_addr) {
> +      /* clients with an IPv4LL ip normally have no default gw  
> assigned, rendering uamanyip useless
> +      They must rather get a proper dynamic ip via dhcp */
> +      log_dbg("IPv4LL/APIPA address requested, ignoring");
> +      return -1;
> +    }
> +  }
> +
>   appconn->reqip.s_addr = addr->s_addr; /* Save for MAC auth later */
>
>   /* If IP address is allready allocated: Fill it in */
> @@ -2598,6 +2612,11 @@
>     if (options.macallowlocal) {
>       upprot_getip(appconn, &appconn->reqip, 0);/**/
>       dnprot_accept(appconn);
> +      log_info("Granted MAC=%.2X-%.2X-%.2X-%.2X-%.2X-%.2X with IP=% 
> s access without radius auth" ,
> +                    conn->hismac[0], conn->hismac[1],
> +                    conn->hismac[2], conn->hismac[3],
> +                    conn->hismac[4], conn->hismac[5],
> +                    inet_ntoa(appconn->hisip));
>     } else {
>       macauth_radius(appconn, dhcp_pkt, dhcp_len);
>     }
> @@ -3521,6 +3540,10 @@
>   }
>   */
>
> +  /* setup IPv4LL/APIPA network ip and mask for uamanyip exception */
> +  inet_aton("169.254.0.0", &ipv4ll_ip);
> +  inet_aton("255.255.0.0", &ipv4ll_mask);
> +
>   if (options.debug)
>     log_dbg("Waiting for client request...");
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From wlan at mac.com  Mon May  5 09:13:50 2008
From: wlan at mac.com (wlan at mac.com)
Date: Mon, 5 May 2008 11:13:50 +0200
Subject: Messages
In-Reply-To: <81B2B4AE03A22D4490CD35A0F20F89E003A82194@thsvml00.togewa.com>
References: <81B2B4AE03A22D4490CD35A0F20F89E003996F41@thsvml00.togewa.com> <1362E6EE-B62F-45A8-A505-53A18E3F1338@mac.com> <81B2B4AE03A22D4490CD35A0F20F89E003A82194@thsvml00.togewa.com>
Message-ID: <90902C68-F196-465A-8C64-0487D15E7819@mac.com>

Hi Bruno,

Do you get anything with a "lsmod | grep tun" ?

Is your tun0 setup manually? If so, try specifically settings the -- 
tundev=tun0

David

On May 5, 2008, at 10:46 AM, Urech Bruno wrote:

> Hi David
>
> The problem is persistent, as soon as Chilli is started (and it is
> started automatically with the server's boot).
> The chilli service is started as root, yes. There is only one tun  
> device
> (tun0) and it seems to be configured correctly.
> Also is only 1 instance of Chilli in the ps | grep chilli viewable.
>
> I really do not know, what went wrong do you have any proposal?
>
> Thank you for the assistance
>
> Best regards
>
> Bruno
>
>
>
> -----Original Message-----
> From: wlan at mac.com [mailto:wlan at mac.com]
> Sent: Freitag, 2. Mai 2008 20:20
> To: Coova Mailinglist
> Subject: Re: Messages
>
> Hmm.. The permission denied is suspicious... you are starting the
> service as root? When you are having problems, how many tun devices do
> you see in an ifconfig? Similarly, do you see multiple instances of
> chilli running when you ps|grep chilli?
>
> David
>
> On Apr 30, 2008, at 11:35 AM, Urech Bruno wrote:
>
>>
>> Hi all
>>
>> Yesterday i found out that since last Thursday, April 24, 2008 all
>> 10 minutes the following message is written in the messages log on /
>> var/log of my Ubuntu 7.04:
>>
>> Apr 27 07:50:01 test2 coova-chilli[16589]: ChilliSpot 1.0.8.
>> Copyright 2002-2005 Mondru AB. Licensed under GPL. Copyright
>> 2006-2007 David Bird <dbird at acm.org>. Licensed under GPL. See
>> http://www.chillispot.org/ & http://coova.org/ for details
>>
>> In the syslog is additionally mentionned, that there is a problem
>> with the tun device:
>>
>> Apr 30 06:40:01 test2 coova-chilli[17716]: ChilliSpot 1.0.8.
>> Copyright 2002-2005 Mondru AB. Licensed under GPL. Copyright
>> 2006-2007 David Bird <dbird at acm.org>. Licensed under GPL. See
>> http://www.chillispot.org/ & http://coova.org/ for details.
>> Apr 30 06:40:01 test2 coova-chilli[17716]: tun.c: 631: 13
>> (Permission denied) open() failed
>> Apr 30 06:40:01 test2 coova-chilli[17716]: chilli.c: 3238: Failed
>> to create tun
>> Apr 30 06:50:01 test2 coova-chilli[17776]: tun.c: 631: 13
>> (Permission denied) open() failed
>> Apr 30 06:50:01 test2 coova-chilli[17776]: chilli.c: 3238: Failed
>> to create tun
>>
>> As the chilli service hung, last Friday - the subscribers did
>> receive an IP address, but were no longer redirected to the login
>> page, i tried to restart the chilli service. But as chilli restart
>> did not work, i tried also out the following:  chilli restart;
>> chilli condrestart; chilli reload, as written wen just giving
>> chilli and enter: start|stop|restart|condrestart|status|reload|
>> radconfig . After each of them, the chilli seamed to be running,
>> but the redirection only worked after a restart of the whole
>> server. After restarting, the chilli service was up and the
>> subscribers where redirected again, as usually, but only
>> submentioned messages appear.
>>
>> Can somebody imagine and describe, what i do wrong, where this
>> messages are from, how and what occures and how can i remove them?
>>
>> Thank you
>>
>> Yours
>>
>> Bruni
>>
>> <messages.extract>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From BrunoRobert.Urech at comfone.com  Mon May  5 11:27:32 2008
From: BrunoRobert.Urech at comfone.com (Urech Bruno)
Date: Mon, 5 May 2008 13:27:32 +0200
Subject: Messages
In-Reply-To: <90902C68-F196-465A-8C64-0487D15E7819@mac.com>
References: <81B2B4AE03A22D4490CD35A0F20F89E003996F41@thsvml00.togewa.com> <1362E6EE-B62F-45A8-A505-53A18E3F1338@mac.com> <81B2B4AE03A22D4490CD35A0F20F89E003A82194@thsvml00.togewa.com> <90902C68-F196-465A-8C64-0487D15E7819@mac.com>
Message-ID: <81B2B4AE03A22D4490CD35A0F20F89E003A822A7@thsvml00.togewa.com>

Hi David

The tun0 is not setuped manually. With the "lsmod | grep tun" i get
following response: "tun 12288 1", 1 tun interface, used by 1 service.

Bruno
 
-----Original Message-----
From: wlan at mac.com [mailto:wlan at mac.com] 
Sent: Montag, 5. Mai 2008 11:14
To: chilli at coova.org
Subject: Re: Messages

Hi Bruno,

Do you get anything with a "lsmod | grep tun" ?

Is your tun0 setup manually? If so, try specifically settings the --
tundev=tun0

David

On May 5, 2008, at 10:46 AM, Urech Bruno wrote:

> Hi David
>
> The problem is persistent, as soon as Chilli is started (and it is 
> started automatically with the server's boot).
> The chilli service is started as root, yes. There is only one tun 
> device
> (tun0) and it seems to be configured correctly.
> Also is only 1 instance of Chilli in the ps | grep chilli viewable.
>
> I really do not know, what went wrong do you have any proposal?
>
> Thank you for the assistance
>
> Best regards
>
> Bruno
>
>
>
> -----Original Message-----
> From: wlan at mac.com [mailto:wlan at mac.com]
> Sent: Freitag, 2. Mai 2008 20:20
> To: Coova Mailinglist
> Subject: Re: Messages
>
> Hmm.. The permission denied is suspicious... you are starting the 
> service as root? When you are having problems, how many tun devices do

> you see in an ifconfig? Similarly, do you see multiple instances of 
> chilli running when you ps|grep chilli?
>
> David
>
> On Apr 30, 2008, at 11:35 AM, Urech Bruno wrote:
>
>>
>> Hi all
>>
>> Yesterday i found out that since last Thursday, April 24, 2008 all 10

>> minutes the following message is written in the messages log on / 
>> var/log of my Ubuntu 7.04:
>>
>> Apr 27 07:50:01 test2 coova-chilli[16589]: ChilliSpot 1.0.8.
>> Copyright 2002-2005 Mondru AB. Licensed under GPL. Copyright
>> 2006-2007 David Bird <dbird at acm.org>. Licensed under GPL. See 
>> http://www.chillispot.org/ & http://coova.org/ for details
>>
>> In the syslog is additionally mentionned, that there is a problem 
>> with the tun device:
>>
>> Apr 30 06:40:01 test2 coova-chilli[17716]: ChilliSpot 1.0.8.
>> Copyright 2002-2005 Mondru AB. Licensed under GPL. Copyright
>> 2006-2007 David Bird <dbird at acm.org>. Licensed under GPL. See 
>> http://www.chillispot.org/ & http://coova.org/ for details.
>> Apr 30 06:40:01 test2 coova-chilli[17716]: tun.c: 631: 13 (Permission

>> denied) open() failed Apr 30 06:40:01 test2 coova-chilli[17716]: 
>> chilli.c: 3238: Failed to create tun Apr 30 06:50:01 test2 
>> coova-chilli[17776]: tun.c: 631: 13 (Permission denied) open() failed

>> Apr 30 06:50:01 test2 coova-chilli[17776]: chilli.c: 3238: Failed to 
>> create tun
>>
>> As the chilli service hung, last Friday - the subscribers did receive

>> an IP address, but were no longer redirected to the login page, i 
>> tried to restart the chilli service. But as chilli restart did not 
>> work, i tried also out the following:  chilli restart; chilli 
>> condrestart; chilli reload, as written wen just giving chilli and 
>> enter: start|stop|restart|condrestart|status|reload|
>> radconfig . After each of them, the chilli seamed to be running, but 
>> the redirection only worked after a restart of the whole server. 
>> After restarting, the chilli service was up and the subscribers where

>> redirected again, as usually, but only submentioned messages appear.
>>
>> Can somebody imagine and describe, what i do wrong, where this 
>> messages are from, how and what occures and how can i remove them?
>>
>> Thank you
>>
>> Yours
>>
>> Bruni
>>
>> <messages.extract>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org For additional 
>> commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org For additional 
> commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org For additional 
> commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>


---------------------------------------------------------------------
To unsubscribe, e-mail: chilli-unsubscribe at coova.org For additional
commands, e-mail: chilli-help at coova.org
Wiki: http://coova.org/wiki/index.php/CoovaChilli
Forum: http://coova.org/phpBB3/viewforum.php?f=4



From murray at skyrove.com  Mon May  5 14:18:38 2008
From: murray at skyrove.com (Murray Long)
Date: Mon, 5 May 2008 16:18:38 +0200
Subject: Building SVN coova-chilli to ipkg binary
Message-ID: <56acee400805050718h69027b21r7d2ef59ef048fb68@mail.gmail.com>

Hi Guys,
I've been trying to compile the latest coova-chilli into an ipk package
using the whiterussian SDK, by replacing the build_mipsel/coova-chilli-*
directory as suggested by Sophana here: http://coova.org/lists/?0::30

Alas, this doesn't work for me, make fails with
.
.
checking for getline... yes
checking for res_init in -lresolv... no
configure: creating ./config.status
config.status: error: cannot find input file: Makefile.in
make[4]: *** [build_mipsel/coova-chilli-1.0.11/.configured] Error 1
make[4]: Leaving directory `package/coova-chilli'
.
.

Is this the recommended method for building a coova-chilli ipkg?

Thanks
-Murray
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080505/8716b8d2/attachment.htm>

From ml at t-b-o-h.net  Mon May  5 21:33:43 2008
From: ml at t-b-o-h.net (Tuc at T-B-O-H.NET)
Date: Mon, 5 May 2008 17:33:43 -0400 (EDT)
Subject: radius_ind() failed! ... Why?
Message-ID: <200805052133.m45LXhYx088533@himinbjorg.tucs-beachin-obx-house.com>

Hi,

	We are seeing the following on one of the units, pretty
regularly :

radius.c: ???: No such id in radius queue: 164!
radius.c: ????: Matching request was not found in queue: 164!
chilli.c: ????: radius_ind() failed!

	What is radius_ind(), and what would/could make it fail?

	The unit was rebooted, but it still had issues.

		Thanks, Tuc



From cfinnegan at csc.com.au  Mon May  5 21:35:36 2008
From: cfinnegan at csc.com.au (Ciaran Finnegan)
Date: Tue, 6 May 2008 08:35:36 +1100
Subject: radius_ind() failed! ... Why?
Message-ID: <OFCA257440.00769D51-ONCA257440.00769D51-CA257440.00769DA3@csc.com>

Return Receipt
                                                                           
   Your       radius_ind() failed! ... Why?                                
   document:                                                               
                                                                           
   was        Ciaran Finnegan/GIS/CSC                                      
   received                                                                
   by:                                                                     
                                                                           
   at:        05/06/2008 08:35:35 AM ZE10                                  
                                                                           






From murray at skyrove.com  Tue May  6 07:58:42 2008
From: murray at skyrove.com (Murray Long)
Date: Tue, 6 May 2008 09:58:42 +0200
Subject: Addressing APIPA/IPv4LL issues with uamanyip
Message-ID: <56acee400805060058w202c8e8ep8c156934189b6ede@mail.gmail.com>

Hi Gunter,
Thanks for the patch.

Have done some testing myself and found that the same problem applies if a
user arrives at a hotspot with a static IP and no gateway.
If, on finding he can connect, he tries to connect though DHCP he will be
given his origional IP without any gateway.
And so won't be able to connect until the router is rebooted.

With this in mind, would it not be better for your patch to test for all
IP's outside of the DHCP dynamic ip range rather than just those in the
IPv4LL subnet?

-Murray
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080506/23964721/attachment.htm>

From oguzhank at bilkent.edu.tr  Tue May  6 12:39:28 2008
From: oguzhank at bilkent.edu.tr (Oguzhan Kayhan)
Date: Tue, 6 May 2008 15:39:28 +0300 (EEST)
Subject: disable nat
Message-ID: <37720.139.179.14.250.1210077568.squirrel@webmail.bilkent.edu.tr>

Hi, i installed coovaap for wrt54gl without a problem.
Everything works fine  till now.
I want to use real ips instead of nat on client side.
How will i disable nat for coovaap?
Thank you.




From gunther.mayer at googlemail.com  Tue May  6 14:39:43 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Tue, 06 May 2008 16:39:43 +0200
Subject: Addressing APIPA/IPv4LL issues with uamanyip
In-Reply-To: <56acee400805060058w202c8e8ep8c156934189b6ede@mail.gmail.com>
References: <56acee400805060058w202c8e8ep8c156934189b6ede@mail.gmail.com>
Message-ID: <48206DAF.7020705@gmail.com>

Murray Long wrote:
> Hi Gunter,
> Thanks for the patch.
>
> Have done some testing myself and found that the same problem applies 
> if a user arrives at a hotspot with a static IP and no gateway.
> If, on finding he can connect, he tries to connect though DHCP he will 
> be given his origional IP without any gateway.
> And so won't be able to connect until the router is rebooted.
>
> With this in mind, would it not be better for your patch to test for 
> all IP's outside of the DHCP dynamic ip range rather than just those 
> in the IPv4LL subnet?
No, and this is the one and only case where uamanyip fails. You see, if 
you ignore all IP's outside the dynamic dhcp range you might as well not 
use uamanyip as it then wouldn't serve any purpose whatsoever.

But I doubt this is any cause for concern and is a highly unlikely case 
anyways. Somebody who arrives at a hotspot with a static ip and no 
gateway likely has never used the Internet before and doesn't use the 
Internet where he comes from because without a default gateway it's 
impossible for ANY client ANYWHERE to connect to the Internet. So 
chances are you're dealing with somebody who doesn't know how to use the 
Internet and probably wouldn't want to use it in the first place. You 
see, I doubt you'll ever encounter such a case.

Gunther


From gunther.mayer at googlemail.com  Tue May  6 14:33:54 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Tue, 06 May 2008 16:33:54 +0200
Subject: Messages
In-Reply-To: <81B2B4AE03A22D4490CD35A0F20F89E003996F41@thsvml00.togewa.com>
References: <81B2B4AE03A22D4490CD35A0F20F89E003996F41@thsvml00.togewa.com>
Message-ID: <48206C52.5000202@gmail.com>

Urech Bruno wrote:
> Hi all
>
> Yesterday i found out that since last Thursday, April 24, 2008 all 10 minutes the following message is written in the messages log on /var/log of my Ubuntu 7.04:
>
> Apr 27 07:50:01 test2 coova-chilli[16589]: ChilliSpot 1.0.8. Copyright 2002-2005 Mondru AB. Licensed under GPL. Copyright 2006-2007 David Bird <dbird at acm.org>. Licensed under GPL. See http://www.chillispot.org/ & http://coova.org/ for details
>
> In the syslog is additionally mentionned, that there is a problem with the tun device:
>
> Apr 30 06:40:01 test2 coova-chilli[17716]: ChilliSpot 1.0.8. Copyright 2002-2005 Mondru AB. Licensed under GPL. Copyright 2006-2007 David Bird <dbird at acm.org>. Licensed under GPL. See http://www.chillispot.org/ & http://coova.org/ for details.
> Apr 30 06:40:01 test2 coova-chilli[17716]: tun.c: 631: 13 (Permission denied) open() failed
> Apr 30 06:40:01 test2 coova-chilli[17716]: chilli.c: 3238: Failed to create tun 
> Apr 30 06:50:01 test2 coova-chilli[17776]: tun.c: 631: 13 (Permission denied) open() failed
> Apr 30 06:50:01 test2 coova-chilli[17776]: chilli.c: 3238: Failed to create tun
>
> As the chilli service hung, last Friday - the subscribers did receive an IP address, but were no longer redirected to the login page, i tried to restart the chilli service. But as chilli restart did not work, i tried also out the following:  chilli restart; chilli condrestart; chilli reload, as written wen just giving chilli and enter: start|stop|restart|condrestart|status|reload|radconfig . After each of them, the chilli seamed to be running, but the redirection only worked after a restart of the whole server. After restarting, the chilli service was up and the subscribers where redirected again, as usually, but only submentioned messages appear.
>
> Can somebody imagine and describe, what i do wrong, where this messages are from, how and what occures and how can i remove them?
>   
The log that you attached suggests that you are starting dozens of 
chilli instances at regular intervals, something must be wrong with your 
init setup. First of all would you mind please upgrading to the latest 
stable (1.0.11) and following the official installation procedure? Also, 
as soon as you encounter problems, issue

ps wax |grep [c]hilli

and

ifconfig -a |grep tun

and send us the output which will help troubleshoot.

Gunther


From gunther.mayer at googlemail.com  Tue May  6 14:43:58 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Tue, 06 May 2008 16:43:58 +0200
Subject: Addressing APIPA/IPv4LL issues with uamanyip
In-Reply-To: <14137EDD-6CC2-4313-A822-15EC10C6CECF@mac.com>
References: <481CBBE4.60500@gmail.com> <14137EDD-6CC2-4313-A822-15EC10C6CECF@mac.com>
Message-ID: <48206EAE.9000503@gmail.com>

wlan at mac.com wrote:
> Hi Gunther,
>
> This is a great fix -- cheers!
>
> I agree that chilli shouldn't be considering these addresses as 
> 'configured'...
Great, it's in r169 then...

Gunther


From gunther.mayer at googlemail.com  Tue May  6 14:49:44 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Tue, 06 May 2008 16:49:44 +0200
Subject: Building SVN coova-chilli to ipkg binary
In-Reply-To: <56acee400805050718h69027b21r7d2ef59ef048fb68@mail.gmail.com>
References: <56acee400805050718h69027b21r7d2ef59ef048fb68@mail.gmail.com>
Message-ID: <48207008.7080502@gmail.com>

Murray Long wrote:
> Hi Guys,
> I've been trying to compile the latest coova-chilli into an ipk 
> package using the whiterussian SDK, by replacing the 
> build_mipsel/coova-chilli-* directory as suggested by Sophana here: 
> http://coova.org/lists/?0::30
>
> Alas, this doesn't work for me, make fails with
> .
> .
> checking for getline... yes
> checking for res_init in -lresolv... no
> configure: creating ./config.status
> config.status: error: cannot find input file: Makefile.in
> make[4]: *** [build_mipsel/coova-chilli-1.0.11/.configured] Error 1
> make[4]: Leaving directory `package/coova-chilli'
> .
> .
>
> Is this the recommended method for building a coova-chilli ipkg?
I take it you need this to roll your own ipkg for your own patches or a 
version from svn? Cause there are standard ipkg's floating around for 
the stable versions if you need them. What I do is just to put my 
patches to coova in $BUILDROOT/packages/coova-chilli/patches, rm -rf 
build_mipsel/coova-chilli* and let the full buildroot sort out the rest. 
That's because there's an OpenWRT package (1.0.11) for kamikaze (svn co 
http://dev.coova.org/svn/coova-ap/packages/kamikaze/coova-chilli in 
$BUILDROOT/packages). Any reason you're still on whiterussian?

But I must say I haven't found an elegant way to incorporate an svn 
version into OpenWRT, I just compile it by hand and then copy the files 
across, then build my image. Perhaps David can share what the best way 
of doing this is.

Gunther


From gunther.mayer at googlemail.com  Tue May  6 14:55:37 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Tue, 06 May 2008 16:55:37 +0200
Subject: radius_ind() failed! ... Why?
In-Reply-To: <200805052133.m45LXhYx088533@himinbjorg.tucs-beachin-obx-house.com>
References: <200805052133.m45LXhYx088533@himinbjorg.tucs-beachin-obx-house.com>
Message-ID: <48207169.3060909@gmail.com>

Tuc at T-B-O-H.NET wrote:
> Hi,
>
> 	We are seeing the following on one of the units, pretty
> regularly :
>
> radius.c: ???: No such id in radius queue: 164!
> radius.c: ????: Matching request was not found in queue: 164!
> chilli.c: ????: radius_ind() failed!
>
> 	What is radius_ind(), and what would/could make it fail?
>
> 	The unit was rebooted, but it still had issues.
>   
We have had these issues for quite some time with 1.0.6, one of the 
reasons we're upgrading to 1.0.11. Now the messages still appear but 
seemingly far less frequently. Not sure what's causing them but we 
haven't as yet detected any resulting problems with client's 
authentication or accounting so I doubt this is cause for concern. But 
of course it would still be good to find out anyways...

Gunther


From gunther.mayer at googlemail.com  Tue May  6 14:57:36 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Tue, 06 May 2008 16:57:36 +0200
Subject: disable nat
In-Reply-To: <37720.139.179.14.250.1210077568.squirrel@webmail.bilkent.edu.tr>
References: <37720.139.179.14.250.1210077568.squirrel@webmail.bilkent.edu.tr>
Message-ID: <482071E0.8040409@gmail.com>

Oguzhan Kayhan wrote:
> Hi, i installed coovaap for wrt54gl without a problem.
> Everything works fine  till now.
> I want to use real ips instead of nat on client side.
> How will i disable nat for coovaap?
> Thank you.
>   
I doubt any OpenWRT based derivative will do that for you without any 
significant hacking on the underlying firewall scripts. But why would 
you not want to use NAT? Does your ISP allocate you too many IP's and 
you just don't know what to do with them?

Gunther


From murray at skyrove.com  Tue May  6 15:16:25 2008
From: murray at skyrove.com (Murray Long)
Date: Tue, 6 May 2008 17:16:25 +0200
Subject: Addressing APIPA/IPv4LL issues with uamanyip
In-Reply-To: <48206DAF.7020705@gmail.com>
References: <56acee400805060058w202c8e8ep8c156934189b6ede@mail.gmail.com>
	 <48206DAF.7020705@gmail.com>
Message-ID: <56acee400805060816i7f8d8877nd02b72955357563@mail.gmail.com>

Ok, thanks, I'll stop worrying then..

But it does seem strange to me that future DHCP requests will reissue an old
address used though anyip.  Is there any reason for this?

-Murray

On Tue, May 6, 2008 at 4:39 PM, Gunther Mayer <gunther.mayer at googlemail.com>
wrote:

> Murray Long wrote:
>
> > Hi Gunter,
> > Thanks for the patch.
> >
> > Have done some testing myself and found that the same problem applies if
> > a user arrives at a hotspot with a static IP and no gateway.
> > If, on finding he can connect, he tries to connect though DHCP he will
> > be given his origional IP without any gateway.
> > And so won't be able to connect until the router is rebooted.
> >
> > With this in mind, would it not be better for your patch to test for all
> > IP's outside of the DHCP dynamic ip range rather than just those in the
> > IPv4LL subnet?
> >
> No, and this is the one and only case where uamanyip fails. You see, if
> you ignore all IP's outside the dynamic dhcp range you might as well not use
> uamanyip as it then wouldn't serve any purpose whatsoever.
>
> But I doubt this is any cause for concern and is a highly unlikely case
> anyways. Somebody who arrives at a hotspot with a static ip and no gateway
> likely has never used the Internet before and doesn't use the Internet where
> he comes from because without a default gateway it's impossible for ANY
> client ANYWHERE to connect to the Internet. So chances are you're dealing
> with somebody who doesn't know how to use the Internet and probably wouldn't
> want to use it in the first place. You see, I doubt you'll ever encounter
> such a case.
>
> Gunther
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080506/51ab1247/attachment.htm>

From gunther.mayer at googlemail.com  Tue May  6 15:25:19 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Tue, 06 May 2008 17:25:19 +0200
Subject: Addressing APIPA/IPv4LL issues with uamanyip
In-Reply-To: <56acee400805060816i7f8d8877nd02b72955357563@mail.gmail.com>
References: <56acee400805060058w202c8e8ep8c156934189b6ede@mail.gmail.com>	 <48206DAF.7020705@gmail.com> <56acee400805060816i7f8d8877nd02b72955357563@mail.gmail.com>
Message-ID: <4820785F.2030506@gmail.com>

Murray Long wrote:
> Ok, thanks, I'll stop worrying then..
>
> But it does seem strange to me that future DHCP requests will reissue 
> an old address used though anyip.  Is there any reason for this?
It's for efficiency purposes - chilli remembers past connections for the 
same MAC since there's no point in deallocating and reallocating memory 
all the time for a client who's likely to reconnect several times. Of 
course this is only remembered until either the client explicitly 
releases his ip or an idletimeout occurs.
>
> -Murray
>
> On Tue, May 6, 2008 at 4:39 PM, Gunther Mayer 
> <gunther.mayer at googlemail.com <mailto:gunther.mayer at googlemail.com>> 
> wrote:
>
>     Murray Long wrote:
>
>         Hi Gunter,
>         Thanks for the patch.
>
>         Have done some testing myself and found that the same problem
>         applies if a user arrives at a hotspot with a static IP and no
>         gateway.
>         If, on finding he can connect, he tries to connect though DHCP
>         he will be given his origional IP without any gateway.
>         And so won't be able to connect until the router is rebooted.
>
>         With this in mind, would it not be better for your patch to
>         test for all IP's outside of the DHCP dynamic ip range rather
>         than just those in the IPv4LL subnet?
>
>     No, and this is the one and only case where uamanyip fails. You
>     see, if you ignore all IP's outside the dynamic dhcp range you
>     might as well not use uamanyip as it then wouldn't serve any
>     purpose whatsoever.
>
>     But I doubt this is any cause for concern and is a highly unlikely
>     case anyways. Somebody who arrives at a hotspot with a static ip
>     and no gateway likely has never used the Internet before and
>     doesn't use the Internet where he comes from because without a
>     default gateway it's impossible for ANY client ANYWHERE to connect
>     to the Internet. So chances are you're dealing with somebody who
>     doesn't know how to use the Internet and probably wouldn't want to
>     use it in the first place. You see, I doubt you'll ever encounter
>     such a case.
>
>     Gunther
>
>     ---------------------------------------------------------------------
>     To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>     <mailto:chilli-unsubscribe at coova.org>
>     For additional commands, e-mail: chilli-help at coova.org
>     <mailto:chilli-help at coova.org>
>     Wiki: http://coova.org/wiki/index.php/CoovaChilli
>     Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080506/7c6bcfba/attachment.htm>

From BrunoRobert.Urech at comfone.com  Tue May  6 15:27:34 2008
From: BrunoRobert.Urech at comfone.com (Urech Bruno)
Date: Tue, 6 May 2008 17:27:34 +0200
Subject: Messages
In-Reply-To: <48206C52.5000202@gmail.com>
References: <81B2B4AE03A22D4490CD35A0F20F89E003996F41@thsvml00.togewa.com> <48206C52.5000202@gmail.com>
Message-ID: <81B2B4AE03A22D4490CD35A0F20F89E003A82998@thsvml00.togewa.com>

Hi

There was nothing wrong with the init setup before, the messages file
did not look this in the beginning. The configuration didn't change.
I just made a "fresh" installation and i assume that this message is
some kind of debug message, but i do not know where it comes from.
Meanwhile the Chilli access gateway works fine, but this messages are a
bit disturbing and i would like to get rid of it.

As with the recent Version 1.0.11 still shows problems with the Netgear
PoE switches (redirection works not) we use, we have to keep the 1.0.8
and
we cannot upgrade actually.

The asked for outputs are:

$ ps wax | grep chilli
  1737 pts/0    S+     0:00 grep chilli
  3923 ?        Ss     0:27 /usr/sbin/chilli --pidfile
/var/run/chilli.pid

$ ifconfig -a | grep tun
tun0      Link encap:UNSPEC  HWaddr  
00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00

Thank you for the assistance

Regards

Bruno


 

-----Original Message-----
From: Gunther Mayer [mailto:gunther.mayer at googlemail.com] 
Sent: Dienstag, 6. Mai 2008 16:34
To: chilli at coova.org
Subject: Re: Messages

Urech Bruno wrote:
> Hi all
>
> Yesterday i found out that since last Thursday, April 24, 2008 all 10
minutes the following message is written in the messages log on /var/log
of my Ubuntu 7.04:
>
> Apr 27 07:50:01 test2 coova-chilli[16589]: ChilliSpot 1.0.8. Copyright

> 2002-2005 Mondru AB. Licensed under GPL. Copyright 2006-2007 David 
> Bird <dbird at acm.org>. Licensed under GPL. See 
> http://www.chillispot.org/ & http://coova.org/ for details
>
> In the syslog is additionally mentionned, that there is a problem with
the tun device:
>
> Apr 30 06:40:01 test2 coova-chilli[17716]: ChilliSpot 1.0.8. Copyright
2002-2005 Mondru AB. Licensed under GPL. Copyright 2006-2007 David Bird
<dbird at acm.org>. Licensed under GPL. See http://www.chillispot.org/ &
http://coova.org/ for details.
> Apr 30 06:40:01 test2 coova-chilli[17716]: tun.c: 631: 13 (Permission 
> denied) open() failed Apr 30 06:40:01 test2 coova-chilli[17716]: 
> chilli.c: 3238: Failed to create tun Apr 30 06:50:01 test2 
> coova-chilli[17776]: tun.c: 631: 13 (Permission denied) open() failed 
> Apr 30 06:50:01 test2 coova-chilli[17776]: chilli.c: 3238: Failed to 
> create tun
>
> As the chilli service hung, last Friday - the subscribers did receive
an IP address, but were no longer redirected to the login page, i tried
to restart the chilli service. But as chilli restart did not work, i
tried also out the following:  chilli restart; chilli condrestart;
chilli reload, as written wen just giving chilli and enter:
start|stop|restart|condrestart|status|reload|radconfig . After each of
them, the chilli seamed to be running, but the redirection only worked
after a restart of the whole server. After restarting, the chilli
service was up and the subscribers where redirected again, as usually,
but only submentioned messages appear.
>
> Can somebody imagine and describe, what i do wrong, where this
messages are from, how and what occures and how can i remove them?
>   
The log that you attached suggests that you are starting dozens of
chilli instances at regular intervals, something must be wrong with your
init setup. First of all would you mind please upgrading to the latest
stable (1.0.11) and following the official installation procedure? Also,
as soon as you encounter problems, issue

ps wax |grep [c]hilli

and

ifconfig -a |grep tun

and send us the output which will help troubleshoot.

Gunther

---------------------------------------------------------------------
To unsubscribe, e-mail: chilli-unsubscribe at coova.org For additional
commands, e-mail: chilli-help at coova.org
Wiki: http://coova.org/wiki/index.php/CoovaChilli
Forum: http://coova.org/phpBB3/viewforum.php?f=4



From wlan at mac.com  Tue May  6 18:10:38 2008
From: wlan at mac.com (wlan at mac.com)
Date: Tue, 6 May 2008 20:10:38 +0200
Subject: radius_ind() failed! ... Why?
In-Reply-To: <48207169.3060909@gmail.com>
References: <200805052133.m45LXhYx088533@himinbjorg.tucs-beachin-obx-house.com> <48207169.3060909@gmail.com>
Message-ID: <AC49BE23-43C0-4E4F-BDD7-0CAFC7E131C7@mac.com>

It is when a RADIUS response was received when the request is longer  
in the queue. Most likely cause: a request and a retransmitted of the  
request (after radiustimeout) to the RADIUS server both resulted in a  
reply -- the first one just took too long. When the second response  
is processed, it prints the error.

On May 6, 2008, at 4:55 PM, Gunther Mayer wrote:

> Tuc at T-B-O-H.NET wrote:
>> Hi,
>>
>> 	We are seeing the following on one of the units, pretty
>> regularly :
>>
>> radius.c: ???: No such id in radius queue: 164!
>> radius.c: ????: Matching request was not found in queue: 164!
>> chilli.c: ????: radius_ind() failed!
>>
>> 	What is radius_ind(), and what would/could make it fail?
>>
>> 	The unit was rebooted, but it still had issues.
>>
> We have had these issues for quite some time with 1.0.6, one of the  
> reasons we're upgrading to 1.0.11. Now the messages still appear  
> but seemingly far less frequently. Not sure what's causing them but  
> we haven't as yet detected any resulting problems with client's  
> authentication or accounting so I doubt this is cause for concern.  
> But of course it would still be good to find out anyways...
>
> Gunther
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From oguzhank at bilkent.edu.tr  Tue May  6 20:50:07 2008
From: oguzhank at bilkent.edu.tr (Oguzhan Kayhan)
Date: Tue, 6 May 2008 23:50:07 +0300 (EEST)
Subject: disable nat
In-Reply-To: <482071E0.8040409@gmail.com>
References: <37720.139.179.14.250.1210077568.squirrel@webmail.bilkent.edu.tr>
    <482071E0.8040409@gmail.com>
Message-ID: <2125.85.105.98.159.1210107007.squirrel@webmail.bilkent.edu.tr>

> Oguzhan Kayhan wrote:
>> Hi, i installed coovaap for wrt54gl without a problem.
>> Everything works fine  till now.
>> I want to use real ips instead of nat on client side.
>> How will i disable nat for coovaap?
>> Thank you.
>>
> I doubt any OpenWRT based derivative will do that for you without any
> significant hacking on the underlying firewall scripts. But why would
> you not want to use NAT? Does your ISP allocate you too many IP's and
> you just don't know what to do with them?
>
> Gunther
>

Hello,
I already made it by disabling masquerade rule on iptables.
Actually, not an isp but the university i am working has a B class subnet
and i have to log all outgoing connections with usernames for security.
Thats why i need to use real ip addresses.
Thanks anyway.

> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>




From gunther.mayer at googlemail.com  Wed May  7 17:27:16 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Wed, 07 May 2008 19:27:16 +0200
Subject: radius_ind() failed! ... Why?
In-Reply-To: <AC49BE23-43C0-4E4F-BDD7-0CAFC7E131C7@mac.com>
References: <200805052133.m45LXhYx088533@himinbjorg.tucs-beachin-obx-house.com> <48207169.3060909@gmail.com> <AC49BE23-43C0-4E4F-BDD7-0CAFC7E131C7@mac.com>
Message-ID: <4821E674.6040400@gmail.com>

wlan at mac.com wrote:
> It is when a RADIUS response was received when the request is longer 
> in the queue. Most likely cause: a request and a retransmitted of the 
> request (after radiustimeout) to the RADIUS server both resulted in a 
> reply -- the first one just took too long. When the second response is 
> processed, it prints the error.
Ah, I see, that makes a lot of sense. Network issues then or sluggish 
server response times are then the real culprit, chilli just reports on 
it but in the end it doesn't cause noteworthy problems.


From gunther.mayer at googlemail.com  Wed May  7 17:42:55 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Wed, 07 May 2008 19:42:55 +0200
Subject: Help! Chilli accounting for dropped packets
Message-ID: <4821EA1F.2090303@gmail.com>

Hi again,

We recently noticed that a very nasty trojan/virus is doing the rounds 
that uploads a ton of data to the Internet. Since our captive portal 
charges in data units this becomes a major problem as customers loose 
their purchased Internet units like water through a sieve. While legally 
not our problem customers still contact us all the time wondering what 
happened, demanding refunds and all that jazz.

Tricky part is: we cannot sanely ask them to "quickly" download, install 
and/or upgrade their anti-virus because either they already have a zero 
balance or doing so would lose them even more units. It's a catch-22 
until we find a way to block those trojans.

I started investigating instead what patterns such abnormal Internet 
usage follows and managed to block specific instances with custom 
iptables firewall rules (based on port and/or host specs). One example:

iptables -I FORWARD -p tcp --dport 5000 -j DROP

The problem though is: even though the kernel correctly drops the 
trojan's packets (verified with iptables -L -vn), chilli somehow still 
counts them, so I've only solved the smaller part of the problem, making 
sure that the bogus packets never reach the Internet. The larger part, 
that of upload accounting going ballistic is still unaddressed. I always 
thought the kernel would drop them BEFORE chilli gets its hands on them 
for accounting purposes, but it seems like it does so AFTER.

What can I do, if anything, to make sure that either chilli disregards 
certain packets or that I get the kernel to drop packets BEFORE chilli 
gets hold of them?

Gunther


From wlan at mac.com  Thu May  8 06:21:29 2008
From: wlan at mac.com (wlan at mac.com)
Date: Thu, 8 May 2008 08:21:29 +0200
Subject: Help! Chilli accounting for dropped packets
In-Reply-To: <4821EA1F.2090303@gmail.com>
References: <4821EA1F.2090303@gmail.com>
Message-ID: <F2CDB07D-88EE-4CBC-A4DC-4B77CDC42179@mac.com>

Hi Gunther,

The issue is that chilli's _raw_ socket on the dhcpif sees packets  
_before_ the kernel does. This is why you should be dropping all  
input on the dhcpif interface in iptables - because otherwise you  
have chilli _and_ the kernel processing (and potentially forwarding  
the same) packets. So, you can not use iptables to filter traffic  
coming into chilli. As you noted, you _can_ control how packets are  
forwarded through the kernel -- this includes packets chilli is  
forwarding through the tun interface.

As for accounting, it really should be counting (per RFC) data  
received from and sent to the subscriber from the NAS. Meaning, it is  
doing the right thing by counting all packets received and sent to  
the subscriber, even if later dropped by iptables.

I suppose a feature you would like -- and others have mentioned it  
too -- would be something like an "acctignore" option to list out (in  
a uamallowed fashion) networks to not count in accounting. This way  
you can exclude the same ports you are filtering...

David

On May 7, 2008, at 7:42 PM, Gunther Mayer wrote:

> Hi again,
>
> We recently noticed that a very nasty trojan/virus is doing the  
> rounds that uploads a ton of data to the Internet. Since our  
> captive portal charges in data units this becomes a major problem  
> as customers loose their purchased Internet units like water  
> through a sieve. While legally not our problem customers still  
> contact us all the time wondering what happened, demanding refunds  
> and all that jazz.
>
> Tricky part is: we cannot sanely ask them to "quickly" download,  
> install and/or upgrade their anti-virus because either they already  
> have a zero balance or doing so would lose them even more units.  
> It's a catch-22 until we find a way to block those trojans.
>
> I started investigating instead what patterns such abnormal  
> Internet usage follows and managed to block specific instances with  
> custom iptables firewall rules (based on port and/or host specs).  
> One example:
>
> iptables -I FORWARD -p tcp --dport 5000 -j DROP
>
> The problem though is: even though the kernel correctly drops the  
> trojan's packets (verified with iptables -L -vn), chilli somehow  
> still counts them, so I've only solved the smaller part of the  
> problem, making sure that the bogus packets never reach the  
> Internet. The larger part, that of upload accounting going  
> ballistic is still unaddressed. I always thought the kernel would  
> drop them BEFORE chilli gets its hands on them for accounting  
> purposes, but it seems like it does so AFTER.
>
> What can I do, if anything, to make sure that either chilli  
> disregards certain packets or that I get the kernel to drop packets  
> BEFORE chilli gets hold of them?
>
> Gunther
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From gunther.mayer at googlemail.com  Thu May  8 11:02:43 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Thu, 08 May 2008 13:02:43 +0200
Subject: Messages
In-Reply-To: <81B2B4AE03A22D4490CD35A0F20F89E003A82998@thsvml00.togewa.com>
References: <81B2B4AE03A22D4490CD35A0F20F89E003996F41@thsvml00.togewa.com> <48206C52.5000202@gmail.com> <81B2B4AE03A22D4490CD35A0F20F89E003A82998@thsvml00.togewa.com>
Message-ID: <4822DDD3.90700@gmail.com>

Urech Bruno wrote:
> Hi
>
> There was nothing wrong with the init setup before, the messages file
> did not look this in the beginning. The configuration didn't change.
> I just made a "fresh" installation and i assume that this message is
> some kind of debug message, but i do not know where it comes from.
> Meanwhile the Chilli access gateway works fine, but this messages are a
> bit disturbing and i would like to get rid of it.
>   
Let me get this straight - everything works 100% but you see some 
strange messages appearing in your syslog at regular intervals, is that 
right? You see, the log that you attached initially says something 
completely different from the logs that you put into your message body. 
The former suggest that your chilli process is being (re)started every 
10 minutes, the latter suggest a permissions problem but seeing that all 
your processes run as root (do they really?) I'm not sure what they mean 
(perhaps trying to create a tun device that already exists?).

Best is you attach one single complete log file that shows all the 
entries that you're worried about and we'll take it from there.

Also, did you take the "ps wax |grep [c]hilli" and "ifconfig -a |grep 
tun" snapshots when things were running 100% or when you encountered 
problems?

Gunther
> As with the recent Version 1.0.11 still shows problems with the Netgear
> PoE switches (redirection works not) we use, we have to keep the 1.0.8
> and
> we cannot upgrade actually.
>
> The asked for outputs are:
>
> $ ps wax | grep chilli
>   1737 pts/0    S+     0:00 grep chilli
>   3923 ?        Ss     0:27 /usr/sbin/chilli --pidfile
> /var/run/chilli.pid
>
> $ ifconfig -a | grep tun
> tun0      Link encap:UNSPEC  HWaddr  
> 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00
>
> Thank you for the assistance
>
> Regards
>
> Bruno
>
>
>  
>
> -----Original Message-----
> From: Gunther Mayer [mailto:gunther.mayer at googlemail.com] 
> Sent: Dienstag, 6. Mai 2008 16:34
> To: chilli at coova.org
> Subject: Re: Messages
>
> Urech Bruno wrote:
>   
>> Hi all
>>
>> Yesterday i found out that since last Thursday, April 24, 2008 all 10
>>     
> minutes the following message is written in the messages log on /var/log
> of my Ubuntu 7.04:
>   
>> Apr 27 07:50:01 test2 coova-chilli[16589]: ChilliSpot 1.0.8. Copyright
>>     
>
>   
>> 2002-2005 Mondru AB. Licensed under GPL. Copyright 2006-2007 David 
>> Bird <dbird at acm.org>. Licensed under GPL. See 
>> http://www.chillispot.org/ & http://coova.org/ for details
>>
>> In the syslog is additionally mentionned, that there is a problem with
>>     
> the tun device:
>   
>> Apr 30 06:40:01 test2 coova-chilli[17716]: ChilliSpot 1.0.8. Copyright
>>     
> 2002-2005 Mondru AB. Licensed under GPL. Copyright 2006-2007 David Bird
> <dbird at acm.org>. Licensed under GPL. See http://www.chillispot.org/ &
> http://coova.org/ for details.
>   
>> Apr 30 06:40:01 test2 coova-chilli[17716]: tun.c: 631: 13 (Permission 
>> denied) open() failed Apr 30 06:40:01 test2 coova-chilli[17716]: 
>> chilli.c: 3238: Failed to create tun Apr 30 06:50:01 test2 
>> coova-chilli[17776]: tun.c: 631: 13 (Permission denied) open() failed 
>> Apr 30 06:50:01 test2 coova-chilli[17776]: chilli.c: 3238: Failed to 
>> create tun
>>
>> As the chilli service hung, last Friday - the subscribers did receive
>>     
> an IP address, but were no longer redirected to the login page, i tried
> to restart the chilli service. But as chilli restart did not work, i
> tried also out the following:  chilli restart; chilli condrestart;
> chilli reload, as written wen just giving chilli and enter:
> start|stop|restart|condrestart|status|reload|radconfig . After each of
> them, the chilli seamed to be running, but the redirection only worked
> after a restart of the whole server. After restarting, the chilli
> service was up and the subscribers where redirected again, as usually,
> but only submentioned messages appear.
>   
>> Can somebody imagine and describe, what i do wrong, where this
>>     
> messages are from, how and what occures and how can i remove them?
>   
>>   
>>     
> The log that you attached suggests that you are starting dozens of
> chilli instances at regular intervals, something must be wrong with your
> init setup. First of all would you mind please upgrading to the latest
> stable (1.0.11) and following the official installation procedure? Also,
> as soon as you encounter problems, issue
>
> ps wax |grep [c]hilli
>
> and
>
> ifconfig -a |grep tun
>
> and send us the output which will help troubleshoot.
>
> Gunther
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org For additional
> commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>
>   

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080508/28746a19/attachment.htm>

From ccesario at tecnomega.com.br  Thu May  8 11:49:53 2008
From: ccesario at tecnomega.com.br (Carlos Cesario)
Date: Thu, 8 May 2008 08:49:53 -0300
Subject: Static IP
Message-ID: <1210247393.7555.31.camel@ccesario-laptop>

Hi Gunther Mayer,

your patch is applied in coovachilli svn ?

if no, where I can download it ?


thanks

Carlos



From chilli at silverserver.at  Thu May  8 16:27:10 2008
From: chilli at silverserver.at (lc)
Date: Thu, 8 May 2008 18:27:10 +0200
Subject: Mac Authentication - what happens after session timeout
Message-ID: <64440E37-CFA7-4082-AE60-2F8B6D2678C0@silverserver.at>

Hi,

Why does coova-chilli (SVN 167) not retry a mac-authentication after a  
mac-authenticated session has timed out (or was manually closed)?
Only when the client removes his DHCP connection (during an active  
session) and reestablishes it later chilli tries again to mac- 
authenticate him.

Is this a bug? If it isn't, what are the thoughts behind this behavior?


From chilli at silverserver.at  Thu May  8 16:43:55 2008
From: chilli at silverserver.at (lc)
Date: Thu, 8 May 2008 18:43:55 +0200
Subject: Mac Authentication - framed IP address not reported to Radius server in access request
Message-ID: <8C2B64CD-5B64-4B22-91E5-A5FC1B2B09AD@silverserver.at>

Hi,

It seems chilli (SVN 167) does not include the clients IP address  
(framed ip) in the radius access request. In the following radius  
communication it is included, it is also passed to chilli.conup.

Is this a bug or on purpose?




From gunther.mayer at googlemail.com  Fri May  9 12:10:56 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Fri, 09 May 2008 14:10:56 +0200
Subject: Static IP
In-Reply-To: <1210247393.7555.31.camel@ccesario-laptop>
References: <1210247393.7555.31.camel@ccesario-laptop>
Message-ID: <48243F50.5050705@gmail.com>

Carlos Cesario wrote:
> Hi Gunther Mayer,
>
> your patch is applied in coovachilli svn ?
>
> if no, where I can download it ?
>   
I'm not sure which patch you're referring to but I recently committed 
two patches to svn, one for ignoring arp requests for ip's inside 
chilli's own net and the other for ignoring IPv4LL/APIPA clients. If you 
go back through my recent posts to this mailing list you'll see which 
was done in which revision.

Gunther


From gunther.mayer at googlemail.com  Fri May  9 12:24:15 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Fri, 09 May 2008 14:24:15 +0200
Subject: Mac Authentication - what happens after session timeout
In-Reply-To: <64440E37-CFA7-4082-AE60-2F8B6D2678C0@silverserver.at>
References: <64440E37-CFA7-4082-AE60-2F8B6D2678C0@silverserver.at>
Message-ID: <4824426F.3050301@gmail.com>

lc wrote:
> Hi,
>
> Why does coova-chilli (SVN 167) not retry a mac-authentication after a 
> mac-authenticated session has timed out (or was manually closed)?
> Only when the client removes his DHCP connection (during an active 
> session) and reestablishes it later chilli tries again to 
> mac-authenticate him.
>
> Is this a bug? If it isn't, what are the thoughts behind this behavior?
As far as I can tell from the code the mac authentication (be it through 
radius or locally) only happens during establishment of the dhcp 
connection. Once the connection has been initiated no re-authentication 
occurs so what you observe seems consistent.

To answer your question, I do think that's a bug, I just don't know how 
that could be solved as mac-authenticated clients don't explicitly 
trigger any sorts of events, i.e. no user interaction happens for 
authentication, other than the initial dhcp request. Triggering a radius 
auth for every packet that gets routed to the Internet perhaps? But that 
might be way too inefficient...

Gunther


From wlan at mac.com  Sun May 11 05:54:00 2008
From: wlan at mac.com (wlan at mac.com)
Date: Sun, 11 May 2008 07:54:00 +0200
Subject: Mac Authentication - framed IP address not reported to Radius server in access request
In-Reply-To: <8C2B64CD-5B64-4B22-91E5-A5FC1B2B09AD@silverserver.at>
References: <8C2B64CD-5B64-4B22-91E5-A5FC1B2B09AD@silverserver.at>
Message-ID: <BF7C60E5-5E62-4F17-8851-9069874B045A@mac.com>

You are saying the framed-ip-address attribute isn't in the access- 
request of mac-authentication requests? That makes sense because the  
subscriber doesn't have an IP address yet ... in fact, it can be set  
during mac authentication if the framed-ip-address is returned in the  
access-accept.


On May 8, 2008, at 6:43 PM, lc wrote:

> Hi,
>
> It seems chilli (SVN 167) does not include the clients IP address  
> (framed ip) in the radius access request. In the following radius  
> communication it is included, it is also passed to chilli.conup.
>
> Is this a bug or on purpose?
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From wlan at mac.com  Sun May 11 06:01:20 2008
From: wlan at mac.com (wlan at mac.com)
Date: Sun, 11 May 2008 08:01:20 +0200
Subject: Mac Authentication - what happens after session timeout
In-Reply-To: <64440E37-CFA7-4082-AE60-2F8B6D2678C0@silverserver.at>
References: <64440E37-CFA7-4082-AE60-2F8B6D2678C0@silverserver.at>
Message-ID: <134047BD-55CF-4607-BA73-7798148ACFAE@mac.com>

One idea could be to always set the DHCP lease time to that of the  
session-timeout returned in a mac-auth access-accept. This should  
result in the lease expiring at the same time as the session (unless  
due to idle-timeout).

On May 8, 2008, at 6:27 PM, lc wrote:

> Hi,
>
> Why does coova-chilli (SVN 167) not retry a mac-authentication  
> after a mac-authenticated session has timed out (or was manually  
> closed)?
> Only when the client removes his DHCP connection (during an active  
> session) and reestablishes it later chilli tries again to mac- 
> authenticate him.
>
> Is this a bug? If it isn't, what are the thoughts behind this  
> behavior?
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From javi.larrea at gmail.com  Mon May 12 12:20:38 2008
From: javi.larrea at gmail.com (=?ISO-8859-1?Q?Javier_Larrea_Arma=F1anzas?=)
Date: Mon, 12 May 2008 14:20:38 +0200
Subject: no error message when user doesn't exist
Message-ID: <48283616.7050406@gmail.com>

Hi list,
I've set up a pc with coovachilli+freeradius+apache and I'm testing a 
little.  Everything is fine when I put a correct username and password 
in my local captive portal but when I put a wrong username or password I 
get a page that says "Please wait..." but I would expect an error 
message when the radius service gave the "Access-Reject" response.  
However I only get the "Please wait..." message and nothing new happens.
It's this normal?
Thanks a lot,

Javier.


From gunther.mayer at googlemail.com  Mon May 12 12:43:04 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Mon, 12 May 2008 14:43:04 +0200
Subject: no error message when user doesn't exist
In-Reply-To: <48283616.7050406@gmail.com>
References: <48283616.7050406@gmail.com>
Message-ID: <48283B58.7080009@gmail.com>

Javier Larrea Arma?anzas wrote:
> Hi list,
> I've set up a pc with coovachilli+freeradius+apache and I'm testing a 
> little.  Everything is fine when I put a correct username and password 
> in my local captive portal but when I put a wrong username or password 
> I get a page that says "Please wait..." but I would expect an error 
> message when the radius service gave the "Access-Reject" response.  
> However I only get the "Please wait..." message and nothing new happens.
> It's this normal?
afaik yes. However, it's been ages since we last looked at stock login 
scripts, we ended up heavily customising ours to get it to do what we 
wanted. Also, you'll see that there are multiple causes for reject 
(invalid password, not enough credits etc.) which are best controlled 
through radius messages that your login script then converts into html. 
I haven't done that coding myself though so I'm afraid I can't help you 
further.

Gunther


From rpope at totalteam.co.nz  Mon May 12 22:53:54 2008
From: rpope at totalteam.co.nz (Roland Pope)
Date: Tue, 13 May 2008 10:53:54 +1200
Subject: Problems with postauthproxy behaviour
Message-ID: <4828CA82.50205@totalteam.co.nz>

Hi all,

I am having an issue with coova-chilli 1.0.11 and transparent 
postauthproxy.
When I request a HTTP page, it is retrieved from the proxy, however, it 
seems when I do a post from that same website, chilli doesn't use the 
proxy and sends the request directly.

 eg. www.google.com gets served up via the proxy, but submitting a 
search on the google page tries to go direct.

As a result of this behavior, I have to allow direct HTTP access to the 
Internet whereas I was hoping to only allow access via the proxy.

Any ideas?

Thanks
Roland


From wlan at mac.com  Tue May 13 05:36:25 2008
From: wlan at mac.com (wlan at mac.com)
Date: Tue, 13 May 2008 07:36:25 +0200
Subject: Problems with postauthproxy behaviour
In-Reply-To: <4828CA82.50205@totalteam.co.nz>
References: <4828CA82.50205@totalteam.co.nz>
Message-ID: <85C215CB-CE6C-4A79-B188-88CA8279C6E7@mac.com>

Hmm.. well, when using the postauthproxy option, chilli is not  
inspecting the traffic. so, it doesn't really know the difference in  
a Get or Post. Is the Post using https or an alternate port (other  
than 80)? I wonder if your proxy is trying to fix it so that it  
doesn't proxy a post.

David

On May 13, 2008, at 12:53 AM, Roland Pope wrote:

> Hi all,
>
> I am having an issue with coova-chilli 1.0.11 and transparent  
> postauthproxy.
> When I request a HTTP page, it is retrieved from the proxy,  
> however, it seems when I do a post from that same website, chilli  
> doesn't use the proxy and sends the request directly.
>
> eg. www.google.com gets served up via the proxy, but submitting a  
> search on the google page tries to go direct.
>
> As a result of this behavior, I have to allow direct HTTP access to  
> the Internet whereas I was hoping to only allow access via the proxy.
>
> Any ideas?
>
> Thanks
> Roland
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From m.simioni at gmail.com  Tue May 13 07:28:28 2008
From: m.simioni at gmail.com (Marco Simioni)
Date: Tue, 13 May 2008 09:28:28 +0200
Subject: no error message when user doesn't exist
In-Reply-To: <48283B58.7080009@gmail.com>
References: <48283616.7050406@gmail.com> <48283B58.7080009@gmail.com>
Message-ID: <f71cb680805130028j7bde4595oca0a68c22a337b25@mail.gmail.com>

2008/5/12 Gunther Mayer <gunther.mayer at googlemail.com>:
> Javier Larrea Arma?anzas wrote:
>
> > Hi list,
> > I've set up a pc with coovachilli+freeradius+apache and I'm testing a
> little.  Everything is fine when I put a correct username and password in my
> local captive portal but when I put a wrong username or password I get a
> page that says "Please wait..." but I would expect an error message when the
> radius service gave the "Access-Reject" response.  However I only get the
> "Please wait..." message and nothing new happens.
> > It's this normal?
> >
>  afaik yes. However, it's been ages since we last looked at stock login
> scripts, we ended up heavily customising ours to get it to do what we
> wanted. Also, you'll see that there are multiple causes for reject (invalid
> password, not enough credits etc.) which are best controlled through radius
> messages that your login script then converts into html. I haven't done that
> coding myself though so I'm afraid I can't help you further.
>
>  Gunther
>
>
>
>  ---------------------------------------------------------------------
>  To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>  For additional commands, e-mail: chilli-help at coova.org
>  Wiki: http://coova.org/wiki/index.php/CoovaChilli
>  Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>

Can anybody provide some example of script to catch Access-Reject
messages and its variants?

My customers too are asking for such features, because just waiting
for the timeout is somewhat annoying.

Thankyou i.a.

Marco


From wlan at mac.com  Tue May 13 08:22:05 2008
From: wlan at mac.com (wlan at mac.com)
Date: Tue, 13 May 2008 10:22:05 +0200
Subject: no error message when user doesn't exist
In-Reply-To: <48283616.7050406@gmail.com>
References: <48283616.7050406@gmail.com>
Message-ID: <2D9AD485-12F0-4198-8FED-C37455AA96B0@mac.com>

No, that is not normal. What captive portal are you using? -- it  
sounds like the JSON version (default for coovachilli). You might try  
the latest SVN version if you have already. When an access-reject is  
received, the Reply-Message should be presented (it is for me, using  
latest and greatest). Sometimes RADIUS servers are configured with a  
delay for access-reject (to thwart off brute force password guessing  
attaches), but it is usually just a second or two.

Another resource to consider is the Drupal Hotspot module which, at a  
minimum, gives a good start for creating your chilli captive portal.

David

On May 12, 2008, at 2:20 PM, Javier Larrea Arma?anzas wrote:

> Hi list,
> I've set up a pc with coovachilli+freeradius+apache and I'm testing  
> a little.  Everything is fine when I put a correct username and  
> password in my local captive portal but when I put a wrong username  
> or password I get a page that says "Please wait..." but I would  
> expect an error message when the radius service gave the "Access- 
> Reject" response.  However I only get the "Please wait..." message  
> and nothing new happens.
> It's this normal?
> Thanks a lot,
>
> Javier.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From javi.larrea at gmail.com  Tue May 13 08:34:12 2008
From: javi.larrea at gmail.com (=?ISO-8859-1?Q?Javier_Larrea_Arma=F1anzas?=)
Date: Tue, 13 May 2008 10:34:12 +0200
Subject: no error message when user doesn't exist
In-Reply-To: <2D9AD485-12F0-4198-8FED-C37455AA96B0@mac.com>
References: <48283616.7050406@gmail.com> <2D9AD485-12F0-4198-8FED-C37455AA96B0@mac.com>
Message-ID: <48295284.7070500@gmail.com>

I've been browsing the forum and I've discovered that it happens using 
IE on the client but using Firefox at least after 30 seconds I get 
redirected to the login page again.  I'm using version 1.0.11.

Javier.


wlan at mac.com escribi?:
> No, that is not normal. What captive portal are you using? -- it 
> sounds like the JSON version (default for coovachilli). You might try 
> the latest SVN version if you have already. When an access-reject is 
> received, the Reply-Message should be presented (it is for me, using 
> latest and greatest). Sometimes RADIUS servers are configured with a 
> delay for access-reject (to thwart off brute force password guessing 
> attaches), but it is usually just a second or two.
>
> Another resource to consider is the Drupal Hotspot module which, at a 
> minimum, gives a good start for creating your chilli captive portal.
>
> David
>
> On May 12, 2008, at 2:20 PM, Javier Larrea Arma?anzas wrote:
>
>> Hi list,
>> I've set up a pc with coovachilli+freeradius+apache and I'm testing a 
>> little.  Everything is fine when I put a correct username and 
>> password in my local captive portal but when I put a wrong username 
>> or password I get a page that says "Please wait..." but I would 
>> expect an error message when the radius service gave the 
>> "Access-Reject" response.  However I only get the "Please wait..." 
>> message and nothing new happens.
>> It's this normal?
>> Thanks a lot,
>>
>> Javier.
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>



From javi.larrea at gmail.com  Wed May 14 08:01:51 2008
From: javi.larrea at gmail.com (=?ISO-8859-1?Q?Javier_Larrea_Arma=F1anzas?=)
Date: Wed, 14 May 2008 10:01:51 +0200
Subject: problems with ldap users
Message-ID: <482A9C6F.7080408@gmail.com>

Hi list,
I've got a problem authenticating ldap users.  My radius server 
authenticate local users but it refuses to authenticate ldap users.  
(The radius server ask a ldap server for some users).  It is related to 
CHAP authentication?  Someone has tried radius+ldap with coova chilli?
Regards,

Javier


From javi.larrea at gmail.com  Wed May 14 11:51:09 2008
From: javi.larrea at gmail.com (=?ISO-8859-1?Q?Javier_Larrea_Arma=F1anzas?=)
Date: Wed, 14 May 2008 13:51:09 +0200
Subject: problems with ldap users
In-Reply-To: <482A9C6F.7080408@gmail.com>
References: <482A9C6F.7080408@gmail.com>
Message-ID: <482AD22D.3050906@gmail.com>

I've found that it works using the old cgi script, setting an 
"uamsecret".  I suppose it would be better if it worked with the JSON 
interface.  How good it's the old hotspotlogin.cgi?

Javier Larrea Arma?anzas escribi?:
> Hi list,
> I've got a problem authenticating ldap users.  My radius server 
> authenticate local users but it refuses to authenticate ldap users.  
> (The radius server ask a ldap server for some users).  It is related 
> to CHAP authentication?  Someone has tried radius+ldap with coova chilli?
> Regards,
>
> Javier
>



From kaevee at gmail.com  Wed May 14 13:22:52 2008
From: kaevee at gmail.com (Venkatesh K)
Date: Wed, 14 May 2008 18:52:52 +0530
Subject: SVN Revision 171 issue
Message-ID: <e187fc980805140622td7fdd3ve4f595c53f020630@mail.gmail.com>

Hi,

I am trying svn revision 171.  It seems to work fine, but only in debug mode.
If I switch off debug, it stops working.

Here is the main.conf

# THIS FILE IS AUTOMATICALLY GENERATED
cmdsocket       /var/run/chilli.sock
pidfile         /var/run/chilli.pid
net             10.1.0.0/255.255.255.0
uamlisten       10.1.0.1
uamport         3990
dhcpif          eth1
adminuser       chillispot
adminpasswd     chillispot
uamallowed      coova.org,10.1.0.1,172.16.194.221,coova.org
uamanydns

uamanyip
debug
statip 10.1.0.0/255.255.255.0
domain lan
dns1 208.67.220.220
dns2 208.67.222.222
uamhomepage http://10.1.0.1:3990/www/coova.html
wisprlogin https://coova.org/app/uam/auth
wwwdir /etc/chilli/www
wwwbin /etc/chilli/wwwsh
locationname "My HotSpot"
radiuslocationname My_HotSpot
radiuslocationid isocc=,cc=,ac=,network=Coova,
radiusserver1   172.16.194.221
radiusserver2   172.16.194.221
radiussecret    testing123
radiusauthport  1812
radiusacctport  1813
uamserver       http://10.1.0.1/uam/
radiusnasid     cfff1fb7c7ad3f19a8fc

papalwaysok
macauth

Anyone has suggestions?

thanks

Venkatesh. K


From wlan at mac.com  Wed May 14 19:39:53 2008
From: wlan at mac.com (wlan at mac.com)
Date: Wed, 14 May 2008 21:39:53 +0200
Subject: SVN Revision 171 issue
In-Reply-To: <e187fc980805140622td7fdd3ve4f595c53f020630@mail.gmail.com>
References: <e187fc980805140622td7fdd3ve4f595c53f020630@mail.gmail.com>
Message-ID: <D0D40F21-C2BB-45FE-A0BC-BCC6696D95C2@mac.com>

Nothing comes to mind... What do you mean by 'stops working'?

On May 14, 2008, at 3:22 PM, Venkatesh K wrote:

> Hi,
>
> I am trying svn revision 171.  It seems to work fine, but only in  
> debug mode.
> If I switch off debug, it stops working.
>
> Here is the main.conf
>
> # THIS FILE IS AUTOMATICALLY GENERATED
> cmdsocket       /var/run/chilli.sock
> pidfile         /var/run/chilli.pid
> net             10.1.0.0/255.255.255.0
> uamlisten       10.1.0.1
> uamport         3990
> dhcpif          eth1
> adminuser       chillispot
> adminpasswd     chillispot
> uamallowed      coova.org,10.1.0.1,172.16.194.221,coova.org
> uamanydns
>
> uamanyip
> debug
> statip 10.1.0.0/255.255.255.0
> domain lan
> dns1 208.67.220.220
> dns2 208.67.222.222
> uamhomepage http://10.1.0.1:3990/www/coova.html
> wisprlogin https://coova.org/app/uam/auth
> wwwdir /etc/chilli/www
> wwwbin /etc/chilli/wwwsh
> locationname "My HotSpot"
> radiuslocationname My_HotSpot
> radiuslocationid isocc=,cc=,ac=,network=Coova,
> radiusserver1   172.16.194.221
> radiusserver2   172.16.194.221
> radiussecret    testing123
> radiusauthport  1812
> radiusacctport  1813
> uamserver       http://10.1.0.1/uam/
> radiusnasid     cfff1fb7c7ad3f19a8fc
>
> papalwaysok
> macauth
>
> Anyone has suggestions?
>
> thanks
>
> Venkatesh. K
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From kaevee at gmail.com  Wed May 14 20:41:50 2008
From: kaevee at gmail.com (Venkatesh K)
Date: Thu, 15 May 2008 02:11:50 +0530
Subject: SVN Revision 171 issue
In-Reply-To: <D0D40F21-C2BB-45FE-A0BC-BCC6696D95C2@mac.com>
References: <e187fc980805140622td7fdd3ve4f595c53f020630@mail.gmail.com>
	 <D0D40F21-C2BB-45FE-A0BC-BCC6696D95C2@mac.com>
Message-ID: <e187fc980805141341t7ef9383p3a30010800c5144b@mail.gmail.com>

On Thu, May 15, 2008 at 1:09 AM,  <wlan at mac.com> wrote:
> Nothing comes to mind... What do you mean by 'stops working'?

When I run normally,  everything stops working. I cannot get the
chilli to redirect the clients to uampage. Also clients with mac auth
stop working.

If I switch to debug mode (I modified functions to add "debug"
to main.conf), things start working. Again, it works fine in
foreground cum debug mode.

I did not check on upstream router for incoming/outgoing traffic.
I will check some time tomorrow

>
> On May 14, 2008, at 3:22 PM, Venkatesh K wrote:
>
>> Hi,
>>
>> I am trying svn revision 171.  It seems to work fine, but only in debug
>> mode.
>> If I switch off debug, it stops working.
>>
>> Here is the main.conf
>>
>> # THIS FILE IS AUTOMATICALLY GENERATED
>> cmdsocket       /var/run/chilli.sock
>> pidfile         /var/run/chilli.pid
>> net             10.1.0.0/255.255.255.0
>> uamlisten       10.1.0.1
>> uamport         3990
>> dhcpif          eth1
>> adminuser       chillispot
>> adminpasswd     chillispot
>> uamallowed      coova.org,10.1.0.1,172.16.194.221,coova.org
>> uamanydns
>>
>> uamanyip
>> debug
>> statip 10.1.0.0/255.255.255.0
>> domain lan
>> dns1 208.67.220.220
>> dns2 208.67.222.222
>> uamhomepage http://10.1.0.1:3990/www/coova.html
>> wisprlogin https://coova.org/app/uam/auth
>> wwwdir /etc/chilli/www
>> wwwbin /etc/chilli/wwwsh
>> locationname "My HotSpot"
>> radiuslocationname My_HotSpot
>> radiuslocationid isocc=,cc=,ac=,network=Coova,
>> radiusserver1   172.16.194.221
>> radiusserver2   172.16.194.221
>> radiussecret    testing123
>> radiusauthport  1812
>> radiusacctport  1813
>> uamserver       http://10.1.0.1/uam/
>> radiusnasid     cfff1fb7c7ad3f19a8fc
>>
>> papalwaysok
>> macauth
>>
>> Anyone has suggestions?
>>
>> thanks
>>
>> Venkatesh. K
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>

-- 
Venkatesh. K


From murray at skyrove.com  Thu May 15 07:54:10 2008
From: murray at skyrove.com (Murray Long)
Date: Thu, 15 May 2008 09:54:10 +0200
Subject: PPP(oe) WAN connection not established when using Wireless-Only hotspot
Message-ID: <56acee400805150054h12867e04p8b0a644a6071b2ce@mail.gmail.com>

I've run into a problem when using PPP (or PPPoe ) internet connection, with
the wireless only hotspot option. On startup, the router gets into an
endless cycle or connecting and reconnecting.

Here's why it happens:
The "/etc/init.d/S90chillli start" script is run to start coova-chilli
the wireless_split function then restarts all network interfaces which
starts the ppp dialup
Coova-chilli is then started but fails to initialize because it can't
determine the ip address of the radius server (because the ppp is slow and
the connection is not yet established)
5 seconds later (still not enough time for ppp to establish a connection)
"S90chilli checkrunning" is called which detects chilli is not running and
restarts the whole process.

Has anyone experienced this before?
Should I be filling a bug report or something? How is this done in the coova
project?

-Murray
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080515/984d2df8/attachment.htm>

From javi.larrea at gmail.com  Thu May 15 12:00:37 2008
From: javi.larrea at gmail.com (=?ISO-8859-1?Q?Javier_Larrea_Arma=F1anzas?=)
Date: Thu, 15 May 2008 14:00:37 +0200
Subject: Several chilli process in the same computer
Message-ID: <482C25E5.2060309@gmail.com>

Hi list,
is it possible to run several chilli process in the same computer?.  I'd 
like to do that so that I could set up different captive portals for 
several interfaces in differents vlans.  But I get this error debugging 
when I start the second process, although I use another uam port, uam 
listen ip, pid file, sock file and ip range for this process.

redir.c: 932: 0 (Debug) UAM port already in use. Waiting for retry.

Thanks,

Javier


From oguzhank at bilkent.edu.tr  Thu May 15 12:04:08 2008
From: oguzhank at bilkent.edu.tr (Oguzhan Kayhan)
Date: Thu, 15 May 2008 15:04:08 +0300 (EEST)
Subject: Several chilli process in the same computer
In-Reply-To: <482C25E5.2060309@gmail.com>
References: <482C25E5.2060309@gmail.com>
Message-ID: <33877.139.179.14.250.1210853048.squirrel@webmail.bilkent.edu.tr>

Hello,
If you create different config files for chilli processes and set them to
work on different interfaces, it should work without a problem..which for
ex we use over 3-4 different interfaces with different chilli processes.

> Hi list,
> is it possible to run several chilli process in the same computer?.  I'd
> like to do that so that I could set up different captive portals for
> several interfaces in differents vlans.  But I get this error debugging
> when I start the second process, although I use another uam port, uam
> listen ip, pid file, sock file and ip range for this process.
>
> redir.c: 932: 0 (Debug) UAM port already in use. Waiting for retry.
>
> Thanks,
>
> Javier
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>




From javi.larrea at gmail.com  Thu May 15 12:36:00 2008
From: javi.larrea at gmail.com (=?UTF-8?B?SmF2aWVyIExhcnJlYSBBcm1hw7Fhbnphcw==?=)
Date: Thu, 15 May 2008 14:36:00 +0200
Subject: Several chilli process in the same computer
In-Reply-To: <33877.139.179.14.250.1210853048.squirrel@webmail.bilkent.edu.tr>
References: <482C25E5.2060309@gmail.com> <33877.139.179.14.250.1210853048.squirrel@webmail.bilkent.edu.tr>
Message-ID: <482C2E30.6030609@gmail.com>

I've created different config files but It doesn't work.  I use vlan 
interfaces, eth1.1, eth1.2 and eth1.3.  Do you use different physical 
interfaces?  And I've got only one WAN interface, eth0.

Thanks.

Oguzhan Kayhan escribi?:
> Hello,
> If you create different config files for chilli processes and set them to
> work on different interfaces, it should work without a problem..which for
> ex we use over 3-4 different interfaces with different chilli processes.
>
>   
>> Hi list,
>> is it possible to run several chilli process in the same computer?.  I'd
>> like to do that so that I could set up different captive portals for
>> several interfaces in differents vlans.  But I get this error debugging
>> when I start the second process, although I use another uam port, uam
>> listen ip, pid file, sock file and ip range for this process.
>>
>> redir.c: 932: 0 (Debug) UAM port already in use. Waiting for retry.
>>
>> Thanks,
>>
>> Javier
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>>
>>     
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>
>   



From oguzhank at bilkent.edu.tr  Thu May 15 13:58:37 2008
From: oguzhank at bilkent.edu.tr (Oguzhan Kayhan)
Date: Thu, 15 May 2008 16:58:37 +0300 (EEST)
Subject: Several chilli process in the same computer
In-Reply-To: <482C2E30.6030609@gmail.com>
References: <482C25E5.2060309@gmail.com>
    <33877.139.179.14.250.1210853048.squirrel@webmail.bilkent.edu.tr>
    <482C2E30.6030609@gmail.com>
Message-ID: <38942.139.179.14.250.1210859917.squirrel@webmail.bilkent.edu.tr>

> I've created different config files but It doesn't work.  I use vlan
> interfaces, eth1.1, eth1.2 and eth1.3.  Do you use different physical
> interfaces?  And I've got only one WAN interface, eth0.
>
> Thanks.
>

Actually, i am using both vlan interfaces and physical interfaces in my
network.


here's my ps-ef result for chilli.
be careful about selecting different pid files for chilli processes.
That might be your problem.


root     26032     1 16 May13 ?        08:00:31 /usr/sbin/chilli
--conf=/etc/chilli.d/chilli-dogu.conf --pidfile=/var/run/chilli-dogu.pid
root     26042     1  1 May13 ?        00:31:12 /usr/sbin/chilli
--conf=/etc/chilli.d/chilli-dogu-wireless.conf
--pidfile=/var/run/chilli-dogu-wireless.pid


We also made a modification in distrto package as we are keeping  config
files under /etc/chilli.d/ folder
and all cofig files added to this folder runs a different chilli process.


Im also adding our init.d script for chilli in here for your test purposes.

-------------------------------------------------------------------------

PATH=/sbin:/bin:/usr/sbin:/usr/bin
DAEMON=/usr/sbin/chilli
NAME=chilli
DESC=chilli

test -f $DAEMON || exit 0

set -e

case "$1" in
  start)
        echo -n "Starting $DESC: "
        if [ -d /etc/chilli.d ]; then
                for cnf in /etc/chilli.d/*.conf
                do
                        pfile=`basename $cnf .conf`
                        start-stop-daemon --start --quiet \
                                --pidfile /var/run/$pfile.pid \
                                --exec $DAEMON -- --conf=$cnf
--pidfile=/var/run/$pfile.pid
                        echo -n $pfile ", "
                done
        else
                start-stop-daemon --oknodo --stop --quiet --pidfile
/var/run/$NAME.pid \
                        --exec $DAEMON
        fi
        echo "$NAME."
        ;;
stop)
        echo -n "Stopping $DESC: "
        if [ -d /etc/chilli.d ]; then
                for cnf in /etc/chilli.d/*.conf
                do
                        pfile=`basename $cnf .conf`
                        start-stop-daemon --oknodo --stop --quiet \
                                --pidfile /var/run/$pfile.pid \
                                --exec $DAEMON -- --conf=$cnf
                        echo -n $pfile ", "
                done
        else
                start-stop-daemon --oknodo --stop --quiet --pidfile
/var/run/$NAME.pid \
                --exec $DAEMON
        fi
        echo "$NAME."
        ;;
  #reload)
#reload)
        #
        #       If the daemon can reload its config files on the fly
        #       for example by sending it SIGHUP, do it here.
        #
        #       If the daemon responds to changes in its config file
        #       directly anyway, make this a do-nothing entry.
        #
        # echo "Reloading $DESC configuration files."
        # start-stop-daemon --stop --signal 1 --quiet --pidfile \
        #       /var/run/$NAME.pid --exec $DAEMON
  #;;
  restart|force-reload)
        #
        #       If the "reload" option is implemented, move the
"force-reload"
        #       option to the "reload" entry above. If not, "force-reload" is
        #       just the same as "restart".
        #
        echo -n "Restarting $DESC: "
        start-stop-daemon --stop --quiet --pidfile \
                /var/run/$NAME.pid --exec $DAEMON
        sleep 1
        start-stop-daemon --start --quiet --pidfile \
           /var/run/$NAME.pid --exec $DAEMON
        echo "$NAME."
        ;;
  *)
        N=/etc/init.d/$NAME
        # echo "Usage: $N {start|stop|restart|reload|force-reload}" >&2
        echo "Usage: $N {start|stop|restart|force-reload}" >&2
        exit 1
        ;;
esac

exit 0

---------------------------------------------------------------------------------------

> Oguzhan Kayhan escribi?:
>> Hello,
>> If you create different config files for chilli processes and set them
>> to
>> work on different interfaces, it should work without a problem..which
>> for
>> ex we use over 3-4 different interfaces with different chilli processes.
>>
>>
>>> Hi list,
>>> is it possible to run several chilli process in the same computer?.
>>> I'd
>>> like to do that so that I could set up different captive portals for
>>> several interfaces in differents vlans.  But I get this error debugging
>>> when I start the second process, although I use another uam port, uam
>>> listen ip, pid file, sock file and ip range for this process.
>>>
>>> redir.c: 932: 0 (Debug) UAM port already in use. Waiting for retry.
>>>
>>> Thanks,
>>>
>>> Javier
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>> For additional commands, e-mail: chilli-help at coova.org
>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>
>>>
>>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>




From krnak.janos at wiera.hu  Thu May 15 14:08:38 2008
From: krnak.janos at wiera.hu (=?UTF-8?B?S3Juw6FrIErDoW5vcw==?=)
Date: Thu, 15 May 2008 16:08:38 +0200
Subject: Several chilli process in the same computer
In-Reply-To: <38942.139.179.14.250.1210859917.squirrel@webmail.bilkent.edu.tr>
References: <482C25E5.2060309@gmail.com>    <33877.139.179.14.250.1210853048.squirrel@webmail.bilkent.edu.tr>    <482C2E30.6030609@gmail.com> <38942.139.179.14.250.1210859917.squirrel@webmail.bilkent.edu.tr>
Message-ID: <482C43E6.2090208@wiera.hu>

An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080515/1de19017/attachment.htm>

From wlan at mac.com  Thu May 15 15:11:51 2008
From: wlan at mac.com (wlan at mac.com)
Date: Thu, 15 May 2008 17:11:51 +0200
Subject: Several chilli process in the same computer
In-Reply-To: <482C2E30.6030609@gmail.com>
References: <482C25E5.2060309@gmail.com> <33877.139.179.14.250.1210853048.squirrel@webmail.bilkent.edu.tr> <482C2E30.6030609@gmail.com>
Message-ID: <D7E30351-EBA4-451E-9E17-404D36CEF506@mac.com>

What chilli really should do is simply support VLAN/802.1q headers  
and to make some decisions accordingly. But, I haven't gotten around  
to it. Would make for a great contribution if anyone is interested in  
taking it on!

On May 15, 2008, at 2:36 PM, Javier Larrea Arma?anzas wrote:

> I've created different config files but It doesn't work.  I use  
> vlan interfaces, eth1.1, eth1.2 and eth1.3.  Do you use different  
> physical interfaces?  And I've got only one WAN interface, eth0.
>
> Thanks.
>
> Oguzhan Kayhan escribi?:
>> Hello,
>> If you create different config files for chilli processes and set  
>> them to
>> work on different interfaces, it should work without a  
>> problem..which for
>> ex we use over 3-4 different interfaces with different chilli  
>> processes.
>>
>>
>>> Hi list,
>>> is it possible to run several chilli process in the same  
>>> computer?.  I'd
>>> like to do that so that I could set up different captive portals for
>>> several interfaces in differents vlans.  But I get this error  
>>> debugging
>>> when I start the second process, although I use another uam port,  
>>> uam
>>> listen ip, pid file, sock file and ip range for this process.
>>>
>>> redir.c: 932: 0 (Debug) UAM port already in use. Waiting for retry.
>>>
>>> Thanks,
>>>
>>> Javier
>>>
>>> -------------------------------------------------------------------- 
>>> -
>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>> For additional commands, e-mail: chilli-help at coova.org
>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>
>>>
>>>
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>>
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From m.simioni at gmail.com  Thu May 15 15:20:49 2008
From: m.simioni at gmail.com (Marco Simioni)
Date: Thu, 15 May 2008 17:20:49 +0200
Subject: Several chilli process in the same computer
In-Reply-To: <D7E30351-EBA4-451E-9E17-404D36CEF506@mac.com>
References: <482C25E5.2060309@gmail.com>
	 <33877.139.179.14.250.1210853048.squirrel@webmail.bilkent.edu.tr>
	 <482C2E30.6030609@gmail.com>
	 <D7E30351-EBA4-451E-9E17-404D36CEF506@mac.com>
Message-ID: <f71cb680805150820o6f127c93k1d3c8adb766131ba@mail.gmail.com>

Hi.

I think that chilli should not handle 802.1q tags: they are handled by
linux kernel, chilli just sees different interfaces (for example
"eth0.2" for VLAN 2 on interface eth0).

Am i wrong ?

You could have WAN ("eth0.1") and LAN ("eth0.2") interface on just the
same physical interface "eth0" using VLANS. Just configure them with
eth0.1 and eth0.2 in your chilli config file.

Regards,

aNt1X

2008/5/15  <wlan at mac.com>:
> What chilli really should do is simply support VLAN/802.1q headers and to
> make some decisions accordingly. But, I haven't gotten around to it. Would
> make for a great contribution if anyone is interested in taking it on!
>
> On May 15, 2008, at 2:36 PM, Javier Larrea Arma?anzas wrote:
>
>> I've created different config files but It doesn't work.  I use vlan
>> interfaces, eth1.1, eth1.2 and eth1.3.  Do you use different physical
>> interfaces?  And I've got only one WAN interface, eth0.
>>
>> Thanks.
>>
>> Oguzhan Kayhan escribi?:
>>>
>>> Hello,
>>> If you create different config files for chilli processes and set them to
>>> work on different interfaces, it should work without a problem..which for
>>> ex we use over 3-4 different interfaces with different chilli processes.
>>>
>>>
>>>> Hi list,
>>>> is it possible to run several chilli process in the same computer?.  I'd
>>>> like to do that so that I could set up different captive portals for
>>>> several interfaces in differents vlans.  But I get this error debugging
>>>> when I start the second process, although I use another uam port, uam
>>>> listen ip, pid file, sock file and ip range for this process.
>>>>
>>>> redir.c: 932: 0 (Debug) UAM port already in use. Waiting for retry.
>>>>
>>>> Thanks,
>>>>
>>>> Javier
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>>> For additional commands, e-mail: chilli-help at coova.org
>>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>>
>>>>
>>>>
>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>> For additional commands, e-mail: chilli-help at coova.org
>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>
>>>
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>


From graham-ml at apolix.co.za  Thu May 15 15:37:54 2008
From: graham-ml at apolix.co.za (Graham Beneke)
Date: Thu, 15 May 2008 17:37:54 +0200
Subject: PPP(oe) WAN connection not established when using Wireless-Only
 hotspot
In-Reply-To: <56acee400805150054h12867e04p8b0a644a6071b2ce@mail.gmail.com>
References: <56acee400805150054h12867e04p8b0a644a6071b2ce@mail.gmail.com>
Message-ID: <482C58D2.8050109@apolix.co.za>

Murray Long wrote:
> I've run into a problem when using PPP (or PPPoe ) internet connection, 
> with the wireless only hotspot option. On startup, the router gets into 
> an endless cycle or connecting and reconnecting.
> 
> Here's why it happens:
> The "/etc/init.d/S90chillli start" script is run to start coova-chilli
> the wireless_split function then restarts all network interfaces which 
> starts the ppp dialup
> Coova-chilli is then started but fails to initialize because it can't 
> determine the ip address of the radius server (because the ppp is slow 
> and the connection is not yet established)
> 5 seconds later (still not enough time for ppp to establish a 
> connection) "S90chilli checkrunning" is called which detects chilli is 
> not running and restarts the whole process.

I have been experiencing problems with run away bandwidth usage on a 
provider you probably know (iBurst). I have not yet traced the exact 
source of the problem but it would seem to be some sort of nasty loop 
that Coova gets into trying to validate its servers that result in 
extremely high bandwidth usage and an AP that becomes non-functional 
until it has been rebooted.

It probably stems from the same aggressive validation that seems to fail 
on sub-standard broadband connections.

-- 
Graham Beneke
Apolix Internet Services
E-Mail/MSN/Jabber: graham at apolix.co.za   Skype: grbeneke
VoIP: 087-750-5696                       Cell: 082-432-1873
http://www.apolix.co.za/


From kaevee at gmail.com  Thu May 15 15:45:07 2008
From: kaevee at gmail.com (Venkatesh K)
Date: Thu, 15 May 2008 21:15:07 +0530
Subject: Several chilli process in the same computer
In-Reply-To: <f71cb680805150820o6f127c93k1d3c8adb766131ba@mail.gmail.com>
References: <482C25E5.2060309@gmail.com>
	 <33877.139.179.14.250.1210853048.squirrel@webmail.bilkent.edu.tr>
	 <482C2E30.6030609@gmail.com>
	 <D7E30351-EBA4-451E-9E17-404D36CEF506@mac.com>
	 <f71cb680805150820o6f127c93k1d3c8adb766131ba@mail.gmail.com>
Message-ID: <e187fc980805150845l4f49592cw5c5f234b6d0d74cd@mail.gmail.com>

On Thu, May 15, 2008 at 8:50 PM, Marco Simioni <m.simioni at gmail.com> wrote:
> Hi.
>
> I think that chilli should not handle 802.1q tags: they are handled by
> linux kernel, chilli just sees different interfaces (for example
> "eth0.2" for VLAN 2 on interface eth0).
>
> Am i wrong ?

No. You are right.

>
> You could have WAN ("eth0.1") and LAN ("eth0.2") interface on just the
> same physical interface "eth0" using VLANS. Just configure them with
> eth0.1 and eth0.2 in your chilli config file.
>

Almost all consumer wireless routers like Linksys WRT's have only one
vlan enabled switch.

Thanks,

Venkatesh K

> Regards
> aNt1X
>
> 2008/5/15  <wlan at mac.com>:
>> What chilli really should do is simply support VLAN/802.1q headers and to
>> make some decisions accordingly. But, I haven't gotten around to it. Would
>> make for a great contribution if anyone is interested in taking it on!
>>
>> On May 15, 2008, at 2:36 PM, Javier Larrea Arma?anzas wrote:
>>
>>> I've created different config files but It doesn't work.  I use vlan
>>> interfaces, eth1.1, eth1.2 and eth1.3.  Do you use different physical
>>> interfaces?  And I've got only one WAN interface, eth0.
>>>
>>> Thanks.
>>>
>>> Oguzhan Kayhan escribi?:
>>>>
>>>> Hello,
>>>> If you create different config files for chilli processes and set them to
>>>> work on different interfaces, it should work without a problem..which for
>>>> ex we use over 3-4 different interfaces with different chilli processes.
>>>>
>>>>
>>>>> Hi list,
>>>>> is it possible to run several chilli process in the same computer?.  I'd
>>>>> like to do that so that I could set up different captive portals for
>>>>> several interfaces in differents vlans.  But I get this error debugging
>>>>> when I start the second process, although I use another uam port, uam
>>>>> listen ip, pid file, sock file and ip range for this process.
>>>>>
>>>>> redir.c: 932: 0 (Debug) UAM port already in use. Waiting for retry.
>>>>>
>>>>> Thanks,
>>>>>
>>>>> Javier
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>>>> For additional commands, e-mail: chilli-help at coova.org
>>>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>>>
>>>>>
>>>>>
>>>>
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>>> For additional commands, e-mail: chilli-help at coova.org
>>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>>
>>>>
>>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>> For additional commands, e-mail: chilli-help at coova.org
>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>



-- 
Venkatesh. K


From wlan at mac.com  Thu May 15 17:31:23 2008
From: wlan at mac.com (wlan at mac.com)
Date: Thu, 15 May 2008 19:31:23 +0200
Subject: PPP(oe) WAN connection not established when using Wireless-Only hotspot
In-Reply-To: <482C58D2.8050109@apolix.co.za>
References: <56acee400805150054h12867e04p8b0a644a6071b2ce@mail.gmail.com> <482C58D2.8050109@apolix.co.za>
Message-ID: <02E2F3C1-4198-409D-89E1-16DCEC92D77C@mac.com>

These are perhaps more issues with CoovaAP - particularly so with the  
wireless-only, since the script, as noted, will reset the network  
(after changing some settings to break the pre-existing bridge).  
Agreed that the checking of chilli being up should be a bit smarter.

On May 15, 2008, at 5:37 PM, Graham Beneke wrote:

> Murray Long wrote:
>> I've run into a problem when using PPP (or PPPoe ) internet  
>> connection, with the wireless only hotspot option. On startup, the  
>> router gets into an endless cycle or connecting and reconnecting.
>> Here's why it happens:
>> The "/etc/init.d/S90chillli start" script is run to start coova- 
>> chilli
>> the wireless_split function then restarts all network interfaces  
>> which starts the ppp dialup
>> Coova-chilli is then started but fails to initialize because it  
>> can't determine the ip address of the radius server (because the  
>> ppp is slow and the connection is not yet established)
>> 5 seconds later (still not enough time for ppp to establish a  
>> connection) "S90chilli checkrunning" is called which detects  
>> chilli is not running and restarts the whole process.
>
> I have been experiencing problems with run away bandwidth usage on  
> a provider you probably know (iBurst). I have not yet traced the  
> exact source of the problem but it would seem to be some sort of  
> nasty loop that Coova gets into trying to validate its servers that  
> result in extremely high bandwidth usage and an AP that becomes non- 
> functional until it has been rebooted.
>
> It probably stems from the same aggressive validation that seems to  
> fail on sub-standard broadband connections.
>
> -- 
> Graham Beneke
> Apolix Internet Services
> E-Mail/MSN/Jabber: graham at apolix.co.za   Skype: grbeneke
> VoIP: 087-750-5696                       Cell: 082-432-1873
> http://www.apolix.co.za/
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From wlan at mac.com  Thu May 15 17:31:40 2008
From: wlan at mac.com (wlan at mac.com)
Date: Thu, 15 May 2008 19:31:40 +0200
Subject: Several chilli process in the same computer
In-Reply-To: <482C43E6.2090208@wiera.hu>
References: <482C25E5.2060309@gmail.com> <33877.139.179.14.250.1210853048.squirrel@webmail.bilkent.edu.tr> <482C2E30.6030609@gmail.com> <38942.139.179.14.250.1210859917.squirrel@webmail.bilkent.edu.tr> <482C43E6.2090208@wiera.hu>
Message-ID: <D9BEBFB7-22DB-4303-9568-C86431415FE0@mac.com>

Chilli originally only had the uamport, and still does. uamuiport was  
added to allow a bit more ability (like POST processing) for the  
embedded http server. While uamport binds to the uamlisten, currently  
uamuiport does not - it binds to '*' and thus must be different (or  
not used) with multiple instances. Perhaps it should just bind to  
uamlisten...

David


On May 15, 2008, at 4:08 PM, Krn?k J?nos wrote:

> hi
>
> there is also another option called uamuiport i think this is what  
> is used by the other chilli, change this as well
>
> bye
>
> Oguzhan Kayhan escribi?:
>>
>>> I've created different config files but It doesn't work.  I use vlan
>>> interfaces, eth1.1, eth1.2 and eth1.3.  Do you use different  
>>> physical
>>> interfaces?  And I've got only one WAN interface, eth0.
>>>
>>> Thanks.
>>>
>>>
>> Actually, i am using both vlan interfaces and physical interfaces  
>> in my
>> network.
>>
>>
>> here's my ps-ef result for chilli.
>> be careful about selecting different pid files for chilli processes.
>> That might be your problem.
>>
>>
>> root     26032     1 16 May13 ?        08:00:31 /usr/sbin/chilli
>> --conf=/etc/chilli.d/chilli-dogu.conf --pidfile=/var/run/chilli- 
>> dogu.pid
>> root     26042     1  1 May13 ?        00:31:12 /usr/sbin/chilli
>> --conf=/etc/chilli.d/chilli-dogu-wireless.conf
>> --pidfile=/var/run/chilli-dogu-wireless.pid
>>
>>
>> We also made a modification in distrto package as we are keeping   
>> config
>> files under /etc/chilli.d/ folder
>> and all cofig files added to this folder runs a different chilli  
>> process.
>>
>>
>> Im also adding our init.d script for chilli in here for your test  
>> purposes.
>>
>> --------------------------------------------------------------------- 
>> ----
>>
>> PATH=/sbin:/bin:/usr/sbin:/usr/bin
>> DAEMON=/usr/sbin/chilli
>> NAME=chilli
>> DESC=chilli
>>
>> test -f $DAEMON || exit 0
>>
>> set -e
>>
>> case "$1" in
>>   start)
>>         echo -n "Starting $DESC: "
>>         if [ -d /etc/chilli.d ]; then
>>                 for cnf in /etc/chilli.d/*.conf
>>                 do
>>                         pfile=`basename $cnf .conf`
>>                         start-stop-daemon --start --quiet \
>>                                 --pidfile /var/run/$pfile.pid \
>>                                 --exec $DAEMON -- --conf=$cnf
>> --pidfile=/var/run/$pfile.pid
>>                         echo -n $pfile ", "
>>                 done
>>         else
>>                 start-stop-daemon --oknodo --stop --quiet --pidfile
>> /var/run/$NAME.pid \
>>                         --exec $DAEMON
>>         fi
>>         echo "$NAME."
>>         ;;
>> stop)
>>         echo -n "Stopping $DESC: "
>>         if [ -d /etc/chilli.d ]; then
>>                 for cnf in /etc/chilli.d/*.conf
>>                 do
>>                         pfile=`basename $cnf .conf`
>>                         start-stop-daemon --oknodo --stop --quiet \
>>                                 --pidfile /var/run/$pfile.pid \
>>                                 --exec $DAEMON -- --conf=$cnf
>>                         echo -n $pfile ", "
>>                 done
>>         else
>>                 start-stop-daemon --oknodo --stop --quiet --pidfile
>> /var/run/$NAME.pid \
>>                 --exec $DAEMON
>>         fi
>>         echo "$NAME."
>>         ;;
>>   #reload)
>> #reload)
>>         #
>>         #       If the daemon can reload its config files on the fly
>>         #       for example by sending it SIGHUP, do it here.
>>         #
>>         #       If the daemon responds to changes in its config file
>>         #       directly anyway, make this a do-nothing entry.
>>         #
>>         # echo "Reloading $DESC configuration files."
>>         # start-stop-daemon --stop --signal 1 --quiet --pidfile \
>>         #       /var/run/$NAME.pid --exec $DAEMON
>>   #;;
>>   restart|force-reload)
>>         #
>>         #       If the "reload" option is implemented, move the
>> "force-reload"
>>         #       option to the "reload" entry above. If not, "force- 
>> reload" is
>>         #       just the same as "restart".
>>         #
>>         echo -n "Restarting $DESC: "
>>         start-stop-daemon --stop --quiet --pidfile \
>>                 /var/run/$NAME.pid --exec $DAEMON
>>         sleep 1
>>         start-stop-daemon --start --quiet --pidfile \
>>            /var/run/$NAME.pid --exec $DAEMON
>>         echo "$NAME."
>>         ;;
>>   *)
>>         N=/etc/init.d/$NAME
>>         # echo "Usage: $N {start|stop|restart|reload|force- 
>> reload}" >&2
>>         echo "Usage: $N {start|stop|restart|force-reload}" >&2
>>         exit 1
>>         ;;
>> esac
>>
>> exit 0
>>
>> --------------------------------------------------------------------- 
>> ------------------
>>
>>
>>> Oguzhan Kayhan escribi?:
>>>
>>>> Hello,
>>>> If you create different config files for chilli processes and  
>>>> set them
>>>> to
>>>> work on different interfaces, it should work without a  
>>>> problem..which
>>>> for
>>>> ex we use over 3-4 different interfaces with different chilli  
>>>> processes.
>>>>
>>>>
>>>>
>>>>> Hi list,
>>>>> is it possible to run several chilli process in the same  
>>>>> computer?.
>>>>> I'd
>>>>> like to do that so that I could set up different captive  
>>>>> portals for
>>>>> several interfaces in differents vlans.  But I get this error  
>>>>> debugging
>>>>> when I start the second process, although I use another uam  
>>>>> port, uam
>>>>> listen ip, pid file, sock file and ip range for this process.
>>>>>
>>>>> redir.c: 932: 0 (Debug) UAM port already in use. Waiting for  
>>>>> retry.
>>>>>
>>>>> Thanks,
>>>>>
>>>>> Javier
>>>>>
>>>>> ------------------------------------------------------------------ 
>>>>> ---
>>>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>>>> For additional commands, e-mail: chilli-help at coova.org
>>>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>>>
>>>>>
>>>>>
>>>>>
>>>> ------------------------------------------------------------------- 
>>>> --
>>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>>> For additional commands, e-mail: chilli-help at coova.org
>>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>>
>>>>
>>>>
>>>>
>>> -------------------------------------------------------------------- 
>>> -
>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>> For additional commands, e-mail: chilli-help at coova.org
>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>
>>>
>>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>>
>>
>
> -- 
> This message has been scanned for viruses and
> dangerous content by MailScanner, and is
> believed to be clean.  
> ---------------------------------------------------------------------  
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org For additional  
> commands, e-mail: chilli-help at coova.org Wiki: http://coova.org/wiki/ 
> index.php/CoovaChilli Forum: http://coova.org/phpBB3/viewforum.php?f=4

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080515/f896501d/attachment.htm>

From gunther.mayer at googlemail.com  Thu May 15 20:34:18 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Thu, 15 May 2008 22:34:18 +0200
Subject: Several chilli process in the same computer
In-Reply-To: <482C25E5.2060309@gmail.com>
References: <482C25E5.2060309@gmail.com>
Message-ID: <482C9E4A.1090008@gmail.com>

Javier Larrea Arma?anzas wrote:
> Hi list,
> is it possible to run several chilli process in the same computer?.  
> I'd like to do that so that I could set up different captive portals 
> for several interfaces in differents vlans.  But I get this error 
> debugging when I start the second process, although I use another uam 
> port, uam listen ip, pid file, sock file and ip range for this process.
>
> redir.c: 932: 0 (Debug) UAM port already in use. Waiting for retry.
There are a whole bunch of other ports that chilli opens. uamuiport 
comes to mind, there might be others. Just run a "netstat -lu" when 
running just one chilli process and you'll see which ones it opens. All 
those you must of course explicitly state to be different for all other 
processes.

Gunther


From ml at t-b-o-h.net  Fri May 16 00:25:08 2008
From: ml at t-b-o-h.net (Tuc at T-B-O-H.NET)
Date: Thu, 15 May 2008 20:25:08 -0400 (EDT)
Subject: Sense of self awareness? :)
Message-ID: <200805160025.m4G0P8lr096796@himinbjorg.tucs-beachin-obx-house.com>

Hi,

	More Chilli questions, but original, not Coova. I again look to a 
solid install base. (And anyone that might help the author of DD-WRT to get
Coova running under it)

	It appears, probably due to the network, that radius accounting
records aren't always making it back to the radius server. Since I can't
get the person to fix the network, I need to try to find a way to
compensate for it.

	In radius they want to set Simultaneous-User to 1. However, 
checking radwho -C:

lobnic14   00-13-02-25-8C-   shell S1   Thu 17:3  192.168.7 192.168.182.3
lobnic14   00-1B-77-11-F4-   shell S2   Thu 18:2  192.168.7 192.168.182.4
lobnic14   00-1B-77-11-F4-   shell S3   Wed 18:1  192.168.7 192.168.182.14

	(Yea, one user appears to be on twice, and then there is a 2nd login).

	If he was to set it to 1 right now, there would be support calls, and
he HATES to support people....

	SO, what I was wondering, is if in some sense Chilli is "self aware".
Can I ask it, poke it, prod it, etc to see who is actively connected at the
time? I'd use the checkrad radius program to update the files once and a bit.

	Thanks, Tuc



From gunther.mayer at googlemail.com  Fri May 16 00:41:24 2008
From: gunther.mayer at googlemail.com (Gunther Mayer)
Date: Fri, 16 May 2008 02:41:24 +0200
Subject: Sense of self awareness? :)
In-Reply-To: <200805160025.m4G0P8lr096796@himinbjorg.tucs-beachin-obx-house.com>
References: <200805160025.m4G0P8lr096796@himinbjorg.tucs-beachin-obx-house.com>
Message-ID: <482CD834.6090106@gmail.com>

Tuc at T-B-O-H.NET wrote:
> Hi,
>
> 	More Chilli questions, but original, not Coova. I again look to a 
> solid install base. (And anyone that might help the author of DD-WRT to get
> Coova running under it)
>   
You're in the wrong place if you want support for stock chillispot. I 
don't think anyone still supports it though it seems many still use it.
> 	SO, what I was wondering, is if in some sense Chilli is "self aware".
> Can I ask it, poke it, prod it, etc to see who is actively connected at the
> time? I'd use the checkrad radius program to update the files once and a bit.
>   
The old chilli couldn't do what you want, but coova certainly can: it 
has chilli_query, check out its documentation on the coova wiki 
(http://coova.org/wiki/index.php/CoovaChilli/chilli_query%281%29).

Gunther


From cfinnegan at csc.com.au  Fri May 16 00:44:49 2008
From: cfinnegan at csc.com.au (Ciaran Finnegan)
Date: Fri, 16 May 2008 11:44:49 +1100
Subject: Sense of self awareness? :)
Message-ID: <OFCA25744B.00041A7D-ONCA25744B.00041A7D-CA25744B.00041A7D@csc.com>

Return Receipt
                                                                           
   Your       Sense of self awareness? :)                                  
   document:                                                               
                                                                           
   was        Ciaran Finnegan/GIS/CSC                                      
   received                                                                
   by:                                                                     
                                                                           
   at:        05/16/2008 11:44:49 AM ZE10                                  
                                                                           






From ml at t-b-o-h.net  Fri May 16 02:31:21 2008
From: ml at t-b-o-h.net (Tuc at T-B-O-H.NET)
Date: Thu, 15 May 2008 22:31:21 -0400 (EDT)
Subject: [chilli] Re: Sense of self awareness? :)
In-Reply-To: <482CD834.6090106@gmail.com>
Message-ID: <200805160231.m4G2VLme098381@himinbjorg.tucs-beachin-obx-house.com>

> 
> Tuc at T-B-O-H.NET wrote:
> > Hi,
> >
> > 	More Chilli questions, but original, not Coova. I again look to a 
> > solid install base. (And anyone that might help the author of DD-WRT to get
> > Coova running under it)
>   
> You're in the wrong place if you want support for stock chillispot. I 
> don't think anyone still supports it though it seems many still use it.
>
	I realize this, as I mentioned above. I'm "stuck" currently with
Chillispot due to what the author of DD-WRT says "coova is not big endian 
and arm/xscale safe.". Until he does, we are going to have to use stock
Chilli for many reasons. I'm not at liberty to "roll my own" due to 
the clients request. 

	I realize this is a stock Chillia question, but since Coova is a 
fork of it, there might be a chance of something I've overlooked, and the 
potential for making a request for something to be added to Coova. :)
>
>
> > 	SO, what I was wondering, is if in some sense Chilli is "self aware".
> > Can I ask it, poke it, prod it, etc to see who is actively connected at the
> > time? I'd use the checkrad radius program to update the files once and a bit.
> >   
> The old chilli couldn't do what you want, but coova certainly can: it 
> has chilli_query, check out its documentation on the coova wiki 
> (http://coova.org/wiki/index.php/CoovaChilli/chilli_query%281%29).
> 
	Kewl, exactly what I need. Maybe I can see what it took to accomplish
this can get it patched into the old server for use. Or, I'll find its just
way too much and have to find other means of accomplishing my goals. But now
I have direction. 

	Thank you, Tuc
> Gunther
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
> 



From cfinnegan at csc.com.au  Fri May 16 02:42:38 2008
From: cfinnegan at csc.com.au (Ciaran Finnegan)
Date: Fri, 16 May 2008 13:42:38 +1100
Subject: [chilli] Re: Sense of self awareness? :)
Message-ID: <OFCA25744B.000EE3D3-ONCA25744B.000EE3D3-CA25744B.000EE3D3@csc.com>

Return Receipt
                                                                           
   Your       Re: [chilli] Re: Sense of self awareness? :)                 
   document:                                                               
                                                                           
   was        Ciaran Finnegan/GIS/CSC                                      
   received                                                                
   by:                                                                     
                                                                           
   at:        05/16/2008 01:42:38 PM ZE10                                  
                                                                           






From wlan at mac.com  Thu May 15 16:31:43 2008
From: wlan at mac.com (wlan at mac.com)
Date: Thu, 15 May 2008 18:31:43 +0200
Subject: Several chilli process in the same computer
In-Reply-To: <f71cb680805150820o6f127c93k1d3c8adb766131ba@mail.gmail.com>
References: <482C25E5.2060309@gmail.com>
 <33877.139.179.14.250.1210853048.squirrel@webmail.bilkent.edu.tr>
 <482C2E30.6030609@gmail.com> <D7E30351-EBA4-451E-9E17-404D36CEF506@mac.com>
 <f71cb680805150820o6f127c93k1d3c8adb766131ba@mail.gmail.com>
Message-ID: <FBA8299C-70CB-411C-8238-3E63C617F889@mac.com>

Of course, it depends greatly on the setup... running an instance per- 
vlan is a great way to break up the load and configurations of the  
various networks. But, it could also be nice to have chilli handle  
vlan tags directly and perhaps sending redirects with vlan=#  
parameters. I've always done it the multi-instance way... hence the  
lack of vlan support ;)

On May 15, 2008, at 5:20 PM, Marco Simioni wrote:

> Hi.
>
> I think that chilli should not handle 802.1q tags: they are handled by
> linux kernel, chilli just sees different interfaces (for example
> "eth0.2" for VLAN 2 on interface eth0).
>
> Am i wrong ?
>
> You could have WAN ("eth0.1") and LAN ("eth0.2") interface on just the
> same physical interface "eth0" using VLANS. Just configure them with
> eth0.1 and eth0.2 in your chilli config file.
>
> Regards,
>
> aNt1X
>
> 2008/5/15  <wlan at mac.com>:
>> What chilli really should do is simply support VLAN/802.1q headers  
>> and to
>> make some decisions accordingly. But, I haven't gotten around to  
>> it. Would
>> make for a great contribution if anyone is interested in taking it  
>> on!
>>
>> On May 15, 2008, at 2:36 PM, Javier Larrea Arma?anzas wrote:
>>
>>> I've created different config files but It doesn't work.  I use vlan
>>> interfaces, eth1.1, eth1.2 and eth1.3.  Do you use different  
>>> physical
>>> interfaces?  And I've got only one WAN interface, eth0.
>>>
>>> Thanks.
>>>
>>> Oguzhan Kayhan escribi?:
>>>>
>>>> Hello,
>>>> If you create different config files for chilli processes and  
>>>> set them to
>>>> work on different interfaces, it should work without a  
>>>> problem..which for
>>>> ex we use over 3-4 different interfaces with different chilli  
>>>> processes.
>>>>
>>>>
>>>>> Hi list,
>>>>> is it possible to run several chilli process in the same  
>>>>> computer?.  I'd
>>>>> like to do that so that I could set up different captive  
>>>>> portals for
>>>>> several interfaces in differents vlans.  But I get this error  
>>>>> debugging
>>>>> when I start the second process, although I use another uam  
>>>>> port, uam
>>>>> listen ip, pid file, sock file and ip range for this process.
>>>>>
>>>>> redir.c: 932: 0 (Debug) UAM port already in use. Waiting for  
>>>>> retry.
>>>>>
>>>>> Thanks,
>>>>>
>>>>> Javier
>>>>>
>>>>> ------------------------------------------------------------------ 
>>>>> ---
>>>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>>>> For additional commands, e-mail: chilli-help at coova.org
>>>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>>>
>>>>>
>>>>>
>>>>
>>>>
>>>>
>>>> ------------------------------------------------------------------- 
>>>> --
>>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>>> For additional commands, e-mail: chilli-help at coova.org
>>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>>
>>>>
>>>>
>>>
>>>
>>> -------------------------------------------------------------------- 
>>> -
>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>> For additional commands, e-mail: chilli-help at coova.org
>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From wlan at mac.com  Fri May 16 04:17:27 2008
From: wlan at mac.com (wlan at mac.com)
Date: Fri, 16 May 2008 06:17:27 +0200
Subject: [chilli] Re: Sense of self awareness? :)
In-Reply-To: <200805160231.m4G2VLme098381@himinbjorg.tucs-beachin-obx-house.com>
References: <200805160231.m4G2VLme098381@himinbjorg.tucs-beachin-obx-house.com>
Message-ID: <D4874384-8789-46DD-B46B-3FE58CFB01C6@mac.com>

> 	Kewl, exactly what I need. Maybe I can see what it took to accomplish
> this can get it patched into the old server for use. Or, I'll find  
> its just
> way too much and have to find other means of accomplishing my  
> goals. But now
> I have direction.

I don't think taking patches back to chillispot is that great of an  
idea. CoovaChilli has _many_ fixes and new features that make it  
worth the switch. I wonder that the point is in keeping chillispot  
limping along with band-aids.

David



From ml at t-b-o-h.net  Fri May 16 04:29:08 2008
From: ml at t-b-o-h.net (Tuc at T-B-O-H.NET)
Date: Fri, 16 May 2008 00:29:08 -0400 (EDT)
Subject: [chilli] Re: [chilli] Re: Sense of self awareness? :)
In-Reply-To: <D4874384-8789-46DD-B46B-3FE58CFB01C6@mac.com>
Message-ID: <200805160429.m4G4T89Y006040@himinbjorg.tucs-beachin-obx-house.com>

> 
> > 	Kewl, exactly what I need. Maybe I can see what it took to accomplish
> > this can get it patched into the old server for use. Or, I'll find  
> > its just
> > way too much and have to find other means of accomplishing my  
> > goals. But now
> > I have direction.
> 
> I don't think taking patches back to chillispot is that great of an  
> idea. CoovaChilli has _many_ fixes and new features that make it  
> worth the switch. I wonder that the point is in keeping chillispot  
> limping along with band-aids.
> 
	I agree its not a great idea. Its worse than chicken wire and
bubble gum in my opinion. But bringing Coova over to DD-WRT isn't happening
because as the author has stated "right now coova is not big endian and 
arm/xscale safe". I'm limited in what I can do with presenting something
to the person running the network. If it can't be supported by the DD-WRT
community through a general distribution release, then its unacceptable.
That means, instead of allowing me to add a small script that would backup
the config of the appliance, as well as restore it during a "I've been reset
to default" reboot, he rolls a truck when a unit loses all the configuration.
Is there someone who rolled a version with this in it? Yes. Is it default in
the DD-WRT images? No. So, it doesn't happen. I have my hands tied. This is
the same people rather suffer a 6 hour outage due to equipment failure, than
get emails saying the equipment is down the seconds it happens since "Too many 
emails makes Vista work poorly". 

	So until the big endian and arm/xscale issue is resolved in BS's view,
and Coova makes it into DD-WRT, I'm stuck with what can be done in the mean time.
And that, unfortunately, may mean some ugly patching potentially. Or, just
letting yet another thing be "ignored".

			Tuc


From wlan at mac.com  Fri May 16 04:43:22 2008
From: wlan at mac.com (wlan at mac.com)
Date: Fri, 16 May 2008 06:43:22 +0200
Subject: [chilli] Re: [chilli] Re: Sense of self awareness? :)
In-Reply-To: <200805160429.m4G4T89Y006040@himinbjorg.tucs-beachin-obx-house.com>
References: <200805160429.m4G4T89Y006040@himinbjorg.tucs-beachin-obx-house.com>
Message-ID: <AC0C397E-DC7F-4C1F-98FF-9780C0CE7F24@mac.com>

If you are more able to patch chillispot in dd-wrt, then just  
consider coova-chilli a really big chillispot patch (which it is). I  
personally haven't compiled it on xscale, but I don't know what you  
mean by it not being arm/xscale ready. I assume you mean that there  
is a byte order issue somewhere -- which there was, actually, in the  
original chillispot, fixed by OpenWrt for the FONera. This patch is  
not in CoovaChilli only because I did the same fix differently. If  
there are other endian issues that I am unaware of, well, it would be  
nice if someone made them known instead of spreading mis-information.

Perhaps you will find better hotspot centric community support here  
-- using CoovaChilli/AP :)

On May 16, 2008, at 6:29 AM, Tuc at T-B-O-H.NET wrote:

>>
>>> 	Kewl, exactly what I need. Maybe I can see what it took to  
>>> accomplish
>>> this can get it patched into the old server for use. Or, I'll find
>>> its just
>>> way too much and have to find other means of accomplishing my
>>> goals. But now
>>> I have direction.
>>
>> I don't think taking patches back to chillispot is that great of an
>> idea. CoovaChilli has _many_ fixes and new features that make it
>> worth the switch. I wonder that the point is in keeping chillispot
>> limping along with band-aids.
>>
> 	I agree its not a great idea. Its worse than chicken wire and
> bubble gum in my opinion. But bringing Coova over to DD-WRT isn't  
> happening
> because as the author has stated "right now coova is not big endian  
> and
> arm/xscale safe". I'm limited in what I can do with presenting  
> something
> to the person running the network. If it can't be supported by the  
> DD-WRT
> community through a general distribution release, then its  
> unacceptable.
> That means, instead of allowing me to add a small script that would  
> backup
> the config of the appliance, as well as restore it during a "I've  
> been reset
> to default" reboot, he rolls a truck when a unit loses all the  
> configuration.
> Is there someone who rolled a version with this in it? Yes. Is it  
> default in
> the DD-WRT images? No. So, it doesn't happen. I have my hands tied.  
> This is
> the same people rather suffer a 6 hour outage due to equipment  
> failure, than
> get emails saying the equipment is down the seconds it happens  
> since "Too many
> emails makes Vista work poorly".
>
> 	So until the big endian and arm/xscale issue is resolved in BS's  
> view,
> and Coova makes it into DD-WRT, I'm stuck with what can be done in  
> the mean time.
> And that, unfortunately, may mean some ugly patching potentially.  
> Or, just
> letting yet another thing be "ignored".
>
> 			Tuc
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From ml at t-b-o-h.net  Fri May 16 04:58:11 2008
From: ml at t-b-o-h.net (Tuc at T-B-O-H.NET)
Date: Fri, 16 May 2008 00:58:11 -0400 (EDT)
Subject: Sense of self awareness? :)
In-Reply-To: <AC0C397E-DC7F-4C1F-98FF-9780C0CE7F24@mac.com>
Message-ID: <200805160458.m4G4wBJJ006480@himinbjorg.tucs-beachin-obx-house.com>

Hi,

	I'm not "able" per se. I'll put it in as a ticket and see if the
powers to be accept it. I've actually turned my attention to something
else I'd RATHER have instead though... The "Accounting-On/Off" patches.
I think thats a better solution to the problem they are running into.

	As for the ENDIAN/ARM/XSCALE issue.... Thats beyond my knowledge,
I'm just cutting/pasting the reason I was given by the DD-WRT author. If
its untrue, I have no problem going back and saying "Its fixed, take another
look, and PLEASE get it in there for the next release". Unfortuantely,
thats also where my capabilities end. I'm not a committer, so I don't have
the authority to do it, just beg/plead. If someone wants to help campaign
it to the author, I'll be happy to offlist give an email contact address.

	For the umpteenth time, I'm not on old school Chilli because I 
want to. My hands are tied. Short of buying the WISP thats doing this, I
don't own it yet so don't have any authority to do anything except give
my opinion and suggestions. I would like almost nothing more (I'd like
only 1 thing more than this, but I can't mention it on list) than to be
using Coova on DD-WRT!!!!!!!!

		Tuc
> 
> If you are more able to patch chillispot in dd-wrt, then just  
> consider coova-chilli a really big chillispot patch (which it is). I  
> personally haven't compiled it on xscale, but I don't know what you  
> mean by it not being arm/xscale ready. I assume you mean that there  
> is a byte order issue somewhere -- which there was, actually, in the  
> original chillispot, fixed by OpenWrt for the FONera. This patch is  
> not in CoovaChilli only because I did the same fix differently. If  
> there are other endian issues that I am unaware of, well, it would be  
> nice if someone made them known instead of spreading mis-information.
> 
> Perhaps you will find better hotspot centric community support here  
> -- using CoovaChilli/AP :)
> 
> On May 16, 2008, at 6:29 AM, Tuc at T-B-O-H.NET wrote:
> 
> >>
> >>> 	Kewl, exactly what I need. Maybe I can see what it took to  
> >>> accomplish
> >>> this can get it patched into the old server for use. Or, I'll find
> >>> its just
> >>> way too much and have to find other means of accomplishing my
> >>> goals. But now
> >>> I have direction.
> >>
> >> I don't think taking patches back to chillispot is that great of an
> >> idea. CoovaChilli has _many_ fixes and new features that make it
> >> worth the switch. I wonder that the point is in keeping chillispot
> >> limping along with band-aids.
> >>
> > 	I agree its not a great idea. Its worse than chicken wire and
> > bubble gum in my opinion. But bringing Coova over to DD-WRT isn't  
> > happening
> > because as the author has stated "right now coova is not big endian  
> > and
> > arm/xscale safe". I'm limited in what I can do with presenting  
> > something
> > to the person running the network. If it can't be supported by the  
> > DD-WRT
> > community through a general distribution release, then its  
> > unacceptable.
> > That means, instead of allowing me to add a small script that would  
> > backup
> > the config of the appliance, as well as restore it during a "I've  
> > been reset
> > to default" reboot, he rolls a truck when a unit loses all the  
> > configuration.
> > Is there someone who rolled a version with this in it? Yes. Is it  
> > default in
> > the DD-WRT images? No. So, it doesn't happen. I have my hands tied.  
> > This is
> > the same people rather suffer a 6 hour outage due to equipment  
> > failure, than
> > get emails saying the equipment is down the seconds it happens  
> > since "Too many
> > emails makes Vista work poorly".
> >
> > 	So until the big endian and arm/xscale issue is resolved in BS's  
> > view,
> > and Coova makes it into DD-WRT, I'm stuck with what can be done in  
> > the mean time.
> > And that, unfortunately, may mean some ugly patching potentially.  
> > Or, just
> > letting yet another thing be "ignored".
> >
> > 			Tuc



From wlan at mac.com  Fri May 16 05:11:28 2008
From: wlan at mac.com (wlan at mac.com)
Date: Fri, 16 May 2008 07:11:28 +0200
Subject: Sense of self awareness? :)
In-Reply-To: <200805160458.m4G4wBJJ006480@himinbjorg.tucs-beachin-obx-house.com>
References: <200805160458.m4G4wBJJ006480@himinbjorg.tucs-beachin-obx-house.com>
Message-ID: <CD523A45-C3F1-4B5F-9AB4-5573227FAFCF@mac.com>

> 	For the umpteenth time, I'm not on old school Chilli because I
> want to. My hands are tied. Short of buying the WISP thats doing  
> this, I
> don't own it yet so don't have any authority to do anything except  
> give
> my opinion and suggestions. I would like almost nothing more (I'd like
> only 1 thing more than this, but I can't mention it on list) than  
> to be
> using Coova on DD-WRT!!!!!!!!

I don't know what to say... you can lead a horse to water, but can't  
make it drink.



From cfinnegan at csc.com.au  Fri May 16 05:13:19 2008
From: cfinnegan at csc.com.au (Ciaran Finnegan)
Date: Fri, 16 May 2008 16:13:19 +1100
Subject: Sense of self awareness? :)
Message-ID: <OFCA25744B.001CAFB6-ONCA25744B.001CAFB6-CA25744B.001CAFB6@csc.com>

Return Receipt
                                                                           
   Your       Re: Sense of self awareness? :)                              
   document:                                                               
                                                                           
   was        Ciaran Finnegan/GIS/CSC                                      
   received                                                                
   by:                                                                     
                                                                           
   at:        05/16/2008 04:13:19 PM ZE10                                  
                                                                           






From cfinnegan at csc.com.au  Fri May 16 05:13:39 2008
From: cfinnegan at csc.com.au (Ciaran Finnegan)
Date: Fri, 16 May 2008 16:13:39 +1100
Subject: [chilli] Re: [chilli] Re: Sense of self awareness? :)
Message-ID: <OFCA25744B.001CB776-ONCA25744B.001CB776-CA25744B.001CB778@csc.com>

Return Receipt
                                                                           
   Your       Re: [chilli] Re: [chilli] Re: Sense of self awareness? :)    
   document:                                                               
                                                                           
   was        Ciaran Finnegan/GIS/CSC                                      
   received                                                                
   by:                                                                     
                                                                           
   at:        05/16/2008 04:13:39 PM ZE10                                  
                                                                           






From richard.strand at moovera.com  Fri May 16 10:19:05 2008
From: richard.strand at moovera.com (Richard Strand)
Date: Fri, 16 May 2008 11:19:05 +0100
Subject: Several chilli process in the same computer
In-Reply-To: <FBA8299C-70CB-411C-8238-3E63C617F889@mac.com>
References: <482C25E5.2060309@gmail.com> <33877.139.179.14.250.1210853048.squirrel@webmail.bilkent.edu.tr> <482C2E30.6030609@gmail.com> <D7E30351-EBA4-451E-9E17-404D36CEF506@mac.com> <f71cb680805150820o6f127c93k1d3c8adb766131ba@mail.gmail.com> <FBA8299C-70CB-411C-8238-3E63C617F889@mac.com>
Message-ID: <482D5F99.4040403@moovera.com>

Hi,

If it is possible to add VLAN support, would there be any way to add 
support for multiple interfaces, or is that a completely different problem?

Regards,

Richard

wlan at mac.com wrote:
> Of course, it depends greatly on the setup... running an instance 
> per-vlan is a great way to break up the load and configurations of the 
> various networks. But, it could also be nice to have chilli handle 
> vlan tags directly and perhaps sending redirects with vlan=# 
> parameters. I've always done it the multi-instance way... hence the 
> lack of vlan support ;)
>
> On May 15, 2008, at 5:20 PM, Marco Simioni wrote:
>
>> Hi.
>>
>> I think that chilli should not handle 802.1q tags: they are handled by
>> linux kernel, chilli just sees different interfaces (for example
>> "eth0.2" for VLAN 2 on interface eth0).
>>
>> Am i wrong ?
>>
>> You could have WAN ("eth0.1") and LAN ("eth0.2") interface on just the
>> same physical interface "eth0" using VLANS. Just configure them with
>> eth0.1 and eth0.2 in your chilli config file.
>>
>> Regards,
>>
>> aNt1X
>>
>> 2008/5/15  <wlan at mac.com>:
>>> What chilli really should do is simply support VLAN/802.1q headers 
>>> and to
>>> make some decisions accordingly. But, I haven't gotten around to it. 
>>> Would
>>> make for a great contribution if anyone is interested in taking it on!
>>>
>>> On May 15, 2008, at 2:36 PM, Javier Larrea Arma?anzas wrote:
>>>
>>>> I've created different config files but It doesn't work.  I use vlan
>>>> interfaces, eth1.1, eth1.2 and eth1.3.  Do you use different physical
>>>> interfaces?  And I've got only one WAN interface, eth0.
>>>>
>>>> Thanks.
>>>>
>>>> Oguzhan Kayhan escribi?:
>>>>>
>>>>> Hello,
>>>>> If you create different config files for chilli processes and set 
>>>>> them to
>>>>> work on different interfaces, it should work without a 
>>>>> problem..which for
>>>>> ex we use over 3-4 different interfaces with different chilli 
>>>>> processes.
>>>>>
>>>>>
>>>>>> Hi list,
>>>>>> is it possible to run several chilli process in the same 
>>>>>> computer?.  I'd
>>>>>> like to do that so that I could set up different captive portals for
>>>>>> several interfaces in differents vlans.  But I get this error 
>>>>>> debugging
>>>>>> when I start the second process, although I use another uam port, 
>>>>>> uam
>>>>>> listen ip, pid file, sock file and ip range for this process.
>>>>>>
>>>>>> redir.c: 932: 0 (Debug) UAM port already in use. Waiting for retry.
>>>>>>
>>>>>> Thanks,
>>>>>>
>>>>>> Javier
>>>>>>
>>>>>> --------------------------------------------------------------------- 
>>>>>>
>>>>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>>>>> For additional commands, e-mail: chilli-help at coova.org
>>>>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>>>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>>
>>>>> ---------------------------------------------------------------------
>>>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>>>> For additional commands, e-mail: chilli-help at coova.org
>>>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>>>
>>>>>
>>>>>
>>>>
>>>>
>>>> ---------------------------------------------------------------------
>>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>>> For additional commands, e-mail: chilli-help at coova.org
>>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>> For additional commands, e-mail: chilli-help at coova.org
>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>
>>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>


-- 
Richard Strand
Head of Software Development
Moovera Networks
E   richard at moovera.com
T   +44 (0)870 446 0461
W   www.moovera.com

Confidentiality note: The information contained in this message is legally privileged and confidential information intended only for the use of the individual or entity named above. If the reader of this message is not the intended recipient, you are hereby notified that any use, dissemination, distribution or copying of this message is strictly prohibited. If you have received this message in error, please delete it and notify the sender.
Moovera Networks Ltd. 1096 Galley Drive, Kent Science Park, Sittingbourne, Kent ME9 8GA. Registered in England Number 5978464.



From javi.larrea at gmail.com  Fri May 16 10:23:16 2008
From: javi.larrea at gmail.com (=?UTF-8?B?SmF2aWVyIExhcnJlYSBBcm1hw7Fhbnphcw==?=)
Date: Fri, 16 May 2008 12:23:16 +0200
Subject: Several chilli process in the same computer
In-Reply-To: <482C43E6.2090208@wiera.hu>
References: <482C25E5.2060309@gmail.com>    <33877.139.179.14.250.1210853048.squirrel@webmail.bilkent.edu.tr>    <482C2E30.6030609@gmail.com> <38942.139.179.14.250.1210859917.squirrel@webmail.bilkent.edu.tr> <482C43E6.2090208@wiera.hu>
Message-ID: <482D6094.8050805@gmail.com>

Thanks Krn?k, 'uamuiport' has been the key to solve my problem.  I have 
changed it and it works.

Krn?k J?nos escribi?:
> hi
>
> there is also another option called *uamuiport *i think this is what 
> is used by the other chilli, change this as well
>
> bye



From wlan at mac.com  Fri May 16 11:19:56 2008
From: wlan at mac.com (wlan at mac.com)
Date: Fri, 16 May 2008 13:19:56 +0200
Subject: Several chilli process in the same computer
In-Reply-To: <482D5F99.4040403@moovera.com>
References: <482C25E5.2060309@gmail.com>
 <33877.139.179.14.250.1210853048.squirrel@webmail.bilkent.edu.tr>
 <482C2E30.6030609@gmail.com> <D7E30351-EBA4-451E-9E17-404D36CEF506@mac.com>
 <f71cb680805150820o6f127c93k1d3c8adb766131ba@mail.gmail.com>
 <FBA8299C-70CB-411C-8238-3E63C617F889@mac.com> <482D5F99.4040403@moovera.com>
Message-ID: <CCB43021-0470-47B1-A157-A8A0C7636EA8@mac.com>

Two different things.. adding additional 'dhcpif' interfaces is an  
interesting idea - particularly for routers where multiple instances  
is less an option. You could use that with VLANs (whereby you have  
interfaces for each vlan). Having chilli support 802.1q directly  
would mean something a bit different. It could mean that your dhcpif,  
just the one interface, with multiple VLAN/802.1q traffic, can be  
handled by one chilli. It could also mean chilli uses 802.1q for  
upstream packets -- thereby having the option of assigning sessions  
to certain upstream VLANs.


On May 16, 2008, at 12:19 PM, Richard Strand wrote:

> Hi,
>
> If it is possible to add VLAN support, would there be any way to  
> add support for multiple interfaces, or is that a completely  
> different problem?
>
> Regards,
>
> Richard
>
> wlan at mac.com wrote:
>> Of course, it depends greatly on the setup... running an instance  
>> per-vlan is a great way to break up the load and configurations of  
>> the various networks. But, it could also be nice to have chilli  
>> handle vlan tags directly and perhaps sending redirects with  
>> vlan=# parameters. I've always done it the multi-instance way...  
>> hence the lack of vlan support ;)
>>
>> On May 15, 2008, at 5:20 PM, Marco Simioni wrote:
>>
>>> Hi.
>>>
>>> I think that chilli should not handle 802.1q tags: they are  
>>> handled by
>>> linux kernel, chilli just sees different interfaces (for example
>>> "eth0.2" for VLAN 2 on interface eth0).
>>>
>>> Am i wrong ?
>>>
>>> You could have WAN ("eth0.1") and LAN ("eth0.2") interface on  
>>> just the
>>> same physical interface "eth0" using VLANS. Just configure them with
>>> eth0.1 and eth0.2 in your chilli config file.
>>>
>>> Regards,
>>>
>>> aNt1X
>>>
>>> 2008/5/15  <wlan at mac.com>:
>>>> What chilli really should do is simply support VLAN/802.1q  
>>>> headers and to
>>>> make some decisions accordingly. But, I haven't gotten around to  
>>>> it. Would
>>>> make for a great contribution if anyone is interested in taking  
>>>> it on!
>>>>
>>>> On May 15, 2008, at 2:36 PM, Javier Larrea Arma?anzas wrote:
>>>>
>>>>> I've created different config files but It doesn't work.  I use  
>>>>> vlan
>>>>> interfaces, eth1.1, eth1.2 and eth1.3.  Do you use different  
>>>>> physical
>>>>> interfaces?  And I've got only one WAN interface, eth0.
>>>>>
>>>>> Thanks.
>>>>>
>>>>> Oguzhan Kayhan escribi?:
>>>>>>
>>>>>> Hello,
>>>>>> If you create different config files for chilli processes and  
>>>>>> set them to
>>>>>> work on different interfaces, it should work without a  
>>>>>> problem..which for
>>>>>> ex we use over 3-4 different interfaces with different chilli  
>>>>>> processes.
>>>>>>
>>>>>>
>>>>>>> Hi list,
>>>>>>> is it possible to run several chilli process in the same  
>>>>>>> computer?.  I'd
>>>>>>> like to do that so that I could set up different captive  
>>>>>>> portals for
>>>>>>> several interfaces in differents vlans.  But I get this error  
>>>>>>> debugging
>>>>>>> when I start the second process, although I use another uam  
>>>>>>> port, uam
>>>>>>> listen ip, pid file, sock file and ip range for this process.
>>>>>>>
>>>>>>> redir.c: 932: 0 (Debug) UAM port already in use. Waiting for  
>>>>>>> retry.
>>>>>>>
>>>>>>> Thanks,
>>>>>>>
>>>>>>> Javier
>>>>>>>
>>>>>>> ---------------------------------------------------------------- 
>>>>>>> -----
>>>>>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>>>>>> For additional commands, e-mail: chilli-help at coova.org
>>>>>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>>>>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> ----------------------------------------------------------------- 
>>>>>> ----
>>>>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>>>>> For additional commands, e-mail: chilli-help at coova.org
>>>>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>>>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>>
>>>>> ------------------------------------------------------------------ 
>>>>> ---
>>>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>>>> For additional commands, e-mail: chilli-help at coova.org
>>>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>>>
>>>>
>>>>
>>>> ------------------------------------------------------------------- 
>>>> --
>>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>>> For additional commands, e-mail: chilli-help at coova.org
>>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>>
>>>>
>>>
>>> -------------------------------------------------------------------- 
>>> -
>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>> For additional commands, e-mail: chilli-help at coova.org
>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>
>
> -- 
> Richard Strand
> Head of Software Development
> Moovera Networks
> E   richard at moovera.com
> T   +44 (0)870 446 0461
> W   www.moovera.com
>
> Confidentiality note: The information contained in this message is  
> legally privileged and confidential information intended only for  
> the use of the individual or entity named above. If the reader of  
> this message is not the intended recipient, you are hereby notified  
> that any use, dissemination, distribution or copying of this  
> message is strictly prohibited. If you have received this message  
> in error, please delete it and notify the sender.
> Moovera Networks Ltd. 1096 Galley Drive, Kent Science Park,  
> Sittingbourne, Kent ME9 8GA. Registered in England Number 5978464.
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From wlan at mac.com  Fri May 16 11:28:01 2008
From: wlan at mac.com (wlan at mac.com)
Date: Fri, 16 May 2008 13:28:01 +0200
Subject: Several chilli process in the same computer
In-Reply-To: <482C9E4A.1090008@gmail.com>
References: <482C25E5.2060309@gmail.com> <482C9E4A.1090008@gmail.com>
Message-ID: <406E8371-9100-435E-B010-0B3FBCE103DA@mac.com>

I also find 'lsof' one of the most useful little programs for  
inspecting a process' file descriptors and libraries.

# lsof -Pp <chilli-pid>
COMMAND  PID USER   FD   TYPE     DEVICE    SIZE    NODE NAME
chilli  4467 root  cwd    DIR        3,2    4096  294337 /root
chilli  4467 root  rtd    DIR        3,2    4096       2 /
chilli  4467 root  txt    REG        3,2    7426 1602952 /usr/local/ 
sbin/chilli
chilli  4467 root  mem    REG        3,2 1529392 3908293 /lib/ 
libc-2.4.so
chilli  4467 root  mem    REG        3,2   46652 3908309 /lib/ 
libnss_files-2.4.so
chilli  4467 root  mem    REG        3,2   21768 3908307 /lib/ 
libnss_dns-2.4.so
chilli  4467 root  mem    REG        3,2   33244  369033 /usr/lib/ 
libbstring.so.0.0.0
chilli  4467 root  mem    REG        3,2  120160 3908286 /lib/ld-2.4.so
chilli  4467 root  mem    REG        3,2   74552 3909868 /lib/ 
libresolv-2.4.so
chilli  4467 root  mem    REG        3,2  283824  369036 /usr/lib/ 
libchilli.so.0.0.0
chilli  4467 root  mem    REG        0,0               0 [vdso]  
(stat: No such file or directory)
chilli  4467 root    0r   CHR        1,3            1088 /dev/null
chilli  4467 root    1w   CHR        1,3            1088 /dev/null
chilli  4467 root    2w   CHR        1,3            1088 /dev/null
chilli  4467 root    3u  unix 0xc6889300          264945 socket
chilli  4467 root    4u   CHR     10,200            1085 /dev/net/tun
chilli  4467 root    5u  sock        0,4          264973 can't  
identify protocol
chilli  4467 root    6u  sock        0,4          264974 can't  
identify protocol
chilli  4467 root    7r   CHR        1,9            1675 /dev/urandom
chilli  4467 root    8u  IPv4     264975             UDP *:2175
chilli  4467 root    9u  IPv4     264976             TCP  
10.1.0.1:3990 (LISTEN)
chilli  4467 root   10u  IPv4     264977             TCP *:3991 (LISTEN)
chilli  4467 root   11u  unix 0xf5ed8300          264978 /var/run/ 
chilli.sock


On May 15, 2008, at 10:34 PM, Gunther Mayer wrote:

> Javier Larrea Arma?anzas wrote:
>> Hi list,
>> is it possible to run several chilli process in the same  
>> computer?.  I'd like to do that so that I could set up different  
>> captive portals for several interfaces in differents vlans.  But I  
>> get this error debugging when I start the second process, although  
>> I use another uam port, uam listen ip, pid file, sock file and ip  
>> range for this process.
>>
>> redir.c: 932: 0 (Debug) UAM port already in use. Waiting for retry.
> There are a whole bunch of other ports that chilli opens. uamuiport  
> comes to mind, there might be others. Just run a "netstat -lu" when  
> running just one chilli process and you'll see which ones it opens.  
> All those you must of course explicitly state to be different for  
> all other processes.
>
> Gunther
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From Ivano.Cristofolini at ing.unitn.it  Fri May 16 11:54:13 2008
From: Ivano.Cristofolini at ing.unitn.it (Ivano Cristofolini)
Date: Fri, 16 May 2008 13:54:13 +0200
Subject: handle initial requests to http proxy
Message-ID: <1210938853.3146.67.camel@azathoth.ing.unitn.it>

Hello,

I need to modify coova-chilli to capture http requests directed to a
(NON transparent) http proxy running on port 3128 (keeping current
functionality as well).

I have successfully modified the http parsing functions in redir.c (very
simple: only redirurl changes).

I'm trying to modify the DNAT routines in dhcp.c so that requests to
port 3128 are handled in the same way as regular requests to http
servers (i.e. they are NATted to uamserver).

This is easy for dhcp_doDNAT() (I added the last line):

...
  /* Was it a http request for another server? */
  /* We are changing dest IP and dest port to local UAM server */
  if ((pack->iph.protocol == PKT_IP_PROTO_TCP) &&
      ((tcph->dst == htons(DHCP_HTTP)) || 
       (tcph->dst == htons(3128)))) {
...

I don't know how to do it for dhcp_undoDNAT().

...
/* Was it a reply from redir server? */
...
if (something???) {
  tcph->src = htons(DHCP_HTTP);
else
  tcph->src = htons(3128);
...

Any suggestions?

-- 
Ivano Cristofolini
Presidio Informatico Ingegneria
Direzione Informatica e Telecomunicazioni
Universita' degli Studi di Trento
Via Mesiano 77,
38050 Povo(TN), Italy
Tel: +39 0461/881940
Fax: +39 0461/882628



From ml at t-b-o-h.net  Fri May 16 13:44:06 2008
From: ml at t-b-o-h.net (Tuc at T-B-O-H.NET)
Date: Fri, 16 May 2008 09:44:06 -0400 (EDT)
Subject: [chilli] Re: Sense of self awareness? :)
In-Reply-To: <CD523A45-C3F1-4B5F-9AB4-5573227FAFCF@mac.com>
Message-ID: <200805161344.m4GDi6Q9013297@himinbjorg.tucs-beachin-obx-house.com>

> 
> > 	For the umpteenth time, I'm not on old school Chilli because I
> > want to. My hands are tied. Short of buying the WISP thats doing  
> > this, I
> > don't own it yet so don't have any authority to do anything except  
> > give
> > my opinion and suggestions. I would like almost nothing more (I'd like
> > only 1 thing more than this, but I can't mention it on list) than  
> > to be
> > using Coova on DD-WRT!!!!!!!!
> 
> I don't know what to say... you can lead a horse to water, but can't  
> make it drink.
> 
	If the statement that the DD-WRT author told me is untrue about
the endian and xscale/arm issues, then as long as someone helps point me
towards a revision number, changelog, or something else that might convince
him I'd be more than happy to go back to him and tell him to start
integrating it. Until then, since those issues are out of my league, I
have to blindly accept what he's saying. 

		Thanks, Tuc


From Ivano.Cristofolini at ing.unitn.it  Fri May 16 14:26:06 2008
From: Ivano.Cristofolini at ing.unitn.it (Ivano Cristofolini)
Date: Fri, 16 May 2008 16:26:06 +0200
Subject: handle initial requests to http proxy
In-Reply-To: <1210938853.3146.67.camel@azathoth.ing.unitn.it>
References: <1210938853.3146.67.camel@azathoth.ing.unitn.it>
Message-ID: <1210947966.3146.74.camel@azathoth.ing.unitn.it>

just solved it by myself, sorry for the bother.

Ivano

On Fri, 2008-05-16 at 13:54 +0200, Ivano Cristofolini wrote:
> Hello,
> 
> I need to modify coova-chilli to capture http requests directed to a
> (NON transparent) http proxy running on port 3128 (keeping current
> functionality as well).
> 
> I have successfully modified the http parsing functions in redir.c (very
> simple: only redirurl changes).
> 
> I'm trying to modify the DNAT routines in dhcp.c so that requests to
> port 3128 are handled in the same way as regular requests to http
> servers (i.e. they are NATted to uamserver).
> 
> This is easy for dhcp_doDNAT() (I added the last line):
> 
> ...
>   /* Was it a http request for another server? */
>   /* We are changing dest IP and dest port to local UAM server */
>   if ((pack->iph.protocol == PKT_IP_PROTO_TCP) &&
>       ((tcph->dst == htons(DHCP_HTTP)) || 
>        (tcph->dst == htons(3128)))) {
> ...
> 
> I don't know how to do it for dhcp_undoDNAT().
> 
> ...
> /* Was it a reply from redir server? */
> ...
> if (something???) {
>   tcph->src = htons(DHCP_HTTP);
> else
>   tcph->src = htons(3128);
> ...
> 
> Any suggestions?
> 
-- 
Ivano Cristofolini
Presidio Informatico Ingegneria
Direzione Informatica e Telecomunicazioni
Universita' degli Studi di Trento
Via Mesiano 77,
38050 Povo(TN), Italy
Tel: +39 0461/881940
Fax: +39 0461/882628



From wlan at mac.com  Sat May 17 07:21:55 2008
From: wlan at mac.com (wlan at mac.com)
Date: Sat, 17 May 2008 09:21:55 +0200
Subject: handle initial requests to http proxy
In-Reply-To: <1210947966.3146.74.camel@azathoth.ing.unitn.it>
References: <1210938853.3146.67.camel@azathoth.ing.unitn.it>
 <1210947966.3146.74.camel@azathoth.ing.unitn.it>
Message-ID: <EA05D815-626F-4026-AEE8-C9F0C127AA8D@mac.com>

Working contributions are welcome!

On May 16, 2008, at 4:26 PM, Ivano Cristofolini wrote:

> just solved it by myself, sorry for the bother.
>
> Ivano
>
> On Fri, 2008-05-16 at 13:54 +0200, Ivano Cristofolini wrote:
>> Hello,
>>
>> I need to modify coova-chilli to capture http requests directed to a
>> (NON transparent) http proxy running on port 3128 (keeping current
>> functionality as well).
>>
>> I have successfully modified the http parsing functions in redir.c  
>> (very
>> simple: only redirurl changes).
>>
>> I'm trying to modify the DNAT routines in dhcp.c so that requests to
>> port 3128 are handled in the same way as regular requests to http
>> servers (i.e. they are NATted to uamserver).
>>
>> This is easy for dhcp_doDNAT() (I added the last line):
>>
>> ...
>>   /* Was it a http request for another server? */
>>   /* We are changing dest IP and dest port to local UAM server */
>>   if ((pack->iph.protocol == PKT_IP_PROTO_TCP) &&
>>       ((tcph->dst == htons(DHCP_HTTP)) ||
>>        (tcph->dst == htons(3128)))) {
>> ...
>>
>> I don't know how to do it for dhcp_undoDNAT().
>>
>> ...
>> /* Was it a reply from redir server? */
>> ...
>> if (something???) {
>>   tcph->src = htons(DHCP_HTTP);
>> else
>>   tcph->src = htons(3128);
>> ...
>>
>> Any suggestions?
>>
> -- 
> Ivano Cristofolini
> Presidio Informatico Ingegneria
> Direzione Informatica e Telecomunicazioni
> Universita' degli Studi di Trento
> Via Mesiano 77,
> 38050 Povo(TN), Italy
> Tel: +39 0461/881940
> Fax: +39 0461/882628
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From wlan at mac.com  Sat May 17 07:25:55 2008
From: wlan at mac.com (wlan at mac.com)
Date: Sat, 17 May 2008 09:25:55 +0200
Subject: PPP(oe) WAN connection not established when using Wireless-Only
 hotspot
In-Reply-To: <482C58D2.8050109@apolix.co.za>
References: <56acee400805150054h12867e04p8b0a644a6071b2ce@mail.gmail.com>
 <482C58D2.8050109@apolix.co.za>
Message-ID: <E0DBD579-88E2-4CC4-B6FA-3A662340A8AA@mac.com>

I'm interested to know what kind of traffic is taking up your  
bandwidth... Does this happen when the Internet is (or was recently)  
unavailable?


On May 15, 2008, at 5:37 PM, Graham Beneke wrote:

> Murray Long wrote:
>> I've run into a problem when using PPP (or PPPoe ) internet  
>> connection, with the wireless only hotspot option. On startup, the  
>> router gets into an endless cycle or connecting and reconnecting.
>> Here's why it happens:
>> The "/etc/init.d/S90chillli start" script is run to start coova- 
>> chilli
>> the wireless_split function then restarts all network interfaces  
>> which starts the ppp dialup
>> Coova-chilli is then started but fails to initialize because it  
>> can't determine the ip address of the radius server (because the  
>> ppp is slow and the connection is not yet established)
>> 5 seconds later (still not enough time for ppp to establish a  
>> connection) "S90chilli checkrunning" is called which detects  
>> chilli is not running and restarts the whole process.
>
> I have been experiencing problems with run away bandwidth usage on  
> a provider you probably know (iBurst). I have not yet traced the  
> exact source of the problem but it would seem to be some sort of  
> nasty loop that Coova gets into trying to validate its servers that  
> result in extremely high bandwidth usage and an AP that becomes non- 
> functional until it has been rebooted.
>
> It probably stems from the same aggressive validation that seems to  
> fail on sub-standard broadband connections.
>
> -- 
> Graham Beneke
> Apolix Internet Services
> E-Mail/MSN/Jabber: graham at apolix.co.za   Skype: grbeneke
> VoIP: 087-750-5696                       Cell: 082-432-1873
> http://www.apolix.co.za/
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>



From graham-ml at apolix.co.za  Wed May 21 06:35:14 2008
From: graham-ml at apolix.co.za (Graham Beneke)
Date: Wed, 21 May 2008 08:35:14 +0200
Subject: PPP(oe) WAN connection not established when using Wireless-Only
 hotspot
In-Reply-To: <E0DBD579-88E2-4CC4-B6FA-3A662340A8AA@mac.com>
References: <56acee400805150054h12867e04p8b0a644a6071b2ce@mail.gmail.com> <482C58D2.8050109@apolix.co.za> <E0DBD579-88E2-4CC4-B6FA-3A662340A8AA@mac.com>
Message-ID: <4833C2A2.8020805@apolix.co.za>

wlan at mac.com wrote:
> I'm interested to know what kind of traffic is taking up your 
> bandwidth... Does this happen when the Internet is (or was recently) 
> unavailable?
> 

I have been struggling to identify what the traffic is that taking up 
the bandwidth. I have managed to get some SNMP graphing on my devices 
and have concluded that it is:
* only on the PPPoE side of the devices (ie no hacking activity from the 
wireless interface)
* predominantly in the download direction
* at a fairly constant rate and continuing for a number of hours
* only stops when the AP hangs/reboots

iBurst is a wireless broadband technology and it is often badly affected 
by certain environmental issues. The problems seem to occur when there 
are incidents of high packet loss on the wireless link or when the PPPoE 
connection is/was flapping.

-- 
Graham Beneke
Apolix Internet Services
E-Mail/MSN/Jabber: graham at apolix.co.za   Skype: grbeneke
VoIP: 087-750-5696                       Cell: 082-432-1873
http://www.apolix.co.za/


From Ivano.Cristofolini at ing.unitn.it  Wed May 21 08:10:59 2008
From: Ivano.Cristofolini at ing.unitn.it (Ivano Cristofolini)
Date: Wed, 21 May 2008 10:10:59 +0200
Subject: handle initial requests to http proxy
In-Reply-To: <EA05D815-626F-4026-AEE8-C9F0C127AA8D@mac.com>
References: <1210938853.3146.67.camel@azathoth.ing.unitn.it>
	 <1210947966.3146.74.camel@azathoth.ing.unitn.it>
	 <EA05D815-626F-4026-AEE8-C9F0C127AA8D@mac.com>
Message-ID: <1211357459.19347.26.camel@azathoth.ing.unitn.it>

OK, here it is quick'n'dirty (port number is hard-coded, etc.). It's
important to note that browsers must not use a proxy for uamserver and
authentication server; otherwise login will not work.
It is probably not terribly useful in general: I needed it to keep
previous browser settings for a wired network still working on the wifi.

Ivano

--- old_dhcp.h	2008-05-19 09:21:33.000000000 +0200
+++ dhcp.h	2008-05-19 10:16:04.000000000 +0200
@@ -56,6 +56,7 @@
 /* TCP Ports */
 #define DHCP_HTTP   80
 #define DHCP_HTTPS 443
+#define DHCP_HTTPPROXY 3128
 
 
 #define DHCP_ARP_REQUEST 1
@@ -99,6 +100,7 @@
   int nextdnat;                /* Next location to use for DNAT */
   uint32_t dnatip[DHCP_DNAT_MAX]; /* Destination NAT destination IP
address */
   uint16_t dnatport[DHCP_DNAT_MAX]; /* Destination NAT source port */
+  uint16_t http_port;               /* Original (pre-NAT) destination
port */
   uint8_t dnatmac[DHCP_DNAT_MAX][PKT_ETH_ALEN]; /* Destination NAT
source mac */
 /*  uint16_t mtu;                 Maximum transfer unit */
 };
--- old_dhcp.c	2008-05-19 09:21:40.000000000 +0200
+++ dhcp.c	2008-05-19 09:32:42.000000000 +0200
@@ -1245,7 +1245,8 @@
   /* Was it a http request for another server? */
   /* We are changing dest IP and dest port to local UAM server */
   if ((pack->iph.protocol == PKT_IP_PROTO_TCP) &&
-      (tcph->dst == htons(DHCP_HTTP))) {
+      ((tcph->dst == htons(DHCP_HTTP)) ||
+       (tcph->dst == htons(DHCP_HTTPPROXY)))) {
     int n;
     int pos=-1;
     for (n=0; n<DHCP_DNAT_MAX; n++) {
@@ -1260,6 +1261,7 @@
 	memcpy(conn->dnatmac[conn->nextdnat], pack->ethh.dst, PKT_ETH_ALEN); 
       conn->dnatip[conn->nextdnat] = pack->iph.daddr; 
       conn->dnatport[conn->nextdnat] = tcph->src;
+      conn->http_port = tcph->dst;
       conn->nextdnat = (conn->nextdnat + 1) % DHCP_DNAT_MAX;
     }
 
@@ -1420,7 +1422,7 @@
 	if (options.usetap) 
 	  memcpy(pack->ethh.src, conn->dnatmac[n], PKT_ETH_ALEN); 
 	pack->iph.saddr = conn->dnatip[n];
-	tcph->src = htons(DHCP_HTTP);
+	tcph->src = conn->http_port;
 
 	dhcp_tcp_check(pack, len);
 	dhcp_ip_check(pack);
--- old_redir.c	2008-05-19 09:22:03.000000000 +0200
+++ redir.c	2008-05-19 14:52:03.000000000 +0200
@@ -1124,7 +1124,6 @@
 
 	while (*p1 == ' ') p1++; /* Advance through additional white space */
 	if (*p1 == '/') p1++;
-	else return -1;
 	
 	/* The path ends with a ? or a space */
 	p2 = strchr(p1, '?');
@@ -1321,9 +1320,16 @@
   default:
     {
       /* some basic checks for urls we don't care about */
-      
-      snprintf(conn->state.redir.userurl,
sizeof(conn->state.redir.userurl), "http://%s/%s%s%s", 
-	       host, path, qs[0] ? "?" : "", qs[0] ? qs : "");
+
+      /* if GET was for an http proxy then the path starts with
http://host */
+      if (!strncmp(path, "http://", 7)) {
+          snprintf(conn->state.redir.userurl,
sizeof(conn->state.redir.userurl), "%s%s%s",
+               path, qs[0] ? "?" : "", qs[0] ? qs : "");
+      }
+      else {
+          snprintf(conn->state.redir.userurl,
sizeof(conn->state.redir.userurl), "http://%s/%s%s%s",
+               host, path, qs[0] ? "?" : "", qs[0] ? qs : "");
+      }
 
       if (optionsdebug) 
 	log_dbg("-->> Setting userurl=[%s]",conn->state.redir.userurl);


On Sat, 2008-05-17 at 09:21 +0200, wlan at mac.com wrote:
> Working contributions are welcome!
> 
> On May 16, 2008, at 4:26 PM, Ivano Cristofolini wrote:
> 
> > just solved it by myself, sorry for the bother.
> >
> > Ivano
> >
> > On Fri, 2008-05-16 at 13:54 +0200, Ivano Cristofolini wrote:
> >> Hello,
> >>
> >> I need to modify coova-chilli to capture http requests directed to a
> >> (NON transparent) http proxy running on port 3128 (keeping current
> >> functionality as well).
> >>
> >> I have successfully modified the http parsing functions in redir.c  
> >> (very
> >> simple: only redirurl changes).
> >>
> >> I'm trying to modify the DNAT routines in dhcp.c so that requests to
> >> port 3128 are handled in the same way as regular requests to http
> >> servers (i.e. they are NATted to uamserver).
> >>
> >> This is easy for dhcp_doDNAT() (I added the last line):
> >>
> >> ...
> >>   /* Was it a http request for another server? */
> >>   /* We are changing dest IP and dest port to local UAM server */
> >>   if ((pack->iph.protocol == PKT_IP_PROTO_TCP) &&
> >>       ((tcph->dst == htons(DHCP_HTTP)) ||
> >>        (tcph->dst == htons(3128)))) {
> >> ...
> >>
> >> I don't know how to do it for dhcp_undoDNAT().
> >>
> >> ...
> >> /* Was it a reply from redir server? */
> >> ...
> >> if (something???) {
> >>   tcph->src = htons(DHCP_HTTP);
> >> else
> >>   tcph->src = htons(3128);
> >> ...
> >>
> >> Any suggestions?
> >>
> > -- 
> > Ivano Cristofolini
> > Presidio Informatico Ingegneria
> > Direzione Informatica e Telecomunicazioni
> > Universita' degli Studi di Trento
> > Via Mesiano 77,
> > 38050 Povo(TN), Italy
> > Tel: +39 0461/881940
> > Fax: +39 0461/882628
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> > For additional commands, e-mail: chilli-help at coova.org
> > Wiki: http://coova.org/wiki/index.php/CoovaChilli
> > Forum: http://coova.org/phpBB3/viewforum.php?f=4
> >
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
> 
-- 
Ivano Cristofolini
Presidio Informatico Ingegneria
Direzione Informatica e Telecomunicazioni
Universita' degli Studi di Trento
Via Mesiano 77,
38050 Povo(TN), Italy
Tel: +39 0461/881940
Fax: +39 0461/882628
-------------- next part --------------
A non-text attachment was scrubbed...
Name: httpproxy.patch
Type: text/x-patch
Size: 2904 bytes
Desc: not available
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080521/5140b891/attachment.bin>

From wlan at mac.com  Wed May 21 08:29:01 2008
From: wlan at mac.com (wlan at mac.com)
Date: Wed, 21 May 2008 10:29:01 +0200
Subject: handle initial requests to http proxy
In-Reply-To: <1211357459.19347.26.camel@azathoth.ing.unitn.it>
References: <1210938853.3146.67.camel@azathoth.ing.unitn.it>
 <1210947966.3146.74.camel@azathoth.ing.unitn.it>
 <EA05D815-626F-4026-AEE8-C9F0C127AA8D@mac.com>
 <1211357459.19347.26.camel@azathoth.ing.unitn.it>
Message-ID: <2CA221C7-6800-4849-BF58-1B1B8B0F9C3C@mac.com>

So, in your browser, you have it configured to use a proxy for all  
sites except the explicitly configured uam and chilli server? Yeah,  
that wouldn't be very useful generally, I would think. I suppose it  
is also possible to have chilli support the proxy URL format in  
redir_getreq() which might help. Seeing your use of 'http_port' makes  
me think it could be an option to have chilli 'redirect' on a list of  
ports. It has also been brewing in the back of my head to try out  
some minimal content filtering for http traffic which could "de- 
proxy" a request pre-authentication and perhaps do a "captive-frame"  
without the need of an external privoxy. Oh, so little time..


On May 21, 2008, at 10:10 AM, Ivano Cristofolini wrote:

> OK, here it is quick'n'dirty (port number is hard-coded, etc.). It's
> important to note that browsers must not use a proxy for uamserver and
> authentication server; otherwise login will not work.
> It is probably not terribly useful in general: I needed it to keep
> previous browser settings for a wired network still working on the  
> wifi.
>
> Ivano
>
> --- old_dhcp.h	2008-05-19 09:21:33.000000000 +0200
> +++ dhcp.h	2008-05-19 10:16:04.000000000 +0200
> @@ -56,6 +56,7 @@
>  /* TCP Ports */
>  #define DHCP_HTTP   80
>  #define DHCP_HTTPS 443
> +#define DHCP_HTTPPROXY 3128
>
>
>  #define DHCP_ARP_REQUEST 1
> @@ -99,6 +100,7 @@
>    int nextdnat;                /* Next location to use for DNAT */
>    uint32_t dnatip[DHCP_DNAT_MAX]; /* Destination NAT destination IP
> address */
>    uint16_t dnatport[DHCP_DNAT_MAX]; /* Destination NAT source port */
> +  uint16_t http_port;               /* Original (pre-NAT) destination
> port */
>    uint8_t dnatmac[DHCP_DNAT_MAX][PKT_ETH_ALEN]; /* Destination NAT
> source mac */
>  /*  uint16_t mtu;                 Maximum transfer unit */
>  };
> --- old_dhcp.c	2008-05-19 09:21:40.000000000 +0200
> +++ dhcp.c	2008-05-19 09:32:42.000000000 +0200
> @@ -1245,7 +1245,8 @@
>    /* Was it a http request for another server? */
>    /* We are changing dest IP and dest port to local UAM server */
>    if ((pack->iph.protocol == PKT_IP_PROTO_TCP) &&
> -      (tcph->dst == htons(DHCP_HTTP))) {
> +      ((tcph->dst == htons(DHCP_HTTP)) ||
> +       (tcph->dst == htons(DHCP_HTTPPROXY)))) {
>      int n;
>      int pos=-1;
>      for (n=0; n<DHCP_DNAT_MAX; n++) {
> @@ -1260,6 +1261,7 @@
>  	memcpy(conn->dnatmac[conn->nextdnat], pack->ethh.dst, PKT_ETH_ALEN);
>        conn->dnatip[conn->nextdnat] = pack->iph.daddr;
>        conn->dnatport[conn->nextdnat] = tcph->src;
> +      conn->http_port = tcph->dst;
>        conn->nextdnat = (conn->nextdnat + 1) % DHCP_DNAT_MAX;
>      }
>
> @@ -1420,7 +1422,7 @@
>  	if (options.usetap)
>  	  memcpy(pack->ethh.src, conn->dnatmac[n], PKT_ETH_ALEN);
>  	pack->iph.saddr = conn->dnatip[n];
> -	tcph->src = htons(DHCP_HTTP);
> +	tcph->src = conn->http_port;
>
>  	dhcp_tcp_check(pack, len);
>  	dhcp_ip_check(pack);
> --- old_redir.c	2008-05-19 09:22:03.000000000 +0200
> +++ redir.c	2008-05-19 14:52:03.000000000 +0200
> @@ -1124,7 +1124,6 @@
>
>  	while (*p1 == ' ') p1++; /* Advance through additional white  
> space */
>  	if (*p1 == '/') p1++;
> -	else return -1;
>  	
>  	/* The path ends with a ? or a space */
>  	p2 = strchr(p1, '?');
> @@ -1321,9 +1320,16 @@
>    default:
>      {
>        /* some basic checks for urls we don't care about */
> -
> -      snprintf(conn->state.redir.userurl,
> sizeof(conn->state.redir.userurl), "http://%s/%s%s%s",
> -	       host, path, qs[0] ? "?" : "", qs[0] ? qs : "");
> +
> +      /* if GET was for an http proxy then the path starts with
> http://host */
> +      if (!strncmp(path, "http://", 7)) {
> +          snprintf(conn->state.redir.userurl,
> sizeof(conn->state.redir.userurl), "%s%s%s",
> +               path, qs[0] ? "?" : "", qs[0] ? qs : "");
> +      }
> +      else {
> +          snprintf(conn->state.redir.userurl,
> sizeof(conn->state.redir.userurl), "http://%s/%s%s%s",
> +               host, path, qs[0] ? "?" : "", qs[0] ? qs : "");
> +      }
>
>        if (optionsdebug)
>  	log_dbg("-->> Setting userurl=[%s]",conn->state.redir.userurl);
>
>
> On Sat, 2008-05-17 at 09:21 +0200, wlan at mac.com wrote:
>> Working contributions are welcome!
>>
>> On May 16, 2008, at 4:26 PM, Ivano Cristofolini wrote:
>>
>>> just solved it by myself, sorry for the bother.
>>>
>>> Ivano
>>>
>>> On Fri, 2008-05-16 at 13:54 +0200, Ivano Cristofolini wrote:
>>>> Hello,
>>>>
>>>> I need to modify coova-chilli to capture http requests directed  
>>>> to a
>>>> (NON transparent) http proxy running on port 3128 (keeping current
>>>> functionality as well).
>>>>
>>>> I have successfully modified the http parsing functions in redir.c
>>>> (very
>>>> simple: only redirurl changes).
>>>>
>>>> I'm trying to modify the DNAT routines in dhcp.c so that  
>>>> requests to
>>>> port 3128 are handled in the same way as regular requests to http
>>>> servers (i.e. they are NATted to uamserver).
>>>>
>>>> This is easy for dhcp_doDNAT() (I added the last line):
>>>>
>>>> ...
>>>>   /* Was it a http request for another server? */
>>>>   /* We are changing dest IP and dest port to local UAM server */
>>>>   if ((pack->iph.protocol == PKT_IP_PROTO_TCP) &&
>>>>       ((tcph->dst == htons(DHCP_HTTP)) ||
>>>>        (tcph->dst == htons(3128)))) {
>>>> ...
>>>>
>>>> I don't know how to do it for dhcp_undoDNAT().
>>>>
>>>> ...
>>>> /* Was it a reply from redir server? */
>>>> ...
>>>> if (something???) {
>>>>   tcph->src = htons(DHCP_HTTP);
>>>> else
>>>>   tcph->src = htons(3128);
>>>> ...
>>>>
>>>> Any suggestions?
>>>>
>>> -- 
>>> Ivano Cristofolini
>>> Presidio Informatico Ingegneria
>>> Direzione Informatica e Telecomunicazioni
>>> Universita' degli Studi di Trento
>>> Via Mesiano 77,
>>> 38050 Povo(TN), Italy
>>> Tel: +39 0461/881940
>>> Fax: +39 0461/882628
>>>
>>>
>>> -------------------------------------------------------------------- 
>>> -
>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>> For additional commands, e-mail: chilli-help at coova.org
>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
> -- 
> Ivano Cristofolini
> Presidio Informatico Ingegneria
> Direzione Informatica e Telecomunicazioni
> Universita' degli Studi di Trento
> Via Mesiano 77,
> 38050 Povo(TN), Italy
> Tel: +39 0461/881940
> Fax: +39 0461/882628<httpproxy.patch>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4



From Ivano.Cristofolini at ing.unitn.it  Wed May 21 11:37:47 2008
From: Ivano.Cristofolini at ing.unitn.it (Ivano Cristofolini)
Date: Wed, 21 May 2008 13:37:47 +0200
Subject: handle initial requests to http proxy
In-Reply-To: <2CA221C7-6800-4849-BF58-1B1B8B0F9C3C@mac.com>
References: <1210938853.3146.67.camel@azathoth.ing.unitn.it>
	 <1210947966.3146.74.camel@azathoth.ing.unitn.it>
	 <EA05D815-626F-4026-AEE8-C9F0C127AA8D@mac.com>
	 <1211357459.19347.26.camel@azathoth.ing.unitn.it>
	 <2CA221C7-6800-4849-BF58-1B1B8B0F9C3C@mac.com>
Message-ID: <1211369867.19347.106.camel@azathoth.ing.unitn.it>

Actually, I'm using a proxy.pac that returns DIRECT for servers inside
my domain, registered uamserver/chilli in DNS and trivially modified
hotspotlogin.cgi so that inside prelogin/logoff/... URLs a FQHN appears
instead of an IP number.

To handle de-proxying, I think that a separate optional service would be
nicer than adding complexity to existing code. Initial requests to
proxies should be NATted to this service, which should rewrite the
requests as "normal" http connections starting from the client. Being
modular this way, it could possibly work with any captive portal.

Ivano

On Wed, 2008-05-21 at 10:29 +0200, wlan at mac.com wrote:
> So, in your browser, you have it configured to use a proxy for all  
> sites except the explicitly configured uam and chilli server? Yeah,  
> that wouldn't be very useful generally, I would think. I suppose it  
> is also possible to have chilli support the proxy URL format in  
> redir_getreq() which might help. Seeing your use of 'http_port' makes  
> me think it could be an option to have chilli 'redirect' on a list of  
> ports. It has also been brewing in the back of my head to try out  
> some minimal content filtering for http traffic which could "de- 
> proxy" a request pre-authentication and perhaps do a "captive-frame"  
> without the need of an external privoxy. Oh, so little time..
> 
> 
> On May 21, 2008, at 10:10 AM, Ivano Cristofolini wrote:
> 
> > OK, here it is quick'n'dirty (port number is hard-coded, etc.). It's
> > important to note that browsers must not use a proxy for uamserver and
> > authentication server; otherwise login will not work.
> > It is probably not terribly useful in general: I needed it to keep
> > previous browser settings for a wired network still working on the  
> > wifi.
> >
> > Ivano
> >
> > --- old_dhcp.h	2008-05-19 09:21:33.000000000 +0200
> > +++ dhcp.h	2008-05-19 10:16:04.000000000 +0200
> > @@ -56,6 +56,7 @@
> >  /* TCP Ports */
> >  #define DHCP_HTTP   80
> >  #define DHCP_HTTPS 443
> > +#define DHCP_HTTPPROXY 3128
> >
> >
> >  #define DHCP_ARP_REQUEST 1
> > @@ -99,6 +100,7 @@
> >    int nextdnat;                /* Next location to use for DNAT */
> >    uint32_t dnatip[DHCP_DNAT_MAX]; /* Destination NAT destination IP
> > address */
> >    uint16_t dnatport[DHCP_DNAT_MAX]; /* Destination NAT source port */
> > +  uint16_t http_port;               /* Original (pre-NAT) destination
> > port */
> >    uint8_t dnatmac[DHCP_DNAT_MAX][PKT_ETH_ALEN]; /* Destination NAT
> > source mac */
> >  /*  uint16_t mtu;                 Maximum transfer unit */
> >  };
> > --- old_dhcp.c	2008-05-19 09:21:40.000000000 +0200
> > +++ dhcp.c	2008-05-19 09:32:42.000000000 +0200
> > @@ -1245,7 +1245,8 @@
> >    /* Was it a http request for another server? */
> >    /* We are changing dest IP and dest port to local UAM server */
> >    if ((pack->iph.protocol == PKT_IP_PROTO_TCP) &&
> > -      (tcph->dst == htons(DHCP_HTTP))) {
> > +      ((tcph->dst == htons(DHCP_HTTP)) ||
> > +       (tcph->dst == htons(DHCP_HTTPPROXY)))) {
> >      int n;
> >      int pos=-1;
> >      for (n=0; n<DHCP_DNAT_MAX; n++) {
> > @@ -1260,6 +1261,7 @@
> >  	memcpy(conn->dnatmac[conn->nextdnat], pack->ethh.dst, PKT_ETH_ALEN);
> >        conn->dnatip[conn->nextdnat] = pack->iph.daddr;
> >        conn->dnatport[conn->nextdnat] = tcph->src;
> > +      conn->http_port = tcph->dst;
> >        conn->nextdnat = (conn->nextdnat + 1) % DHCP_DNAT_MAX;
> >      }
> >
> > @@ -1420,7 +1422,7 @@
> >  	if (options.usetap)
> >  	  memcpy(pack->ethh.src, conn->dnatmac[n], PKT_ETH_ALEN);
> >  	pack->iph.saddr = conn->dnatip[n];
> > -	tcph->src = htons(DHCP_HTTP);
> > +	tcph->src = conn->http_port;
> >
> >  	dhcp_tcp_check(pack, len);
> >  	dhcp_ip_check(pack);
> > --- old_redir.c	2008-05-19 09:22:03.000000000 +0200
> > +++ redir.c	2008-05-19 14:52:03.000000000 +0200
> > @@ -1124,7 +1124,6 @@
> >
> >  	while (*p1 == ' ') p1++; /* Advance through additional white  
> > space */
> >  	if (*p1 == '/') p1++;
> > -	else return -1;
> >  	
> >  	/* The path ends with a ? or a space */
> >  	p2 = strchr(p1, '?');
> > @@ -1321,9 +1320,16 @@
> >    default:
> >      {
> >        /* some basic checks for urls we don't care about */
> > -
> > -      snprintf(conn->state.redir.userurl,
> > sizeof(conn->state.redir.userurl), "http://%s/%s%s%s",
> > -	       host, path, qs[0] ? "?" : "", qs[0] ? qs : "");
> > +
> > +      /* if GET was for an http proxy then the path starts with
> > http://host */
> > +      if (!strncmp(path, "http://", 7)) {
> > +          snprintf(conn->state.redir.userurl,
> > sizeof(conn->state.redir.userurl), "%s%s%s",
> > +               path, qs[0] ? "?" : "", qs[0] ? qs : "");
> > +      }
> > +      else {
> > +          snprintf(conn->state.redir.userurl,
> > sizeof(conn->state.redir.userurl), "http://%s/%s%s%s",
> > +               host, path, qs[0] ? "?" : "", qs[0] ? qs : "");
> > +      }
> >
> >        if (optionsdebug)
> >  	log_dbg("-->> Setting userurl=[%s]",conn->state.redir.userurl);
> >
> >
> > On Sat, 2008-05-17 at 09:21 +0200, wlan at mac.com wrote:
> >> Working contributions are welcome!
> >>
> >> On May 16, 2008, at 4:26 PM, Ivano Cristofolini wrote:
> >>
> >>> just solved it by myself, sorry for the bother.
> >>>
> >>> Ivano
> >>>
> >>> On Fri, 2008-05-16 at 13:54 +0200, Ivano Cristofolini wrote:
> >>>> Hello,
> >>>>
> >>>> I need to modify coova-chilli to capture http requests directed  
> >>>> to a
> >>>> (NON transparent) http proxy running on port 3128 (keeping current
> >>>> functionality as well).
> >>>>
> >>>> I have successfully modified the http parsing functions in redir.c
> >>>> (very
> >>>> simple: only redirurl changes).
> >>>>
> >>>> I'm trying to modify the DNAT routines in dhcp.c so that  
> >>>> requests to
> >>>> port 3128 are handled in the same way as regular requests to http
> >>>> servers (i.e. they are NATted to uamserver).
> >>>>
> >>>> This is easy for dhcp_doDNAT() (I added the last line):
> >>>>
> >>>> ...
> >>>>   /* Was it a http request for another server? */
> >>>>   /* We are changing dest IP and dest port to local UAM server */
> >>>>   if ((pack->iph.protocol == PKT_IP_PROTO_TCP) &&
> >>>>       ((tcph->dst == htons(DHCP_HTTP)) ||
> >>>>        (tcph->dst == htons(3128)))) {
> >>>> ...
> >>>>
> >>>> I don't know how to do it for dhcp_undoDNAT().
> >>>>
> >>>> ...
> >>>> /* Was it a reply from redir server? */
> >>>> ...
> >>>> if (something???) {
> >>>>   tcph->src = htons(DHCP_HTTP);
> >>>> else
> >>>>   tcph->src = htons(3128);
> >>>> ...
> >>>>
> >>>> Any suggestions?
> >>>>
> >>> -- 
> >>> Ivano Cristofolini
> >>> Presidio Informatico Ingegneria
> >>> Direzione Informatica e Telecomunicazioni
> >>> Universita' degli Studi di Trento
> >>> Via Mesiano 77,
> >>> 38050 Povo(TN), Italy
> >>> Tel: +39 0461/881940
> >>> Fax: +39 0461/882628
> >>>
> >>>
> >>> -------------------------------------------------------------------- 
> >>> -
> >>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> >>> For additional commands, e-mail: chilli-help at coova.org
> >>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> >>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
> >>>
> >>
> >>
> >> ---------------------------------------------------------------------
> >> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> >> For additional commands, e-mail: chilli-help at coova.org
> >> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> >> Forum: http://coova.org/phpBB3/viewforum.php?f=4
> >>
> > -- 
> > Ivano Cristofolini
> > Presidio Informatico Ingegneria
> > Direzione Informatica e Telecomunicazioni
> > Universita' degli Studi di Trento
> > Via Mesiano 77,
> > 38050 Povo(TN), Italy
> > Tel: +39 0461/881940
> > Fax: +39 0461/882628<httpproxy.patch>
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> > For additional commands, e-mail: chilli-help at coova.org
> > Wiki: http://coova.org/wiki/index.php/CoovaChilli
> > Forum: http://coova.org/phpBB3/viewforum.php?f=4
> 
> 
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
> 
-- 
Ivano Cristofolini
Presidio Informatico Ingegneria
Direzione Informatica e Telecomunicazioni
Universita' degli Studi di Trento
Via Mesiano 77,
38050 Povo(TN), Italy
Tel: +39 0461/881940
Fax: +39 0461/882628



From liran.tal at gmail.com  Mon May 26 18:32:12 2008
From: liran.tal at gmail.com (Liran Tal)
Date: Mon, 26 May 2008 21:32:12 +0300
Subject: Chillispot Attributes
Message-ID: <81237f640805261132j5be9a1d8pbdd69d450e480112@mail.gmail.com>

Hey David,

About the Chillispot attributes in the dictionary.
Can you confirm the following - all of them should go into radreply with
operator :=

Thanks




-- 
-- 
Sincerely, Liran Tal

Research and Development
Linux Team - Enginx.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080526/59da8fab/attachment.htm>

From oguzhank at bilkent.edu.tr  Tue May 27 15:14:17 2008
From: oguzhank at bilkent.edu.tr (Oguzhan Kayhan)
Date: Tue, 27 May 2008 18:14:17 +0300 (EEST)
Subject: total data transfer size
Message-ID: <40103.139.179.14.250.1211901257.squirrel@webmail.bilkent.edu.tr>

Hello all,
I'm both using chilli in some linux servers on a wired configuration and
also using coovaap in some wireless areas..
I didnt still tested this on coova but, what i noticed is (on chilli),
when i am checking the amount of upload/download traffics of users on
chilli config over mysql,
the data increases as 2.7gb 2.8 gb 2.9gb and suddenly it drops down to
2.2gb and goes on to increase again.. numbers are just examples, point is,
the amount of data suddenly decreases in some random intervals.. thats why
i can not believe if it is the real amount or not...
What might be the cause for this...
Is it a known problem for chilli and maybe solved in coova? or am i the
only person having this...




From henk at skyrove.com  Tue May 27 15:19:05 2008
From: henk at skyrove.com (Henk Kleynhans)
Date: Tue, 27 May 2008 17:19:05 +0200
Subject: total data transfer size
In-Reply-To: <40103.139.179.14.250.1211901257.squirrel@webmail.bilkent.edu.tr>
References: <40103.139.179.14.250.1211901257.squirrel@webmail.bilkent.edu.tr>
Message-ID: <d42f029a0805270819o55ce369ex97d9177d4041820d@mail.gmail.com>

Hi Oguzhan,

The numbers might actually be relevant.

It might signify that you're using AcctOutputOctets only, instead of
combining them with AcctOutputGigawords.

Which brings me to another question: Why on earth does Coova reverse
InputOctets and OutputOctets when compared with Chillispot?

Henk


On Tue, May 27, 2008 at 5:14 PM, Oguzhan Kayhan <oguzhank at bilkent.edu.tr>
wrote:

> Hello all,
> I'm both using chilli in some linux servers on a wired configuration and
> also using coovaap in some wireless areas..
> I didnt still tested this on coova but, what i noticed is (on chilli),
> when i am checking the amount of upload/download traffics of users on
> chilli config over mysql,
> the data increases as 2.7gb 2.8 gb 2.9gb and suddenly it drops down to
> 2.2gb and goes on to increase again.. numbers are just examples, point is,
> the amount of data suddenly decreases in some random intervals.. thats why
> i can not believe if it is the real amount or not...
> What might be the cause for this...
> Is it a known problem for chilli and maybe solved in coova? or am i the
> only person having this...
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>


-- 
Henk Kleynhans
Skyrove (Pty) Ltd
Technology Top 100 - Most Promising Emerging Enterprise 2006
Tel: +27 (21) 4488843
Cell: +27 (84) 3073451
Fax: +27 (86) 6204077
henk at skyrove.com
blog: www.yeahfi.com

------

"A person with ubuntu is open and available to others, affirming of others,
does not feel threatened that others are able and good, for he or she has a
proper self-assurance that comes from knowing that he or she belongs in a
greater whole and is diminished when others are humiliated or diminished,
when others are tortured or oppressed." - Desmond Tutu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080527/7d6619f3/attachment.htm>

From oguzhank at bilkent.edu.tr  Tue May 27 15:24:24 2008
From: oguzhank at bilkent.edu.tr (Oguzhan Kayhan)
Date: Tue, 27 May 2008 18:24:24 +0300 (EEST)
Subject: total data transfer size
In-Reply-To: <d42f029a0805270819o55ce369ex97d9177d4041820d@mail.gmail.com>
References: <40103.139.179.14.250.1211901257.squirrel@webmail.bilkent.edu.tr>
    <d42f029a0805270819o55ce369ex97d9177d4041820d@mail.gmail.com>
Message-ID: <43134.139.179.14.250.1211901864.squirrel@webmail.bilkent.edu.tr>

Hello Henk,

Yes i am using only AcctInputOctets and OutputOctets.
Im even not sure what is gigawords parameter :)
I thnk it is only a feature of coova right?

> Hi Oguzhan,
>
> The numbers might actually be relevant.
>
> It might signify that you're using AcctOutputOctets only, instead of
> combining them with AcctOutputGigawords.
>
> Which brings me to another question: Why on earth does Coova reverse
> InputOctets and OutputOctets when compared with Chillispot?
>
> Henk
>
>
> On Tue, May 27, 2008 at 5:14 PM, Oguzhan Kayhan <oguzhank at bilkent.edu.tr>
> wrote:
>
>> Hello all,
>> I'm both using chilli in some linux servers on a wired configuration and
>> also using coovaap in some wireless areas..
>> I didnt still tested this on coova but, what i noticed is (on chilli),
>> when i am checking the amount of upload/download traffics of users on
>> chilli config over mysql,
>> the data increases as 2.7gb 2.8 gb 2.9gb and suddenly it drops down to
>> 2.2gb and goes on to increase again.. numbers are just examples, point
>> is,
>> the amount of data suddenly decreases in some random intervals.. thats
>> why
>> i can not believe if it is the real amount or not...
>> What might be the cause for this...
>> Is it a known problem for chilli and maybe solved in coova? or am i the
>> only person having this...
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>>
>
>
> --
> Henk Kleynhans
> Skyrove (Pty) Ltd
> Technology Top 100 - Most Promising Emerging Enterprise 2006
> Tel: +27 (21) 4488843
> Cell: +27 (84) 3073451
> Fax: +27 (86) 6204077
> henk at skyrove.com
> blog: www.yeahfi.com
>
> ------
>
> "A person with ubuntu is open and available to others, affirming of
> others,
> does not feel threatened that others are able and good, for he or she has
> a
> proper self-assurance that comes from knowing that he or she belongs in a
> greater whole and is diminished when others are humiliated or diminished,
> when others are tortured or oppressed." - Desmond Tutu
>




From oguzhank at bilkent.edu.tr  Tue May 27 15:26:38 2008
From: oguzhank at bilkent.edu.tr (Oguzhan Kayhan)
Date: Tue, 27 May 2008 18:26:38 +0300 (EEST)
Subject: total data transfer size
In-Reply-To: 
     <43134.139.179.14.250.1211901864.squirrel@webmail.bilkent.edu.tr>
References: <40103.139.179.14.250.1211901257.squirrel@webmail.bilkent.edu.tr>
    <d42f029a0805270819o55ce369ex97d9177d4041820d@mail.gmail.com>
    <43134.139.179.14.250.1211901864.squirrel@webmail.bilkent.edu.tr>
Message-ID: <33336.139.179.14.250.1211901998.squirrel@webmail.bilkent.edu.tr>

Edit for my previous message..
I googled and figured out whats gigawords..
Sure if i was using gigawords it might be normal for loosing some counters
after reaching to 4 gb data..



> Hello Henk,
>
> Yes i am using only AcctInputOctets and OutputOctets.
> Im even not sure what is gigawords parameter :)
> I thnk it is only a feature of coova right?
>
>> Hi Oguzhan,
>>
>> The numbers might actually be relevant.
>>
>> It might signify that you're using AcctOutputOctets only, instead of
>> combining them with AcctOutputGigawords.
>>
>> Which brings me to another question: Why on earth does Coova reverse
>> InputOctets and OutputOctets when compared with Chillispot?
>>
>> Henk
>>
>>
>> On Tue, May 27, 2008 at 5:14 PM, Oguzhan Kayhan
>> <oguzhank at bilkent.edu.tr>
>> wrote:
>>
>>> Hello all,
>>> I'm both using chilli in some linux servers on a wired configuration
>>> and
>>> also using coovaap in some wireless areas..
>>> I didnt still tested this on coova but, what i noticed is (on chilli),
>>> when i am checking the amount of upload/download traffics of users on
>>> chilli config over mysql,
>>> the data increases as 2.7gb 2.8 gb 2.9gb and suddenly it drops down to
>>> 2.2gb and goes on to increase again.. numbers are just examples, point
>>> is,
>>> the amount of data suddenly decreases in some random intervals.. thats
>>> why
>>> i can not believe if it is the real amount or not...
>>> What might be the cause for this...
>>> Is it a known problem for chilli and maybe solved in coova? or am i the
>>> only person having this...
>>>
>>>
>>>
>>> ---------------------------------------------------------------------
>>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>>> For additional commands, e-mail: chilli-help at coova.org
>>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>>
>>>
>>
>>
>> --
>> Henk Kleynhans
>> Skyrove (Pty) Ltd
>> Technology Top 100 - Most Promising Emerging Enterprise 2006
>> Tel: +27 (21) 4488843
>> Cell: +27 (84) 3073451
>> Fax: +27 (86) 6204077
>> henk at skyrove.com
>> blog: www.yeahfi.com
>>
>> ------
>>
>> "A person with ubuntu is open and available to others, affirming of
>> others,
>> does not feel threatened that others are able and good, for he or she
>> has
>> a
>> proper self-assurance that comes from knowing that he or she belongs in
>> a
>> greater whole and is diminished when others are humiliated or
>> diminished,
>> when others are tortured or oppressed." - Desmond Tutu
>>
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>




From liran.tal at gmail.com  Tue May 27 20:31:26 2008
From: liran.tal at gmail.com (Liran Tal)
Date: Tue, 27 May 2008 23:31:26 +0300
Subject: total data transfer size
In-Reply-To: <33336.139.179.14.250.1211901998.squirrel@webmail.bilkent.edu.tr>
References: <40103.139.179.14.250.1211901257.squirrel@webmail.bilkent.edu.tr>
	 <d42f029a0805270819o55ce369ex97d9177d4041820d@mail.gmail.com>
	 <43134.139.179.14.250.1211901864.squirrel@webmail.bilkent.edu.tr>
	 <33336.139.179.14.250.1211901998.squirrel@webmail.bilkent.edu.tr>
Message-ID: <81237f640805271331g3fceec05pfadd386bfc872995@mail.gmail.com>

Hey Oguzhan,

On Tue, May 27, 2008 at 6:26 PM, Oguzhan Kayhan <oguzhank at bilkent.edu.tr>
wrote:

> Edit for my previous message..
> I googled and figured out whats gigawords..
> Sure if i was using gigawords it might be normal for loosing some counters
> after reaching to 4 gb data..
>
>
It's actually the other way around, if you do NOT use gigawords then you can
expect
the numbers to crunch, overlap the 32bit limit and continue from a different
point.
It's not related to Coova or Chillispot really, it's a matter of how you
store accounting
packets in MySQL. So set it up with Gigawords and you should be ok.

Goodluck,
Liran Tal.





> > Hello Henk,
> >
> > Yes i am using only AcctInputOctets and OutputOctets.
> > Im even not sure what is gigawords parameter :)
> > I thnk it is only a feature of coova right?
> >
> >> Hi Oguzhan,
> >>
> >> The numbers might actually be relevant.
> >>
> >> It might signify that you're using AcctOutputOctets only, instead of
> >> combining them with AcctOutputGigawords.
> >>
> >> Which brings me to another question: Why on earth does Coova reverse
> >> InputOctets and OutputOctets when compared with Chillispot?
> >>
> >> Henk
> >>
> >>
> >> On Tue, May 27, 2008 at 5:14 PM, Oguzhan Kayhan
> >> <oguzhank at bilkent.edu.tr>
> >> wrote:
> >>
> >>> Hello all,
> >>> I'm both using chilli in some linux servers on a wired configuration
> >>> and
> >>> also using coovaap in some wireless areas..
> >>> I didnt still tested this on coova but, what i noticed is (on chilli),
> >>> when i am checking the amount of upload/download traffics of users on
> >>> chilli config over mysql,
> >>> the data increases as 2.7gb 2.8 gb 2.9gb and suddenly it drops down to
> >>> 2.2gb and goes on to increase again.. numbers are just examples, point
> >>> is,
> >>> the amount of data suddenly decreases in some random intervals.. thats
> >>> why
> >>> i can not believe if it is the real amount or not...
> >>> What might be the cause for this...
> >>> Is it a known problem for chilli and maybe solved in coova? or am i the
> >>> only person having this...
> >>>
> >>>
> >>>
> >>> ---------------------------------------------------------------------
> >>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> >>> For additional commands, e-mail: chilli-help at coova.org
> >>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> >>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
> >>>
> >>>
> >>
> >>
> >> --
> >> Henk Kleynhans
> >> Skyrove (Pty) Ltd
> >> Technology Top 100 - Most Promising Emerging Enterprise 2006
> >> Tel: +27 (21) 4488843
> >> Cell: +27 (84) 3073451
> >> Fax: +27 (86) 6204077
> >> henk at skyrove.com
> >> blog: www.yeahfi.com
> >>
> >> ------
> >>
> >> "A person with ubuntu is open and available to others, affirming of
> >> others,
> >> does not feel threatened that others are able and good, for he or she
> >> has
> >> a
> >> proper self-assurance that comes from knowing that he or she belongs in
> >> a
> >> greater whole and is diminished when others are humiliated or
> >> diminished,
> >> when others are tortured or oppressed." - Desmond Tutu
> >>
> >
> >
> >
> > ---------------------------------------------------------------------
> > To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> > For additional commands, e-mail: chilli-help at coova.org
> > Wiki: http://coova.org/wiki/index.php/CoovaChilli
> > Forum: http://coova.org/phpBB3/viewforum.php?f=4
> >
> >
>
>
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
> For additional commands, e-mail: chilli-help at coova.org
> Wiki: http://coova.org/wiki/index.php/CoovaChilli
> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>
>


-- 
-- 
Sincerely, Liran Tal

Research and Development
Linux Team - Enginx.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080527/d0a3a618/attachment.htm>

From henk at skyrove.com  Tue May 27 20:33:30 2008
From: henk at skyrove.com (Henk Kleynhans)
Date: Tue, 27 May 2008 22:33:30 +0200
Subject: total data transfer size
In-Reply-To: <81237f640805271331g3fceec05pfadd386bfc872995@mail.gmail.com>
References: <40103.139.179.14.250.1211901257.squirrel@webmail.bilkent.edu.tr>
	 <d42f029a0805270819o55ce369ex97d9177d4041820d@mail.gmail.com>
	 <43134.139.179.14.250.1211901864.squirrel@webmail.bilkent.edu.tr>
	 <33336.139.179.14.250.1211901998.squirrel@webmail.bilkent.edu.tr>
	 <81237f640805271331g3fceec05pfadd386bfc872995@mail.gmail.com>
Message-ID: <d42f029a0805271333q500b82d6pc012d0430f9f3cb7@mail.gmail.com>

You beat me to it Liran :-)

There you have it Oguzhan!



On Tue, May 27, 2008 at 10:31 PM, Liran Tal <liran.tal at gmail.com> wrote:

> Hey Oguzhan,
>
> On Tue, May 27, 2008 at 6:26 PM, Oguzhan Kayhan <oguzhank at bilkent.edu.tr>
> wrote:
>
>> Edit for my previous message..
>> I googled and figured out whats gigawords..
>> Sure if i was using gigawords it might be normal for loosing some counters
>> after reaching to 4 gb data..
>>
>>
> It's actually the other way around, if you do NOT use gigawords then you
> can expect
> the numbers to crunch, overlap the 32bit limit and continue from a
> different point.
> It's not related to Coova or Chillispot really, it's a matter of how you
> store accounting
> packets in MySQL. So set it up with Gigawords and you should be ok.
>
> Goodluck,
> Liran Tal.
>
>
>
>
>
>> > Hello Henk,
>> >
>> > Yes i am using only AcctInputOctets and OutputOctets.
>> > Im even not sure what is gigawords parameter :)
>> > I thnk it is only a feature of coova right?
>> >
>> >> Hi Oguzhan,
>> >>
>> >> The numbers might actually be relevant.
>> >>
>> >> It might signify that you're using AcctOutputOctets only, instead of
>> >> combining them with AcctOutputGigawords.
>> >>
>> >> Which brings me to another question: Why on earth does Coova reverse
>> >> InputOctets and OutputOctets when compared with Chillispot?
>> >>
>> >> Henk
>> >>
>> >>
>> >> On Tue, May 27, 2008 at 5:14 PM, Oguzhan Kayhan
>> >> <oguzhank at bilkent.edu.tr>
>> >> wrote:
>> >>
>> >>> Hello all,
>> >>> I'm both using chilli in some linux servers on a wired configuration
>> >>> and
>> >>> also using coovaap in some wireless areas..
>> >>> I didnt still tested this on coova but, what i noticed is (on chilli),
>> >>> when i am checking the amount of upload/download traffics of users on
>> >>> chilli config over mysql,
>> >>> the data increases as 2.7gb 2.8 gb 2.9gb and suddenly it drops down to
>> >>> 2.2gb and goes on to increase again.. numbers are just examples, point
>> >>> is,
>> >>> the amount of data suddenly decreases in some random intervals.. thats
>> >>> why
>> >>> i can not believe if it is the real amount or not...
>> >>> What might be the cause for this...
>> >>> Is it a known problem for chilli and maybe solved in coova? or am i
>> the
>> >>> only person having this...
>> >>>
>> >>>
>> >>>
>> >>> ---------------------------------------------------------------------
>> >>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> >>> For additional commands, e-mail: chilli-help at coova.org
>> >>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> >>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>> >>>
>> >>>
>> >>
>> >>
>> >> --
>> >> Henk Kleynhans
>> >> Skyrove (Pty) Ltd
>> >> Technology Top 100 - Most Promising Emerging Enterprise 2006
>> >> Tel: +27 (21) 4488843
>> >> Cell: +27 (84) 3073451
>> >> Fax: +27 (86) 6204077
>> >> henk at skyrove.com
>> >> blog: www.yeahfi.com
>> >>
>> >> ------
>> >>
>> >> "A person with ubuntu is open and available to others, affirming of
>> >> others,
>> >> does not feel threatened that others are able and good, for he or she
>> >> has
>> >> a
>> >> proper self-assurance that comes from knowing that he or she belongs in
>> >> a
>> >> greater whole and is diminished when others are humiliated or
>> >> diminished,
>> >> when others are tortured or oppressed." - Desmond Tutu
>> >>
>> >
>> >
>> >
>> > ---------------------------------------------------------------------
>> > To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> > For additional commands, e-mail: chilli-help at coova.org
>> > Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> > Forum: http://coova.org/phpBB3/viewforum.php?f=4
>> >
>> >
>>
>>
>>
>> ---------------------------------------------------------------------
>> To unsubscribe, e-mail: chilli-unsubscribe at coova.org
>> For additional commands, e-mail: chilli-help at coova.org
>> Wiki: http://coova.org/wiki/index.php/CoovaChilli
>> Forum: http://coova.org/phpBB3/viewforum.php?f=4
>>
>>
>
>
> --
> --
> Sincerely, Liran Tal
>
> Research and Development
> Linux Team - Enginx.com




-- 
Henk Kleynhans
Skyrove (Pty) Ltd
Technology Top 100 - Most Promising Emerging Enterprise 2006
Tel: +27 (21) 4488843
Cell: +27 (84) 3073451
Fax: +27 (86) 6204077
henk at skyrove.com
blog: www.yeahfi.com

------

"A person with ubuntu is open and available to others, affirming of others,
does not feel threatened that others are able and good, for he or she has a
proper self-assurance that comes from knowing that he or she belongs in a
greater whole and is diminished when others are humiliated or diminished,
when others are tortured or oppressed." - Desmond Tutu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080527/28604f8a/attachment.htm>

From wlan at mac.com  Wed May 28 04:41:48 2008
From: wlan at mac.com (wlan at mac.com)
Date: Wed, 28 May 2008 06:41:48 +0200
Subject: total data transfer size
In-Reply-To: <d42f029a0805270819o55ce369ex97d9177d4041820d@mail.gmail.com>
References: <40103.139.179.14.250.1211901257.squirrel@webmail.bilkent.edu.tr>
 <d42f029a0805270819o55ce369ex97d9177d4041820d@mail.gmail.com>
Message-ID: <9D89745B-8CC4-4181-BEC5-D483B08C30E2@mac.com>

> It might signify that you're using AcctOutputOctets only, instead  
> of combining them with AcctOutputGigawords.
>

Indeed. Integers in RADIUS are unsigned 32bit. This leaves room for  
integers between 0 and 4,294,967,295. I believe there was also an  
issue in earlier chillispot versions where internally the octets were  
counted on signed integers, reducing the max (positive) value by  
half. CoovaChilli now uses an unsigned 64bit value of which the upper  
32bits are put in giga attributes (if needed).

> Which brings me to another question: Why on earth does Coova  
> reverse InputOctets and OutputOctets when compared with Chillispot?
>

Regrettable, yes. But, not without reason. It's just at the time the  
motivation was  compatibility with commercial hotspot gear we were  
using. You can always go back with the option 'swapoctets'. See:

http://coova.org/wiki/index.php/CoovaChilli/RADIUS

David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080528/9786b337/attachment.htm>

From wlan at mac.com  Wed May 28 04:54:49 2008
From: wlan at mac.com (wlan at mac.com)
Date: Wed, 28 May 2008 06:54:49 +0200
Subject: Chillispot Attributes
In-Reply-To: <81237f640805261132j5be9a1d8pbdd69d450e480112@mail.gmail.com>
References: <81237f640805261132j5be9a1d8pbdd69d450e480112@mail.gmail.com>
Message-ID: <F4CE11E8-1846-4895-B2A9-28279D35D73E@mac.com>

Hi Liran,

Sorry for the delay... is your question really: are all attributes  
only expected once in the packet?

The answer depends on the attribute... For most, yes, they are only  
expected once. Others, like the ChilliSpot-Config attribute in an  
Authoritative-User login is expected multiple times. CoovaChilli also  
allows for "attribute fragmentation" in some circumstances -- where  
you might, for example, have to split up a really long URL into  
multiple attributes.

David

On May 26, 2008, at 8:32 PM, Liran Tal wrote:

> Hey David,
>
> About the Chillispot attributes in the dictionary.
> Can you confirm the following - all of them should go into radreply  
> with operator :=
>
> Thanks
>
>
>
>
> -- 
> -- 
> Sincerely, Liran Tal
>
> Research and Development
> Linux Team - Enginx.com



From oguzhank at bilkent.edu.tr  Wed May 28 06:22:23 2008
From: oguzhank at bilkent.edu.tr (Oguzhan Kayhan)
Date: Wed, 28 May 2008 09:22:23 +0300 (EEST)
Subject: total data transfer size
In-Reply-To: <9D89745B-8CC4-4181-BEC5-D483B08C30E2@mac.com>
References: <40103.139.179.14.250.1211901257.squirrel@webmail.bilkent.edu.tr>
    <d42f029a0805270819o55ce369ex97d9177d4041820d@mail.gmail.com>
    <9D89745B-8CC4-4181-BEC5-D483B08C30E2@mac.com>
Message-ID: <40111.139.179.14.250.1211955743.squirrel@webmail.bilkent.edu.tr>

>> It might signify that you're using AcctOutputOctets only, instead
>> of combining them with AcctOutputGigawords.
>>
>
> Indeed. Integers in RADIUS are unsigned 32bit. This leaves room for
> integers between 0 and 4,294,967,295. I believe there was also an
> issue in earlier chillispot versions where internally the octets were
> counted on signed integers, reducing the max (positive) value by
> half. CoovaChilli now uses an unsigned 64bit value of which the upper
> 32bits are put in giga attributes (if needed).
>


So, i found a webpage describing to combine octets with gigawords,
for a crosscheck i wonder if the following is enough for using gigawords..

Adding the following to mysql.

ALTER TABLE radacct CHANGE AcctInputOctets AcctInputOctets BIGINT(20);
ALTER TABLE radacct CHANGE AcctOutputOctets AcctOutputOctets BIGINT(20);

And replacing '%{Acct-Input-Octets}'  in sql.conf with
'%{Acct-Input-Gigawords:-0}'  << 32 | '%{Acct-Input-Octets:-0}'

(and also outpout octets too)

Or do i have to do smthing more?

Or should i follow a different way?



>> Which brings me to another question: Why on earth does Coova
>> reverse InputOctets and OutputOctets when compared with Chillispot?
>>
>
> Regrettable, yes. But, not without reason. It's just at the time the
> motivation was  compatibility with commercial hotspot gear we were
> using. You can always go back with the option 'swapoctets'. See:
>
> http://coova.org/wiki/index.php/CoovaChilli/RADIUS
>
> David
>




From info at ollisnet.de  Wed May 28 06:46:49 2008
From: info at ollisnet.de (Oliver Hinckel)
Date: Wed, 28 May 2008 08:46:49 +0200
Subject: total data transfer size
In-Reply-To: <40111.139.179.14.250.1211955743.squirrel@webmail.bilkent.edu.tr>
References: <40103.139.179.14.250.1211901257.squirrel@webmail.bilkent.edu.tr>    <d42f029a0805270819o55ce369ex97d9177d4041820d@mail.gmail.com>    <9D89745B-8CC4-4181-BEC5-D483B08C30E2@mac.com> <40111.139.179.14.250.1211955743.squirrel@webmail.bilkent.edu.tr>
Message-ID: <483CFFD9.3080501@ollisnet.de>

Oguzhan Kayhan wrote on 05/28/2008 08:22 AM:
>>> It might signify that you're using AcctOutputOctets only, instead
>>> of combining them with AcctOutputGigawords.
>>>
>> Indeed. Integers in RADIUS are unsigned 32bit. This leaves room for
>> integers between 0 and 4,294,967,295. I believe there was also an
>> issue in earlier chillispot versions where internally the octets were
>> counted on signed integers, reducing the max (positive) value by
>> half. CoovaChilli now uses an unsigned 64bit value of which the upper
>> 32bits are put in giga attributes (if needed).
>>
> 
> 
> So, i found a webpage describing to combine octets with gigawords,
> for a crosscheck i wonder if the following is enough for using gigawords..
> 
> Adding the following to mysql.
> 
> ALTER TABLE radacct CHANGE AcctInputOctets AcctInputOctets BIGINT(20);
> ALTER TABLE radacct CHANGE AcctOutputOctets AcctOutputOctets BIGINT(20);
> 
> And replacing '%{Acct-Input-Octets}'  in sql.conf with
> '%{Acct-Input-Gigawords:-0}'  << 32 | '%{Acct-Input-Octets:-0}'
> 
> (and also outpout octets too)
> 
> Or do i have to do smthing more?
> 
> Or should i follow a different way?

No, that's all. That's also what we did to solve this issue (except we 
used "+" operator instead of "|" operator, but they have the same 
meaning) and it works great :)

- Olli


From murray at skyrove.com  Fri May 30 12:03:54 2008
From: murray at skyrove.com (Murray Long)
Date: Fri, 30 May 2008 14:03:54 +0200
Subject: Starting coova chilli with no internet connection
Message-ID: <56acee400805300503w77d0ba2y7392de33bbf1102e@mail.gmail.com>

I've run into a problem when trying to start coova chilli without an
internet connection:

The chilli startup scripts gradually spawn multiple udhcpc processes (or
pppd depending on connection type)  which drive the load on the router
though the roof and eventually stop it resopnding.

Has anyone else experienced anything similar?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20080530/b072752e/attachment.htm>

From wlan at mac.com  Sat May 31 06:10:19 2008
From: wlan at mac.com (wlan at mac.com)
Date: Sat, 31 May 2008 08:10:19 +0200
Subject: Starting coova chilli with no internet connection
In-Reply-To: <56acee400805300503w77d0ba2y7392de33bbf1102e@mail.gmail.com>
References: <56acee400805300503w77d0ba2y7392de33bbf1102e@mail.gmail.com>
Message-ID: <329CF588-65AC-4CDD-8FA0-02FCCF775855@mac.com>

Yes, there are issues with the auto-start. When chilli can't start,  
the scripts tries to reset the system (turning off chilli) and will  
restart again later. This doesn't play well with long disconnects  
from the Internet. Chilli isn't able to function without being able  
to resolve various configurations (walled garden, uam server, etc),  
so it might as well exit. Do you think it should not try to start  
again? Perhaps with a ping test first...

David


On May 30, 2008, at 2:03 PM, Murray Long wrote:

> I've run into a problem when trying to start coova chilli without  
> an internet connection:
>
> The chilli startup scripts gradually spawn multiple udhcpc  
> processes (or pppd depending on connection type)  which drive the  
> load on the router though the roof and eventually stop it resopnding.
>
> Has anyone else experienced anything similar?
>



From info at ollisnet.de  Sat May 31 22:10:45 2008
From: info at ollisnet.de (Oliver Hinckel)
Date: Sun, 01 Jun 2008 00:10:45 +0200
Subject: dynip/statip IP overflow
Message-ID: <4841CCE5.7000801@ollisnet.de>

Hello,

we're using dynip and statip in our chilli setup and noticed a strange 
behaviour. When clients connect to our access point they'll get a dynip 
from chilli. When another client connects to the access point he'll get 
the next free IP address from the dynip network. That all is OK.

The problem is, that in case a client get's the last free dynip from the 
dynip network and another client connects to the access point, he'll get 
an IP address out of the dynip range.

E.g. we have the following setup
dynip 192.168.174.128/25
statip 192.168.174.0/25

In case a client will get the dynip address 192.168.174.128, the next 
client will get 192.168.175.1. It seems that the IP address is just 
increased by one without checking against the dynip network mask. This 
seems like an "overflow" too me.

Anyone noticed this already? Is there a fix for it?

Thanks for feedback.

Greetings
Oliver Hinckel


