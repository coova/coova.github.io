<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> VPN revisited.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:chilli%40coova.org?Subject=Re%3A%20VPN%20revisited.&In-Reply-To=%3C48AD4A22.2030205%40endian.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000456.html">
   <LINK REL="Next"  HREF="000460.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>VPN revisited.</H1>
    <B>Peter Warasin</B> 
    <A HREF="mailto:chilli%40coova.org?Subject=Re%3A%20VPN%20revisited.&In-Reply-To=%3C48AD4A22.2030205%40endian.com%3E"
       TITLE="VPN revisited.">peter at endian.com
       </A><BR>
    <I>Thu Aug 21 10:57:38 UTC 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000456.html">VPN revisited.
</A></li>
        <LI>Next message: <A HREF="000460.html">VPN revisited.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#459">[ date ]</a>
              <a href="thread.html#459">[ thread ]</a>
              <a href="subject.html#459">[ subject ]</a>
              <a href="author.html#459">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Sevan, hi IanC

Sevan / Venture37 wrote:
&gt;&gt;<i> Yes, its those very kernel modules and iptables rules Im currently
</I>&gt;&gt;<i> wrestling with, to no avail.
</I>
I have exactly the same problem. I narrowed down the problem to chilli, 
at least I think so.

(it's a linux kernel 2.6.22, with pptp netfilter helpers loaded and gre 
and port 1723 allowed)

PPTP is working well passing through the exactly same box when chilli is 
not running. It takes about 2 seconds to connect. connect, disconnect, 
reconnecting, that's all working fine, also with multiple clients and 
different servers.

As soon as i snap in chilli, establishing a PPTP connection takes a very 
very long time (several minutes).
Most of the time there is no chance to connect. Only sometimes, after a 
long handshake period PPTP connects. I think that's pure luck that it 
connects.

I noticed that chilli somehow seems to send out of order duplicates 
through the tun device. At least I see (with wireshark) TCP DUP ACK's 
coming back from the server some packets after the original ACK, which 
causes the client to resend a SYN, which then confuses the protocol.
I see then closing the connection (PSH ACK, FIN ACK, ACK, RST) and 
reconnecting (SYN, SYN ACK, ...).

I am digging deeper into the source code right now in order to debug the 
problem. If someone has advices, please tell me :)

kind regards,

peter

-- 
::<i> e n d i a n
</I>::<i> open source - open minds
</I>
::<i> peter warasin
</I>::<i> <A HREF="http://www.endian.com">http://www.endian.com</A>   :: <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">peter at endian.com</A>
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000456.html">VPN revisited.
</A></li>
	<LI>Next message: <A HREF="000460.html">VPN revisited.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#459">[ date ]</a>
              <a href="thread.html#459">[ thread ]</a>
              <a href="subject.html#459">[ subject ]</a>
              <a href="author.html#459">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">More information about the Chilli
mailing list</a><br>
</body></html>
