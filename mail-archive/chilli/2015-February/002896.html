<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Chilli] Too sharp upload bandwidth limit on 1gbps wired network
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:chilli%40coova.org?Subject=Re%3A%20%5BChilli%5D%20Too%20sharp%20upload%20bandwidth%20limit%20on%201gbps%20wired%20network&In-Reply-To=%3C224842392.61573.1425091022824.JavaMail.yahoo%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002895.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Chilli] Too sharp upload bandwidth limit on 1gbps wired network</H1>
    <B>kl</B> 
    <A HREF="mailto:chilli%40coova.org?Subject=Re%3A%20%5BChilli%5D%20Too%20sharp%20upload%20bandwidth%20limit%20on%201gbps%20wired%20network&In-Reply-To=%3C224842392.61573.1425091022824.JavaMail.yahoo%40mail.yahoo.com%3E"
       TITLE="[Chilli] Too sharp upload bandwidth limit on 1gbps wired network">kl522 at yahoo.com
       </A><BR>
    <I>Sat Feb 28 02:37:02 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002895.html">[Chilli] Chilli Digest, Vol 63, Issue 14
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2896">[ date ]</a>
              <a href="thread.html#2896">[ thread ]</a>
              <a href="subject.html#2896">[ subject ]</a>
              <a href="author.html#2896">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Based on my testing, turn off generic receive offload fixes my issue of too sharp upload bandwidth limit on 1 Gb wired network.

But the strange thing is older kernel has the same setting 'on' and without problem, while newer kernel has to turn it 'off'. 


On Saturday, February 28, 2015 6:01 AM, Richard REY &lt;<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">richard at rexy.fr</A>&gt; wrote:
Yes, but this doesn't explain why there isn't any problem when the flows 
pass through the appliance. this issue is seen only when the TCP flows 
is sent to an internal processes

I'll try to disable packet off-loading next monday.
I'll also try to forbid the &quot;jumbo frame&quot; on NIC

Rexy

Le 27/02/2015 20:50, Alexandru Gheorghe a &#233;crit :
&gt;<i> Usually fragmentation needed means you need to adjust the MTU of your nic.
</I>&gt;<i>
</I>&gt;<i> Alex
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 02/26/2015 02:30 PM, Claus Stjernoe wrote:
</I>&gt;&gt;<i> Hi Richard,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Try to disable packet off-loading on the Gigabit NIC.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Kind regards,
</I>&gt;&gt;<i> Claus
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -----Oprindelig meddelelse-----
</I>&gt;&gt;<i> Fra: <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli-bounces at coova.org</A> [mailto:<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli-bounces at coova.org</A>] P&#229; vegne af <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli-request at coova.org</A>
</I>&gt;&gt;<i> Sendt: 26. februar 2015 13:00
</I>&gt;&gt;<i> Til: <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli at coova.org</A>
</I>&gt;&gt;<i> Emne: Chilli Digest, Vol 63, Issue 14
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Send Chilli mailing list submissions to
</I>&gt;&gt;<i>     <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli at coova.org</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> To subscribe or unsubscribe via the World Wide Web, visit
</I>&gt;&gt;<i>     <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">http://lists.coova.org/cgi-bin/mailman/listinfo/chilli</A>
</I>&gt;&gt;<i> or, via email, send a message with subject or body 'help' to
</I>&gt;&gt;<i>     <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli-request at coova.org</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> You can reach the person managing the list at
</I>&gt;&gt;<i>     <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli-owner at coova.org</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> When replying, please edit your Subject line so it is more specific than &quot;Re: Contents of Chilli digest...&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Today's Topics:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     1. Re: Chilli Digest, Vol 63, Issue 12 (Richard REY)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ----------------------------------------------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Message: 1
</I>&gt;&gt;<i> Date: Wed, 25 Feb 2015 22:48:56 +0100
</I>&gt;&gt;<i> From: Richard REY &lt;<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">richard at rexy.fr</A>&gt;
</I>&gt;&gt;<i> To: <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli at coova.org</A>
</I>&gt;&gt;<i> Subject: Re: [Chilli] Chilli Digest, Vol 63, Issue 12
</I>&gt;&gt;<i> Message-ID: &lt;<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">54EE4348.2090503 at rexy.fr</A>&gt;
</I>&gt;&gt;<i> Content-Type: text/plain; charset=windows-1252; format=flowed
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i> I use COOVA in its last version (SVN revision 492) running on an ALCASAR appliance (mageia 4.1 - kernel 3.14.32), all is OK excepted a flow issue.
</I>&gt;&gt;<i> When a TCP stream goes across the appliance there isn't any flow issue (forward mode). BUT when a TCP stream is sent inside the appliance (to a HTTP proxy for example) the observed flow is very weak (Input mode). The problem is maximal when the card connected to COOVA is in the Gigabit mode.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Our investigation :
</I>&gt;&gt;<i>   From the appliance, we try to download a file located on a FTP server connected on the network controlled by COOVA. Without COOVA the observed flow in gigabit mode is about 888Mb/s whereas with COOVA we can see just
</I>&gt;&gt;<i> 68 Kb/s (YES 68 Kb/s). Regarding the packets exchanged we can see ICMP packets sent by the appliance (Destination unreachable (Fragmentation needed).
</I>&gt;&gt;<i> We found a by-pass ?solution? by fixing the speed of the card to 100Mb/s. At this speed the phenomenon is practically invisible (just one ICMP packet sent) and the flow approaches the maximum supported by the network card. On a virtual machine where we can't fix Ethernet speed, we must choose a 100Mb/s virtual Ethernet card when building the VM.
</I>&gt;&gt;<i> We have the Pcap file of our investigation. I say it again, this issue is seen only when the TCP flows is sent to an internal processes (in 'forward' mode all is ok).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards
</I>&gt;&gt;<i> Rexy &amp; ALCASAR team
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Le 23/02/2015 08:59, kl a ?crit :
</I>&gt;&gt;&gt;<i> I see problem on kernel version &gt; 3.7 right up to 3.10.  Above 3.10 not tested.
</I>&gt;&gt;&gt;<i> However, in the other quoted post, it says kernel 2.6.39 upto 3.3.4. Above that not tested.
</I>&gt;&gt;&gt;<i> Something not consist here.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> So which kernel version you guys are using which are seeing this problem ?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On Monday, February 23, 2015 3:13 PM, Danny Magat &lt;<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">danny at sb-ps.ae</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> This problem is still exist on my setup.
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.coova.org/pipermail/chilli/2013-November/002437.html">http://lists.coova.org/pipermail/chilli/2013-November/002437.html</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I hope that somebody will give us a hint on how to solve this.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Regards,
</I>&gt;&gt;&gt;<i> Danny
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;&gt;<i> From: <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli-bounces at coova.org</A> [mailto:<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli-bounces at coova.org</A>] On
</I>&gt;&gt;&gt;<i> Behalf Of <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli-request at coova.org</A>
</I>&gt;&gt;&gt;<i> Sent: Sunday, February 22, 2015 4:00 PM
</I>&gt;&gt;&gt;<i> To: <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli at coova.org</A>
</I>&gt;&gt;&gt;<i> Subject: Chilli Digest, Vol 63, Issue 12
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Send Chilli mailing list submissions to
</I>&gt;&gt;&gt;<i>      <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli at coova.org</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> To subscribe or unsubscribe via the World Wide Web, visit
</I>&gt;&gt;&gt;<i>      <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">http://lists.coova.org/cgi-bin/mailman/listinfo/chilli</A>
</I>&gt;&gt;&gt;<i> or, via email, send a message with subject or body 'help' to
</I>&gt;&gt;&gt;<i>      <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli-request at coova.org</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> You can reach the person managing the list at
</I>&gt;&gt;&gt;<i>      <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli-owner at coova.org</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> When replying, please edit your Subject line so it is more specific
</I>&gt;&gt;&gt;<i> than
</I>&gt;&gt;&gt;<i> &quot;Re: Contents of Chilli digest...&quot;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Today's Topics:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>      1. Too sharp upload bandwidth limit on 1gbps wired network (kl)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ----------------------------------------------------------------------
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Message: 1
</I>&gt;&gt;&gt;<i> Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
</I>&gt;&gt;&gt;<i> From: kl &lt;<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">kl522 at yahoo.com</A>&gt;
</I>&gt;&gt;&gt;<i> To: Chilli List &lt;<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli at coova.org</A>&gt;
</I>&gt;&gt;&gt;<i> Subject: [Chilli] Too sharp upload bandwidth limit on 1gbps wired
</I>&gt;&gt;&gt;<i>       network
</I>&gt;&gt;&gt;<i> Message-ID:
</I>&gt;&gt;&gt;<i>       &lt;<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com</A>&gt;
</I>&gt;&gt;&gt;<i> Content-Type: text/plain; charset=UTF-8
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Nobody is facing this issue with coova chilli ?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> <A HREF="http://www.coova.org/node/5171">http://www.coova.org/node/5171</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> <A HREF="https://github.com/coova/coova-chilli/issues/32">https://github.com/coova/coova-chilli/issues/32</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Happens only on Gigabit wired network and certain kernel verson.
</I>&gt;&gt;&gt;<i> Applies to 1.2.9, 1.3.0 and other versions ....
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ------------------------------
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Chilli mailing list
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">Chilli at coova.org</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">http://lists.coova.org/cgi-bin/mailman/listinfo/chilli</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> End of Chilli Digest, Vol 63, Issue 12
</I>&gt;&gt;&gt;<i> **************************************
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Chilli mailing list
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">Chilli at coova.org</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">http://lists.coova.org/cgi-bin/mailman/listinfo/chilli</A>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Chilli mailing list
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">Chilli at coova.org</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">http://lists.coova.org/cgi-bin/mailman/listinfo/chilli</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Chilli mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">Chilli at coova.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">http://lists.coova.org/cgi-bin/mailman/listinfo/chilli</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> End of Chilli Digest, Vol 63, Issue 14
</I>
&gt;&gt;<i> **************************************
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Chilli mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">Chilli at coova.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">http://lists.coova.org/cgi-bin/mailman/listinfo/chilli</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Chilli mailing list
</I>&gt;<i> <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">Chilli at coova.org</A>
</I>&gt;<i> <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">http://lists.coova.org/cgi-bin/mailman/listinfo/chilli</A>
</I>&gt;<i>
</I>_______________________________________________
Chilli mailing list
<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">Chilli at coova.org</A>
<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">http://lists.coova.org/cgi-bin/mailman/listinfo/chilli</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002895.html">[Chilli] Chilli Digest, Vol 63, Issue 14
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2896">[ date ]</a>
              <a href="thread.html#2896">[ thread ]</a>
              <a href="subject.html#2896">[ subject ]</a>
              <a href="author.html#2896">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">More information about the Chilli
mailing list</a><br>
</body></html>
