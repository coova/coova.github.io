<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Chilli] Apparent intrusion attempt on AP running	coova-chilli	1.2.9, ways to mitigate?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:chilli%40coova.org?Subject=Re%3A%20%5BChilli%5D%20Apparent%20intrusion%20attempt%20on%20AP%20running%0A%09coova-chilli%091.2.9%2C%20ways%20to%20mitigate%3F&In-Reply-To=%3C1933869555.6653619.1424045038317.JavaMail.yahoo%40mail.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002879.html">
   <LINK REL="Next"  HREF="002882.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Chilli] Apparent intrusion attempt on AP running	coova-chilli	1.2.9, ways to mitigate?</H1>
    <B>reiner otto</B> 
    <A HREF="mailto:chilli%40coova.org?Subject=Re%3A%20%5BChilli%5D%20Apparent%20intrusion%20attempt%20on%20AP%20running%0A%09coova-chilli%091.2.9%2C%20ways%20to%20mitigate%3F&In-Reply-To=%3C1933869555.6653619.1424045038317.JavaMail.yahoo%40mail.yahoo.com%3E"
       TITLE="[Chilli] Apparent intrusion attempt on AP running	coova-chilli	1.2.9, ways to mitigate?">augustus_meyer at yahoo.de
       </A><BR>
    <I>Mon Feb 16 00:03:58 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002879.html">[Chilli] Apparent intrusion attempt on AP running coova-chilli 1.2.9, ways to mitigate?
</A></li>
        <LI>Next message: <A HREF="002882.html">[Chilli] Apparent intrusion attempt on AP running
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2880">[ date ]</a>
              <a href="thread.html#2880">[ thread ]</a>
              <a href="subject.html#2880">[ subject ]</a>
              <a href="author.html#2880">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You might have a look at &quot;logtrigger&quot; or &quot;fail2ban&quot;.
 

     Ben West &lt;<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">ben at gowasabi.net</A>&gt; schrieb am 22:35 Sonntag, 15.Februar 2015:
   

 A Nanostation M2 running Openwrt AA with coova-chilli v1.2.9 stopped its periodic heartbeat, and I had a chance to SSH in locally w/in 1 hour of the last heartbeat.

I didn't get a chance to inspect the APs local state very well before having to issue a &quot;reboot -f&quot; after the initial SSH session appeared to freeze.

Besides, the device only have 1Mbyte of remaining free memory, I did notice these log messages from coova-chilli (trimmed and anonymized):

Feb 15 20:43:56 Openwrt local6.notice coova-chilli[2056]: chilli.c: 5005: Client MAC=8C-84-01-XX-XX-XX assigned IP 101.209.43.124
Feb 15 20:44:16 Openwrt local6.err coova-chilli[18240]: redir.c: 3462: invalid file extension! [wwwroot/apkupdate.php]
Feb 15 20:44:19 Openwrt local6.err coova-chilli[18243]: redir.c: 3462: invalid file extension! [wwwroot/xmlupdate.php]
...
Feb 15 20:44:42 Openwrt local6.err coova-chilli[18283]: redir.c: 3462: invalid file extension! [getTasklist.php]
Feb 15 20:44:42 Openwrt local6.err coova-chilli[18284]: redir.c: 3462: invalid file extension! [getAccountNum.php]
Feb 15 20:44:46 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX IEEE 802.11: authenticated
Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX IEEE 802.11: authenticated
Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX IEEE 802.11: associated (aid 3)
Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX RADIUS: starting accounting session 0000002F-000001AD
Feb 15 20:59:46 Openwrt local6.err coova-chilli[18919]: redir.c: 3462: invalid file extension! [getTasklist.php]
...
Feb 15 20:59:49 Openwrt local6.err coova-chilli[18923]: redir.c: 3462: invalid file extension! [getTasklist2.php]
...

The &quot;invalid file extension&quot; instances, if which there are a couple dozen, are only a few seconds apart.&#160; The URL parts like &quot;getTasklist.php&quot; and &quot;getAccountNum.php&quot; seem to suggest whatever the client is doing (i.e. hammering the chilli agent with lots of bogus port 80 requests) is abusive.&#160; These log messages did coincide with this particular Nanostation verging on unresponsive, although I didn't get a chance to run &quot;top&quot; or &quot;uptime&quot; before needing to force a reboot.

Besides simply blocking this particular MAC from associating, are the other measures to ward off intrusions like this?

-- 
Ben <A HREF="Westhttp://gowasabi.net">Westhttp://gowasabi.net</A>
<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">ben at gowasabi.net</A>
314-246-9434

_______________________________________________
Chilli mailing list
<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">Chilli at coova.org</A>
<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">http://lists.coova.org/cgi-bin/mailman/listinfo/chilli</A>


   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.coova.org/pipermail/chilli/attachments/20150216/c699cf22/attachment-0001.html">http://lists.coova.org/pipermail/chilli/attachments/20150216/c699cf22/attachment-0001.html</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002879.html">[Chilli] Apparent intrusion attempt on AP running coova-chilli 1.2.9, ways to mitigate?
</A></li>
	<LI>Next message: <A HREF="002882.html">[Chilli] Apparent intrusion attempt on AP running
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2880">[ date ]</a>
              <a href="thread.html#2880">[ thread ]</a>
              <a href="subject.html#2880">[ subject ]</a>
              <a href="author.html#2880">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">More information about the Chilli
mailing list</a><br>
</body></html>
