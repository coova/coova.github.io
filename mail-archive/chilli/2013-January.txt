From james at adsl24.co.uk  Wed Jan  2 11:54:21 2013
From: james at adsl24.co.uk (James @ ADSL24)
Date: Wed, 2 Jan 2013 11:54:21 -0000
Subject: [Chilli] postauthproxy authentication
Message-ID: <00f901cde8df$e7155b60$b5401220$@adsl24.co.uk>

Happy New Year to you all!

I'm wondering if anyone can help.

We currently have a requirement to use the postauthproxy config option
within coovachilli but I need to know if there is a way to set a
username/password for the HTTP proxy, so we can lock it down on the squid
server to a specified user/pass.

We can't just set squid based on specific IPs as a lot of customers are on
dynamic IPs so we can't track them easily.

Does postauthproxy allow a username/password for the proxy to be specified
in this way, and if so how?

Many thanks

James


From david at coova.com  Wed Jan  2 20:15:55 2013
From: david at coova.com (David Bird)
Date: Wed, 02 Jan 2013 12:15:55 -0800
Subject: [Chilli] postauthproxy authentication
In-Reply-To: <00f901cde8df$e7155b60$b5401220$@adsl24.co.uk>
References: <00f901cde8df$e7155b60$b5401220$@adsl24.co.uk>
Message-ID: <1357157755.8816.42.camel@david-laptop>

There is no chilli option for that, though you could just implement that
with a local proxy with an up-stream configuration. 

Happy new year!
David

On Wed, 2013-01-02 at 11:54 +0000, James @ ADSL24 wrote:
> Happy New Year to you all!
> 
> I'm wondering if anyone can help.
> 
> We currently have a requirement to use the postauthproxy config option
> within coovachilli but I need to know if there is a way to set a
> username/password for the HTTP proxy, so we can lock it down on the squid
> server to a specified user/pass.
> 
> We can't just set squid based on specific IPs as a lot of customers are on
> dynamic IPs so we can't track them easily.
> 
> Does postauthproxy allow a username/password for the proxy to be specified
> in this way, and if so how?
> 
> Many thanks
> 
> James
> 
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli



From james at adsl24.co.uk  Wed Jan  2 20:25:53 2013
From: james at adsl24.co.uk (James @ ADSL24)
Date: Wed, 2 Jan 2013 20:25:53 -0000
Subject: [Chilli] postauthproxy authentication
In-Reply-To: <1357157755.8816.42.camel@david-laptop>
References: <00f901cde8df$e7155b60$b5401220$@adsl24.co.uk>
 <1357157755.8816.42.camel@david-laptop>
Message-ID: <01f801cde927$5cdcc120$16964360$@adsl24.co.uk>

Thanks David

But,  not sure how that can help unless I am missing the trick?

So if I install tinyproxy I can tell it to use my external squid proxy...
but I still need a way to lock it so only coova users can use the external
proxy...

Thank you,

James

-----Original Message-----
From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On Behalf
Of David Bird
Sent: 02 January 2013 20:16
To: chilli at coova.org
Subject: Re: [Chilli] postauthproxy authentication

There is no chilli option for that, though you could just implement that
with a local proxy with an up-stream configuration. 

Happy new year!
David

On Wed, 2013-01-02 at 11:54 +0000, James @ ADSL24 wrote:
> Happy New Year to you all!
> 
> I'm wondering if anyone can help.
> 
> We currently have a requirement to use the postauthproxy config option
> within coovachilli but I need to know if there is a way to set a
> username/password for the HTTP proxy, so we can lock it down on the squid
> server to a specified user/pass.
> 
> We can't just set squid based on specific IPs as a lot of customers are on
> dynamic IPs so we can't track them easily.
> 
> Does postauthproxy allow a username/password for the proxy to be specified
> in this way, and if so how?
> 
> Many thanks
> 
> James
> 
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


From jedgainer at gmail.com  Wed Jan  2 21:35:25 2013
From: jedgainer at gmail.com (Jed Gainer)
Date: Wed, 02 Jan 2013 13:35:25 -0800
Subject: [Chilli] Failed logins
Message-ID: <50E4A81D.3070206@gmail.com>

I have setup a 2 clients sharing a limited bandwidth satellite link so I 
have set them each up with a username and password with a daily limit of 
half the satellites daily limit. Each username and password is used by 
roughly 10 people and I have been getting complaints no one can login, I 
reboot chilli and it works again. Ideas?

From sherca at gmail.com  Thu Jan  3 07:17:55 2013
From: sherca at gmail.com (sherca)
Date: Thu, 3 Jan 2013 09:17:55 +0200
Subject: [Chilli] Wifi security
Message-ID: <CA+GoXsFaX9MVSHt2RMdP5TkDgJCPWLYw+gWbn6z+pU0Y+-z2BQ@mail.gmail.com>

Hi all,

I was wondering if the use of Coova Chilli (or any captive portal for that
matter) was any help for security issues like the use of Firesheep.

I was believing the use of the captive portal would allow us to not use
secured connection ( WEP or WPA), thus allowing the user to connect to the
router without login/password exchange at that level (that is before the
captive portal).

Thanks !
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130103/3066b1a8/attachment.html>

From maxxer at ufficyo.com  Thu Jan  3 07:56:13 2013
From: maxxer at ufficyo.com (Lorenzo Milesi)
Date: Thu, 3 Jan 2013 08:56:13 +0100 (CET)
Subject: [Chilli] Failed logins
In-Reply-To: <50E4A81D.3070206@gmail.com>
Message-ID: <21525015.114.1357199770605.JavaMail.maxxer@dharma>

> login, I reboot chilli and it works again. Ideas?

block non standard port if you don't have already, allow access only to web and few other stuff, the connection will benefit a lot.

-- 
Lorenzo Milesi - lorenzo.milesi at yetopen.it

GPG/PGP Key-Id: 0xE704E230 - http://keyserver.linux.it



From info at easyhorpak.com  Thu Jan  3 13:46:17 2013
From: info at easyhorpak.com (EasyHorpak.com)
Date: Thu, 03 Jan 2013 20:46:17 +0700
Subject: [Chilli] Wifi security
In-Reply-To: <CA+GoXsFaX9MVSHt2RMdP5TkDgJCPWLYw+gWbn6z+pU0Y+-z2BQ@mail.gmail.com>
References: <CA+GoXsFaX9MVSHt2RMdP5TkDgJCPWLYw+gWbn6z+pU0Y+-z2BQ@mail.gmail.com>
Message-ID: <50E58BA9.7080608@easyhorpak.com>

An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130103/25f58333/attachment.html>

From sherca at gmail.com  Thu Jan  3 13:54:15 2013
From: sherca at gmail.com (sherca)
Date: Thu, 3 Jan 2013 15:54:15 +0200
Subject: [Chilli] Wifi security
In-Reply-To: <50E58BA9.7080608@easyhorpak.com>
References: <CA+GoXsFaX9MVSHt2RMdP5TkDgJCPWLYw+gWbn6z+pU0Y+-z2BQ@mail.gmail.com>
 <50E58BA9.7080608@easyhorpak.com>
Message-ID: <CA+GoXsEWOqmomLArwX-K8y6YMcLk-K4SZR6Q4Vh6jbWpAc828w@mail.gmail.com>

Thank you for your answer. This is what I meant, coova-chilli (https
landing page) and freeradius are not enough to prevent attacks like
firesheep, right ?

Indeed one can use wpa2 entreprise, but the question is : do we have to ?


2013/1/3 EasyHorpak.com <info at easyhorpak.com>

>  On 03/01/2556 14:17, sherca wrote:
>
> Hi all,
>
>  I was wondering if the use of Coova Chilli (or any captive portal for
> that matter) was any help for security issues like the use of Firesheep.
>
>  I was believing the use of the captive portal would allow us to not use
> secured connection ( WEP or WPA), thus allowing the user to connect to the
> router without login/password exchange at that level (that is before the
> captive portal).
>
>  Thanks !
>
>
> _______________________________________________
> Chilli mailing listChilli at coova.orghttp://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>  you can use wpa2 enterpise with coovachilli +freeradius
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130103/d3484d2e/attachment.html>

From timwhite88 at gmail.com  Fri Jan  4 01:07:26 2013
From: timwhite88 at gmail.com (Timothy White)
Date: Fri, 4 Jan 2013 11:37:26 +1030
Subject: [Chilli] Wifi security
In-Reply-To: <CA+GoXsEWOqmomLArwX-K8y6YMcLk-K4SZR6Q4Vh6jbWpAc828w@mail.gmail.com>
References: <CA+GoXsFaX9MVSHt2RMdP5TkDgJCPWLYw+gWbn6z+pU0Y+-z2BQ@mail.gmail.com>
 <50E58BA9.7080608@easyhorpak.com>
 <CA+GoXsEWOqmomLArwX-K8y6YMcLk-K4SZR6Q4Vh6jbWpAc828w@mail.gmail.com>
Message-ID: <CAESLx0Khiz-G1oGSmgctoef9k+EF9CpVAXY5Mf1LiHRf+y5JqA@mail.gmail.com>

On Fri, Jan 4, 2013 at 12:24 AM, sherca <sherca at gmail.com> wrote:

> Thank you for your answer. This is what I meant, coova-chilli (https
> landing page) and freeradius are not enough to prevent attacks like
> firesheep, right ?
>
> Indeed one can use wpa2 entreprise, but the question is : do we have to ?
>

Firesheep generally uses the fact the the Wifi clients can see each others
traffic. WPA(2) plus client isolation on the wireless access point are 2
things to do to help prevent it. Coova Chilli has no part in preventing
firesheep as it occurs before firesheep.

Should you use something like WPA2? Probably to prevent firesheep. Or
introduce your clients to HTTPS everywhere or if using wireless without any
encryption, then VPN's.

Tim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130104/bcd419fa/attachment.html>

From zigiwifitha at gmail.com  Fri Jan  4 07:41:09 2013
From: zigiwifitha at gmail.com (zigiria kalmara)
Date: Fri, 4 Jan 2013 13:11:09 +0530
Subject: [Chilli] Doubt in interface configuration
Message-ID: <CAHi6omhheqdaftVM8DVm-iHZuFo5ezmE31P=2xnbXRM3VK5Z5A@mail.gmail.com>

Hi,

   Can we implement authentication using wireless card to ether net (i.e
instud of eth0, eth1 can we use wlan0,eth1)

please give me idea.

Regrads,
k zigiria
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130104/cea6775f/attachment.html>

From info at easyhorpak.com  Fri Jan  4 09:08:22 2013
From: info at easyhorpak.com (EasyHorpak.com)
Date: Fri, 04 Jan 2013 16:08:22 +0700
Subject: [Chilli] Doubt in interface configuration
In-Reply-To: <CAHi6omhheqdaftVM8DVm-iHZuFo5ezmE31P=2xnbXRM3VK5Z5A@mail.gmail.com>
References: <CAHi6omhheqdaftVM8DVm-iHZuFo5ezmE31P=2xnbXRM3VK5Z5A@mail.gmail.com>
Message-ID: <50E69C06.6030708@easyhorpak.com>

An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130104/ec37ab9b/attachment.html>

From sherca at gmail.com  Fri Jan  4 14:06:36 2013
From: sherca at gmail.com (sherca)
Date: Fri, 4 Jan 2013 16:06:36 +0200
Subject: [Chilli] Wifi security
In-Reply-To: <CAESLx0Khiz-G1oGSmgctoef9k+EF9CpVAXY5Mf1LiHRf+y5JqA@mail.gmail.com>
References: <CA+GoXsFaX9MVSHt2RMdP5TkDgJCPWLYw+gWbn6z+pU0Y+-z2BQ@mail.gmail.com>
 <50E58BA9.7080608@easyhorpak.com>
 <CA+GoXsEWOqmomLArwX-K8y6YMcLk-K4SZR6Q4Vh6jbWpAc828w@mail.gmail.com>
 <CAESLx0Khiz-G1oGSmgctoef9k+EF9CpVAXY5Mf1LiHRf+y5JqA@mail.gmail.com>
Message-ID: <CA+GoXsH7Fqs89EFdXqeBKG_swwKybbdbxFP1rzAcxxC-s1MnAQ@mail.gmail.com>

Thank you all so much for your answers. So to sum up. My goal was to :
1. make connection as easy as possible for the users : no login / passord
via WPA or other, no authentification on Radius (hidden fields for login /
password) just a Term of Agreements page.
2. at least a minimum of security while browsing : users isolated one from
the others and immuned to Firesheep (session stealing).

As it appears, 1 is not possible if 2. In order to get 2, one must go
through either use of WPA 2 (Entreprise ?), or some settings from client
side, or use https only or via VPN.

Please feel free to correct me if I am wrong or if I forgot something.

Thank you again for your help.


2013/1/4 Timothy White <timwhite88 at gmail.com>

>
>
>
> On Fri, Jan 4, 2013 at 12:24 AM, sherca <sherca at gmail.com> wrote:
>
>> Thank you for your answer. This is what I meant, coova-chilli (https
>> landing page) and freeradius are not enough to prevent attacks like
>> firesheep, right ?
>>
>> Indeed one can use wpa2 entreprise, but the question is : do we have to ?
>>
>
> Firesheep generally uses the fact the the Wifi clients can see each others
> traffic. WPA(2) plus client isolation on the wireless access point are 2
> things to do to help prevent it. Coova Chilli has no part in preventing
> firesheep as it occurs before firesheep.
>
> Should you use something like WPA2? Probably to prevent firesheep. Or
> introduce your clients to HTTPS everywhere or if using wireless without any
> encryption, then VPN's.
>
> Tim
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130104/0f44412d/attachment.html>

From jedgainer at gmail.com  Fri Jan  4 17:42:07 2013
From: jedgainer at gmail.com (Jed Gainer)
Date: Fri, 4 Jan 2013 09:42:07 -0800
Subject: [Chilli] Content-injection
Message-ID: <CAJc1nupLbLfotrZrV+wGZdc1Om3LkT3JPj-S_fkcXc=fgzgQkA@mail.gmail.com>

http://coova.org/node/4656

I have setup HotSpots for people on low bandwidth Satellite links and
all is going well except the users constantly complain. They go over
their daily limit then all want their limits reset for various
ridiculous reasons. One of the big excuses is they didn't know they
had a limit or how to check it. I have wrote a bandiwdth monitor for
them but no one seems capable of typing http://bandwidth in their
browser to keep an eye on it. I really like that screen shot on the
content-injection blog post, I could display their usage on every
page! Looks like I will have one problem though I only want the
content-injection after the login (I need to use the captive portal I
built.)

Ideas?

I do have the users forced though Dan'sGuardian and Squid as well but
that method does not look promising.

From jedgainer at gmail.com  Sat Jan  5 02:38:49 2013
From: jedgainer at gmail.com (Jed Gainer)
Date: Fri, 4 Jan 2013 18:38:49 -0800
Subject: [Chilli] Content-injection
In-Reply-To: <CAJc1nupLbLfotrZrV+wGZdc1Om3LkT3JPj-S_fkcXc=fgzgQkA@mail.gmail.com>
References: <CAJc1nupLbLfotrZrV+wGZdc1Om3LkT3JPj-S_fkcXc=fgzgQkA@mail.gmail.com>
Message-ID: <CAJc1nurqsWwdAYbZfwj==JSDXACP7ksrXX8N_fp=K533tr+JqQ@mail.gmail.com>

Turns out Dan's Guardian does it no sweat. I have injected a script
into every page! Does anyone have the com.coova.Cd.nocache.js david
used in his blog post?

On Fri, Jan 4, 2013 at 9:42 AM, Jed Gainer <jedgainer at gmail.com> wrote:
> http://coova.org/node/4656
>
> I have setup HotSpots for people on low bandwidth Satellite links and
> all is going well except the users constantly complain. They go over
> their daily limit then all want their limits reset for various
> ridiculous reasons. One of the big excuses is they didn't know they
> had a limit or how to check it. I have wrote a bandiwdth monitor for
> them but no one seems capable of typing http://bandwidth in their
> browser to keep an eye on it. I really like that screen shot on the
> content-injection blog post, I could display their usage on every
> page! Looks like I will have one problem though I only want the
> content-injection after the login (I need to use the captive portal I
> built.)
>
> Ideas?
>
> I do have the users forced though Dan'sGuardian and Squid as well but
> that method does not look promising.

From james at adsl24.co.uk  Sat Jan  5 23:06:02 2013
From: james at adsl24.co.uk (James @ ADSL24)
Date: Sat, 5 Jan 2013 23:06:02 -0000
Subject: [Chilli] Proxy and REDIRSSL issues
Message-ID: <00be01cdeb99$3b9ad960$b2d08c20$@adsl24.co.uk>

David,

Hi All,

As you know, it's not really possible to proxy all HTTPS traffic without
causing SSL violation/certificate errors to the end users browser. So, is
there any way that when the postauthproxy option is used within coova, to
send all HTTPS traffic direct and not via the defined proxy?

I must concur, this only happens when we use the HS_REDIRSSL = on setting
because we need to redirect the initial end users HTTPS page requests to the
captive portal else it does not redirect. If you don't use HS_REDIRSSL then
no HTTPs traffic is sent via the proxy - doh!

Any ideas?

Looking at dhcp.c it appears the below code is being used, but I'm not 100%
sure on what to modify to send all HTTPS traffic direct and not through the
proxy once they are authenticated.

----------------------------------------------------------------------------
------
if (_options.postauth_proxyport > 0) {
    if (is_return) {
      if ((iph->protocol == PKT_IP_PROTO_TCP) &&
	  (iph->saddr == _options.postauth_proxyip.s_addr) &&
	  (tcph->src == htons(_options.postauth_proxyport))) {
	
	*do_checksum = 1;
	return dhcp_uam_unnat(conn, ethh, iph, tcph);
      }
    }
    else {
      if ((iph->protocol == PKT_IP_PROTO_TCP) &&
	  (tcph->dst == htons(DHCP_HTTP) 
#ifdef HAVE_SSL
	   || (_options.redirssl && tcph->dst == htons(DHCP_HTTPS))
#endif
	   )) {

#if(_debug_ > 0)	
	log_dbg("rewriting packet for post-auth proxy %s:%d",
		inet_ntoa(_options.postauth_proxyip),
		_options.postauth_proxyport);
#endif
	
	*do_checksum = 1;
	return dhcp_uam_nat(conn, ethh, iph, tcph,
			    &_options.postauth_proxyip, 
			    _options.postauth_proxyport);
      }
    }
  }
----------------------------------------------------------------------------
------

Thanks in advance.

James 

-----Original Message-----
From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On Behalf
Of David Bird
Sent: 02 January 2013 20:16
To: chilli at coova.org
Subject: Re: [Chilli] postauthproxy authentication

There is no chilli option for that, though you could just implement that
with a local proxy with an up-stream configuration. 

Happy new year!
David

On Wed, 2013-01-02 at 11:54 +0000, James @ ADSL24 wrote:
> Happy New Year to you all!
> 
> I'm wondering if anyone can help.
> 
> We currently have a requirement to use the postauthproxy config option
> within coovachilli but I need to know if there is a way to set a
> username/password for the HTTP proxy, so we can lock it down on the squid
> server to a specified user/pass.
> 
> We can't just set squid based on specific IPs as a lot of customers are on
> dynamic IPs so we can't track them easily.
> 
> Does postauthproxy allow a username/password for the proxy to be specified
> in this way, and if so how?
> 
> Many thanks
> 
> James
> 
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


From james at adsl24.co.uk  Sun Jan  6 11:55:30 2013
From: james at adsl24.co.uk (James @ ADSL24)
Date: Sun, 6 Jan 2013 11:55:30 -0000
Subject: [Chilli] Proxy and REDIRSSL issues
In-Reply-To: <00be01cdeb99$3b9ad960$b2d08c20$@adsl24.co.uk>
References: <00be01cdeb99$3b9ad960$b2d08c20$@adsl24.co.uk>
Message-ID: <00c701cdec04$ba273b50$2e75b1f0$@adsl24.co.uk>

I took a punt and got it working. See below dhcp.c modifications for anyone
else who needs postauthproxy support but to send HTTPS direct:

----------------------------------------------------------------------------
if (_options.postauth_proxyport > 0) {
    if (is_return) {
      if ((iph->protocol == PKT_IP_PROTO_TCP) &&
	  (iph->saddr == _options.postauth_proxyip.s_addr) &&
	  (tcph->src == htons(_options.postauth_proxyport))) {
	
	*do_checksum = 1;
	return dhcp_uam_unnat(conn, ethh, iph, tcph);
      }
    } else {
      if ((iph->protocol == PKT_IP_PROTO_TCP) &&
	  (tcph->dst == htons(DHCP_HTTP) )) {

#if(_debug_ > 0)	
	log_dbg("rewriting packet for post-auth proxy %s:%d",
		inet_ntoa(_options.postauth_proxyip),
		_options.postauth_proxyport);
#endif
	
	*do_checksum = 1;
	return dhcp_uam_nat(conn, ethh, iph, tcph,
			    &_options.postauth_proxyip, 
			    _options.postauth_proxyport);
      } elseif (_options.redirssl && tcph->dst == htons(DHCP_HTTPS)) {
		#if(_debug_ > 0)	
		log_dbg("NOT rewriting packet for post-auth proxy %s:%d",
			inet_ntoa(_options.postauth_proxyip),
			_options.postauth_proxyport);
	#endif
	  }
    }
  }
----------------------------------------------------------------------------

-----Original Message-----
From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On Behalf
Of James @ ADSL24
Sent: 05 January 2013 23:06
To: chilli at coova.org
Subject: [Chilli] Proxy and REDIRSSL issues

David,

Hi All,

As you know, it's not really possible to proxy all HTTPS traffic without
causing SSL violation/certificate errors to the end users browser. So, is
there any way that when the postauthproxy option is used within coova, to
send all HTTPS traffic direct and not via the defined proxy?

I must concur, this only happens when we use the HS_REDIRSSL = on setting
because we need to redirect the initial end users HTTPS page requests to the
captive portal else it does not redirect. If you don't use HS_REDIRSSL then
no HTTPs traffic is sent via the proxy - doh!

Any ideas?

Looking at dhcp.c it appears the below code is being used, but I'm not 100%
sure on what to modify to send all HTTPS traffic direct and not through the
proxy once they are authenticated.

----------------------------------------------------------------------------
------
if (_options.postauth_proxyport > 0) {
    if (is_return) {
      if ((iph->protocol == PKT_IP_PROTO_TCP) &&
	  (iph->saddr == _options.postauth_proxyip.s_addr) &&
	  (tcph->src == htons(_options.postauth_proxyport))) {
	
	*do_checksum = 1;
	return dhcp_uam_unnat(conn, ethh, iph, tcph);
      }
    }
    else {
      if ((iph->protocol == PKT_IP_PROTO_TCP) &&
	  (tcph->dst == htons(DHCP_HTTP) 
#ifdef HAVE_SSL
	   || (_options.redirssl && tcph->dst == htons(DHCP_HTTPS))
#endif
	   )) {

#if(_debug_ > 0)	
	log_dbg("rewriting packet for post-auth proxy %s:%d",
		inet_ntoa(_options.postauth_proxyip),
		_options.postauth_proxyport);
#endif
	
	*do_checksum = 1;
	return dhcp_uam_nat(conn, ethh, iph, tcph,
			    &_options.postauth_proxyip, 
			    _options.postauth_proxyport);
      }
    }
  }
----------------------------------------------------------------------------
------

Thanks in advance.

James 

-----Original Message-----
From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On Behalf
Of David Bird
Sent: 02 January 2013 20:16
To: chilli at coova.org
Subject: Re: [Chilli] postauthproxy authentication

There is no chilli option for that, though you could just implement that
with a local proxy with an up-stream configuration. 

Happy new year!
David

On Wed, 2013-01-02 at 11:54 +0000, James @ ADSL24 wrote:
> Happy New Year to you all!
> 
> I'm wondering if anyone can help.
> 
> We currently have a requirement to use the postauthproxy config option
> within coovachilli but I need to know if there is a way to set a
> username/password for the HTTP proxy, so we can lock it down on the squid
> server to a specified user/pass.
> 
> We can't just set squid based on specific IPs as a lot of customers are on
> dynamic IPs so we can't track them easily.
> 
> Does postauthproxy allow a username/password for the proxy to be specified
> in this way, and if so how?
> 
> Many thanks
> 
> James
> 
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli

_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


From david at coova.com  Thu Jan 10 18:00:13 2013
From: david at coova.com (David Bird)
Date: Thu, 10 Jan 2013 10:00:13 -0800
Subject: [Chilli] Proxy and REDIRSSL issues
In-Reply-To: <00c701cdec04$ba273b50$2e75b1f0$@adsl24.co.uk>
References: <00be01cdeb99$3b9ad960$b2d08c20$@adsl24.co.uk>
 <00c701cdec04$ba273b50$2e75b1f0$@adsl24.co.uk>
Message-ID: <1357840813.12574.4.camel@david-laptop>

Perhaps there should be an option postauthproxyssl that defaults to
false that when enabled means the postauth proxy is used for ssl too.


On Sun, 2013-01-06 at 11:55 +0000, James @ ADSL24 wrote:
> I took a punt and got it working. See below dhcp.c modifications for anyone
> else who needs postauthproxy support but to send HTTPS direct:
> 
> ----------------------------------------------------------------------------
> if (_options.postauth_proxyport > 0) {
>     if (is_return) {
>       if ((iph->protocol == PKT_IP_PROTO_TCP) &&
> 	  (iph->saddr == _options.postauth_proxyip.s_addr) &&
> 	  (tcph->src == htons(_options.postauth_proxyport))) {
> 	
> 	*do_checksum = 1;
> 	return dhcp_uam_unnat(conn, ethh, iph, tcph);
>       }
>     } else {
>       if ((iph->protocol == PKT_IP_PROTO_TCP) &&
> 	  (tcph->dst == htons(DHCP_HTTP) )) {
> 
> #if(_debug_ > 0)	
> 	log_dbg("rewriting packet for post-auth proxy %s:%d",
> 		inet_ntoa(_options.postauth_proxyip),
> 		_options.postauth_proxyport);
> #endif
> 	
> 	*do_checksum = 1;
> 	return dhcp_uam_nat(conn, ethh, iph, tcph,
> 			    &_options.postauth_proxyip, 
> 			    _options.postauth_proxyport);
>       } elseif (_options.redirssl && tcph->dst == htons(DHCP_HTTPS)) {
> 		#if(_debug_ > 0)	
> 		log_dbg("NOT rewriting packet for post-auth proxy %s:%d",
> 			inet_ntoa(_options.postauth_proxyip),
> 			_options.postauth_proxyport);
> 	#endif
> 	  }
>     }
>   }
> ----------------------------------------------------------------------------
> 
> -----Original Message-----
> From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On Behalf
> Of James @ ADSL24
> Sent: 05 January 2013 23:06
> To: chilli at coova.org
> Subject: [Chilli] Proxy and REDIRSSL issues
> 
> David,
> 
> Hi All,
> 
> As you know, it's not really possible to proxy all HTTPS traffic without
> causing SSL violation/certificate errors to the end users browser. So, is
> there any way that when the postauthproxy option is used within coova, to
> send all HTTPS traffic direct and not via the defined proxy?
> 
> I must concur, this only happens when we use the HS_REDIRSSL = on setting
> because we need to redirect the initial end users HTTPS page requests to the
> captive portal else it does not redirect. If you don't use HS_REDIRSSL then
> no HTTPs traffic is sent via the proxy - doh!
> 
> Any ideas?
> 
> Looking at dhcp.c it appears the below code is being used, but I'm not 100%
> sure on what to modify to send all HTTPS traffic direct and not through the
> proxy once they are authenticated.
> 
> ----------------------------------------------------------------------------
> ------
> if (_options.postauth_proxyport > 0) {
>     if (is_return) {
>       if ((iph->protocol == PKT_IP_PROTO_TCP) &&
> 	  (iph->saddr == _options.postauth_proxyip.s_addr) &&
> 	  (tcph->src == htons(_options.postauth_proxyport))) {
> 	
> 	*do_checksum = 1;
> 	return dhcp_uam_unnat(conn, ethh, iph, tcph);
>       }
>     }
>     else {
>       if ((iph->protocol == PKT_IP_PROTO_TCP) &&
> 	  (tcph->dst == htons(DHCP_HTTP) 
> #ifdef HAVE_SSL
> 	   || (_options.redirssl && tcph->dst == htons(DHCP_HTTPS))
> #endif
> 	   )) {
> 
> #if(_debug_ > 0)	
> 	log_dbg("rewriting packet for post-auth proxy %s:%d",
> 		inet_ntoa(_options.postauth_proxyip),
> 		_options.postauth_proxyport);
> #endif
> 	
> 	*do_checksum = 1;
> 	return dhcp_uam_nat(conn, ethh, iph, tcph,
> 			    &_options.postauth_proxyip, 
> 			    _options.postauth_proxyport);
>       }
>     }
>   }
> ----------------------------------------------------------------------------
> ------
> 
> Thanks in advance.
> 
> James 
> 
> -----Original Message-----
> From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On Behalf
> Of David Bird
> Sent: 02 January 2013 20:16
> To: chilli at coova.org
> Subject: Re: [Chilli] postauthproxy authentication
> 
> There is no chilli option for that, though you could just implement that
> with a local proxy with an up-stream configuration. 
> 
> Happy new year!
> David
> 
> On Wed, 2013-01-02 at 11:54 +0000, James @ ADSL24 wrote:
> > Happy New Year to you all!
> > 
> > I'm wondering if anyone can help.
> > 
> > We currently have a requirement to use the postauthproxy config option
> > within coovachilli but I need to know if there is a way to set a
> > username/password for the HTTP proxy, so we can lock it down on the squid
> > server to a specified user/pass.
> > 
> > We can't just set squid based on specific IPs as a lot of customers are on
> > dynamic IPs so we can't track them easily.
> > 
> > Does postauthproxy allow a username/password for the proxy to be specified
> > in this way, and if so how?
> > 
> > Many thanks
> > 
> > James
> > 
> > _______________________________________________
> > Chilli mailing list
> > Chilli at coova.org
> > http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> 
> 
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> 
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> 
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli



From timwhite88 at gmail.com  Sat Jan 12 10:59:28 2013
From: timwhite88 at gmail.com (Tim White)
Date: Sat, 12 Jan 2013 20:59:28 +1000
Subject: [Chilli] Wifi security
In-Reply-To: <CA+GoXsH7Fqs89EFdXqeBKG_swwKybbdbxFP1rzAcxxC-s1MnAQ@mail.gmail.com>
References: <CA+GoXsFaX9MVSHt2RMdP5TkDgJCPWLYw+gWbn6z+pU0Y+-z2BQ@mail.gmail.com>
 <50E58BA9.7080608@easyhorpak.com>
 <CA+GoXsEWOqmomLArwX-K8y6YMcLk-K4SZR6Q4Vh6jbWpAc828w@mail.gmail.com>
 <CAESLx0Khiz-G1oGSmgctoef9k+EF9CpVAXY5Mf1LiHRf+y5JqA@mail.gmail.com>
 <CA+GoXsH7Fqs89EFdXqeBKG_swwKybbdbxFP1rzAcxxC-s1MnAQ@mail.gmail.com>
Message-ID: <50F14210.9050601@gmail.com>

On 05/01/13 00:06, sherca wrote:
> Thank you all so much for your answers. So to sum up. My goal was to :
> 1. make connection as easy as possible for the users : no login / 
> passord via WPA or other, no authentification on Radius (hidden fields 
> for login / password) just a Term of Agreements page.
> 2. at least a minimum of security while browsing : users isolated one 
> from the others and immuned to Firesheep (session stealing).
>
> As it appears, 1 is not possible if 2. In order to get 2, one must go 
> through either use of WPA 2 (Entreprise ?), or some settings from 
> client side, or use https only or via VPN.
>
> Please feel free to correct me if I am wrong or if I forgot something.

Or use an Access Point (wireless) that has client isolation.

Tim

From danny at sb-ps.ae  Tue Jan 15 14:07:30 2013
From: danny at sb-ps.ae (Danny Magat)
Date: Tue, 15 Jan 2013 18:07:30 +0400
Subject: [Chilli] RADIUS based way to set the per session
Message-ID: <00a101cdf329$a886fd00$f994f700$@ae>

Dear All,

 

http://coova.org/node/4788#comment-9802

 

Based on the above links by David there is a way on how to inject-URL per
session. 

Can somebody guide me on how to achieve this.

 

Thanks in Advance.

Danny

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130115/1ecc541b/attachment.html>

From danny at sb-ps.ae  Wed Jan 16 08:17:49 2013
From: danny at sb-ps.ae (Danny Magat)
Date: Wed, 16 Jan 2013 12:17:49 +0400
Subject: [Chilli] RADIUS based way to set the per session
In-Reply-To: <CAJc1nuoZ8Xe_T8eFbBNKSXKGABwHAneKOxoTRiP4YOLxN55hmg@mail.gmail.com>
References: <00a101cdf329$a886fd00$f994f700$@ae>
 <CAJc1nuoZ8Xe_T8eFbBNKSXKGABwHAneKOxoTRiP4YOLxN55hmg@mail.gmail.com>
Message-ID: <000401cdf3c2$10a3aee0$31eb0ca0$@ae>

Yes inject url per user wherein the URL is coming from the radius reply.


-----Original Message-----
From: Jed Gainer [mailto:jedgainer at gmail.com] 
Sent: Wednesday, January 16, 2013 8:11 AM
To: Danny Magat
Subject: Re: [Chilli] RADIUS based way to set the per session

I am not sure what you mean. Inject per user you mean?

    $.getJSON("http://10.1.0.1:3990/json/status?callback=?",
function(chilli) {
        console.log(chilli);
        if ($.inArray(chilli.session.userName, ['Cyndy', 'Chris']) != -1)
        {
            var addHeight =
(/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent))
? 60 : 40;
            $('body').height($('body').height() + addHeight);
            $('body').append('<div style="position: fixed; bottom: 0;
left: 0; right: 0; height: ' + addHeight + 'px; border-top: 2px solid
#000; background-color: #fff"><iframe style="border: 0; width: 99%"
src="http://10.1.0.1/toolbar.php"></iframe></div>');
        }
    });

On Tue, Jan 15, 2013 at 6:07 AM, Danny Magat <danny at sb-ps.ae> wrote:
> Dear All,
>
>
>
> http://coova.org/node/4788#comment-9802
>
>
>
> Based on the above links by David there is a way on how to inject-URL per
> session.
>
> Can somebody guide me on how to achieve this.
>
>
>
> Thanks in Advance.
>
> Danny
>
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>


From portsbsd at gmail.com  Thu Jan 17 07:11:29 2013
From: portsbsd at gmail.com (Alberto Moreno)
Date: Wed, 16 Jan 2013 23:11:29 -0800
Subject: [Chilli] Wifi clients cannot reach Internet?
Message-ID: <CAHdK7WmS=oA_yH75pM0z-yMc+D7FKSAFtwEaSsE+PVmcc7wB4g@mail.gmail.com>

Hi.

I start my learning curve with coova, fr2.

My box is a centos 5.x with coova 1.3.0, this box have 2 nics:
nic-1 connected to subnet 192.168.50.0
nic-2 is dedicated to coova and connected to subnet 172.16.1.0.

This machine is behind fw.

This is my settings for coova:

# THIS FILE IS AUTOMATICALLY GENERATED
cmdsocket       /var/run/chilli.eth1.sock
unixipc         chilli.eth1.ipc
pidfile         /var/run/chilli.eth1.pid
net             172.16.1.10/255.255.255.0
uamlisten       172.16.1.3
uamport         3990
dhcpif          eth1
uamallowed      "www.coova.org,
https://172.16.1.3/hotspotlogin/hotspotlogin.php,www.coova.org"
uamanydns
domain "lan"
dns1 "172.16.1.1" <<==========firewall pfsense 2.0.2
dns2 "172.16.1.1"<<==========firewall pfsense 2.0.2
uamhomepage http://172.16.1.3:3990/www/coova.html
wwwdir /etc/chilli/www
wwwbin /etc/chilli/wwwsh
uamuiport 4990
locationname "My HotSpot"
radiuslocationname "My_HotSpot"
radiuslocationid "isocc=,cc=,ac=,network=Coova,"

I had 1 issue:

My wifi clients receive IP from coova, they receive coova login page, they
give their credentials, fr2 accept the data, coova try to redirect to the
page they wanted but they cannot reach their wbe page.

I see that they have coova Ip as GW, this is normal or

-- 
LIving the dream...
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130116/af4e60d1/attachment.html>

From portsbsd at gmail.com  Thu Jan 17 07:18:53 2013
From: portsbsd at gmail.com (Alberto Moreno)
Date: Wed, 16 Jan 2013 23:18:53 -0800
Subject: [Chilli] Wifi clients cannot reach Internet?
In-Reply-To: <CAHdK7WmS=oA_yH75pM0z-yMc+D7FKSAFtwEaSsE+PVmcc7wB4g@mail.gmail.com>
References: <CAHdK7WmS=oA_yH75pM0z-yMc+D7FKSAFtwEaSsE+PVmcc7wB4g@mail.gmail.com>
Message-ID: <CAHdK7WkrAsk8pZp0yZV0mr3uoBUKQqvPaR-BqCnW2tF=kit3oA@mail.gmail.com>

 Continue, I hate went u press the send button by mistake.
....
I see that my clients have the coova IP as gw, this is normal or I can
change the default gw to be my firewall? Or how can I handle this?
The thing that took my attention is that they can reach my firewall dns but
they cannot reach port 80/443.

Now I have some question:

1) I see that the help manual, show options to define dhcp start number and
end number, I can setup this in the config?
2) Can I use my firewall dhcp?

Thanks!!!!


On Wed, Jan 16, 2013 at 11:11 PM, Alberto Moreno <portsbsd at gmail.com> wrote:

> Hi.
>
> I start my learning curve with coova, fr2.
>
> My box is a centos 5.x with coova 1.3.0, this box have 2 nics:
> nic-1 connected to subnet 192.168.50.0
> nic-2 is dedicated to coova and connected to subnet 172.16.1.0.
>
> This machine is behind fw.
>
> This is my settings for coova:
>
> # THIS FILE IS AUTOMATICALLY GENERATED
> cmdsocket       /var/run/chilli.eth1.sock
> unixipc         chilli.eth1.ipc
> pidfile         /var/run/chilli.eth1.pid
> net             172.16.1.10/255.255.255.0
> uamlisten       172.16.1.3
> uamport         3990
> dhcpif          eth1
> uamallowed      "www.coova.org,
> https://172.16.1.3/hotspotlogin/hotspotlogin.php,www.coova.org"
> uamanydns
> domain "lan"
> dns1 "172.16.1.1" <<==========firewall pfsense 2.0.2
> dns2 "172.16.1.1"<<==========firewall pfsense 2.0.2
> uamhomepage http://172.16.1.3:3990/www/coova.html
> wwwdir /etc/chilli/www
> wwwbin /etc/chilli/wwwsh
> uamuiport 4990
> locationname "My HotSpot"
> radiuslocationname "My_HotSpot"
> radiuslocationid "isocc=,cc=,ac=,network=Coova,"
>
> I had 1 issue:
>
> My wifi clients receive IP from coova, they receive coova login page, they
> give their credentials, fr2 accept the data, coova try to redirect to the
> page they wanted but they cannot reach their wbe page.
>
> I see that they have coova Ip as GW, this is normal or
>
> --
> LIving the dream...
>



-- 
LIving the dream...
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130116/b3510cb0/attachment.html>

From maxxer at ufficyo.com  Thu Jan 17 08:05:24 2013
From: maxxer at ufficyo.com (Lorenzo Milesi)
Date: Thu, 17 Jan 2013 09:05:24 +0100 (CET)
Subject: [Chilli] Problem in UAMALLOwing PayPal
Message-ID: <1485187659.46073.1358409923269.JavaMail.root@yetopen.it>

Hi. Since some weeks (maybe several) we're having troubles in UAMALLOWing paypal.
We used to allow paypal.com, paypalobjects.com, paypal.2o7.net, but right now we're having timeouts on load, like it's trying to redirect to a disabled ssl site (we still have to figure out which).

Anyone else ran into the same issue?
thanks

-- 
Lorenzo Milesi - lorenzo.milesi at yetopen.it

GPG/PGP Key-Id: 0xE704E230 - http://keyserver.linux.it



From david at coova.com  Thu Jan 17 18:34:47 2013
From: david at coova.com (David Bird)
Date: Thu, 17 Jan 2013 10:34:47 -0800
Subject: [Chilli] RADIUS based way to set the per session
In-Reply-To: <000401cdf3c2$10a3aee0$31eb0ca0$@ae>
References: <00a101cdf329$a886fd00$f994f700$@ae>
 <CAJc1nuoZ8Xe_T8eFbBNKSXKGABwHAneKOxoTRiP4YOLxN55hmg@mail.gmail.com>
 <000401cdf3c2$10a3aee0$31eb0ca0$@ae>
Message-ID: <1358447687.6314.3.camel@david-laptop>

You have tried the ChilliSpot-Inject-URL attribute? 

Also, it is also helpful to --enable-inspect so that chilli_query
inspect mac <mac> gives you more information on per session
configurations. 

David


On Wed, 2013-01-16 at 12:17 +0400, Danny Magat wrote:
> Yes inject url per user wherein the URL is coming from the radius reply.
> 
> 
> -----Original Message-----
> From: Jed Gainer [mailto:jedgainer at gmail.com] 
> Sent: Wednesday, January 16, 2013 8:11 AM
> To: Danny Magat
> Subject: Re: [Chilli] RADIUS based way to set the per session
> 
> I am not sure what you mean. Inject per user you mean?
> 
>     $.getJSON("http://10.1.0.1:3990/json/status?callback=?",
> function(chilli) {
>         console.log(chilli);
>         if ($.inArray(chilli.session.userName, ['Cyndy', 'Chris']) != -1)
>         {
>             var addHeight =
> (/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent))
> ? 60 : 40;
>             $('body').height($('body').height() + addHeight);
>             $('body').append('<div style="position: fixed; bottom: 0;
> left: 0; right: 0; height: ' + addHeight + 'px; border-top: 2px solid
> #000; background-color: #fff"><iframe style="border: 0; width: 99%"
> src="http://10.1.0.1/toolbar.php"></iframe></div>');
>         }
>     });
> 
> On Tue, Jan 15, 2013 at 6:07 AM, Danny Magat <danny at sb-ps.ae> wrote:
> > Dear All,
> >
> >
> >
> > http://coova.org/node/4788#comment-9802
> >
> >
> >
> > Based on the above links by David there is a way on how to inject-URL per
> > session.
> >
> > Can somebody guide me on how to achieve this.
> >
> >
> >
> > Thanks in Advance.
> >
> > Danny
> >
> >
> > _______________________________________________
> > Chilli mailing list
> > Chilli at coova.org
> > http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> >
> 
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli



From david at coova.com  Thu Jan 17 19:03:10 2013
From: david at coova.com (David Bird)
Date: Thu, 17 Jan 2013 11:03:10 -0800
Subject: [Chilli] Problem in UAMALLOwing PayPal
In-Reply-To: <1485187659.46073.1358409923269.JavaMail.root@yetopen.it>
References: <1485187659.46073.1358409923269.JavaMail.root@yetopen.it>
Message-ID: <1358449390.6314.7.camel@david-laptop>

They could have changed the resources required for their page or are
using alternating DNS results for load balancing purposes. You could use
a chrome/firefox extension to monitor the requests being made by the
browser. You also might consider using uamdomain so that any round robin
DNS is picked up and added to the garden dynamically. 

David



On Thu, 2013-01-17 at 09:05 +0100, Lorenzo Milesi wrote:
> Hi. Since some weeks (maybe several) we're having troubles in UAMALLOWing paypal.
> We used to allow paypal.com, paypalobjects.com, paypal.2o7.net, but right now we're having timeouts on load, like it's trying to redirect to a disabled ssl site (we still have to figure out which).
> 
> Anyone else ran into the same issue?
> thanks
> 



From radius.sir at gmail.com  Fri Jan 18 10:24:26 2013
From: radius.sir at gmail.com (Russell Mike)
Date: Fri, 18 Jan 2013 10:24:26 +0000
Subject: [Chilli] Coova-Chilli DHCP Pools
Message-ID: <CADao4CqL38cugZ_GO6wCVzc64Jmw1Ct_Cm33zrwvxMGCHuRxpQ@mail.gmail.com>

My Greetings to Coova-Chilli Community,

Question about Covva-Chilli, i am new to Captive Portal concept, but i am
working on the Linux O/S for sometime now . i need help with respect to
Coova-Chilli captive portal. i managed to get the following working.

1.) Freeradius with rlm_sqlcounters such as "sql_bandwidth_counter",
"sql_traffic_quota_counter"  "dailycunter", "noresetcounter" etc..

2.) Daloradius to manage backend implementation of Freeradius & MySQL.

3.) Coova-Chilli up and running, displaying login page and login
successfully using Freeradious Vouchers, some basic attributes are also
working using mysql counter (MAX-DAILYS-ESSIONS & MAX-ALL-SESSION etc..)

4.) This is Ubuntu Server X64 12.4 LTS - Installation

Please i need the help for some advance configuration and attributes, i
would ask two questions, i afraid if my question would be correct, please
somebody help me

I don't have some fronted web interface to manage coova-chilli
implementation, such as, to view live used, kill connection etc. i have
come across the few JSON & YFi Manager.  i would like to seek advice for
the one that offers more flexibility and control to be used.


Is it possible to configure Covva-Chilli build in DHCP server to issue ip
address from multiple subnets to the clients. Such as, IP to HostSpot-A
from the range of 172.31.43.0 -  172.31.43.254 subnet And IP to HotSpot-B
from the rang of 41.232.222.0 subnet, like that? if someone can indicate
the directive, i am willing to study about it.

i.e. we have two hotspots A & B, we do not want vouchers to work across the
hotspots. Vouchers for HotSpot-A Should be Invalid at HotSpot-B) should
not allow to login. that means username/password somehow should be bounded
with the pool ip address (Perhaps With FreeRadius Attribute Using Group /
Profile). i want help to understand how that can logically work,


*PERHAPS, *

HotSpot-A = VLAN-ID: 10

configuring coova-chilli that when the dhcp request packet coming from VLAN
_ID:10 then ip should be issued from specific pool such as from from
172.31.43.0 subnet

HotSpot-B = VLAN-ID: 20

configuring coova-chilli that when the dhcp request packet coming from VLAN
_ID:20 then ip should be issued from specific pool such as from from
41.232.222.0 subnet

Why i am doing so because i do not want vouchers from Hotspot-A should work
at Hotspot-B

i want to make sure that perhaps there is better way to achieve that i am
overlooking. Is anyone managed to get that kind of environment working, i
want their opinion? There is unclear logical picture in the mind, looking
assistance for the clarity from the community friends. Below i am trying to
put little different way for same understanding incase i could not put my
question well.


Kindly help, how this scenario can work? conclusion of above question.

Guys, we have two hot spots, need coova-chilli dhcp server to configure
such as way that it should issue the ip address from the specified subnet
according to the VLAN (perhaps), if any other logic can be used please
advice. reason i am doing this because we do not want vouchers to work
across the hot spots. Voucher for the hotspot A should be invalid at
hotspot B, if this can be achieved any other way, your advice mean to me,
thanks for attending to this materiel.

Regards
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130118/487a4fdb/attachment.html>

From danny at sb-ps.ae  Fri Jan 18 18:49:58 2013
From: danny at sb-ps.ae (Danny Magat)
Date: Fri, 18 Jan 2013 22:49:58 +0400
Subject: [Chilli] RADIUS based way to set the per session
In-Reply-To: <1358447687.6314.3.camel@david-laptop>
References: <00a101cdf329$a886fd00$f994f700$@ae>
 <CAJc1nuoZ8Xe_T8eFbBNKSXKGABwHAneKOxoTRiP4YOLxN55hmg@mail.gmail.com>
 <000401cdf3c2$10a3aee0$31eb0ca0$@ae> <1358447687.6314.3.camel@david-laptop>
Message-ID: <B4F1D496-EC8A-4E69-8A96-C7EB5F9B4629@sb-ps.ae>

Thanks David,

I appreciate your response.

I would be more grateful if you can give more specific details on how to achieve this.
I trie putting value on radreply username := mac and Attributes := ChilliSpot-Inject-URL Value:= url 


On Jan 17, 2013, at 10:34 PM, David Bird <david at coova.com> wrote:

> You have tried the ChilliSpot-Inject-URL attribute? 
> 
> Also, it is also helpful to --enable-inspect so that chilli_query
> inspect mac <mac> gives you more information on per session
> configurations. 
> 
> David
> 
> 
> On Wed, 2013-01-16 at 12:17 +0400, Danny Magat wrote:
>> Yes inject url per user wherein the URL is coming from the radius reply.
>> 
>> 
>> -----Original Message-----
>> From: Jed Gainer [mailto:jedgainer at gmail.com] 
>> Sent: Wednesday, January 16, 2013 8:11 AM
>> To: Danny Magat
>> Subject: Re: [Chilli] RADIUS based way to set the per session
>> 
>> I am not sure what you mean. Inject per user you mean?
>> 
>>    $.getJSON("http://10.1.0.1:3990/json/status?callback=?",
>> function(chilli) {
>>        console.log(chilli);
>>        if ($.inArray(chilli.session.userName, ['Cyndy', 'Chris']) != -1)
>>        {
>>            var addHeight =
>> (/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent))
>> ? 60 : 40;
>>            $('body').height($('body').height() + addHeight);
>>            $('body').append('<div style="position: fixed; bottom: 0;
>> left: 0; right: 0; height: ' + addHeight + 'px; border-top: 2px solid
>> #000; background-color: #fff"><iframe style="border: 0; width: 99%"
>> src="http://10.1.0.1/toolbar.php"></iframe></div>');
>>        }
>>    });
>> 
>> On Tue, Jan 15, 2013 at 6:07 AM, Danny Magat <danny at sb-ps.ae> wrote:
>>> Dear All,
>>> 
>>> 
>>> 
>>> http://coova.org/node/4788#comment-9802
>>> 
>>> 
>>> 
>>> Based on the above links by David there is a way on how to inject-URL per
>>> session.
>>> 
>>> Can somebody guide me on how to achieve this.
>>> 
>>> 
>>> 
>>> Thanks in Advance.
>>> 
>>> Danny
>>> 
>>> 
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>> 
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> 
> 

From david at coova.com  Fri Jan 18 19:03:23 2013
From: david at coova.com (David Bird)
Date: Fri, 18 Jan 2013 11:03:23 -0800
Subject: [Chilli] RADIUS based way to set the per session
In-Reply-To: <B4F1D496-EC8A-4E69-8A96-C7EB5F9B4629@sb-ps.ae>
References: <00a101cdf329$a886fd00$f994f700$@ae>
 <CAJc1nuoZ8Xe_T8eFbBNKSXKGABwHAneKOxoTRiP4YOLxN55hmg@mail.gmail.com>
 <000401cdf3c2$10a3aee0$31eb0ca0$@ae> <1358447687.6314.3.camel@david-laptop>
 <B4F1D496-EC8A-4E69-8A96-C7EB5F9B4629@sb-ps.ae>
Message-ID: <1358535803.6922.1.camel@david-laptop>

You'd want to return the attribute in an Access-Reject. An Accept will
give them access without injecting the URL (which should point to a j/s
script). 


On Fri, 2013-01-18 at 22:49 +0400, Danny Magat wrote:
> Thanks David,
> 
> I appreciate your response.
> 
> I would be more grateful if you can give more specific details on how to achieve this.
> I trie putting value on radreply username := mac and Attributes := ChilliSpot-Inject-URL Value:= url 
> 
> 
> On Jan 17, 2013, at 10:34 PM, David Bird <david at coova.com> wrote:
> 
> > You have tried the ChilliSpot-Inject-URL attribute? 
> > 
> > Also, it is also helpful to --enable-inspect so that chilli_query
> > inspect mac <mac> gives you more information on per session
> > configurations. 
> > 
> > David
> > 
> > 
> > On Wed, 2013-01-16 at 12:17 +0400, Danny Magat wrote:
> >> Yes inject url per user wherein the URL is coming from the radius reply.
> >> 
> >> 
> >> -----Original Message-----
> >> From: Jed Gainer [mailto:jedgainer at gmail.com] 
> >> Sent: Wednesday, January 16, 2013 8:11 AM
> >> To: Danny Magat
> >> Subject: Re: [Chilli] RADIUS based way to set the per session
> >> 
> >> I am not sure what you mean. Inject per user you mean?
> >> 
> >>    $.getJSON("http://10.1.0.1:3990/json/status?callback=?",
> >> function(chilli) {
> >>        console.log(chilli);
> >>        if ($.inArray(chilli.session.userName, ['Cyndy', 'Chris']) != -1)
> >>        {
> >>            var addHeight =
> >> (/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent))
> >> ? 60 : 40;
> >>            $('body').height($('body').height() + addHeight);
> >>            $('body').append('<div style="position: fixed; bottom: 0;
> >> left: 0; right: 0; height: ' + addHeight + 'px; border-top: 2px solid
> >> #000; background-color: #fff"><iframe style="border: 0; width: 99%"
> >> src="http://10.1.0.1/toolbar.php"></iframe></div>');
> >>        }
> >>    });
> >> 
> >> On Tue, Jan 15, 2013 at 6:07 AM, Danny Magat <danny at sb-ps.ae> wrote:
> >>> Dear All,
> >>> 
> >>> 
> >>> 
> >>> http://coova.org/node/4788#comment-9802
> >>> 
> >>> 
> >>> 
> >>> Based on the above links by David there is a way on how to inject-URL per
> >>> session.
> >>> 
> >>> Can somebody guide me on how to achieve this.
> >>> 
> >>> 
> >>> 
> >>> Thanks in Advance.
> >>> 
> >>> Danny
> >>> 
> >>> 
> >>> _______________________________________________
> >>> Chilli mailing list
> >>> Chilli at coova.org
> >>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> >> 
> >> _______________________________________________
> >> Chilli mailing list
> >> Chilli at coova.org
> >> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> > 
> > 



From danny at sb-ps.ae  Sat Jan 19 14:27:10 2013
From: danny at sb-ps.ae (Danny Magat)
Date: Sat, 19 Jan 2013 18:27:10 +0400
Subject: [Chilli] RADIUS based way to set the per session
In-Reply-To: <1358447687.6314.3.camel@david-laptop>
References: <00a101cdf329$a886fd00$f994f700$@ae>
 <CAJc1nuoZ8Xe_T8eFbBNKSXKGABwHAneKOxoTRiP4YOLxN55hmg@mail.gmail.com>
 <000401cdf3c2$10a3aee0$31eb0ca0$@ae> <1358447687.6314.3.camel@david-laptop>
Message-ID: <000e01cdf651$117de6a0$3479b3e0$@sb-ps.ae>

Dear David,

Yes I am using ChilliSpot-Inject-URL attributes,
Below is my configuration:
Chilli.conf
--redir
-- macauth

-Radcheck-
Username = mac
Attributes = Auth-Type
Operator = :=
Value=Reject

Radreply
Username = 98-03-D8-F4-0D-90
Attributes = ChilliSpot-Inject-URL
Operator = :=
Value =  http://URL/inject.js

I did compile with --enable-inspect
And its showing below:

root at danny:/etc/chilli# chilli_query inspect mac 98-03-D8-F4-0D-90
MAC:   98-03-D8-F4-0D-90   IP:  10.1.0.2
---------------------------------------------------
              status: not authenticated
           challenge: 935faea8add1ab843786da6a87eed4e2
          session id: 50faa9e600000001
           user name: 98-03-D8-F4-0D-90
        session time: 0 sec
     session timeout: 0 sec
           idle time: 0 sec
        idle timeout: 0 sec
       octets in/out: in=down, out=up
           octets in: 0
          octets out: 0
          max b/w up: 0
        max b/w down: 0
      last sent time: 520 sec ago
           last seen: 513 sec ago
            user url: http://www.apple.com/library/test/success.html
           url param:
               flags:


am I missing something in the config? Because I am not able to redirect to injected page. Please advise...
-----Original Message-----
From: David Bird [mailto:david at coova.com] 
Sent: Thursday, January 17, 2013 10:35 PM
To: Danny Magat
Cc: 'Jed Gainer'; chilli at coova.org
Subject: Re: [Chilli] RADIUS based way to set the per session

You have tried the ChilliSpot-Inject-URL attribute? 

Also, it is also helpful to --enable-inspect so that chilli_query inspect mac <mac> gives you more information on per session configurations. 

David


On Wed, 2013-01-16 at 12:17 +0400, Danny Magat wrote:
> Yes inject url per user wherein the URL is coming from the radius reply.
> 
> 
> -----Original Message-----
> From: Jed Gainer [mailto:jedgainer at gmail.com]
> Sent: Wednesday, January 16, 2013 8:11 AM
> To: Danny Magat
> Subject: Re: [Chilli] RADIUS based way to set the per session
> 
> I am not sure what you mean. Inject per user you mean?
> 
>     $.getJSON("http://10.1.0.1:3990/json/status?callback=?",
> function(chilli) {
>         console.log(chilli);
>         if ($.inArray(chilli.session.userName, ['Cyndy', 'Chris']) != -1)
>         {
>             var addHeight =
> (/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent
> ))
> ? 60 : 40;
>             $('body').height($('body').height() + addHeight);
>             $('body').append('<div style="position: fixed; bottom: 0;
> left: 0; right: 0; height: ' + addHeight + 'px; border-top: 2px solid 
> #000; background-color: #fff"><iframe style="border: 0; width: 99%"
> src="http://10.1.0.1/toolbar.php"></iframe></div>');
>         }
>     });
> 
> On Tue, Jan 15, 2013 at 6:07 AM, Danny Magat <danny at sb-ps.ae> wrote:
> > Dear All,
> >
> >
> >
> > http://coova.org/node/4788#comment-9802
> >
> >
> >
> > Based on the above links by David there is a way on how to 
> > inject-URL per session.
> >
> > Can somebody guide me on how to achieve this.
> >
> >
> >
> > Thanks in Advance.
> >
> > Danny
> >
> >
> > _______________________________________________
> > Chilli mailing list
> > Chilli at coova.org
> > http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> >
> 
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli




From ynezz at true.cz  Sun Jan 20 20:13:43 2013
From: ynezz at true.cz (Petr =?iso-8859-2?Q?=A9tetiar?=)
Date: Sun, 20 Jan 2013 21:13:43 +0100
Subject: [Chilli] Multiple chilli instances on the same network
Message-ID: <20130120201343.GX16095@ibawizard.net>

Hi,

I wonder, what's the status of the "cluster" feature, mentioned here[1] for
the first time. I've looked at the source code of version 1.3.0 and it seems,
that there's only 'hello' command implemented so far, no client state sharing
etc (as mentioned in that David's email). It seems to me, like this feature
isn't completed yet, am I right? Can anyone shed some light onto this?

I just need to run about 3-5 APs to cover some bigger area and I would like to
allow authenticated users to roam between those APs and this 'cluster' feature
seems like a good solution.

Thanks for info.

1. http://lists.coova.org/pipermail/chilli/2010-September/001493.html

-- ynezz

From richard at rexy.fr  Sun Jan 20 23:12:51 2013
From: richard at rexy.fr (Richard REY)
Date: Mon, 21 Jan 2013 00:12:51 +0100
Subject: [Chilli] net.c : too many errors reporting
Message-ID: <50FC79F3.6090205@rexy.fr>

Hi,

Some systems stop after coova writes in the "/var/log/message" until the 
hard drive is full.

chilli.c: 5864: Successful UAM login from username=Gm0542 IP=172.16.13.30
net.c: 892: 11 (Resource temporarily unavailable) packet dropped due to 
congestion
net.c: 343: 2 (No such file or directory) epoll fd 5 not found
net.c: 915: 2 (No such file or directory) net_write_eth(fd=5, len=1514) 
failed
net.c: 777: 11 (Resource temporarily unavailable) could not read packet
net.c: 803: 11 (Resource temporarily unavailable) net_read_eth(fd=5, 
len=65497, mtu=1500) == -1
net.c: 777: 11 (Resource temporarily unavailable) could not read packet
net.c: 803: 11 (Resource temporarily unavailable) net_read_eth(fd=5, 
len=65497, mtu=1500) == -1

The last two lines are repeated each millisecond until the /var 
partition is full (and the system stop).

Any idea ?


-- 
           _._
          /_ _`.
          (.X.)|
          |\_/'|
          )____`\
         //_V _\ \
        ((  |  `(_)
       / \> '   / \
       \  \.__./  /
        `-'    `-'
      mageia Linux :
l'ind?pendance informatique
  fran?aise et europ?enne
     richard at rexy.fr


From ep at acm.org  Mon Jan 21 07:04:59 2013
From: ep at acm.org (Emanuele Pucciarelli)
Date: Mon, 21 Jan 2013 08:04:59 +0100
Subject: [Chilli] Multiple chilli instances on the same network
In-Reply-To: <20130120201343.GX16095@ibawizard.net>
References: <20130120201343.GX16095@ibawizard.net>
Message-ID: <CA+oQUaRQH2GSBALJbT-PG0dbnEfmt7tBEVm+KZkxNubcOG_MNA@mail.gmail.com>

On 20 January 2013 21:13, Petr ?tetiar <ynezz at true.cz> wrote:

> I wonder, what's the status of the "cluster" feature, mentioned here[1] for

Hello Petr,

> I just need to run about 3-5 APs to cover some bigger area and I would like to
> allow authenticated users to roam between those APs and this 'cluster' feature
> seems like a good solution.

I hope I'm not misunderstanding your question, but while the cluster
feature (which I'm not familiar with) would theoretically improve the
reliability of such a setup, you don't really need it to achieve what
you're looking at. I'm using the standard roaming capabilities of
ordinary APs with one instance of Chillispot, and it works just fine
on a small network of 3 APs, both with 802.1x and captive portal
authentication.

Best regards,

-- 
Emanuele

From ynezz at true.cz  Mon Jan 21 08:15:41 2013
From: ynezz at true.cz (Petr =?iso-8859-2?Q?=A9tetiar?=)
Date: Mon, 21 Jan 2013 09:15:41 +0100
Subject: [Chilli] Multiple chilli instances on the same network
In-Reply-To: <CA+oQUaRQH2GSBALJbT-PG0dbnEfmt7tBEVm+KZkxNubcOG_MNA@mail.gmail.com>
References: <20130120201343.GX16095@ibawizard.net>
 <CA+oQUaRQH2GSBALJbT-PG0dbnEfmt7tBEVm+KZkxNubcOG_MNA@mail.gmail.com>
Message-ID: <20130121081541.GY16095@ibawizard.net>

Emanuele Pucciarelli <ep at acm.org> [2013-01-21 08:04:59]:

Hi,

> I hope I'm not misunderstanding your question, but while the cluster
> feature (which I'm not familiar with) would theoretically improve the
> reliability of such a setup, you don't really need it to achieve what
> you're looking at. I'm using the standard roaming capabilities of
> ordinary APs with one instance of Chillispot, and it works just fine
> on a small network of 3 APs, both with 802.1x and captive portal
> authentication.

Yes, I could imagine that also, but in this setup, you've single point of
failure, right? If the AP which is running the Chilli instance goes down, then
you've a problem. What I would like to have instead, is Chilli running on all
the APs and share the client states between them, so if the user roams from
one Chilli instance to another one, he doesn't need to authenticate again.

-- ynezz

From ep at acm.org  Mon Jan 21 08:55:01 2013
From: ep at acm.org (Emanuele Pucciarelli)
Date: Mon, 21 Jan 2013 09:55:01 +0100
Subject: [Chilli] Multiple chilli instances on the same network
In-Reply-To: <20130121081541.GY16095@ibawizard.net>
References: <20130120201343.GX16095@ibawizard.net>
 <CA+oQUaRQH2GSBALJbT-PG0dbnEfmt7tBEVm+KZkxNubcOG_MNA@mail.gmail.com>
 <20130121081541.GY16095@ibawizard.net>
Message-ID: <CA+oQUaRnDPGQS1WTouqRdeo4d1JAbHesEvefj--qK16SO9Xpvw@mail.gmail.com>

Hi,

> Yes, I could imagine that also, but in this setup, you've single point of
> failure, right? If the AP which is running the Chilli instance goes down, then
> you've a problem. What I would like to have instead, is Chilli running on all
> the APs and share the client states between them, so if the user roams from
> one Chilli instance to another one, he doesn't need to authenticate again.

Correct! I almost forgot that it's designed to be run on access
points! :) What I'm doing in this case is, simply, running Chillispot
in a VM and handling availability at that level. My access points are
completely unaware of Chillispot, except for being configured to use
Chillispot as a RADIUS server and having both the 802.1x SSID and the
"captive portal" SSID bound to the VLAN where Chillispot's DHCP server
is listening.

Best regards,

-- 
Emanuele Pucciarelli

From david at coova.com  Mon Jan 21 18:37:41 2013
From: david at coova.com (David Bird)
Date: Mon, 21 Jan 2013 10:37:41 -0800
Subject: [Chilli] Multiple chilli instances on the same network
In-Reply-To: <CA+oQUaRnDPGQS1WTouqRdeo4d1JAbHesEvefj--qK16SO9Xpvw@mail.gmail.com>
References: <20130120201343.GX16095@ibawizard.net>
 <CA+oQUaRQH2GSBALJbT-PG0dbnEfmt7tBEVm+KZkxNubcOG_MNA@mail.gmail.com>
 <20130121081541.GY16095@ibawizard.net>
 <CA+oQUaRnDPGQS1WTouqRdeo4d1JAbHesEvefj--qK16SO9Xpvw@mail.gmail.com>
Message-ID: <1358793461.6241.6.camel@david-laptop>

"Roaming" can mean several things here. As correctly pointed out, it is
routine to allow for roaming authentication through standard RADIUS
practices - typically using 802.1x or mac authentication on UAM network.
You could also have roaming between APs where the same chilli session is
maintained where the APs bridge into the same network. However, that is
separate from the clustering feature, which is designed to provide fault
tolerance. The feature is not complete and has only been experimented
with (with encouraging results). The concept is to have multiple
instance of chilli synchronized and able to assume control over the
network segment should the primary instance fail. 


On Mon, 2013-01-21 at 09:55 +0100, Emanuele Pucciarelli wrote:
> Hi,
> 
> > Yes, I could imagine that also, but in this setup, you've single point of
> > failure, right? If the AP which is running the Chilli instance goes down, then
> > you've a problem. What I would like to have instead, is Chilli running on all
> > the APs and share the client states between them, so if the user roams from
> > one Chilli instance to another one, he doesn't need to authenticate again.
> 
> Correct! I almost forgot that it's designed to be run on access
> points! :) What I'm doing in this case is, simply, running Chillispot
> in a VM and handling availability at that level. My access points are
> completely unaware of Chillispot, except for being configured to use
> Chillispot as a RADIUS server and having both the 802.1x SSID and the
> "captive portal" SSID bound to the VLAN where Chillispot's DHCP server
> is listening.
> 
> Best regards,
> 

-- 
--
David Bird
http://www.linkedin.com/in/dwbird
https://twitter.com/wlanmac


From david at coova.com  Mon Jan 21 18:41:13 2013
From: david at coova.com (David Bird)
Date: Mon, 21 Jan 2013 10:41:13 -0800
Subject: [Chilli] RADIUS based way to set the per session
In-Reply-To: <000e01cdf651$117de6a0$3479b3e0$@sb-ps.ae>
References: <00a101cdf329$a886fd00$f994f700$@ae>
 <CAJc1nuoZ8Xe_T8eFbBNKSXKGABwHAneKOxoTRiP4YOLxN55hmg@mail.gmail.com>
 <000401cdf3c2$10a3aee0$31eb0ca0$@ae> <1358447687.6314.3.camel@david-laptop>
 <000e01cdf651$117de6a0$3479b3e0$@sb-ps.ae>
Message-ID: <1358793673.6241.9.camel@david-laptop>

Hi Danny,

I can't say I'm an expert on the functionality of FR and it's standard
database structure. Are you certain (via wireshark, etc) that FR is
putting the attribute out of the radreply table when the response is
Reject? 


On Sat, 2013-01-19 at 18:27 +0400, Danny Magat wrote:
> Dear David,
> 
> Yes I am using ChilliSpot-Inject-URL attributes,
> Below is my configuration:
> Chilli.conf
> --redir
> -- macauth
> 
> -Radcheck-
> Username = mac
> Attributes = Auth-Type
> Operator = :=
> Value=Reject
> 
> Radreply
> Username = 98-03-D8-F4-0D-90
> Attributes = ChilliSpot-Inject-URL
> Operator = :=
> Value =  http://URL/inject.js
> 
> I did compile with --enable-inspect
> And its showing below:
> 
> root at danny:/etc/chilli# chilli_query inspect mac 98-03-D8-F4-0D-90
> MAC:   98-03-D8-F4-0D-90   IP:  10.1.0.2
> ---------------------------------------------------
>               status: not authenticated
>            challenge: 935faea8add1ab843786da6a87eed4e2
>           session id: 50faa9e600000001
>            user name: 98-03-D8-F4-0D-90
>         session time: 0 sec
>      session timeout: 0 sec
>            idle time: 0 sec
>         idle timeout: 0 sec
>        octets in/out: in=down, out=up
>            octets in: 0
>           octets out: 0
>           max b/w up: 0
>         max b/w down: 0
>       last sent time: 520 sec ago
>            last seen: 513 sec ago
>             user url: http://www.apple.com/library/test/success.html
>            url param:
>                flags:
> 
> 
> am I missing something in the config? Because I am not able to redirect to injected page. Please advise...
> -----Original Message-----
> From: David Bird [mailto:david at coova.com] 
> Sent: Thursday, January 17, 2013 10:35 PM
> To: Danny Magat
> Cc: 'Jed Gainer'; chilli at coova.org
> Subject: Re: [Chilli] RADIUS based way to set the per session
> 
> You have tried the ChilliSpot-Inject-URL attribute? 
> 
> Also, it is also helpful to --enable-inspect so that chilli_query inspect mac <mac> gives you more information on per session configurations. 
> 
> David
> 
> 
> On Wed, 2013-01-16 at 12:17 +0400, Danny Magat wrote:
> > Yes inject url per user wherein the URL is coming from the radius reply.
> > 
> > 
> > -----Original Message-----
> > From: Jed Gainer [mailto:jedgainer at gmail.com]
> > Sent: Wednesday, January 16, 2013 8:11 AM
> > To: Danny Magat
> > Subject: Re: [Chilli] RADIUS based way to set the per session
> > 
> > I am not sure what you mean. Inject per user you mean?
> > 
> >     $.getJSON("http://10.1.0.1:3990/json/status?callback=?",
> > function(chilli) {
> >         console.log(chilli);
> >         if ($.inArray(chilli.session.userName, ['Cyndy', 'Chris']) != -1)
> >         {
> >             var addHeight =
> > (/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent
> > ))
> > ? 60 : 40;
> >             $('body').height($('body').height() + addHeight);
> >             $('body').append('<div style="position: fixed; bottom: 0;
> > left: 0; right: 0; height: ' + addHeight + 'px; border-top: 2px solid 
> > #000; background-color: #fff"><iframe style="border: 0; width: 99%"
> > src="http://10.1.0.1/toolbar.php"></iframe></div>');
> >         }
> >     });
> > 
> > On Tue, Jan 15, 2013 at 6:07 AM, Danny Magat <danny at sb-ps.ae> wrote:
> > > Dear All,
> > >
> > >
> > >
> > > http://coova.org/node/4788#comment-9802
> > >
> > >
> > >
> > > Based on the above links by David there is a way on how to 
> > > inject-URL per session.
> > >
> > > Can somebody guide me on how to achieve this.
> > >
> > >
> > >
> > > Thanks in Advance.
> > >
> > > Danny
> > >
> > >
> > > _______________________________________________
> > > Chilli mailing list
> > > Chilli at coova.org
> > > http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> > >
> > 
> > _______________________________________________
> > Chilli mailing list
> > Chilli at coova.org
> > http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> 
> 
> 

-- 
--
David Bird
http://www.linkedin.com/in/dwbird
https://twitter.com/wlanmac


From danny at sb-ps.ae  Tue Jan 22 11:44:58 2013
From: danny at sb-ps.ae (Danny Magat)
Date: Tue, 22 Jan 2013 15:44:58 +0400
Subject: [Chilli] RADIUS based way to set the per session
In-Reply-To: <1358793673.6241.9.camel@david-laptop>
References: <00a101cdf329$a886fd00$f994f700$@ae>
 <CAJc1nuoZ8Xe_T8eFbBNKSXKGABwHAneKOxoTRiP4YOLxN55hmg@mail.gmail.com>
 <000401cdf3c2$10a3aee0$31eb0ca0$@ae> <1358447687.6314.3.camel@david-laptop>
 <000e01cdf651$117de6a0$3479b3e0$@sb-ps.ae>
 <1358793673.6241.9.camel@david-laptop>
Message-ID: <001001cdf895$e7f633e0$b7e29ba0$@sb-ps.ae>


Hi David,

In freeradius adding the attributes ChilliSpot-Inject-URL =* ANY on attrs.access_reject file response back during the reject authentication.

[root at dannyraddb]# radtest 84-4B-F5-78-87-F6 password localhost:1812 0 testing123
Sending Access-Request of id 75 to 127.0.0.1 port 1812
        User-Name = "84-4B-F5-78-87-F6"
        User-Password = "password"
        NAS-IP-Address = 127.0.0.1
        NAS-Port = 0
        Message-Authenticator = 0x00000000000000000000000000000000
rad_recv: Access-Reject packet from host 127.0.0.1 port 1812, id=75, length=67
        ChilliSpot-Inject-URL = "http://URL/inject.js"
[root at dannyraddb]#

root at emaar:/etc/chilli# chilli_query inspect mac 84-4B-F5-78-87-F6
MAC:   84-4B-F5-78-87-F6   IP:  10.1.0.6
---------------------------------------------------
              status: not authenticated
           challenge: 2badfb4a129d6f1d9bbd6c185e8e34f1
          session id: 50fd2ca400000001
           user name: 84-4B-F5-78-87-F6
        session time: 0 sec
     session timeout: 0 sec
           idle time: 0 sec
        idle timeout: 3600 sec
       octets in/out: in=down, out=up
           octets in: 0
          octets out: 0
          max b/w up: 0
        max b/w down: 0
      last sent time: 469 sec ago
           last seen: 465 sec ago
            user url: http://www.google.com
           url param: http://URL/inject.js
               flags:   			<------------ do I need to put something here via radius. (ChilliSpot-Config) because during my test not from the radius reply, whenever I execute chilli_query update mac (mac) inject http://URL/inject.js it is having a value of "require-uam-auth inject"

Current I am still not able to browse internet  with this setup although it should give me internet with inject. But nothing... 


Thanks  


-----Original Message-----
From: David Bird [mailto:david at coova.com] 
Sent: Monday, January 21, 2013 10:41 PM
To: Danny Magat
Cc: 'Jed Gainer'; chilli at coova.org
Subject: RE: [Chilli] RADIUS based way to set the per session

Hi Danny,

I can't say I'm an expert on the functionality of FR and it's standard database structure. Are you certain (via wireshark, etc) that FR is putting the attribute out of the radreply table when the response is Reject? 


On Sat, 2013-01-19 at 18:27 +0400, Danny Magat wrote:
> Dear David,
> 
> Yes I am using ChilliSpot-Inject-URL attributes, Below is my 
> configuration:
> Chilli.conf
> --redir
> -- macauth
> 
> -Radcheck-
> Username = mac
> Attributes = Auth-Type
> Operator = :=
> Value=Reject
> 
> Radreply
> Username = 98-03-D8-F4-0D-90
> Attributes = ChilliSpot-Inject-URL
> Operator = :=
> Value =  http://URL/inject.js
> 
> I did compile with --enable-inspect
> And its showing below:
> 
> root at danny:/etc/chilli# chilli_query inspect mac 98-03-D8-F4-0D-90
> MAC:   98-03-D8-F4-0D-90   IP:  10.1.0.2
> ---------------------------------------------------
>               status: not authenticated
>            challenge: 935faea8add1ab843786da6a87eed4e2
>           session id: 50faa9e600000001
>            user name: 98-03-D8-F4-0D-90
>         session time: 0 sec
>      session timeout: 0 sec
>            idle time: 0 sec
>         idle timeout: 0 sec
>        octets in/out: in=down, out=up
>            octets in: 0
>           octets out: 0
>           max b/w up: 0
>         max b/w down: 0
>       last sent time: 520 sec ago
>            last seen: 513 sec ago
>             user url: http://www.apple.com/library/test/success.html
>            url param:
>                flags:
> 
> 
> am I missing something in the config? Because I am not able to redirect to injected page. Please advise...
> -----Original Message-----
> From: David Bird [mailto:david at coova.com]
> Sent: Thursday, January 17, 2013 10:35 PM
> To: Danny Magat
> Cc: 'Jed Gainer'; chilli at coova.org
> Subject: Re: [Chilli] RADIUS based way to set the per session
> 
> You have tried the ChilliSpot-Inject-URL attribute? 
> 
> Also, it is also helpful to --enable-inspect so that chilli_query inspect mac <mac> gives you more information on per session configurations. 
> 
> David
> 
> 
> On Wed, 2013-01-16 at 12:17 +0400, Danny Magat wrote:
> > Yes inject url per user wherein the URL is coming from the radius reply.
> > 
> > 
> > -----Original Message-----
> > From: Jed Gainer [mailto:jedgainer at gmail.com]
> > Sent: Wednesday, January 16, 2013 8:11 AM
> > To: Danny Magat
> > Subject: Re: [Chilli] RADIUS based way to set the per session
> > 
> > I am not sure what you mean. Inject per user you mean?
> > 
> >     $.getJSON("http://10.1.0.1:3990/json/status?callback=?",
> > function(chilli) {
> >         console.log(chilli);
> >         if ($.inArray(chilli.session.userName, ['Cyndy', 'Chris']) != -1)
> >         {
> >             var addHeight =
> > (/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAge
> > nt
> > ))
> > ? 60 : 40;
> >             $('body').height($('body').height() + addHeight);
> >             $('body').append('<div style="position: fixed; bottom: 
> > 0;
> > left: 0; right: 0; height: ' + addHeight + 'px; border-top: 2px 
> > solid #000; background-color: #fff"><iframe style="border: 0; width: 99%"
> > src="http://10.1.0.1/toolbar.php"></iframe></div>');
> >         }
> >     });
> > 
> > On Tue, Jan 15, 2013 at 6:07 AM, Danny Magat <danny at sb-ps.ae> wrote:
> > > Dear All,
> > >
> > >
> > >
> > > http://coova.org/node/4788#comment-9802
> > >
> > >
> > >
> > > Based on the above links by David there is a way on how to 
> > > inject-URL per session.
> > >
> > > Can somebody guide me on how to achieve this.
> > >
> > >
> > >
> > > Thanks in Advance.
> > >
> > > Danny
> > >
> > >
> > > _______________________________________________
> > > Chilli mailing list
> > > Chilli at coova.org
> > > http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> > >
> > 
> > _______________________________________________
> > Chilli mailing list
> > Chilli at coova.org
> > http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> 
> 
> 

--
--
David Bird
http://www.linkedin.com/in/dwbird
https://twitter.com/wlanmac



From radius.sir at gmail.com  Wed Jan 23 20:09:10 2013
From: radius.sir at gmail.com (Russell Mike)
Date: Wed, 23 Jan 2013 20:09:10 +0000
Subject: [Chilli] Coova-Chilli Compile Option
Message-ID: <CADao4Cp3-k7Jyv05k7CLqagZMmLkDr8LRU43O3eQSY5vBYmHNg@mail.gmail.com>

Hi list, i want to understand the meaning of following directive when
compiling coovachilli. I tried to google but still unable to.

./configure --enable-layer3

Does this mean if I compiled using this switch, coovachilli cannot be used
as layer2 model anymore, Such as multi tenant, Mac authentication & vlans?

And chilli would be configure for L3. Actually we may use L3 model in
future but L2 for now, need clarification about the switch

Thanks for attending to it.
RM
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130123/d192fde5/attachment.html>

From radius.sir at gmail.com  Wed Jan 23 20:07:47 2013
From: radius.sir at gmail.com (Russell Mike)
Date: Wed, 23 Jan 2013 20:07:47 +0000
Subject: [Chilli] Coova-Chilli DHCP Pools
In-Reply-To: <CADao4CqL38cugZ_GO6wCVzc64Jmw1Ct_Cm33zrwvxMGCHuRxpQ@mail.gmail.com>
References: <CADao4CqL38cugZ_GO6wCVzc64Jmw1Ct_Cm33zrwvxMGCHuRxpQ@mail.gmail.com>
Message-ID: <CADao4CrLWPhAk9boFxTfVUCtDs8bnKTD3oWL-Ug-cXQEd11--w@mail.gmail.com>

Hi list,
i want to understand the meaning of following directive when compiling
coovachilli. I tried to google but could not get some results explaining
that.

./configure --enable-layer3

Does this mean if I compiled using this switch, coovachilli cannot be used as
layer2 model anymore, Such as multi tenant, Mac authentication & vlans? And
chilli would be configure for L3. Actually we may use L3 model in future
but L2 for now, need clarification about the switch

Thanks for attending to it.
 RM


On Fri, Jan 18, 2013 at 10:24 AM, Russell Mike <radius.sir at gmail.com> wrote:

> My Greetings to Coova-Chilli Community,
>
> Question about Covva-Chilli, i am new to Captive Portal concept, but i am
> working on the Linux O/S for sometime now . i need help with respect to
> Coova-Chilli captive portal. i managed to get the following working.
>
> 1.) Freeradius with rlm_sqlcounters such as "sql_bandwidth_counter",
> "sql_traffic_quota_counter"  "dailycunter", "noresetcounter" etc..
>
> 2.) Daloradius to manage backend implementation of Freeradius & MySQL.
>
> 3.) Coova-Chilli up and running, displaying login page and login
> successfully using Freeradious Vouchers, some basic attributes are also
> working using mysql counter (MAX-DAILYS-ESSIONS & MAX-ALL-SESSION etc..)
>
> 4.) This is Ubuntu Server X64 12.4 LTS - Installation
>
> Please i need the help for some advance configuration and attributes, i
> would ask two questions, i afraid if my question would be correct, please
> somebody help me
>
> I don't have some fronted web interface to manage coova-chilli
> implementation, such as, to view live used, kill connection etc. i have
> come across the few JSON & YFi Manager.  i would like to seek advice for
> the one that offers more flexibility and control to be used.
>
>
> Is it possible to configure Covva-Chilli build in DHCP server to issue ip
> address from multiple subnets to the clients. Such as, IP to HostSpot-A
> from the range of 172.31.43.0 -  172.31.43.254 subnet And IP to HotSpot-B
> from the rang of 41.232.222.0 subnet, like that? if someone can indicate
> the directive, i am willing to study about it.
>
> i.e. we have two hotspots A & B, we do not want vouchers to work across
> the hotspots. Vouchers for HotSpot-A Should be Invalid at HotSpot-B)
> should  not allow to login. that means username/password somehow should be
> bounded with the pool ip address (Perhaps With FreeRadius Attribute Using
> Group / Profile). i want help to understand how that can logically work,
>
>
> *PERHAPS, *
>
> HotSpot-A = VLAN-ID: 10
>
> configuring coova-chilli that when the dhcp request packet coming from
> VLAN _ID:10 then ip should be issued from specific pool such as from from
> 172.31.43.0 subnet
>
> HotSpot-B = VLAN-ID: 20
>
> configuring coova-chilli that when the dhcp request packet coming from
> VLAN _ID:20 then ip should be issued from specific pool such as from from
> 41.232.222.0 subnet
>
> Why i am doing so because i do not want vouchers from Hotspot-A should
> work at Hotspot-B
>
> i want to make sure that perhaps there is better way to achieve that i am
> overlooking. Is anyone managed to get that kind of environment working, i
> want their opinion? There is unclear logical picture in the mind, looking
> assistance for the clarity from the community friends. Below i am trying to
> put little different way for same understanding incase i could not put my
> question well.
>
>
> Kindly help, how this scenario can work? conclusion of above question.
>
> Guys, we have two hot spots, need coova-chilli dhcp server to configure
> such as way that it should issue the ip address from the specified subnet
> according to the VLAN (perhaps), if any other logic can be used please
> advice. reason i am doing this because we do not want vouchers to work
> across the hot spots. Voucher for the hotspot A should be invalid at
> hotspot B, if this can be achieved any other way, your advice mean to me,
> thanks for attending to this materiel.
>
> Regards
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130123/5c49420c/attachment.html>

From david at coova.com  Wed Jan 23 21:31:57 2013
From: david at coova.com (David Bird)
Date: Wed, 23 Jan 2013 13:31:57 -0800
Subject: [Chilli] Coova-Chilli Compile Option
In-Reply-To: <CADao4Cp3-k7Jyv05k7CLqagZMmLkDr8LRU43O3eQSY5vBYmHNg@mail.gmail.com>
References: <CADao4Cp3-k7Jyv05k7CLqagZMmLkDr8LRU43O3eQSY5vBYmHNg@mail.gmail.com>
Message-ID: <1358976717.4793.2.camel@david-laptop>

Hi,

The compile time option just makes the feature available. You will still
be able to use Layer2 if you'd like. To enable the layer3 mode in
run-time, you have to add --layer3 to the runtime configuration. 

Cheers

On Wed, 2013-01-23 at 20:09 +0000, Russell Mike wrote:
> Hi list, i want to understand the meaning of following directive when
> compiling coovachilli. I tried to google but still unable to. 
> 
> 
> ./configure --enable-layer3
> 
> 
> Does this mean if I compiled using this switch, coovachilli cannot be
> used as layer2 model anymore, Such as multi tenant, Mac authentication
> & vlans? 
> 
> 
> And chilli would be configure for L3. Actually we may use L3 model in
> future but L2 for now, need clarification about the switch 
> 
> 
> Thanks for attending to it.
> RM
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli

-- 
--
David Bird
http://www.linkedin.com/in/dwbird
https://twitter.com/wlanmac


From ynezz at true.cz  Thu Jan 24 10:52:33 2013
From: ynezz at true.cz (Petr =?iso-8859-2?Q?=A9tetiar?=)
Date: Thu, 24 Jan 2013 11:52:33 +0100
Subject: [Chilli] Multiple chilli instances on the same network
In-Reply-To: <1358793461.6241.6.camel@david-laptop>
References: <20130120201343.GX16095@ibawizard.net>
 <CA+oQUaRQH2GSBALJbT-PG0dbnEfmt7tBEVm+KZkxNubcOG_MNA@mail.gmail.com>
 <20130121081541.GY16095@ibawizard.net>
 <CA+oQUaRnDPGQS1WTouqRdeo4d1JAbHesEvefj--qK16SO9Xpvw@mail.gmail.com>
 <1358793461.6241.6.camel@david-laptop>
Message-ID: <20130124105233.GH21029@ibawizard.net>

David Bird <david at coova.com> [2013-01-21 10:37:41]:

> You could also have roaming between APs where the same chilli session is
> maintained where the APs bridge into the same network.

Can you please tell me, how could I setup the chilli to have a same session
shared/maintained?

Ok, my scenario: 5 APs in the area, connected to the same LAN, remote AAA,
chilli running on every AP. Now if the client gets authenticated via UAM on
say AP1 and roams(losts coverage from AP1) to the AP2, then coova-chilli
instance running on AP2 doesn't have this user amongst authenticated users, so
user has to authenticate in UAM again.  Which is quite cumbersome.

One of the solutions(also proposed by the Emanuele) is to have only one chilli
instance, which would be common for the rest of the APs in the network, but
this has the drawback, that it's a single point of failure. So if this AP with
coova-chilli instance running goes down, whole network is inaccessible.

As I see the "cluster" feature in my use case, if the user gets authenticated
via UAM on AP1, AP1 would broadcast this event, say by NEW_AUTH_USER command
to other coova-chilli instances running on the network (with same shared
secret + session information) and if the user then roams(moves away from
coverage of AP1) to say AP2 in the network, then AP2 would already have this
user's session information and would just allow him to use the network. So in
this scenario, there's no single point of failure. It's kind of the
poor-mans's failover.

Thanks.

-- ynezz

From maxxer at ufficyo.com  Thu Jan 24 11:46:08 2013
From: maxxer at ufficyo.com (Lorenzo Milesi)
Date: Thu, 24 Jan 2013 12:46:08 +0100 (CET)
Subject: [Chilli] How does RADCONF work?
In-Reply-To: <13076930.262.1359025190651.JavaMail.maxxer@dharma>
Message-ID: <15164692.271.1359027964967.JavaMail.maxxer@dharma>

Hi.
How does the RADCONF option works?
I couldn't find documentation about that... Is ALL coova configurable via remote radius/url?  How are options declared?
thanks
-- 
Lorenzo Milesi - lorenzo.milesi at yetopen.it

GPG/PGP Key-Id: 0xE704E230 - http://keyserver.linux.it



From david at coova.com  Thu Jan 24 17:28:06 2013
From: david at coova.com (David Bird)
Date: Thu, 24 Jan 2013 09:28:06 -0800
Subject: [Chilli] Multiple chilli instances on the same network
In-Reply-To: <20130124105233.GH21029@ibawizard.net>
References: <20130120201343.GX16095@ibawizard.net>
 <CA+oQUaRQH2GSBALJbT-PG0dbnEfmt7tBEVm+KZkxNubcOG_MNA@mail.gmail.com>
 <20130121081541.GY16095@ibawizard.net>
 <CA+oQUaRnDPGQS1WTouqRdeo4d1JAbHesEvefj--qK16SO9Xpvw@mail.gmail.com>
 <1358793461.6241.6.camel@david-laptop>
 <20130124105233.GH21029@ibawizard.net>
Message-ID: <1359048486.4535.5.camel@david-laptop>

On Thu, 2013-01-24 at 11:52 +0100, Petr ?tetiar wrote:
> David Bird <david at coova.com> [2013-01-21 10:37:41]:
> 
> > You could also have roaming between APs where the same chilli session is
> > maintained where the APs bridge into the same network.
> 
> Can you please tell me, how could I setup the chilli to have a same session
> shared/maintained?
> 

By running a single instance of chilli. I wouldn't run it on an AP,
rather on a PC (appliance) where you have all your APs bridge into. This
way, you can use unmodified standard AP hardware/firmware and
subscribers will even maintain their same IP across APs. 

> Ok, my scenario: 5 APs in the area, connected to the same LAN, remote AAA,
> chilli running on every AP. Now if the client gets authenticated via UAM on
> say AP1 and roams(losts coverage from AP1) to the AP2, then coova-chilli
> instance running on AP2 doesn't have this user amongst authenticated users, so
> user has to authenticate in UAM again.  Which is quite cumbersome.
> 

Using MAC authentication, with the appropriate logic in your RADIUS
server, you can have subscribers automatically logged into chilli when
they move to a new chilli instance. 

> One of the solutions(also proposed by the Emanuele) is to have only one chilli
> instance, which would be common for the rest of the APs in the network, but
> this has the drawback, that it's a single point of failure. So if this AP with
> coova-chilli instance running goes down, whole network is inaccessible.
> 
> As I see the "cluster" feature in my use case, if the user gets authenticated
> via UAM on AP1, AP1 would broadcast this event, say by NEW_AUTH_USER command
> to other coova-chilli instances running on the network (with same shared
> secret + session information) and if the user then roams(moves away from
> coverage of AP1) to say AP2 in the network, then AP2 would already have this
> user's session information and would just allow him to use the network. So in
> this scenario, there's no single point of failure. It's kind of the
> poor-mans's failover.
> 

The problem there is that if each AP is running chilli, they are not
really on the same broadcast network -- each chilli has it's own local
network. 

> Thanks.
> 
> -- ynezz

-- 
--
David Bird
http://www.linkedin.com/in/dwbird
https://twitter.com/wlanmac


From jedgainer at gmail.com  Thu Jan 24 23:55:17 2013
From: jedgainer at gmail.com (Jed Gainer)
Date: Thu, 24 Jan 2013 15:55:17 -0800
Subject: [Chilli] limit bandwidth
Message-ID: <CAJc1nuqA8EgGitHrTu_BkM==aLDOj5M2ixkAoqzR_ksWLTG55w@mail.gmail.com>

Is there a way to limit the speeds of a user after they go over their
limit rather than kick them off?

From david at coova.com  Fri Jan 25 00:14:57 2013
From: david at coova.com (David Bird)
Date: Thu, 24 Jan 2013 16:14:57 -0800
Subject: [Chilli] limit bandwidth
In-Reply-To: <CAJc1nuqA8EgGitHrTu_BkM==aLDOj5M2ixkAoqzR_ksWLTG55w@mail.gmail.com>
References: <CAJc1nuqA8EgGitHrTu_BkM==aLDOj5M2ixkAoqzR_ksWLTG55w@mail.gmail.com>
Message-ID: <1359072897.4535.10.camel@david-laptop>

You could:

- Use acctupdate option
- Don't limit data on Access-Accept
- Have RADIUS server return bandwidth limiting attributes in
Accounting-Response after the data limit has been reached


On Thu, 2013-01-24 at 15:55 -0800, Jed Gainer wrote:
> Is there a way to limit the speeds of a user after they go over their
> limit rather than kick them off?
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli

-- 
--
David Bird
http://www.linkedin.com/in/dwbird
https://twitter.com/wlanmac


From ynezz at true.cz  Fri Jan 25 08:11:46 2013
From: ynezz at true.cz (Petr =?iso-8859-2?Q?=A9tetiar?=)
Date: Fri, 25 Jan 2013 09:11:46 +0100
Subject: [Chilli] Multiple chilli instances on the same network
In-Reply-To: <1359048486.4535.5.camel@david-laptop>
References: <20130120201343.GX16095@ibawizard.net>
 <CA+oQUaRQH2GSBALJbT-PG0dbnEfmt7tBEVm+KZkxNubcOG_MNA@mail.gmail.com>
 <20130121081541.GY16095@ibawizard.net>
 <CA+oQUaRnDPGQS1WTouqRdeo4d1JAbHesEvefj--qK16SO9Xpvw@mail.gmail.com>
 <1358793461.6241.6.camel@david-laptop> <20130124105233.GH21029@ibawizard.net>
 <1359048486.4535.5.camel@david-laptop>
Message-ID: <20130125081146.GJ21029@ibawizard.net>

David Bird <david at coova.com> [2013-01-24 09:28:06]:

> Using MAC authentication, with the appropriate logic in your RADIUS
> server, you can have subscribers automatically logged into chilli when
> they move to a new chilli instance.

Ah, I've maybe misread the docs, but I've assumed, that the macauth is just
authentication based on the MAC and I've missed the point, that if the user
isn't authenticated, then she would be redirected to the UAM. So this is
actually solution, thanks.
 
> The problem there is that if each AP is running chilli, they are not
> really on the same broadcast network -- each chilli has it's own local
> network.

That's of course one of the assumptions, that they would be reachable by the
broadcasts.

Thanks.

-- ynezz

From radius.sir at gmail.com  Fri Jan 25 14:40:26 2013
From: radius.sir at gmail.com (Russell Mike)
Date: Fri, 25 Jan 2013 14:40:26 +0000
Subject: [Chilli] Reducing MTU Coova-Chilli 1.3.0
Message-ID: <CADao4CpNDc5OTZ=8XXAEO5FdWt3nE0NA_rApLOFSBJn9afdh+g@mail.gmail.com>

Dear List Greetings,

i wish to reduce the MTU size for Chilli due to VLAN headers, my network
card do not support auto adjustment stuff.

which directive would reduce the MTU to 1400 ?

Thanks / RM
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130125/9551ae41/attachment.html>

From david at coova.com  Fri Jan 25 16:49:42 2013
From: david at coova.com (David Bird)
Date: Fri, 25 Jan 2013 08:49:42 -0800
Subject: [Chilli] Multiple chilli instances on the same network
In-Reply-To: <20130125081146.GJ21029@ibawizard.net>
References: <20130120201343.GX16095@ibawizard.net>
 <CA+oQUaRQH2GSBALJbT-PG0dbnEfmt7tBEVm+KZkxNubcOG_MNA@mail.gmail.com>
 <20130121081541.GY16095@ibawizard.net>
 <CA+oQUaRnDPGQS1WTouqRdeo4d1JAbHesEvefj--qK16SO9Xpvw@mail.gmail.com>
 <1358793461.6241.6.camel@david-laptop>
 <20130124105233.GH21029@ibawizard.net>
 <1359048486.4535.5.camel@david-laptop>
 <20130125081146.GJ21029@ibawizard.net>
Message-ID: <1359132582.6307.2.camel@david-laptop>

Yes, macauth is indeed just authentication based on the mac address,
during DHCP (so, immediately after the subscriber associates). If
Access-Accept is returned, then no captive portal. If Reject is
returned, then they do get the portal. If your RADIUS server considers
the fact that this mac is already authenticated (i.e. has an active
session on some other chilli), then you can return the Access-Accept. 

Cheers,
David

On Fri, 2013-01-25 at 09:11 +0100, Petr ?tetiar wrote:
> David Bird <david at coova.com> [2013-01-24 09:28:06]:
> 
> > Using MAC authentication, with the appropriate logic in your RADIUS
> > server, you can have subscribers automatically logged into chilli when
> > they move to a new chilli instance.
> 
> Ah, I've maybe misread the docs, but I've assumed, that the macauth is just
> authentication based on the MAC and I've missed the point, that if the user
> isn't authenticated, then she would be redirected to the UAM. So this is
> actually solution, thanks.
>  
> > The problem there is that if each AP is running chilli, they are not
> > really on the same broadcast network -- each chilli has it's own local
> > network.
> 
> That's of course one of the assumptions, that they would be reachable by the
> broadcasts.
> 
> Thanks.
> 
> -- ynezz

-- 
--
David Bird
http://www.linkedin.com/in/dwbird
https://twitter.com/wlanmac


From david at coova.com  Fri Jan 25 16:52:23 2013
From: david at coova.com (David Bird)
Date: Fri, 25 Jan 2013 08:52:23 -0800
Subject: [Chilli] Reducing MTU Coova-Chilli 1.3.0
In-Reply-To: <CADao4CpNDc5OTZ=8XXAEO5FdWt3nE0NA_rApLOFSBJn9afdh+g@mail.gmail.com>
References: <CADao4CpNDc5OTZ=8XXAEO5FdWt3nE0NA_rApLOFSBJn9afdh+g@mail.gmail.com>
Message-ID: <1359132743.6307.3.camel@david-laptop>


--mtu=1400

On Fri, 2013-01-25 at 14:40 +0000, Russell Mike wrote:
> Dear List Greetings,
> 
> 
> i wish to reduce the MTU size for Chilli due to VLAN headers, my
> network card do not support auto adjustment stuff. 
> 
> 
> which directive would reduce the MTU to 1400 ?
> 
> 
> Thanks / RM
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli



From radius.sir at gmail.com  Sat Jan 26 19:57:55 2013
From: radius.sir at gmail.com (Russell Mike)
Date: Sat, 26 Jan 2013 19:57:55 +0000
Subject: [Chilli] different landing page (Captive Portal Login Page) for
	each customer
Message-ID: <CADao4CrM1CO8X9+0yfb8bomumMFydWKkKkyxtGgLhNNUed9_Jg@mail.gmail.com>

Dear David B.

i work with an ISP and i have been assigned a task to replace a commercial
captive portal solution with open source. i have already decided to move
forward with CoovaChilli. I have almost completed 70% research of features
those we are expecting from  open source captive portal application. i have
working setup of Freeradius + Daloradius + MySQL + CoovaChilli. i have
tested the following attributes of Freeradius with CoovaChilli and they
worked so well.

1.) Session timeout

2.) Account Expiration

3.) Traffic Quota

4.) Time Based Vouchers

5.) Simultaneous Use

We want to do the following, i wish to know if it is possible with Chilli.

A.) We want Chilli to run VLANs (Multi Tenant), i know Chilli supports
that, Fine, i am okay.

B.) We want different landing page (Captive Portal Login Page) for each
customer that can display their logo on login page. Idea is that Chilli
will run in multi tenant mode with VLANs. Each instance will display
separate page. Can that work, has anyone got it working? Logically it looks
possible but i wish to ask your advice because i am not 100% sure.

Thanks / Russell M.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130126/d9bb4564/attachment.html>

From jedgainer at gmail.com  Sun Jan 27 02:39:01 2013
From: jedgainer at gmail.com (Jed Gainer)
Date: Sat, 26 Jan 2013 18:39:01 -0800
Subject: [Chilli] user details
Message-ID: <CAJc1nuovGLHry0NM7uw3fWbso9bkAMig+5v4HPjwwERgLrew6g@mail.gmail.com>

I am working on an administration panel for a hotel and would like to
display identifying details on each MAC. Is there a way to access
details the user provided in the DHCP request? Ideas on what else I
could display?

I don't want to have to make a Java applet be part of the captive
portal login but at this point I see no other options.

From info at easyhorpak.com  Sun Jan 27 03:27:53 2013
From: info at easyhorpak.com (EasyHorpak.com)
Date: Sun, 27 Jan 2013 10:27:53 +0700
Subject: [Chilli] different landing page (Captive Portal Login Page) for
 each customer
In-Reply-To: <CADao4CrM1CO8X9+0yfb8bomumMFydWKkKkyxtGgLhNNUed9_Jg@mail.gmail.com>
References: <CADao4CrM1CO8X9+0yfb8bomumMFydWKkKkyxtGgLhNNUed9_Jg@mail.gmail.com>
Message-ID: <51049EB9.1090309@easyhorpak.com>

An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130127/7688d20c/attachment.html>

From radius.sir at gmail.com  Sun Jan 27 09:13:43 2013
From: radius.sir at gmail.com (Russell Mike)
Date: Sun, 27 Jan 2013 09:13:43 +0000
Subject: [Chilli] different landing page (Captive Portal Login Page) for
	each customer
In-Reply-To: <51049EB9.1090309@easyhorpak.com>
References: <CADao4CrM1CO8X9+0yfb8bomumMFydWKkKkyxtGgLhNNUed9_Jg@mail.gmail.com>
 <51049EB9.1090309@easyhorpak.com>
Message-ID: <CADao4CrD8G_RgJX7sTNQZd6pWB59k-sUqMOSV=e3816O8U=Juw@mail.gmail.com>

On Sunday, January 27, 2013, EasyHorpak.com wrote:

>  On 27/01/2556 02:57, Russell Mike wrote:
>
>  Dear David B.
>
> i work with an ISP and i have been assigned a task to replace a commercial
> captive portal solution with open source. i have already decided to move
> forward with CoovaChilli. I have almost completed 70% research of features
> those we are expecting from  open source captive portal application. i have
> working setup of Freeradius + Daloradius + MySQL + CoovaChilli. i have
> tested the following attributes of Freeradius with CoovaChilli and they
> worked so well.
>
> 1.) Session timeout
>
> 2.) Account Expiration
>
> 3.) Traffic Quota
>
> 4.) Time Based Vouchers
>
> 5.) Simultaneous Use
>
> We want to do the following, i wish to know if it is possible with Chilli.
>
> A.) We want Chilli to run VLANs (Multi Tenant), i know Chilli supports
> that, Fine, i am okay.
>
> I use ubuntu I can install vlan and config vlan as eth1.101
> then set chilli to listen on eth1.101
> you can use multi chilli with comamnd
> chilli -c chilli-vlan101.conf
> chilli -c chilli-vlan102.conf
> chilli -c chilli-vlan103.conf
>
>  B.) We want different landing page (Captive Portal Login Page) for each
> customer that can display their logo on login page. Idea is that Chilli
> will run in multi tenant mode with VLANs. Each instance will display
> separate page. Can that work, has anyone got it working? Logically it looks
> possible but i wish to ask your advice because i am not 100% sure.
>
> You can setting landing page on chilli -c chilli-vlan101.conf with option
> uamserver http://www.your-landing-page-for-customer1-vlan101.com/login.php
> <http://www.your-landing-page-for-customer1-vlan101.com/login.php>
>


> Thanks Man,
> For the guidelines, since you told me that it is possible, I will study
> more. Big thanks to Chilli community
> Russell M
>
>
>
> _______________________________________________
> Chilli mailing listChilli at coova.org <javascript:_e({}, 'cvml', 'Chilli at coova.org');>http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130127/77164a77/attachment.html>

From anders at anduras.de  Wed Jan 30 15:28:34 2013
From: anders at anduras.de (Sven Anders)
Date: Wed, 30 Jan 2013 16:28:34 +0100
Subject: [Chilli] Bugs and patches
Message-ID: <51093C22.6080402@anduras.de>

Bug reports for "coova-chilli-1.3.0"

I compile with the following options:
 --with-openssl --with-mmap --with-poll --enable-largelimits --enable-binstatusfile --enable-statusfile \
 --enable-chilliproxy --enable-chilliradsec --enable-chilliredir --enable-chilliscript --enable-ieee8023 \
 --enable-multiroute

1) If I try to compile without the "--enable-multiroute" option:

chilli.c: In function 'chilli_main':
chilli.c:7540:26: error: 'struct tun_t' has no member named '_interface_count'
chilli.c:7541:16: error: 'struct tun_t' has no member named '_interfaces'

Compiling with this option enabled works fine.


2) I get the following warnings, which are treated as errors:

cc1: warnings being treated as errors
net.c: In function 'net_open_eth':
net.c:1189:22: error: unused variable 'mr'
net.c: At top level:
net.c:1938:13: error: 'setup_filter' defined but not used

I removed the -Werror option from the Makefile.


3) If you start chilli without stdin/stdout/stderr, the file descriptor of opened
   files may be 0.

Patch attached.

4) The default parameters should be initialized right after it's creation.
   (This solved a problem I did not remember).

Patch attached.

5) It should be possible to use the chilli with its own DNS server settings.
   Currently the DNS server settings from the host are used, if none are
   configured.
   I added a new option "--nosystemdns" for that.

Patch attached.


Regards
 Sven Anders

-- 
 Sven Anders <anders at anduras.de>                 () UTF-8 Ribbon Campaign
                                                 /\ Support plain text e-mail
 ANDURAS intranet security AG
 Messestrasse 3 - 94036 Passau - Germany
 Web: www.anduras.de - Tel: +49 (0)851-4 90 50-0 - Fax: +49 (0)851-4 90 50-55

Those who would give up essential Liberty, to purchase a little
temporary Safety, deserve neither Liberty nor Safety.
  - Benjamin Franklin

-------------- next part --------------
A non-text attachment was scrubbed...
Name: coova-macallowed.patch
Type: text/x-diff
Size: 2080 bytes
Desc: not available
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130130/5d7d3b4c/attachment.patch>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: coova-nosystemdns.patch
Type: text/x-diff
Size: 6205 bytes
Desc: not available
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130130/5d7d3b4c/attachment-0001.patch>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: coova-options-load.patch
Type: text/x-diff
Size: 1254 bytes
Desc: not available
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130130/5d7d3b4c/attachment-0002.patch>

From anders at anduras.de  Wed Jan 30 15:20:40 2013
From: anders at anduras.de (Sven Anders)
Date: Wed, 30 Jan 2013 16:20:40 +0100
Subject: [Chilli] Bugs and patches
Message-ID: <51093A48.6070204@anduras.de>

Bug reports for "coova-chilli-1.3.0"

I compile with the following options:
 --with-openssl --with-mmap --with-poll --enable-largelimits --enable-binstatusfile --enable-statusfile \
 --enable-chilliproxy --enable-chilliradsec --enable-chilliredir --enable-chilliscript --enable-ieee8023 \
 --enable-multiroute

1) If I try to compile without the "--enable-multiroute" option:

chilli.c: In function 'chilli_main':
chilli.c:7540:26: error: 'struct tun_t' has no member named '_interface_count'
chilli.c:7541:16: error: 'struct tun_t' has no member named '_interfaces'

Compiling with this option enabled works fine.


2) I get the following warnings, which are treated as errors:

cc1: warnings being treated as errors
net.c: In function 'net_open_eth':
net.c:1189:22: error: unused variable 'mr'
net.c: At top level:
net.c:1938:13: error: 'setup_filter' defined but not used

I removed the -Werror option from the Makefile.


3) If you start chilli without stdin/stdout/stderr, the file descriptor of opened
   files may be 0.

Patch attached.

4) The default parameters should be initialized right after it's creation.
   (This solved a problem I did not remember).

Patch attached.

5) It should be possible to use the chilli with its own DNS server settings.
   Currently the DNS server settings from the host are used, if none are
   configured.
   I added a new option "--nosystemdns" for that.

Patch attached.


Regards
 Sven Anders

-- 
 Sven Anders <anders at anduras.de>                 () UTF-8 Ribbon Campaign
                                                 /\ Support plain text e-mail
 ANDURAS intranet security AG
 Messestrasse 3 - 94036 Passau - Germany
 Web: www.anduras.de - Tel: +49 (0)851-4 90 50-0 - Fax: +49 (0)851-4 90 50-55

Those who would give up essential Liberty, to purchase a little
temporary Safety, deserve neither Liberty nor Safety.
  - Benjamin Franklin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: coova-macallowed.patch
Type: text/x-diff
Size: 2079 bytes
Desc: not available
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130130/b1f0953c/attachment.patch>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: coova-nosystemdns.patch
Type: text/x-diff
Size: 6204 bytes
Desc: not available
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130130/b1f0953c/attachment-0001.patch>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: coova-options-load.patch
Type: text/x-diff
Size: 1253 bytes
Desc: not available
URL: <http://lists.coova.org/pipermail/chilli/attachments/20130130/b1f0953c/attachment-0002.patch>

From steffen.dettmer at nomadrail.com  Thu Jan 31 10:08:40 2013
From: steffen.dettmer at nomadrail.com (Steffen Dettmer)
Date: Thu, 31 Jan 2013 10:08:40 +0000
Subject: [Chilli] Coova Chilli only working without --fg --debug?
Message-ID: <8C2CB2442BFDDB4D95785B991B30D34621ECB231@DBXPRD0510MB372.eurprd05.prod.outlook.com>

Hi,

I tried /etc/init.d/chilli start ; /etc/init.d/chilli stop ; chilli --fg --debug
But didn't even made it to receive a redirect on the client. I tried for
hours while trying hints proposed by Google...

Going desperate, I tried /etc/init.d/chilli start and suddenly get redirect
to a working login form and finally ended up at the original page!

Is there an issue with --fg --debug?

[it seems to be reproducible, when stopping and running --fg --debug again,
I don't even get any redirect; /etc/init.d/chilli start and things are fine.]

Syslog is a bit brief in this mode  of operation (fine if it works, but a
bit too brief for troubleshooting), can it be increased by some option?

Any comments appreciated.

Regards,
Steffen

ps:
I followed [1] using [2], but my setup is a bit more complex and involves
OpenVPN bridging to get the client network to the Coova Chilli box and
is using two Virtual Box appliances.
[1] https://help.ubuntu.com/community/WifiDocs/CoovaChilli
[2] http://coova-chilli.s3.amazonaws.com/coova-chilli_1.3.0_i386.deb


