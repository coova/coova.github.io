<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> dns tunnels a threat?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:chilli%40coova.org?Subject=Re%3A%20dns%20tunnels%20a%20threat%3F&In-Reply-To=%3C96b73a1a0709070426r3c7e6bb1w3390abc30e9a0625%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000037.html">
   <LINK REL="Next"  HREF="000045.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>dns tunnels a threat?</H1>
    <B>Yannick Deltroo</B> 
    <A HREF="mailto:chilli%40coova.org?Subject=Re%3A%20dns%20tunnels%20a%20threat%3F&In-Reply-To=%3C96b73a1a0709070426r3c7e6bb1w3390abc30e9a0625%40mail.gmail.com%3E"
       TITLE="dns tunnels a threat?">deltroo at gmail.com
       </A><BR>
    <I>Fri Sep  7 11:26:08 UTC 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000037.html">dns tunnels a threat?
</A></li>
        <LI>Next message: <A HREF="000045.html">dns tunnels a threat?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41">[ date ]</a>
              <a href="thread.html#41">[ thread ]</a>
              <a href="subject.html#41">[ subject ]</a>
              <a href="author.html#41">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i> &gt; 3 - coova IDNS resolves any other hostname to the uamhomepage IP (with
</I>&gt;<i> &gt; no-cache/ 1 second TTL).
</I>&gt;<i>
</I>&gt;<i> This won't work.
</I>&gt;<i> TTL and cache are in the rfc of dns. But the majority of the browsers,
</I>&gt;<i> expecially for Internet Explorer but also for many others, and many
</I>&gt;<i> resolvers don't implement a cache system based on TTL.
</I>&gt;<i>
</I>&gt;<i> They simply have an internal cache.
</I>&gt;<i>
</I>&gt;<i> For example in IE/Windows there's an internal resolver cache with
</I>&gt;<i> 3600 seconds ( yes, 1 hour) of timeout by default. You can change
</I>&gt;<i> the timeout *only* by changing some key with regedit.
</I>&gt;<i>
</I>You're right. I did some quick research, it seems like the default DNS
caching for IE is 30 minutes:
<A HREF="http://support.microsoft.com/default.aspx?scid=KB;en-us;263558">http://support.microsoft.com/default.aspx?scid=KB;en-us;263558</A>

A coova internal DNS server would then have to parse DNS responses
from upstream servers to extract the IP... and maybe remove (modify?)
all (some?) DNS fields that may be used for the payload.

Removing TXT fields as David initially proposed should break existing
DNS tunnels.
As fas I know it's only used by spam filers (SPF) and should not be a problem.

Have you experienced unwanted side effects when filtering DNS
responses in your set-up?

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000037.html">dns tunnels a threat?
</A></li>
	<LI>Next message: <A HREF="000045.html">dns tunnels a threat?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#41">[ date ]</a>
              <a href="thread.html#41">[ thread ]</a>
              <a href="subject.html#41">[ subject ]</a>
              <a href="author.html#41">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">More information about the Chilli
mailing list</a><br>
</body></html>
