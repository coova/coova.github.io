From richard at rexy.fr  Mon Mar  2 21:12:37 2015
From: richard at rexy.fr (Richard REY)
Date: Mon, 02 Mar 2015 22:12:37 +0100
Subject: [Chilli] Too sharp upload bandwidth limit on 1gbps wired network
In-Reply-To: <224842392.61573.1425091022824.JavaMail.yahoo@mail.yahoo.com>
References: <54F0E916.9060702@rexy.fr>
 <224842392.61573.1425091022824.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <54F4D245.6050003@rexy.fr>

I've just tested to disable "GRO - Generic Receive Offload" (ethtool -K 
gro off) on the coova Gb NIC, and it fixes the issue.
The result for the upload bandwidth :
  - W/O coova & GRO on = 800Mb/s (jumbo frames)
  - W/O coova & GRO off = 700Mb/s (jumbo frames)
  - W coova & GRO on = 70Kb/s (lot of ICMP packets "fragmentation needed")
  - W coova & GRO off = 250Mb/s (no ICMP - no jumbo frame - coova uses 
100% of CPU)

As i understand the meaning of GRO, can somebody explain me the 
technical problem with coova & "GRO on"?

Rexy

Le 28/02/2015 03:37, kl a ?crit :
>
>
> Based on my testing, turn off generic receive offload fixes my issue of too sharp upload bandwidth limit on 1 Gb wired network.
>
> But the strange thing is older kernel has the same setting 'on' and without problem, while newer kernel has to turn it 'off'.
>
>
> On Saturday, February 28, 2015 6:01 AM, Richard REY <richard at rexy.fr> wrote:
> Yes, but this doesn't explain why there isn't any problem when the flows
> pass through the appliance. this issue is seen only when the TCP flows
> is sent to an internal processes
>
> I'll try to disable packet off-loading next monday.
> I'll also try to forbid the "jumbo frame" on NIC
>
> Rexy
>
> Le 27/02/2015 20:50, Alexandru Gheorghe a ?crit :
>> Usually fragmentation needed means you need to adjust the MTU of your nic.
>>
>> Alex
>>
>>
>> On 02/26/2015 02:30 PM, Claus Stjernoe wrote:
>>> Hi Richard,
>>>
>>> Try to disable packet off-loading on the Gigabit NIC.
>>>
>>> Kind regards,
>>> Claus
>>>
>>> -----Oprindelig meddelelse-----
>>> Fra: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] P? vegne af chilli-request at coova.org
>>> Sendt: 26. februar 2015 13:00
>>> Til: chilli at coova.org
>>> Emne: Chilli Digest, Vol 63, Issue 14
>>>
>>> Send Chilli mailing list submissions to
>>>      chilli at coova.org
>>>
>>> To subscribe or unsubscribe via the World Wide Web, visit
>>>      http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>> or, via email, send a message with subject or body 'help' to
>>>      chilli-request at coova.org
>>>
>>> You can reach the person managing the list at
>>>      chilli-owner at coova.org
>>>
>>> When replying, please edit your Subject line so it is more specific than "Re: Contents of Chilli digest..."
>>>
>>>
>>> Today's Topics:
>>>
>>>      1. Re: Chilli Digest, Vol 63, Issue 12 (Richard REY)
>>>
>>>
>>> ----------------------------------------------------------------------
>>>
>>> Message: 1
>>> Date: Wed, 25 Feb 2015 22:48:56 +0100
>>> From: Richard REY <richard at rexy.fr>
>>> To: chilli at coova.org
>>> Subject: Re: [Chilli] Chilli Digest, Vol 63, Issue 12
>>> Message-ID: <54EE4348.2090503 at rexy.fr>
>>> Content-Type: text/plain; charset=windows-1252; format=flowed
>>>
>>> Hi,
>>> I use COOVA in its last version (SVN revision 492) running on an ALCASAR appliance (mageia 4.1 - kernel 3.14.32), all is OK excepted a flow issue.
>>> When a TCP stream goes across the appliance there isn't any flow issue (forward mode). BUT when a TCP stream is sent inside the appliance (to a HTTP proxy for example) the observed flow is very weak (Input mode). The problem is maximal when the card connected to COOVA is in the Gigabit mode.
>>>
>>> Our investigation :
>>>    From the appliance, we try to download a file located on a FTP server connected on the network controlled by COOVA. Without COOVA the observed flow in gigabit mode is about 888Mb/s whereas with COOVA we can see just
>>> 68 Kb/s (YES 68 Kb/s). Regarding the packets exchanged we can see ICMP packets sent by the appliance (Destination unreachable (Fragmentation needed).
>>> We found a by-pass ?solution? by fixing the speed of the card to 100Mb/s. At this speed the phenomenon is practically invisible (just one ICMP packet sent) and the flow approaches the maximum supported by the network card. On a virtual machine where we can't fix Ethernet speed, we must choose a 100Mb/s virtual Ethernet card when building the VM.
>>> We have the Pcap file of our investigation. I say it again, this issue is seen only when the TCP flows is sent to an internal processes (in 'forward' mode all is ok).
>>>
>>> Regards
>>> Rexy & ALCASAR team
>>>
>>> Le 23/02/2015 08:59, kl a ?crit :
>>>> I see problem on kernel version > 3.7 right up to 3.10.  Above 3.10 not tested.
>>>> However, in the other quoted post, it says kernel 2.6.39 upto 3.3.4. Above that not tested.
>>>> Something not consist here.
>>>>
>>>> So which kernel version you guys are using which are seeing this problem ?
>>>>
>>>>
>>>> On Monday, February 23, 2015 3:13 PM, Danny Magat <danny at sb-ps.ae> wrote:
>>>> This problem is still exist on my setup.
>>>> http://lists.coova.org/pipermail/chilli/2013-November/002437.html
>>>>
>>>> I hope that somebody will give us a hint on how to solve this.
>>>>
>>>> Regards,
>>>> Danny
>>>>
>>>> -----Original Message-----
>>>> From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On
>>>> Behalf Of chilli-request at coova.org
>>>> Sent: Sunday, February 22, 2015 4:00 PM
>>>> To: chilli at coova.org
>>>> Subject: Chilli Digest, Vol 63, Issue 12
>>>>
>>>> Send Chilli mailing list submissions to
>>>>       chilli at coova.org
>>>>
>>>> To subscribe or unsubscribe via the World Wide Web, visit
>>>>       http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>> or, via email, send a message with subject or body 'help' to
>>>>       chilli-request at coova.org
>>>>
>>>> You can reach the person managing the list at
>>>>       chilli-owner at coova.org
>>>>
>>>> When replying, please edit your Subject line so it is more specific
>>>> than
>>>> "Re: Contents of Chilli digest..."
>>>>
>>>>
>>>> Today's Topics:
>>>>
>>>>       1. Too sharp upload bandwidth limit on 1gbps wired network (kl)
>>>>
>>>>
>>>> ----------------------------------------------------------------------
>>>>
>>>> Message: 1
>>>> Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
>>>> From: kl <kl522 at yahoo.com>
>>>> To: Chilli List <chilli at coova.org>
>>>> Subject: [Chilli] Too sharp upload bandwidth limit on 1gbps wired
>>>>        network
>>>> Message-ID:
>>>>        <122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com>
>>>> Content-Type: text/plain; charset=UTF-8
>>>>
>>>>
>>>>
>>>> Nobody is facing this issue with coova chilli ?
>>>>
>>>> http://www.coova.org/node/5171
>>>>
>>>> https://github.com/coova/coova-chilli/issues/32
>>>>
>>>> Happens only on Gigabit wired network and certain kernel verson.
>>>> Applies to 1.2.9, 1.3.0 and other versions ....
>>>>
>>>>
>>>> ------------------------------
>>>>
>>>> _______________________________________________
>>>> Chilli mailing list
>>>> Chilli at coova.org
>>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>>
>>>>
>>>> End of Chilli Digest, Vol 63, Issue 12
>>>> **************************************
>>>>
>>>>
>>>> _______________________________________________
>>>> Chilli mailing list
>>>> Chilli at coova.org
>>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>> _______________________________________________
>>>> Chilli mailing list
>>>> Chilli at coova.org
>>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>>
>>>
>>> ------------------------------
>>>
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>
>>>
>>> End of Chilli Digest, Vol 63, Issue 14
>
>>> **************************************
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>
>>
>>
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>

From bojan at gajba.net  Fri Mar  6 23:15:01 2015
From: bojan at gajba.net (Bojan Pogacar)
Date: Sat, 07 Mar 2015 00:15:01 +0100
Subject: [Chilli] Chilli Digest, Vol 63, Issue 14
In-Reply-To: <CADo9JyUmqR8MB6QVi6Nv_OPuEqfDAMfp1xbijD5gKqXSox=chg@mail.gmail.com>
References: <mailman.1.1424952002.815.chilli@coova.org>
 <AM2PR05MB0788EC067BEB3D13B821844492140@AM2PR05MB0788.eurprd05.prod.outlook.com>
 <54F0CA8C.8020901@gmail.com> <54F0E916.9060702@rexy.fr>
 <CADo9JyUmqR8MB6QVi6Nv_OPuEqfDAMfp1xbijD5gKqXSox=chg@mail.gmail.com>
Message-ID: <54FA34F5.3030505@gajba.net>

Hello David and others!

Does anyone has any idea why on OpenWRT (Barrier Breaker, final release) 
upload limit is not working - the oposite problem, it is not sharp 
enough: https://dev.openwrt.org/ticket/17995

Kind regards,
Bojan


Dne 28.2.2015 ob 1:28 je David Bird zapisal(a):
> You can use --tcpmss to clamp the TCP MSS. But, I agree, your issue is
> very likely gso related. Something like "sudo ethtool -K eth1 gro off"
>
> On Fri, Feb 27, 2015 at 2:00 PM, Richard REY <richard at rexy.fr
> <mailto:richard at rexy.fr>> wrote:
>
>     Yes, but this doesn't explain why there isn't any problem when the
>     flows pass through the appliance. this issue is seen only when the
>     TCP flows is sent to an internal processes
>
>     I'll try to disable packet off-loading next monday.
>     I'll also try to forbid the "jumbo frame" on NIC
>
>     Rexy
>
>     Le 27/02/2015 20:50, Alexandru Gheorghe a ?crit :
>
>         Usually fragmentation needed means you need to adjust the MTU of
>         your nic.
>
>         Alex
>
>
>         On 02/26/2015 02:30 PM, Claus Stjernoe wrote:
>
>             Hi Richard,
>
>             Try to disable packet off-loading on the Gigabit NIC.
>
>             Kind regards,
>             Claus
>
>             -----Oprindelig meddelelse-----
>             Fra: chilli-bounces at coova.org
>             <mailto:chilli-bounces at coova.org>
>             [mailto:chilli-bounces at coova.__org
>             <mailto:chilli-bounces at coova.org>] P? vegne af
>             chilli-request at coova.org <mailto:chilli-request at coova.org>
>             Sendt: 26. februar 2015 13:00
>             Til: chilli at coova.org <mailto:chilli at coova.org>
>             Emne: Chilli Digest, Vol 63, Issue 14
>
>             Send Chilli mailing list submissions to
>             chilli at coova.org <mailto:chilli at coova.org>
>
>             To subscribe or unsubscribe via the World Wide Web, visit
>             http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>             <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>             or, via email, send a message with subject or body 'help' to
>             chilli-request at coova.org <mailto:chilli-request at coova.org>
>
>             You can reach the person managing the list at
>             chilli-owner at coova.org <mailto:chilli-owner at coova.org>
>
>             When replying, please edit your Subject line so it is more
>             specific than "Re: Contents of Chilli digest..."
>
>
>             Today's Topics:
>
>                  1. Re: Chilli Digest, Vol 63, Issue 12 (Richard REY)
>
>
>             ------------------------------__------------------------------__----------
>
>             Message: 1
>             Date: Wed, 25 Feb 2015 22:48:56 +0100
>             From: Richard REY <richard at rexy.fr <mailto:richard at rexy.fr>>
>             To: chilli at coova.org <mailto:chilli at coova.org>
>             Subject: Re: [Chilli] Chilli Digest, Vol 63, Issue 12
>             Message-ID: <54EE4348.2090503 at rexy.fr
>             <mailto:54EE4348.2090503 at rexy.fr>>
>             Content-Type: text/plain; charset=windows-1252; format=flowed
>
>             Hi,
>             I use COOVA in its last version (SVN revision 492) running
>             on an ALCASAR appliance (mageia 4.1 - kernel 3.14.32), all
>             is OK excepted a flow issue.
>             When a TCP stream goes across the appliance there isn't any
>             flow issue (forward mode). BUT when a TCP stream is sent
>             inside the appliance (to a HTTP proxy for example) the
>             observed flow is very weak (Input mode). The problem is
>             maximal when the card connected to COOVA is in the Gigabit mode.
>
>             Our investigation :
>                From the appliance, we try to download a file located on
>             a FTP server connected on the network controlled by COOVA.
>             Without COOVA the observed flow in gigabit mode is about
>             888Mb/s whereas with COOVA we can see just
>             68 Kb/s (YES 68 Kb/s). Regarding the packets exchanged we
>             can see ICMP packets sent by the appliance (Destination
>             unreachable (Fragmentation needed).
>             We found a by-pass ?solution? by fixing the speed of the
>             card to 100Mb/s. At this speed the phenomenon is practically
>             invisible (just one ICMP packet sent) and the flow
>             approaches the maximum supported by the network card. On a
>             virtual machine where we can't fix Ethernet speed, we must
>             choose a 100Mb/s virtual Ethernet card when building the VM.
>             We have the Pcap file of our investigation. I say it again,
>             this issue is seen only when the TCP flows is sent to an
>             internal processes (in 'forward' mode all is ok).
>
>             Regards
>             Rexy & ALCASAR team
>
>             Le 23/02/2015 08:59, kl a ?crit :
>
>                 I see problem on kernel version > 3.7 right up to 3.10.
>                 Above 3.10 not tested.
>                 However, in the other quoted post, it says kernel 2.6.39
>                 upto 3.3.4. Above that not tested.
>                 Something not consist here.
>
>                 So which kernel version you guys are using which are
>                 seeing this problem ?
>
>
>                 On Monday, February 23, 2015 3:13 PM, Danny Magat
>                 <danny at sb-ps.ae <mailto:danny at sb-ps.ae>> wrote:
>                 This problem is still exist on my setup.
>                 http://lists.coova.org/__pipermail/chilli/2013-__November/002437.html
>                 <http://lists.coova.org/pipermail/chilli/2013-November/002437.html>
>
>                 I hope that somebody will give us a hint on how to solve
>                 this.
>
>                 Regards,
>                 Danny
>
>                 -----Original Message-----
>                 From: chilli-bounces at coova.org
>                 <mailto:chilli-bounces at coova.org>
>                 [mailto:chilli-bounces at coova.__org
>                 <mailto:chilli-bounces at coova.org>] On
>                 Behalf Of chilli-request at coova.org
>                 <mailto:chilli-request at coova.org>
>                 Sent: Sunday, February 22, 2015 4:00 PM
>                 To: chilli at coova.org <mailto:chilli at coova.org>
>                 Subject: Chilli Digest, Vol 63, Issue 12
>
>                 Send Chilli mailing list submissions to
>                 chilli at coova.org <mailto:chilli at coova.org>
>
>                 To subscribe or unsubscribe via the World Wide Web, visit
>                 http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>                 <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>                 or, via email, send a message with subject or body 'help' to
>                 chilli-request at coova.org <mailto:chilli-request at coova.org>
>
>                 You can reach the person managing the list at
>                 chilli-owner at coova.org <mailto:chilli-owner at coova.org>
>
>                 When replying, please edit your Subject line so it is
>                 more specific
>                 than
>                 "Re: Contents of Chilli digest..."
>
>
>                 Today's Topics:
>
>                       1. Too sharp upload bandwidth limit on 1gbps wired
>                 network (kl)
>
>
>                 ------------------------------__------------------------------__----------
>
>                 Message: 1
>                 Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
>                 From: kl <kl522 at yahoo.com <mailto:kl522 at yahoo.com>>
>                 To: Chilli List <chilli at coova.org <mailto:chilli at coova.org>>
>                 Subject: [Chilli] Too sharp upload bandwidth limit on
>                 1gbps wired
>                        network
>                 Message-ID:
>
>                 <122480453.6349415.__1424571713923.JavaMail.yahoo at __mail.yahoo.com
>                 <mailto:122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com>>
>                 Content-Type: text/plain; charset=UTF-8
>
>
>
>                 Nobody is facing this issue with coova chilli ?
>
>                 http://www.coova.org/node/5171
>
>                 https://github.com/coova/__coova-chilli/issues/32
>                 <https://github.com/coova/coova-chilli/issues/32>
>
>                 Happens only on Gigabit wired network and certain kernel
>                 verson.
>                 Applies to 1.2.9, 1.3.0 and other versions ....
>
>
>                 ------------------------------
>
>                 _________________________________________________
>                 Chilli mailing list
>                 Chilli at coova.org <mailto:Chilli at coova.org>
>                 http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>                 <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>
>
>                 End of Chilli Digest, Vol 63, Issue 12
>                 ******************************__********
>
>
>                 _________________________________________________
>                 Chilli mailing list
>                 Chilli at coova.org <mailto:Chilli at coova.org>
>                 http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>                 <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>                 _________________________________________________
>                 Chilli mailing list
>                 Chilli at coova.org <mailto:Chilli at coova.org>
>                 http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>                 <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>
>
>             ------------------------------
>
>             _________________________________________________
>             Chilli mailing list
>             Chilli at coova.org <mailto:Chilli at coova.org>
>             http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>             <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>
>
>             End of Chilli Digest, Vol 63, Issue 14
>             ******************************__********
>             _________________________________________________
>             Chilli mailing list
>             Chilli at coova.org <mailto:Chilli at coova.org>
>             http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>             <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>
>
>
>
>         _________________________________________________
>         Chilli mailing list
>         Chilli at coova.org <mailto:Chilli at coova.org>
>         http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>         <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>
>     _________________________________________________
>     Chilli mailing list
>     Chilli at coova.org <mailto:Chilli at coova.org>
>     http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>     <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>
>
>
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>

-- 
Lep pozdrav,

Bojan Poga?ar
GSM: 031 262 535

From mctiew at yahoo.com  Fri Mar  6 23:41:44 2015
From: mctiew at yahoo.com (Ming-Ching Tiew)
Date: Fri, 6 Mar 2015 23:41:44 +0000 (UTC)
Subject: [Chilli] Chilli Digest, Vol 63, Issue 14
In-Reply-To: <54FA34F5.3030505@gajba.net>
References: <54FA34F5.3030505@gajba.net>
Message-ID: <466394375.1038.1425685304851.JavaMail.yahoo@mail.yahoo.com>

I tend to think it's iptables problem. For bandwidth control to work, the packets at the LAN interface has to be dropped by iptables.
      From: Bojan Pogacar <bojan at gajba.net>
 To: chilli at coova.org 
 Sent: Saturday, March 7, 2015 7:15 AM
 Subject: Re: [Chilli] Chilli Digest, Vol 63, Issue 14
   
Hello David and others!

Does anyone has any idea why on OpenWRT (Barrier Breaker, final release) 
upload limit is not working - the oposite problem, it is not sharp 
enough: https://dev.openwrt.org/ticket/17995

Kind regards,
Bojan


Dne 28.2.2015 ob 1:28 je David Bird zapisal(a):
> You can use --tcpmss to clamp the TCP MSS. But, I agree, your issue is
> very likely gso related. Something like "sudo ethtool -K eth1 gro off"
>
> On Fri, Feb 27, 2015 at 2:00 PM, Richard REY <richard at rexy.fr
> <mailto:richard at rexy.fr>> wrote:
>
>? ? Yes, but this doesn't explain why there isn't any problem when the
>? ? flows pass through the appliance. this issue is seen only when the
>? ? TCP flows is sent to an internal processes
>
>? ? I'll try to disable packet off-loading next monday.
>? ? I'll also try to forbid the "jumbo frame" on NIC
>
>? ? Rexy
>
>? ? Le 27/02/2015 20:50, Alexandru Gheorghe a ?crit :
>
>? ? ? ? Usually fragmentation needed means you need to adjust the MTU of
>? ? ? ? your nic.
>
>? ? ? ? Alex
>
>
>? ? ? ? On 02/26/2015 02:30 PM, Claus Stjernoe wrote:
>
>? ? ? ? ? ? Hi Richard,
>
>? ? ? ? ? ? Try to disable packet off-loading on the Gigabit NIC.
>
>? ? ? ? ? ? Kind regards,
>? ? ? ? ? ? Claus
>
>? ? ? ? ? ? -----Oprindelig meddelelse-----
>? ? ? ? ? ? Fra: chilli-bounces at coova.org
>? ? ? ? ? ? <mailto:chilli-bounces at coova.org>
>? ? ? ? ? ? [mailto:chilli-bounces at coova.__org
>? ? ? ? ? ? <mailto:chilli-bounces at coova.org>] P? vegne af
>? ? ? ? ? ? chilli-request at coova.org <mailto:chilli-request at coova.org>
>? ? ? ? ? ? Sendt: 26. februar 2015 13:00
>? ? ? ? ? ? Til: chilli at coova.org <mailto:chilli at coova.org>
>? ? ? ? ? ? Emne: Chilli Digest, Vol 63, Issue 14
>
>? ? ? ? ? ? Send Chilli mailing list submissions to
>? ? ? ? ? ? chilli at coova.org <mailto:chilli at coova.org>
>
>? ? ? ? ? ? To subscribe or unsubscribe via the World Wide Web, visit
>? ? ? ? ? ? http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? ? ? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>? ? ? ? ? ? or, via email, send a message with subject or body 'help' to
>? ? ? ? ? ? chilli-request at coova.org <mailto:chilli-request at coova.org>
>
>? ? ? ? ? ? You can reach the person managing the list at
>? ? ? ? ? ? chilli-owner at coova.org <mailto:chilli-owner at coova.org>
>
>? ? ? ? ? ? When replying, please edit your Subject line so it is more
>? ? ? ? ? ? specific than "Re: Contents of Chilli digest..."
>
>
>? ? ? ? ? ? Today's Topics:
>
>? ? ? ? ? ? ? ? ? 1. Re: Chilli Digest, Vol 63, Issue 12 (Richard REY)
>
>
>? ? ? ? ? ? ------------------------------__------------------------------__----------
>
>? ? ? ? ? ? Message: 1
>? ? ? ? ? ? Date: Wed, 25 Feb 2015 22:48:56 +0100
>? ? ? ? ? ? From: Richard REY <richard at rexy.fr <mailto:richard at rexy.fr>>
>? ? ? ? ? ? To: chilli at coova.org <mailto:chilli at coova.org>
>? ? ? ? ? ? Subject: Re: [Chilli] Chilli Digest, Vol 63, Issue 12
>? ? ? ? ? ? Message-ID: <54EE4348.2090503 at rexy.fr
>? ? ? ? ? ? <mailto:54EE4348.2090503 at rexy.fr>>
>? ? ? ? ? ? Content-Type: text/plain; charset=windows-1252; format=flowed
>
>? ? ? ? ? ? Hi,
>? ? ? ? ? ? I use COOVA in its last version (SVN revision 492) running
>? ? ? ? ? ? on an ALCASAR appliance (mageia 4.1 - kernel 3.14.32), all
>? ? ? ? ? ? is OK excepted a flow issue.
>? ? ? ? ? ? When a TCP stream goes across the appliance there isn't any
>? ? ? ? ? ? flow issue (forward mode). BUT when a TCP stream is sent
>? ? ? ? ? ? inside the appliance (to a HTTP proxy for example) the
>? ? ? ? ? ? observed flow is very weak (Input mode). The problem is
>? ? ? ? ? ? maximal when the card connected to COOVA is in the Gigabit mode.
>
>? ? ? ? ? ? Our investigation :
>? ? ? ? ? ? ? ? From the appliance, we try to download a file located on
>? ? ? ? ? ? a FTP server connected on the network controlled by COOVA.
>? ? ? ? ? ? Without COOVA the observed flow in gigabit mode is about
>? ? ? ? ? ? 888Mb/s whereas with COOVA we can see just
>? ? ? ? ? ? 68 Kb/s (YES 68 Kb/s). Regarding the packets exchanged we
>? ? ? ? ? ? can see ICMP packets sent by the appliance (Destination
>? ? ? ? ? ? unreachable (Fragmentation needed).
>? ? ? ? ? ? We found a by-pass ?solution? by fixing the speed of the
>? ? ? ? ? ? card to 100Mb/s. At this speed the phenomenon is practically
>? ? ? ? ? ? invisible (just one ICMP packet sent) and the flow
>? ? ? ? ? ? approaches the maximum supported by the network card. On a
>? ? ? ? ? ? virtual machine where we can't fix Ethernet speed, we must
>? ? ? ? ? ? choose a 100Mb/s virtual Ethernet card when building the VM.
>? ? ? ? ? ? We have the Pcap file of our investigation. I say it again,
>? ? ? ? ? ? this issue is seen only when the TCP flows is sent to an
>? ? ? ? ? ? internal processes (in 'forward' mode all is ok).
>
>? ? ? ? ? ? Regards
>? ? ? ? ? ? Rexy & ALCASAR team
>
>? ? ? ? ? ? Le 23/02/2015 08:59, kl a ?crit :
>
>? ? ? ? ? ? ? ? I see problem on kernel version > 3.7 right up to 3.10.
>? ? ? ? ? ? ? ? Above 3.10 not tested.
>? ? ? ? ? ? ? ? However, in the other quoted post, it says kernel 2.6.39
>? ? ? ? ? ? ? ? upto 3.3.4. Above that not tested.
>? ? ? ? ? ? ? ? Something not consist here.
>
>? ? ? ? ? ? ? ? So which kernel version you guys are using which are
>? ? ? ? ? ? ? ? seeing this problem ?
>
>
>? ? ? ? ? ? ? ? On Monday, February 23, 2015 3:13 PM, Danny Magat
>? ? ? ? ? ? ? ? <danny at sb-ps.ae <mailto:danny at sb-ps.ae>> wrote:
>? ? ? ? ? ? ? ? This problem is still exist on my setup.
>? ? ? ? ? ? ? ? http://lists.coova.org/__pipermail/chilli/2013-__November/002437.html
>? ? ? ? ? ? ? ? <http://lists.coova.org/pipermail/chilli/2013-November/002437.html>
>
>? ? ? ? ? ? ? ? I hope that somebody will give us a hint on how to solve
>? ? ? ? ? ? ? ? this.
>
>? ? ? ? ? ? ? ? Regards,
>? ? ? ? ? ? ? ? Danny
>
>? ? ? ? ? ? ? ? -----Original Message-----
>? ? ? ? ? ? ? ? From: chilli-bounces at coova.org
>? ? ? ? ? ? ? ? <mailto:chilli-bounces at coova.org>
>? ? ? ? ? ? ? ? [mailto:chilli-bounces at coova.__org
>? ? ? ? ? ? ? ? <mailto:chilli-bounces at coova.org>] On
>? ? ? ? ? ? ? ? Behalf Of chilli-request at coova.org
>? ? ? ? ? ? ? ? <mailto:chilli-request at coova.org>
>? ? ? ? ? ? ? ? Sent: Sunday, February 22, 2015 4:00 PM
>? ? ? ? ? ? ? ? To: chilli at coova.org <mailto:chilli at coova.org>
>? ? ? ? ? ? ? ? Subject: Chilli Digest, Vol 63, Issue 12
>
>? ? ? ? ? ? ? ? Send Chilli mailing list submissions to
>? ? ? ? ? ? ? ? chilli at coova.org <mailto:chilli at coova.org>
>
>? ? ? ? ? ? ? ? To subscribe or unsubscribe via the World Wide Web, visit
>? ? ? ? ? ? ? ? http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? ? ? ? ? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>? ? ? ? ? ? ? ? or, via email, send a message with subject or body 'help' to
>? ? ? ? ? ? ? ? chilli-request at coova.org <mailto:chilli-request at coova.org>
>
>? ? ? ? ? ? ? ? You can reach the person managing the list at
>? ? ? ? ? ? ? ? chilli-owner at coova.org <mailto:chilli-owner at coova.org>
>
>? ? ? ? ? ? ? ? When replying, please edit your Subject line so it is
>? ? ? ? ? ? ? ? more specific
>? ? ? ? ? ? ? ? than
>? ? ? ? ? ? ? ? "Re: Contents of Chilli digest..."
>
>
>? ? ? ? ? ? ? ? Today's Topics:
>
>? ? ? ? ? ? ? ? ? ? ? 1. Too sharp upload bandwidth limit on 1gbps wired
>? ? ? ? ? ? ? ? network (kl)
>
>
>? ? ? ? ? ? ? ? ------------------------------__------------------------------__----------
>
>? ? ? ? ? ? ? ? Message: 1
>? ? ? ? ? ? ? ? Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
>? ? ? ? ? ? ? ? From: kl <kl522 at yahoo.com <mailto:kl522 at yahoo.com>>
>? ? ? ? ? ? ? ? To: Chilli List <chilli at coova.org <mailto:chilli at coova.org>>
>? ? ? ? ? ? ? ? Subject: [Chilli] Too sharp upload bandwidth limit on
>? ? ? ? ? ? ? ? 1gbps wired
>? ? ? ? ? ? ? ? ? ? ? ? network
>? ? ? ? ? ? ? ? Message-ID:
>
>? ? ? ? ? ? ? ? <122480453.6349415.__1424571713923.JavaMail.yahoo at __mail.yahoo.com
>? ? ? ? ? ? ? ? <mailto:122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com>>
>? ? ? ? ? ? ? ? Content-Type: text/plain; charset=UTF-8
>
>
>
>? ? ? ? ? ? ? ? Nobody is facing this issue with coova chilli ?
>
>? ? ? ? ? ? ? ? http://www.coova.org/node/5171
>
>? ? ? ? ? ? ? ? https://github.com/coova/__coova-chilli/issues/32
>? ? ? ? ? ? ? ? <https://github.com/coova/coova-chilli/issues/32>
>
>? ? ? ? ? ? ? ? Happens only on Gigabit wired network and certain kernel
>? ? ? ? ? ? ? ? verson.
>? ? ? ? ? ? ? ? Applies to 1.2.9, 1.3.0 and other versions ....
>
>
>? ? ? ? ? ? ? ? ------------------------------
>
>? ? ? ? ? ? ? ? _________________________________________________
>? ? ? ? ? ? ? ? Chilli mailing list
>? ? ? ? ? ? ? ? Chilli at coova.org <mailto:Chilli at coova.org>
>? ? ? ? ? ? ? ? http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? ? ? ? ? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>
>
>? ? ? ? ? ? ? ? End of Chilli Digest, Vol 63, Issue 12
>? ? ? ? ? ? ? ? ******************************__********
>
>
>? ? ? ? ? ? ? ? _________________________________________________
>? ? ? ? ? ? ? ? Chilli mailing list
>? ? ? ? ? ? ? ? Chilli at coova.org <mailto:Chilli at coova.org>
>? ? ? ? ? ? ? ? http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? ? ? ? ? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>? ? ? ? ? ? ? ? _________________________________________________
>? ? ? ? ? ? ? ? Chilli mailing list
>? ? ? ? ? ? ? ? Chilli at coova.org <mailto:Chilli at coova.org>
>? ? ? ? ? ? ? ? http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? ? ? ? ? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>
>
>? ? ? ? ? ? ------------------------------
>
>? ? ? ? ? ? _________________________________________________
>? ? ? ? ? ? Chilli mailing list
>? ? ? ? ? ? Chilli at coova.org <mailto:Chilli at coova.org>
>? ? ? ? ? ? http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? ? ? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>
>
>? ? ? ? ? ? End of Chilli Digest, Vol 63, Issue 14
>? ? ? ? ? ? ******************************__********
>? ? ? ? ? ? _________________________________________________
>? ? ? ? ? ? Chilli mailing list
>? ? ? ? ? ? Chilli at coova.org <mailto:Chilli at coova.org>
>? ? ? ? ? ? http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? ? ? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>
>
>
>
>? ? ? ? _________________________________________________
>? ? ? ? Chilli mailing list
>? ? ? ? Chilli at coova.org <mailto:Chilli at coova.org>
>? ? ? ? http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>
>? ? _________________________________________________
>? ? Chilli mailing list
>? ? Chilli at coova.org <mailto:Chilli at coova.org>
>? ? http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>
>
>
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>

-- 
Lep pozdrav,

Bojan Poga?ar
GSM: 031 262 535
_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150306/76b1a010/attachment-0001.html>

From bojan at gajba.net  Sat Mar  7 07:28:03 2015
From: bojan at gajba.net (Bojan Pogacar)
Date: Sat, 07 Mar 2015 08:28:03 +0100
Subject: [Chilli] Chilli Digest, Vol 63, Issue 14
In-Reply-To: <466394375.1038.1425685304851.JavaMail.yahoo@mail.yahoo.com>
References: <54FA34F5.3030505@gajba.net>
 <466394375.1038.1425685304851.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <54FAA883.5090402@gajba.net>

iptables rules are exactly the same on Barrier Breaker RC2 and Barrier 
Breaker RC3 and final, but upload limit was broken in RC3. There are 
also iptables rules in FORWARD chain for upload limiting (are this the 
right one?)

pkts bytes target     prot opt in     out     source 
destination
0     0 DROP       all  --  *      br-hotspot  0.0.0.0/0 
0.0.0.0/0

316 97194 DROP       all  --  br-hotspot *       0.0.0.0/0 
0.0.0.0/0

Some packets are also dropped, but upload limiting is not working. 
Version of coova chilli is the same 1.3.0.

Any other suggestion?

Kind regards, Bojan



Dne 7.3.2015 ob 0:41 je Ming-Ching Tiew zapisal(a):
> I tend to think it's iptables problem. For bandwidth control to work,
> the packets at the LAN interface has to be dropped by iptables.
>
> ------------------------------------------------------------------------
> *From:* Bojan Pogacar <bojan at gajba.net>
> *To:* chilli at coova.org
> *Sent:* Saturday, March 7, 2015 7:15 AM
> *Subject:* Re: [Chilli] Chilli Digest, Vol 63, Issue 14
>
> Hello David and others!
>
> Does anyone has any idea why on OpenWRT (Barrier Breaker, final release)
> upload limit is not working - the oposite problem, it is not sharp
> enough: https://dev.openwrt.org/ticket/17995
>
> Kind regards,
> Bojan
>
>
> Dne 28.2.2015 ob 1:28 je David Bird zapisal(a):
>  > You can use --tcpmss to clamp the TCP MSS. But, I agree, your issue is
>  > very likely gso related. Something like "sudo ethtool -K eth1 gro off"
>  >
>  > On Fri, Feb 27, 2015 at 2:00 PM, Richard REY <richard at rexy.fr
> <mailto:richard at rexy.fr>
>  > <mailto:richard at rexy.fr <mailto:richard at rexy.fr>>> wrote:
>  >
>  >    Yes, but this doesn't explain why there isn't any problem when the
>  >    flows pass through the appliance. this issue is seen only when the
>  >    TCP flows is sent to an internal processes
>  >
>  >    I'll try to disable packet off-loading next monday.
>  >    I'll also try to forbid the "jumbo frame" on NIC
>  >
>  >    Rexy
>  >
>  >    Le 27/02/2015 20:50, Alexandru Gheorghe a ?crit :
>  >
>  >        Usually fragmentation needed means you need to adjust the MTU of
>  >        your nic.
>  >
>  >        Alex
>  >
>  >
>  >        On 02/26/2015 02:30 PM, Claus Stjernoe wrote:
>  >
>  >            Hi Richard,
>  >
>  >            Try to disable packet off-loading on the Gigabit NIC.
>  >
>  >            Kind regards,
>  >            Claus
>  >
>  >            -----Oprindelig meddelelse-----
>  >            Fra: chilli-bounces at coova.org
> <mailto:chilli-bounces at coova.org>
>  >            <mailto:chilli-bounces at coova.org
> <mailto:chilli-bounces at coova.org>>
>  >            [mailto:chilli-bounces at coova.__org
> <mailto:chilli-bounces at coova.__org>
>  >            <mailto:chilli-bounces at coova.org
> <mailto:chilli-bounces at coova.org>>] P? vegne af
>  > chilli-request at coova.org <mailto:chilli-request at coova.org>
> <mailto:chilli-request at coova.org <mailto:chilli-request at coova.org>>
>  >            Sendt: 26. februar 2015 13:00
>  >            Til: chilli at coova.org <mailto:chilli at coova.org>
> <mailto:chilli at coova.org <mailto:chilli at coova.org>>
>  >            Emne: Chilli Digest, Vol 63, Issue 14
>  >
>  >            Send Chilli mailing list submissions to
>  > chilli at coova.org <mailto:chilli at coova.org> <mailto:chilli at coova.org
> <mailto:chilli at coova.org>>
>  >
>  >            To subscribe or unsubscribe via the World Wide Web, visit
>  > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>  >            <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>  >            or, via email, send a message with subject or body 'help' to
>  > chilli-request at coova.org <mailto:chilli-request at coova.org>
> <mailto:chilli-request at coova.org <mailto:chilli-request at coova.org>>
>  >
>  >            You can reach the person managing the list at
>  > chilli-owner at coova.org <mailto:chilli-owner at coova.org>
> <mailto:chilli-owner at coova.org <mailto:chilli-owner at coova.org>>
>  >
>  >            When replying, please edit your Subject line so it is more
>  >            specific than "Re: Contents of Chilli digest..."
>  >
>  >
>  >            Today's Topics:
>  >
>  >                  1. Re: Chilli Digest, Vol 63, Issue 12 (Richard REY)
>  >
>  >
>  >
> ------------------------------__------------------------------__----------
>  >
>  >            Message: 1
>  >            Date: Wed, 25 Feb 2015 22:48:56 +0100
>  >            From: Richard REY <richard at rexy.fr
> <mailto:richard at rexy.fr> <mailto:richard at rexy.fr <mailto:richard at rexy.fr>>>
>  >            To: chilli at coova.org <mailto:chilli at coova.org>
> <mailto:chilli at coova.org <mailto:chilli at coova.org>>
>  >            Subject: Re: [Chilli] Chilli Digest, Vol 63, Issue 12
>  >            Message-ID: <54EE4348.2090503 at rexy.fr
> <mailto:54EE4348.2090503 at rexy.fr>
>  >            <mailto:54EE4348.2090503 at rexy.fr
> <mailto:54EE4348.2090503 at rexy.fr>>>
>  >            Content-Type: text/plain; charset=windows-1252; format=flowed
>  >
>  >            Hi,
>  >            I use COOVA in its last version (SVN revision 492) running
>  >            on an ALCASAR appliance (mageia 4.1 - kernel 3.14.32), all
>  >            is OK excepted a flow issue.
>  >            When a TCP stream goes across the appliance there isn't any
>  >            flow issue (forward mode). BUT when a TCP stream is sent
>  >            inside the appliance (to a HTTP proxy for example) the
>  >            observed flow is very weak (Input mode). The problem is
>  >            maximal when the card connected to COOVA is in the Gigabit
> mode.
>  >
>  >            Our investigation :
>  >                From the appliance, we try to download a file located on
>  >            a FTP server connected on the network controlled by COOVA.
>  >            Without COOVA the observed flow in gigabit mode is about
>  >            888Mb/s whereas with COOVA we can see just
>  >            68 Kb/s (YES 68 Kb/s). Regarding the packets exchanged we
>  >            can see ICMP packets sent by the appliance (Destination
>  >            unreachable (Fragmentation needed).
>  >            We found a by-pass ?solution? by fixing the speed of the
>  >            card to 100Mb/s. At this speed the phenomenon is practically
>  >            invisible (just one ICMP packet sent) and the flow
>  >            approaches the maximum supported by the network card. On a
>  >            virtual machine where we can't fix Ethernet speed, we must
>  >            choose a 100Mb/s virtual Ethernet card when building the VM.
>  >            We have the Pcap file of our investigation. I say it again,
>  >            this issue is seen only when the TCP flows is sent to an
>  >            internal processes (in 'forward' mode all is ok).
>  >
>  >            Regards
>  >            Rexy & ALCASAR team
>  >
>  >            Le 23/02/2015 08:59, kl a ?crit :
>  >
>  >                I see problem on kernel version > 3.7 right up to 3.10.
>  >                Above 3.10 not tested.
>  >                However, in the other quoted post, it says kernel 2.6.39
>  >                upto 3.3.4. Above that not tested.
>  >                Something not consist here.
>  >
>  >                So which kernel version you guys are using which are
>  >                seeing this problem ?
>  >
>  >
>  >                On Monday, February 23, 2015 3:13 PM, Danny Magat
>  >                <danny at sb-ps.ae <mailto:danny at sb-ps.ae>
> <mailto:danny at sb-ps.ae <mailto:danny at sb-ps.ae>>> wrote:
>  >                This problem is still exist on my setup.
>  > http://lists.coova.org/__pipermail/chilli/2013-__November/002437.html
>  >
> <http://lists.coova.org/pipermail/chilli/2013-November/002437.html>
>  >
>  >                I hope that somebody will give us a hint on how to solve
>  >                this.
>  >
>  >                Regards,
>  >                Danny
>  >
>  >                -----Original Message-----
>  >                From: chilli-bounces at coova.org
> <mailto:chilli-bounces at coova.org>
>  >                <mailto:chilli-bounces at coova.org
> <mailto:chilli-bounces at coova.org>>
>  >                [mailto:chilli-bounces at coova.__org
> <mailto:chilli-bounces at coova.__org>
>  >                <mailto:chilli-bounces at coova.org
> <mailto:chilli-bounces at coova.org>>] On
>  >                Behalf Of chilli-request at coova.org
> <mailto:chilli-request at coova.org>
>  >                <mailto:chilli-request at coova.org
> <mailto:chilli-request at coova.org>>
>  >                Sent: Sunday, February 22, 2015 4:00 PM
>  >                To: chilli at coova.org <mailto:chilli at coova.org>
> <mailto:chilli at coova.org <mailto:chilli at coova.org>>
>  >                Subject: Chilli Digest, Vol 63, Issue 12
>  >
>  >                Send Chilli mailing list submissions to
>  > chilli at coova.org <mailto:chilli at coova.org> <mailto:chilli at coova.org
> <mailto:chilli at coova.org>>
>  >
>  >                To subscribe or unsubscribe via the World Wide Web, visit
>  > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>  >                <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>  >                or, via email, send a message with subject or body
> 'help' to
>  > chilli-request at coova.org <mailto:chilli-request at coova.org>
> <mailto:chilli-request at coova.org <mailto:chilli-request at coova.org>>
>  >
>  >                You can reach the person managing the list at
>  > chilli-owner at coova.org <mailto:chilli-owner at coova.org>
> <mailto:chilli-owner at coova.org <mailto:chilli-owner at coova.org>>
>  >
>  >                When replying, please edit your Subject line so it is
>  >                more specific
>  >                than
>  >                "Re: Contents of Chilli digest..."
>  >
>  >
>  >                Today's Topics:
>  >
>  >                      1. Too sharp upload bandwidth limit on 1gbps wired
>  >                network (kl)
>  >
>  >
>  >
> ------------------------------__------------------------------__----------
>  >
>  >                Message: 1
>  >                Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
>  >                From: kl <kl522 at yahoo.com <mailto:kl522 at yahoo.com>
> <mailto:kl522 at yahoo.com <mailto:kl522 at yahoo.com>>>
>  >                To: Chilli List <chilli at coova.org
> <mailto:chilli at coova.org> <mailto:chilli at coova.org
> <mailto:chilli at coova.org>>>
>  >                Subject: [Chilli] Too sharp upload bandwidth limit on
>  >                1gbps wired
>  >                        network
>  >                Message-ID:
>  >
>  >
> <122480453.6349415.__1424571713923.JavaMail.yahoo at __mail.yahoo.com
> <mailto:122480453.6349415.__1424571713923.JavaMail.yahoo at __mail.yahoo.com>
>  >
> <mailto:122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com
> <mailto:122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com>>>
>  >                Content-Type: text/plain; charset=UTF-8
>  >
>  >
>  >
>  >                Nobody is facing this issue with coova chilli ?
>  >
>  > http://www.coova.org/node/5171
>  >
>  > https://github.com/coova/__coova-chilli/issues/32
>  >                <https://github.com/coova/coova-chilli/issues/32>
>  >
>  >                Happens only on Gigabit wired network and certain kernel
>  >                verson.
>  >                Applies to 1.2.9, 1.3.0 and other versions ....
>  >
>  >
>  >                ------------------------------
>  >
>  >                _________________________________________________
>  >                Chilli mailing list
>  > Chilli at coova.org <mailto:Chilli at coova.org> <mailto:Chilli at coova.org
> <mailto:Chilli at coova.org>>
>  > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>  >                <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>  >
>  >
>  >                End of Chilli Digest, Vol 63, Issue 12
>  >                ******************************__********
>  >
>  >
>  >                _________________________________________________
>  >                Chilli mailing list
>  > Chilli at coova.org <mailto:Chilli at coova.org> <mailto:Chilli at coova.org
> <mailto:Chilli at coova.org>>
>  > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>  >                <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>  >                _________________________________________________
>  >                Chilli mailing list
>  > Chilli at coova.org <mailto:Chilli at coova.org> <mailto:Chilli at coova.org
> <mailto:Chilli at coova.org>>
>  > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>  >                <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>  >
>  >
>  >            ------------------------------
>  >
>  >            _________________________________________________
>  >            Chilli mailing list
>  > Chilli at coova.org <mailto:Chilli at coova.org> <mailto:Chilli at coova.org
> <mailto:Chilli at coova.org>>
>  > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>  >            <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>  >
>  >
>  >            End of Chilli Digest, Vol 63, Issue 14
>  >            ******************************__********
>  >            _________________________________________________
>  >            Chilli mailing list
>  > Chilli at coova.org <mailto:Chilli at coova.org> <mailto:Chilli at coova.org
> <mailto:Chilli at coova.org>>
>  > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>  >            <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>  >
>  >
>  >
>  >
>  >        _________________________________________________
>  >        Chilli mailing list
>  > Chilli at coova.org <mailto:Chilli at coova.org> <mailto:Chilli at coova.org
> <mailto:Chilli at coova.org>>
>  > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>  >        <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>  >
>  >    _________________________________________________
>  >    Chilli mailing list
>  > Chilli at coova.org <mailto:Chilli at coova.org> <mailto:Chilli at coova.org
> <mailto:Chilli at coova.org>>
>  > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>  >    <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>  >
>  >
>  >
>  >
>  > _______________________________________________
>  > Chilli mailing list
>  > Chilli at coova.org <mailto:Chilli at coova.org>
>  > http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>  >
>
> --
> Lep pozdrav,
>
> Bojan Poga?ar
> GSM: 031 262 535
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org <mailto:Chilli at coova.org>
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>

-- 
Lep pozdrav,

Bojan Poga?ar
GSM: 031 262 535

From mctiew at yahoo.com  Sat Mar  7 07:39:16 2015
From: mctiew at yahoo.com (Ming-Ching Tiew)
Date: Sat, 7 Mar 2015 07:39:16 +0000 (UTC)
Subject: [Chilli] Chilli Digest, Vol 63, Issue 14
In-Reply-To: <54FAA883.5090402@gajba.net>
References: <54FAA883.5090402@gajba.net>
Message-ID: <2078287782.68635.1425713956760.JavaMail.yahoo@mail.yahoo.com>

It's the INPUT chain not the FORWARD chain which can make the difference.

      From: Bojan Pogacar <bojan at gajba.net>
 To: "chilli at coova.org" <chilli at coova.org> 
 Sent: Saturday, March 7, 2015 3:28 PM
 Subject: Re: [Chilli] Chilli Digest, Vol 63, Issue 14
   
iptables rules are exactly the same on Barrier Breaker RC2 and Barrier 
Breaker RC3 and final, but upload limit was broken in RC3. There are 
also iptables rules in FORWARD chain for upload limiting (are this the 
right one?)

pkts bytes target? ? prot opt in? ? out? ? source 
destination
0? ? 0 DROP? ? ? all? --? *? ? ? br-hotspot? 0.0.0.0/0 
0.0.0.0/0

316 97194 DROP? ? ? all? --? br-hotspot *? ? ? 0.0.0.0/0 
0.0.0.0/0

Some packets are also dropped, but upload limiting is not working. 
Version of coova chilli is the same 1.3.0.

Any other suggestion?

Kind regards, Bojan



Dne 7.3.2015 ob 0:41 je Ming-Ching Tiew zapisal(a):
> I tend to think it's iptables problem. For bandwidth control to work,
> the packets at the LAN interface has to be dropped by iptables.
>
> ------------------------------------------------------------------------
> *From:* Bojan Pogacar <bojan at gajba.net>
> *To:* chilli at coova.org
> *Sent:* Saturday, March 7, 2015 7:15 AM
> *Subject:* Re: [Chilli] Chilli Digest, Vol 63, Issue 14
>
> Hello David and others!
>
> Does anyone has any idea why on OpenWRT (Barrier Breaker, final release)
> upload limit is not working - the oposite problem, it is not sharp
> enough: https://dev.openwrt.org/ticket/17995
>
> Kind regards,
> Bojan
>
>
> Dne 28.2.2015 ob 1:28 je David Bird zapisal(a):
>? > You can use --tcpmss to clamp the TCP MSS. But, I agree, your issue is
>? > very likely gso related. Something like "sudo ethtool -K eth1 gro off"
>? >
>? > On Fri, Feb 27, 2015 at 2:00 PM, Richard REY <richard at rexy.fr
> <mailto:richard at rexy.fr>
>? > <mailto:richard at rexy.fr <mailto:richard at rexy.fr>>> wrote:
>? >
>? >? ? Yes, but this doesn't explain why there isn't any problem when the
>? >? ? flows pass through the appliance. this issue is seen only when the
>? >? ? TCP flows is sent to an internal processes
>? >
>? >? ? I'll try to disable packet off-loading next monday.
>? >? ? I'll also try to forbid the "jumbo frame" on NIC
>? >
>? >? ? Rexy
>? >
>? >? ? Le 27/02/2015 20:50, Alexandru Gheorghe a ?crit :
>? >
>? >? ? ? ? Usually fragmentation needed means you need to adjust the MTU of
>? >? ? ? ? your nic.
>? >
>? >? ? ? ? Alex
>? >
>? >
>? >? ? ? ? On 02/26/2015 02:30 PM, Claus Stjernoe wrote:
>? >
>? >? ? ? ? ? ? Hi Richard,
>? >
>? >? ? ? ? ? ? Try to disable packet off-loading on the Gigabit NIC.
>? >
>? >? ? ? ? ? ? Kind regards,
>? >? ? ? ? ? ? Claus
>? >
>? >? ? ? ? ? ? -----Oprindelig meddelelse-----
>? >? ? ? ? ? ? Fra: chilli-bounces at coova.org
> <mailto:chilli-bounces at coova.org>
>? >? ? ? ? ? ? <mailto:chilli-bounces at coova.org
> <mailto:chilli-bounces at coova.org>>
>? >? ? ? ? ? ? [mailto:chilli-bounces at coova.__org
> <mailto:chilli-bounces at coova.__org>
>? >? ? ? ? ? ? <mailto:chilli-bounces at coova.org
> <mailto:chilli-bounces at coova.org>>] P? vegne af
>? > chilli-request at coova.org <mailto:chilli-request at coova.org>
> <mailto:chilli-request at coova.org <mailto:chilli-request at coova.org>>
>? >? ? ? ? ? ? Sendt: 26. februar 2015 13:00
>? >? ? ? ? ? ? Til: chilli at coova.org <mailto:chilli at coova.org>
> <mailto:chilli at coova.org <mailto:chilli at coova.org>>
>? >? ? ? ? ? ? Emne: Chilli Digest, Vol 63, Issue 14
>? >
>? >? ? ? ? ? ? Send Chilli mailing list submissions to
>? > chilli at coova.org <mailto:chilli at coova.org> <mailto:chilli at coova.org
> <mailto:chilli at coova.org>>
>? >
>? >? ? ? ? ? ? To subscribe or unsubscribe via the World Wide Web, visit
>? > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? >? ? ? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>? >? ? ? ? ? ? or, via email, send a message with subject or body 'help' to
>? > chilli-request at coova.org <mailto:chilli-request at coova.org>
> <mailto:chilli-request at coova.org <mailto:chilli-request at coova.org>>
>? >
>? >? ? ? ? ? ? You can reach the person managing the list at
>? > chilli-owner at coova.org <mailto:chilli-owner at coova.org>
> <mailto:chilli-owner at coova.org <mailto:chilli-owner at coova.org>>
>? >
>? >? ? ? ? ? ? When replying, please edit your Subject line so it is more
>? >? ? ? ? ? ? specific than "Re: Contents of Chilli digest..."
>? >
>? >
>? >? ? ? ? ? ? Today's Topics:
>? >
>? >? ? ? ? ? ? ? ? ? 1. Re: Chilli Digest, Vol 63, Issue 12 (Richard REY)
>? >
>? >
>? >
> ------------------------------__------------------------------__----------
>? >
>? >? ? ? ? ? ? Message: 1
>? >? ? ? ? ? ? Date: Wed, 25 Feb 2015 22:48:56 +0100
>? >? ? ? ? ? ? From: Richard REY <richard at rexy.fr
> <mailto:richard at rexy.fr> <mailto:richard at rexy.fr <mailto:richard at rexy.fr>>>
>? >? ? ? ? ? ? To: chilli at coova.org <mailto:chilli at coova.org>
> <mailto:chilli at coova.org <mailto:chilli at coova.org>>
>? >? ? ? ? ? ? Subject: Re: [Chilli] Chilli Digest, Vol 63, Issue 12
>? >? ? ? ? ? ? Message-ID: <54EE4348.2090503 at rexy.fr
> <mailto:54EE4348.2090503 at rexy.fr>
>? >? ? ? ? ? ? <mailto:54EE4348.2090503 at rexy.fr
> <mailto:54EE4348.2090503 at rexy.fr>>>
>? >? ? ? ? ? ? Content-Type: text/plain; charset=windows-1252; format=flowed
>? >
>? >? ? ? ? ? ? Hi,
>? >? ? ? ? ? ? I use COOVA in its last version (SVN revision 492) running
>? >? ? ? ? ? ? on an ALCASAR appliance (mageia 4.1 - kernel 3.14.32), all
>? >? ? ? ? ? ? is OK excepted a flow issue.
>? >? ? ? ? ? ? When a TCP stream goes across the appliance there isn't any
>? >? ? ? ? ? ? flow issue (forward mode). BUT when a TCP stream is sent
>? >? ? ? ? ? ? inside the appliance (to a HTTP proxy for example) the
>? >? ? ? ? ? ? observed flow is very weak (Input mode). The problem is
>? >? ? ? ? ? ? maximal when the card connected to COOVA is in the Gigabit
> mode.
>? >
>? >? ? ? ? ? ? Our investigation :
>? >? ? ? ? ? ? ? ? From the appliance, we try to download a file located on
>? >? ? ? ? ? ? a FTP server connected on the network controlled by COOVA.
>? >? ? ? ? ? ? Without COOVA the observed flow in gigabit mode is about
>? >? ? ? ? ? ? 888Mb/s whereas with COOVA we can see just
>? >? ? ? ? ? ? 68 Kb/s (YES 68 Kb/s). Regarding the packets exchanged we
>? >? ? ? ? ? ? can see ICMP packets sent by the appliance (Destination
>? >? ? ? ? ? ? unreachable (Fragmentation needed).
>? >? ? ? ? ? ? We found a by-pass ?solution? by fixing the speed of the
>? >? ? ? ? ? ? card to 100Mb/s. At this speed the phenomenon is practically
>? >? ? ? ? ? ? invisible (just one ICMP packet sent) and the flow
>? >? ? ? ? ? ? approaches the maximum supported by the network card. On a
>? >? ? ? ? ? ? virtual machine where we can't fix Ethernet speed, we must
>? >? ? ? ? ? ? choose a 100Mb/s virtual Ethernet card when building the VM.
>? >? ? ? ? ? ? We have the Pcap file of our investigation. I say it again,
>? >? ? ? ? ? ? this issue is seen only when the TCP flows is sent to an
>? >? ? ? ? ? ? internal processes (in 'forward' mode all is ok).
>? >
>? >? ? ? ? ? ? Regards
>? >? ? ? ? ? ? Rexy & ALCASAR team
>? >
>? >? ? ? ? ? ? Le 23/02/2015 08:59, kl a ?crit :
>? >
>? >? ? ? ? ? ? ? ? I see problem on kernel version > 3.7 right up to 3.10.
>? >? ? ? ? ? ? ? ? Above 3.10 not tested.
>? >? ? ? ? ? ? ? ? However, in the other quoted post, it says kernel 2.6.39
>? >? ? ? ? ? ? ? ? upto 3.3.4. Above that not tested.
>? >? ? ? ? ? ? ? ? Something not consist here.
>? >
>? >? ? ? ? ? ? ? ? So which kernel version you guys are using which are
>? >? ? ? ? ? ? ? ? seeing this problem ?
>? >
>? >
>? >? ? ? ? ? ? ? ? On Monday, February 23, 2015 3:13 PM, Danny Magat
>? >? ? ? ? ? ? ? ? <danny at sb-ps.ae <mailto:danny at sb-ps.ae>
> <mailto:danny at sb-ps.ae <mailto:danny at sb-ps.ae>>> wrote:
>? >? ? ? ? ? ? ? ? This problem is still exist on my setup.
>? > http://lists.coova.org/__pipermail/chilli/2013-__November/002437.html
>? >
> <http://lists.coova.org/pipermail/chilli/2013-November/002437.html>
>? >
>? >? ? ? ? ? ? ? ? I hope that somebody will give us a hint on how to solve
>? >? ? ? ? ? ? ? ? this.
>? >
>? >? ? ? ? ? ? ? ? Regards,
>? >? ? ? ? ? ? ? ? Danny
>? >
>? >? ? ? ? ? ? ? ? -----Original Message-----
>? >? ? ? ? ? ? ? ? From: chilli-bounces at coova.org
> <mailto:chilli-bounces at coova.org>
>? >? ? ? ? ? ? ? ? <mailto:chilli-bounces at coova.org
> <mailto:chilli-bounces at coova.org>>
>? >? ? ? ? ? ? ? ? [mailto:chilli-bounces at coova.__org
> <mailto:chilli-bounces at coova.__org>
>? >? ? ? ? ? ? ? ? <mailto:chilli-bounces at coova.org
> <mailto:chilli-bounces at coova.org>>] On
>? >? ? ? ? ? ? ? ? Behalf Of chilli-request at coova.org
> <mailto:chilli-request at coova.org>
>? >? ? ? ? ? ? ? ? <mailto:chilli-request at coova.org
> <mailto:chilli-request at coova.org>>
>? >? ? ? ? ? ? ? ? Sent: Sunday, February 22, 2015 4:00 PM
>? >? ? ? ? ? ? ? ? To: chilli at coova.org <mailto:chilli at coova.org>
> <mailto:chilli at coova.org <mailto:chilli at coova.org>>
>? >? ? ? ? ? ? ? ? Subject: Chilli Digest, Vol 63, Issue 12
>? >
>? >? ? ? ? ? ? ? ? Send Chilli mailing list submissions to
>? > chilli at coova.org <mailto:chilli at coova.org> <mailto:chilli at coova.org
> <mailto:chilli at coova.org>>
>? >
>? >? ? ? ? ? ? ? ? To subscribe or unsubscribe via the World Wide Web, visit
>? > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? >? ? ? ? ? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>? >? ? ? ? ? ? ? ? or, via email, send a message with subject or body
> 'help' to
>? > chilli-request at coova.org <mailto:chilli-request at coova.org>
> <mailto:chilli-request at coova.org <mailto:chilli-request at coova.org>>
>? >
>? >? ? ? ? ? ? ? ? You can reach the person managing the list at
>? > chilli-owner at coova.org <mailto:chilli-owner at coova.org>
> <mailto:chilli-owner at coova.org <mailto:chilli-owner at coova.org>>
>? >
>? >? ? ? ? ? ? ? ? When replying, please edit your Subject line so it is
>? >? ? ? ? ? ? ? ? more specific
>? >? ? ? ? ? ? ? ? than
>? >? ? ? ? ? ? ? ? "Re: Contents of Chilli digest..."
>? >
>? >
>? >? ? ? ? ? ? ? ? Today's Topics:
>? >
>? >? ? ? ? ? ? ? ? ? ? ? 1. Too sharp upload bandwidth limit on 1gbps wired
>? >? ? ? ? ? ? ? ? network (kl)
>? >
>? >
>? >
> ------------------------------__------------------------------__----------
>? >
>? >? ? ? ? ? ? ? ? Message: 1
>? >? ? ? ? ? ? ? ? Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
>? >? ? ? ? ? ? ? ? From: kl <kl522 at yahoo.com <mailto:kl522 at yahoo.com>
> <mailto:kl522 at yahoo.com <mailto:kl522 at yahoo.com>>>
>? >? ? ? ? ? ? ? ? To: Chilli List <chilli at coova.org
> <mailto:chilli at coova.org> <mailto:chilli at coova.org
> <mailto:chilli at coova.org>>>
>? >? ? ? ? ? ? ? ? Subject: [Chilli] Too sharp upload bandwidth limit on
>? >? ? ? ? ? ? ? ? 1gbps wired
>? >? ? ? ? ? ? ? ? ? ? ? ? network
>? >? ? ? ? ? ? ? ? Message-ID:
>? >
>? >
> <122480453.6349415.__1424571713923.JavaMail.yahoo at __mail.yahoo.com
> <mailto:122480453.6349415.__1424571713923.JavaMail.yahoo at __mail.yahoo.com>
>? >
> <mailto:122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com
> <mailto:122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com>>>
>? >? ? ? ? ? ? ? ? Content-Type: text/plain; charset=UTF-8
>? >
>? >
>? >
>? >? ? ? ? ? ? ? ? Nobody is facing this issue with coova chilli ?
>? >
>? > http://www.coova.org/node/5171
>? >
>? > https://github.com/coova/__coova-chilli/issues/32
>? >? ? ? ? ? ? ? ? <https://github.com/coova/coova-chilli/issues/32>
>? >
>? >? ? ? ? ? ? ? ? Happens only on Gigabit wired network and certain kernel
>? >? ? ? ? ? ? ? ? verson.
>? >? ? ? ? ? ? ? ? Applies to 1.2.9, 1.3.0 and other versions ....
>? >
>? >
>? >? ? ? ? ? ? ? ? ------------------------------
>? >
>? >? ? ? ? ? ? ? ? _________________________________________________
>? >? ? ? ? ? ? ? ? Chilli mailing list
>? > Chilli at coova.org <mailto:Chilli at coova.org> <mailto:Chilli at coova.org
> <mailto:Chilli at coova.org>>
>? > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? >? ? ? ? ? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>? >
>? >
>? >? ? ? ? ? ? ? ? End of Chilli Digest, Vol 63, Issue 12
>? >? ? ? ? ? ? ? ? ******************************__********
>? >
>? >
>? >? ? ? ? ? ? ? ? _________________________________________________
>? >? ? ? ? ? ? ? ? Chilli mailing list
>? > Chilli at coova.org <mailto:Chilli at coova.org> <mailto:Chilli at coova.org
> <mailto:Chilli at coova.org>>
>? > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? >? ? ? ? ? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>? >? ? ? ? ? ? ? ? _________________________________________________
>? >? ? ? ? ? ? ? ? Chilli mailing list
>? > Chilli at coova.org <mailto:Chilli at coova.org> <mailto:Chilli at coova.org
> <mailto:Chilli at coova.org>>
>? > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? >? ? ? ? ? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>? >
>? >
>? >? ? ? ? ? ? ------------------------------
>? >
>? >? ? ? ? ? ? _________________________________________________
>? >? ? ? ? ? ? Chilli mailing list
>? > Chilli at coova.org <mailto:Chilli at coova.org> <mailto:Chilli at coova.org
> <mailto:Chilli at coova.org>>
>? > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? >? ? ? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>? >
>? >
>? >? ? ? ? ? ? End of Chilli Digest, Vol 63, Issue 14
>? >? ? ? ? ? ? ******************************__********
>? >? ? ? ? ? ? _________________________________________________
>? >? ? ? ? ? ? Chilli mailing list
>? > Chilli at coova.org <mailto:Chilli at coova.org> <mailto:Chilli at coova.org
> <mailto:Chilli at coova.org>>
>? > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? >? ? ? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>? >
>? >
>? >
>? >
>? >? ? ? ? _________________________________________________
>? >? ? ? ? Chilli mailing list
>? > Chilli at coova.org <mailto:Chilli at coova.org> <mailto:Chilli at coova.org
> <mailto:Chilli at coova.org>>
>? > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? >? ? ? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>? >
>? >? ? _________________________________________________
>? >? ? Chilli mailing list
>? > Chilli at coova.org <mailto:Chilli at coova.org> <mailto:Chilli at coova.org
> <mailto:Chilli at coova.org>>
>? > http://lists.coova.org/cgi-__bin/mailman/listinfo/chilli
>? >? ? <http://lists.coova.org/cgi-bin/mailman/listinfo/chilli>
>? >
>? >
>? >
>? >
>? > _______________________________________________
>? > Chilli mailing list
>? > Chilli at coova.org <mailto:Chilli at coova.org>
>? > http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>? >
>
> --
> Lep pozdrav,
>
> Bojan Poga?ar
> GSM: 031 262 535
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org <mailto:Chilli at coova.org>
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>

-- 
Lep pozdrav,

Bojan Poga?ar
GSM: 031 262 535
_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150307/988a7b6c/attachment-0001.html>

From alghe.global at gmail.com  Sat Mar  7 10:27:57 2015
From: alghe.global at gmail.com (Alexandru Gheorghe)
Date: Sat, 7 Mar 2015 12:27:57 +0200
Subject: [Chilli] Chilli Digest, Vol 63, Issue 14
In-Reply-To: <CADo9JyUmqR8MB6QVi6Nv_OPuEqfDAMfp1xbijD5gKqXSox=chg@mail.gmail.com>
References: <mailman.1.1424952002.815.chilli@coova.org>
 <AM2PR05MB0788EC067BEB3D13B821844492140@AM2PR05MB0788.eurprd05.prod.outlook.com>
 <54F0CA8C.8020901@gmail.com> <54F0E916.9060702@rexy.fr>
 <CADo9JyUmqR8MB6QVi6Nv_OPuEqfDAMfp1xbijD5gKqXSox=chg@mail.gmail.com>
Message-ID: <CA+qLtxR_ns_1PN=45Zt-Om7mhTefGHFKrYr_H__3y9z8UDwkTA@mail.gmail.com>

If there's offloading on the nic, shouldn't this be seen at kernel level
from L2 and up? Why when raised by CPU (the offloaded packets) to be routed
to the router/appliance itself for the application the bandwidth drops?

It is rather curious it happens to an HTTP proxy application too. But so
far your investigation regarding the 100mb/s points to this with coova
disabled. If I may, I'd like to question if your setup involves any bridges.

Normally the only things that come into my mind are:
1) starting with kernel 2.37 iirc the bridge is set down if there's no
uplink with beat detected on it/down;

2) the way chilli captures traffic packets is to create a tun interface in
order to access the kernel side of routing packets (an usual hook like
netfilter does, similarly).

The first I think does not apply to your case and I can't seem to find any
explanation how it can affect you. The second could be one of the reasons
in a chain of symptoms that gives you the result.

Anyways, I'm rather curious right now to know if indeed offloading on the
NIC was the cause. Any results?

Alex

--
; Alexandru Gheorghe
; alghe.global {at} gmail {com}

; sent from mobile
On Feb 28, 2015 2:54 AM, "David Bird" <dbird at google.com> wrote:

> You can use --tcpmss to clamp the TCP MSS. But, I agree, your issue is
> very likely gso related. Something like "sudo ethtool -K eth1 gro off"
>
> On Fri, Feb 27, 2015 at 2:00 PM, Richard REY <richard at rexy.fr> wrote:
>
>> Yes, but this doesn't explain why there isn't any problem when the flows
>> pass through the appliance. this issue is seen only when the TCP flows is
>> sent to an internal processes
>>
>> I'll try to disable packet off-loading next monday.
>> I'll also try to forbid the "jumbo frame" on NIC
>>
>> Rexy
>>
>> Le 27/02/2015 20:50, Alexandru Gheorghe a ?crit :
>>
>>  Usually fragmentation needed means you need to adjust the MTU of your
>>> nic.
>>>
>>> Alex
>>>
>>>
>>> On 02/26/2015 02:30 PM, Claus Stjernoe wrote:
>>>
>>>> Hi Richard,
>>>>
>>>> Try to disable packet off-loading on the Gigabit NIC.
>>>>
>>>> Kind regards,
>>>> Claus
>>>>
>>>> -----Oprindelig meddelelse-----
>>>> Fra: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] P?
>>>> vegne af chilli-request at coova.org
>>>> Sendt: 26. februar 2015 13:00
>>>> Til: chilli at coova.org
>>>> Emne: Chilli Digest, Vol 63, Issue 14
>>>>
>>>> Send Chilli mailing list submissions to
>>>>         chilli at coova.org
>>>>
>>>> To subscribe or unsubscribe via the World Wide Web, visit
>>>>         http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>> or, via email, send a message with subject or body 'help' to
>>>>         chilli-request at coova.org
>>>>
>>>> You can reach the person managing the list at
>>>>         chilli-owner at coova.org
>>>>
>>>> When replying, please edit your Subject line so it is more specific
>>>> than "Re: Contents of Chilli digest..."
>>>>
>>>>
>>>> Today's Topics:
>>>>
>>>>     1. Re: Chilli Digest, Vol 63, Issue 12 (Richard REY)
>>>>
>>>>
>>>> ----------------------------------------------------------------------
>>>>
>>>> Message: 1
>>>> Date: Wed, 25 Feb 2015 22:48:56 +0100
>>>> From: Richard REY <richard at rexy.fr>
>>>> To: chilli at coova.org
>>>> Subject: Re: [Chilli] Chilli Digest, Vol 63, Issue 12
>>>> Message-ID: <54EE4348.2090503 at rexy.fr>
>>>> Content-Type: text/plain; charset=windows-1252; format=flowed
>>>>
>>>> Hi,
>>>> I use COOVA in its last version (SVN revision 492) running on an
>>>> ALCASAR appliance (mageia 4.1 - kernel 3.14.32), all is OK excepted a flow
>>>> issue.
>>>> When a TCP stream goes across the appliance there isn't any flow issue
>>>> (forward mode). BUT when a TCP stream is sent inside the appliance (to a
>>>> HTTP proxy for example) the observed flow is very weak (Input mode). The
>>>> problem is maximal when the card connected to COOVA is in the Gigabit mode.
>>>>
>>>> Our investigation :
>>>>   From the appliance, we try to download a file located on a FTP server
>>>> connected on the network controlled by COOVA. Without COOVA the observed
>>>> flow in gigabit mode is about 888Mb/s whereas with COOVA we can see just
>>>> 68 Kb/s (YES 68 Kb/s). Regarding the packets exchanged we can see ICMP
>>>> packets sent by the appliance (Destination unreachable (Fragmentation
>>>> needed).
>>>> We found a by-pass ?solution? by fixing the speed of the card to
>>>> 100Mb/s. At this speed the phenomenon is practically invisible (just one
>>>> ICMP packet sent) and the flow approaches the maximum supported by the
>>>> network card. On a virtual machine where we can't fix Ethernet speed, we
>>>> must choose a 100Mb/s virtual Ethernet card when building the VM.
>>>> We have the Pcap file of our investigation. I say it again, this issue
>>>> is seen only when the TCP flows is sent to an internal processes (in
>>>> 'forward' mode all is ok).
>>>>
>>>> Regards
>>>> Rexy & ALCASAR team
>>>>
>>>> Le 23/02/2015 08:59, kl a ?crit :
>>>>
>>>>> I see problem on kernel version > 3.7 right up to 3.10.  Above 3.10
>>>>> not tested.
>>>>> However, in the other quoted post, it says kernel 2.6.39 upto 3.3.4.
>>>>> Above that not tested.
>>>>> Something not consist here.
>>>>>
>>>>> So which kernel version you guys are using which are seeing this
>>>>> problem ?
>>>>>
>>>>>
>>>>> On Monday, February 23, 2015 3:13 PM, Danny Magat <danny at sb-ps.ae>
>>>>> wrote:
>>>>> This problem is still exist on my setup.
>>>>> http://lists.coova.org/pipermail/chilli/2013-November/002437.html
>>>>>
>>>>> I hope that somebody will give us a hint on how to solve this.
>>>>>
>>>>> Regards,
>>>>> Danny
>>>>>
>>>>> -----Original Message-----
>>>>> From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On
>>>>> Behalf Of chilli-request at coova.org
>>>>> Sent: Sunday, February 22, 2015 4:00 PM
>>>>> To: chilli at coova.org
>>>>> Subject: Chilli Digest, Vol 63, Issue 12
>>>>>
>>>>> Send Chilli mailing list submissions to
>>>>>       chilli at coova.org
>>>>>
>>>>> To subscribe or unsubscribe via the World Wide Web, visit
>>>>>       http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>>> or, via email, send a message with subject or body 'help' to
>>>>>       chilli-request at coova.org
>>>>>
>>>>> You can reach the person managing the list at
>>>>>       chilli-owner at coova.org
>>>>>
>>>>> When replying, please edit your Subject line so it is more specific
>>>>> than
>>>>> "Re: Contents of Chilli digest..."
>>>>>
>>>>>
>>>>> Today's Topics:
>>>>>
>>>>>      1. Too sharp upload bandwidth limit on 1gbps wired network (kl)
>>>>>
>>>>>
>>>>> ----------------------------------------------------------------------
>>>>>
>>>>> Message: 1
>>>>> Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
>>>>> From: kl <kl522 at yahoo.com>
>>>>> To: Chilli List <chilli at coova.org>
>>>>> Subject: [Chilli] Too sharp upload bandwidth limit on 1gbps wired
>>>>>       network
>>>>> Message-ID:
>>>>>       <122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com>
>>>>> Content-Type: text/plain; charset=UTF-8
>>>>>
>>>>>
>>>>>
>>>>> Nobody is facing this issue with coova chilli ?
>>>>>
>>>>> http://www.coova.org/node/5171
>>>>>
>>>>> https://github.com/coova/coova-chilli/issues/32
>>>>>
>>>>> Happens only on Gigabit wired network and certain kernel verson.
>>>>> Applies to 1.2.9, 1.3.0 and other versions ....
>>>>>
>>>>>
>>>>> ------------------------------
>>>>>
>>>>> _______________________________________________
>>>>> Chilli mailing list
>>>>> Chilli at coova.org
>>>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>>>
>>>>>
>>>>> End of Chilli Digest, Vol 63, Issue 12
>>>>> **************************************
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> Chilli mailing list
>>>>> Chilli at coova.org
>>>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>>> _______________________________________________
>>>>> Chilli mailing list
>>>>> Chilli at coova.org
>>>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>>>
>>>>>
>>>> ------------------------------
>>>>
>>>> _______________________________________________
>>>> Chilli mailing list
>>>> Chilli at coova.org
>>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>>
>>>>
>>>> End of Chilli Digest, Vol 63, Issue 14
>>>> **************************************
>>>> _______________________________________________
>>>> Chilli mailing list
>>>> Chilli at coova.org
>>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>>
>>>
>>>
>>>
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>
>>>  _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>
>
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150307/5249dad3/attachment.html>

From john.paul at wanadoo.fr  Fri Mar 13 15:32:39 2015
From: john.paul at wanadoo.fr (John Paul)
Date: Fri, 13 Mar 2015 16:32:39 +0100
Subject: [Chilli] new Interface name
Message-ID: <3679783.merMuE1qO5@antec>

Hi,
I meet a strange message with a recent distribution (opensuse 13.2), which has 
3.16 kernel and uses by the way the new interface naming convention.

# uname -a 
Linux linux-80sk 3.16.6-2-desktop #1 SMP PREEMPT Mon Oct 20 13:47:22 UTC 2014 
(feb42ea) x86_64 x86_64 x86_64 GNU/Linux

The ERROR message :
coova-chilli[8630]: options.c: 181: could not generate configuration 
(/var/run/chilli.8630.cfg.bin), sleeping one second


linux-80sk:/etc/chilli # ifconfig -a 
enp0s3    Link encap:Ethernet  HWaddr 08:00:27:B6:E5:F8  
          inet addr:192.168.1.56  Bcast:192.168.1.255  Mask:255.255.255.0
          inet6 addr: fe80::a00:27ff:feb6:e5f8/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:51158 errors:0 dropped:8 overruns:0 frame:0
          TX packets:35328 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:21508614 (20.5 Mb)  TX bytes:6506583 (6.2 Mb)

enp0s8    Link encap:Ethernet  HWaddr 08:00:27:F5:3F:FE  
          UP BROADCAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:6762 errors:0 dropped:0 overruns:0 frame:0
          TX packets:6762 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:2226378 (2.1 Mb)  TX bytes:2226378 (2.1 Mb)

After a little research on the net, I found that trick to keep old interface 
name. "net.ifnames=0" in the grub.cfg at the end of vmlinux line.

Is there already a patch for that new naming convention ?

Thanks,
John



From josh.harle at gmail.com  Tue Mar 24 07:23:18 2015
From: josh.harle at gmail.com (Josh Harle)
Date: Tue, 24 Mar 2015 15:23:18 +0800
Subject: [Chilli] Coova as single point access control
Message-ID: <CAP3GMYAJ57WLxTTWe1UTycthOvqLpsPWOfhFf5GUn-FOSf-OpQ@mail.gmail.com>

Hi all,

I'm working on a project to set up a town-wide mesh network for a festival,
and have control of bandwidth.
I'd like to use CoovaChilli with a mesh network (Commotion Wireless), and
was wondering if it would work just sitting the access control between the
network and the internet access?

I'm wondering if this will work?  Does the captive portal need particular
firmware on the nodes?

Kind Regards,

Josh Harle
BSc (Hons) BA BFA PhD
____________________
http://joshharle.com
http://tacticalspace.org
ph: +61 (0)491 155 985
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150324/cb2f5538/attachment.html>

From sachin0235 at yahoo.com  Tue Mar 24 18:06:39 2015
From: sachin0235 at yahoo.com (Sachin Yadav)
Date: Tue, 24 Mar 2015 18:06:39 +0000 (UTC)
Subject: [Chilli] Chilli Digest, Vol 64, Issue 6
In-Reply-To: <mailman.1.1427198401.23293.chilli@coova.org>
References: <mailman.1.1427198401.23293.chilli@coova.org>
Message-ID: <355019838.789802.1427220399586.JavaMail.yahoo@mail.yahoo.com>

Town wide mesh, woh!! You would like to have a look at?http://www.radiusdesk.com/?and?http://www.radiusdesk.com/meshdesk_user_guideOpensource mesh network using coovachilli and batman. Hope this will help. ?


     On Tuesday, March 24, 2015 5:42 PM, "chilli-request at coova.org" <chilli-request at coova.org> wrote:
   

 Send Chilli mailing list submissions to
??? chilli at coova.org

To subscribe or unsubscribe via the World Wide Web, visit
??? http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
or, via email, send a message with subject or body 'help' to
??? chilli-request at coova.org

You can reach the person managing the list at
??? chilli-owner at coova.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Chilli digest..."


Today's Topics:

? 1. Coova as single point access control (Josh Harle)


----------------------------------------------------------------------

Message: 1
Date: Tue, 24 Mar 2015 15:23:18 +0800
From: Josh Harle <josh.harle at gmail.com>
To: chilli at coova.org
Subject: [Chilli] Coova as single point access control
Message-ID:
??? <CAP3GMYAJ57WLxTTWe1UTycthOvqLpsPWOfhFf5GUn-FOSf-OpQ at mail.gmail.com>
Content-Type: text/plain; charset="utf-8"

Hi all,

I'm working on a project to set up a town-wide mesh network for a festival,
and have control of bandwidth.
I'd like to use CoovaChilli with a mesh network (Commotion Wireless), and
was wondering if it would work just sitting the access control between the
network and the internet access?

I'm wondering if this will work?? Does the captive portal need particular
firmware on the nodes?

Kind Regards,

Josh Harle
BSc (Hons) BA BFA PhD
____________________
http://joshharle.com
http://tacticalspace.org
ph: +61 (0)491 155 985
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150324/cb2f5538/attachment-0001.html>

------------------------------

_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


End of Chilli Digest, Vol 64, Issue 6
*************************************


  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150324/85da57cb/attachment.html>

