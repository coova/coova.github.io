From lferreira at cabocom.cv  Sat Feb  1 10:50:36 2014
From: lferreira at cabocom.cv (Luis Ferreira)
Date: Sat, 1 Feb 2014 09:50:36 -0100
Subject: [Chilli] newbie chilli layer3 itables question
Message-ID: <079701cf1f3b$717c8070$54758150$@cabocom.cv>

Hi everyone,

 

I know this is a bizarre question, and I should know better, but can someone
explain to me the purpose of having this iptables rules for each chilli
instance on layer 3 and vlan?

 

 

-A FORWARD -i tun3 ! -o eth1 -j DROP

-A FORWARD -o tun3 -j ACCEPT

-A FORWARD -i tun3 -j ACCEPT

 

And

 

-A FORWARD -o vlan30 -j DROP

-A FORWARD -i vlan30 -j DROP

 

I ask this because sometimes, when I start chilli, the startup script
/etc/init.d/chilli does not create the rules, and I have to either restart
that instance or manually create them. 

 

Also, sometimes, on startup script,  vlan30, instead of create the iptables
rules for "vlan30", creates them for another one i.e. "vlan70", and then
when vlan70 is starting, it fails

 

I thought that this would affect costumers, but they can still see the login
page and browser normally the internet, so my question is:

 

What is the purpose of them?

 

Regards,

Luis

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140201/9282c6ed/attachment.html>

From eric at craftti.com.br  Tue Feb  4 00:25:16 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Mon, 3 Feb 2014 22:25:16 -0200
Subject: [Chilli] Does coova support multiples subscriber interfaces?
Message-ID: <CAF+USJ5FNZ13wZWYEkHnN01WUc8zPYH=AS5DEL-AvtOP8-YjMQ@mail.gmail.com>

Hi folks,

Can I have a single coova instance handling more than one subscriber
interface (say eth1 and eth2)?

Best regards,

Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140203/d409a48a/attachment.html>

From dbird at google.com  Tue Feb  4 00:59:55 2014
From: dbird at google.com (David Bird)
Date: Mon, 3 Feb 2014 16:59:55 -0800
Subject: [Chilli] Does coova support multiples subscriber interfaces?
In-Reply-To: <CAF+USJ5FNZ13wZWYEkHnN01WUc8zPYH=AS5DEL-AvtOP8-YjMQ@mail.gmail.com>
References: <CAF+USJ5FNZ13wZWYEkHnN01WUc8zPYH=AS5DEL-AvtOP8-YjMQ@mail.gmail.com>
Message-ID: <CADo9JyWZBEe8UnfjW9P3Xz8ygNAO9A8wCgG3HSpK+x1WFYgH2g@mail.gmail.com>

You can create a bridge and add both interfaces to it... or, you can
checkout the --moreif option.


On Mon, Feb 3, 2014 at 4:25 PM, Eric Chaves <eric at craftti.com.br> wrote:

> Hi folks,
>
> Can I have a single coova instance handling more than one subscriber
> interface (say eth1 and eth2)?
>
> Best regards,
>
> Eric
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140203/f6ae4a08/attachment.html>

From eric at craftti.com.br  Tue Feb  4 01:08:32 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Mon, 3 Feb 2014 23:08:32 -0200
Subject: [Chilli] Does coova support multiples subscriber interfaces?
In-Reply-To: <CADo9JyWZBEe8UnfjW9P3Xz8ygNAO9A8wCgG3HSpK+x1WFYgH2g@mail.gmail.com>
References: <CAF+USJ5FNZ13wZWYEkHnN01WUc8zPYH=AS5DEL-AvtOP8-YjMQ@mail.gmail.com>
 <CADo9JyWZBEe8UnfjW9P3Xz8ygNAO9A8wCgG3HSpK+x1WFYgH2g@mail.gmail.com>
Message-ID: <CAF+USJ5dVZ4ed3mKLZemuckudLmwGU-xhAOfG0SN0acNmhh0qQ@mail.gmail.com>

Thanks David! I wasn't aware of the moreif option but it seems to solve my
problem! I'll be trying it tomorrow. Just out of curiosity, how does coova
handle the outgoing traffic in case of more than on WLAN? Does it perform
some kind of load balance or weighted routing on each one? How does it
choose to which one to use?

Cheers,

--
Eric Chaves
(11) 98139-9880


2014-02-03 David Bird <dbird at google.com>:

> You can create a bridge and add both interfaces to it... or, you can
> checkout the --moreif option.
>
>
> On Mon, Feb 3, 2014 at 4:25 PM, Eric Chaves <eric at craftti.com.br> wrote:
>
>> Hi folks,
>>
>> Can I have a single coova instance handling more than one subscriber
>> interface (say eth1 and eth2)?
>>
>> Best regards,
>>
>> Eric
>>
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140203/df76856e/attachment.html>

From jedgainer at gmail.com  Tue Feb  4 04:09:05 2014
From: jedgainer at gmail.com (Jed Gainer)
Date: Mon, 3 Feb 2014 20:09:05 -0800
Subject: [Chilli] chilli and satellite wan
Message-ID: <CAJc1nupt+hRy4dO3auk2b5gb+QK5G_-cqY5bNxi0ydt7n6Y3=A@mail.gmail.com>

I am using chilli to manage users on a very limited bandwidth and high
latency network. Everything fine except chilli randomly stops handing out
IPs and wont let users login. I suspect its crashing and want to cron a
script to check on it every 5 minutes and restart it if its not working.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140203/5f120e65/attachment.html>

From fdfmacedo at gmail.com  Tue Feb  4 09:46:07 2014
From: fdfmacedo at gmail.com (Fernando Macedo)
Date: Tue, 4 Feb 2014 07:46:07 -0200
Subject: [Chilli] chilli and satellite wan
In-Reply-To: <CAJc1nupt+hRy4dO3auk2b5gb+QK5G_-cqY5bNxi0ydt7n6Y3=A@mail.gmail.com>
References: <CAJc1nupt+hRy4dO3auk2b5gb+QK5G_-cqY5bNxi0ydt7n6Y3=A@mail.gmail.com>
Message-ID: <CAEUOhU5h6HVnruAW2j4rOb1kGocWW0a9Dh69iXcrWq46ZZVJ=Q@mail.gmail.com>

Run it with gdb debugger and post more crash informations.

Fernando Macedo


2014-02-04 Jed Gainer <jedgainer at gmail.com>

> I am using chilli to manage users on a very limited bandwidth and high
> latency network. Everything fine except chilli randomly stops handing out
> IPs and wont let users login. I suspect its crashing and want to cron a
> script to check on it every 5 minutes and restart it if its not working.
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140204/df3056be/attachment.html>

From dbird at google.com  Tue Feb  4 16:37:03 2014
From: dbird at google.com (David Bird)
Date: Tue, 4 Feb 2014 08:37:03 -0800
Subject: [Chilli] chilli and satellite wan
In-Reply-To: <CAEUOhU5h6HVnruAW2j4rOb1kGocWW0a9Dh69iXcrWq46ZZVJ=Q@mail.gmail.com>
References: <CAJc1nupt+hRy4dO3auk2b5gb+QK5G_-cqY5bNxi0ydt7n6Y3=A@mail.gmail.com>
 <CAEUOhU5h6HVnruAW2j4rOb1kGocWW0a9Dh69iXcrWq46ZZVJ=Q@mail.gmail.com>
Message-ID: <CADo9JyVmmgb61Bgmofi7RMa5wbZw8S+3hPFPH3+RcbRY77t5WQ@mail.gmail.com>

You can use chilli_query to check if a daemon is running/responsive.


On Tue, Feb 4, 2014 at 1:46 AM, Fernando Macedo <fdfmacedo at gmail.com> wrote:

> Run it with gdb debugger and post more crash informations.
>
> Fernando Macedo
>
>
> 2014-02-04 Jed Gainer <jedgainer at gmail.com>
>
>> I am using chilli to manage users on a very limited bandwidth and high
>> latency network. Everything fine except chilli randomly stops handing out
>> IPs and wont let users login. I suspect its crashing and want to cron a
>> script to check on it every 5 minutes and restart it if its not working.
>>
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>
>>
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140204/ad3f6255/attachment.html>

From otakugodie at gmail.com  Tue Feb  4 21:40:45 2014
From: otakugodie at gmail.com (Diego Rodriguez)
Date: Tue, 4 Feb 2014 16:40:45 -0500
Subject: [Chilli] Problem installing CoovaChilli on Ubuntu 12.04.3 LTS
Message-ID: <CAMFeqSn1ZVkWRPOzJNEBmiFf-376onqk1UFF-Cs1P3hx1bd+2A@mail.gmail.com>

Hi people,

I'm so new in topics about GNU/Linux and Chilli, follow the guide in
https://help.ubuntu.com/community/WifiDocs/CoovaChilli#Basic_Configuration,
I have a little problem.

Follow step by step the *CoovaChilli Source Installation, *when I try:

update-rc.d chilli defaults

Terminal responds:

update-rc.d: warning: chilli start runlevel arguments (2 3 4 5) do not
match LSB Default-Start values (2 3 5)
update-rc.d: warning: chilli stop runlevel arguments (0 1 6) do not match
LSB Default-Stop values (none)
 Adding system startup for /etc/init.d/chilli ...
   /etc/rc0.d/K20chilli -> ../init.d/chilli
   /etc/rc1.d/K20chilli -> ../init.d/chilli
   /etc/rc6.d/K20chilli -> ../init.d/chilli
   /etc/rc2.d/S20chilli -> ../init.d/chilli
   /etc/rc3.d/S20chilli -> ../init.d/chilli
   /etc/rc4.d/S20chilli -> ../init.d/chilli
   /etc/rc5.d/S20chilli -> ../init.d/chilli


And try: /etc/rc.local, responds:
$Shutting down chilli: No process in pidfile '/var/run/chilli.pid' found
running; none killed.
/etc/init.d/chilli: 199: /etc/chilli/defaults: self: not found
Starting chilli:
And none says nothing

Trying: lsof |grep "chilli"

lsof: WARNING: can't stat() fuse.gvfs-fuse-daemon file system
/home/otakugodie/.gvfs
      Output information may be incomplete.
chilli    2837            root  cwd         DIR                8,6
 4096          2 /
chilli    2837            root  rtd           DIR                8,6
 4096          2 /
chilli    2837            root  txt           REG                8,6
18073     434269 /sbin/chilli
chilli    2837            root  mem       REG                8,6    135366
    549073 /lib/x86_64-linux-gnu/libpthread-2.15.so
chilli    2837            root  mem       REG                8,6     92720
    549092 /lib/x86_64-linux-gnu/libz.so.1.2.3.4
chilli    2837            root  mem       REG                8,6     14768
    549083 /lib/x86_64-linux-gnu/libdl-2.15.so
chilli    2837            root  mem       REG                8,6     31752
    549070 /lib/x86_64-linux-gnu/librt-2.15.so
chilli    2837            root  mem       REG                8,6   1930616
    554959 /lib/x86_64-linux-gnu/libcrypto.so.1.0.0
chilli    2837            root  mem       REG                8,6    382896
    554960 /lib/x86_64-linux-gnu/libssl.so.1.0.0
chilli    2837            root  mem       REG                8,6    152793
    549137 /lib/libbstring.so.0.0.0
chilli    2837            root  mem       REG                8,6   1815224
    549056 /lib/x86_64-linux-gnu/libc-2.15.so
chilli    2837            root  mem       REG                8,6   1022467
    549265 /lib/libchilli.so.0.0.0
chilli    2837            root  mem       REG                8,6    149280
    549078 /lib/x86_64-linux-gnu/ld-2.15.so
chilli    2837            root    0r          CHR                1,3
0t0       4100 /dev/null
chilli    2837            root    1w        CHR                1,3
0t0       4100 /dev/null
chilli    2837            root    2w        CHR                1,3
0t0       4100 /dev/null
chilli    2837            root    3u         unix 0xffff880308fee800
0t0      18052 socket
chilli    2837            root    4u         CHR             10,200
0t0       4244 /dev/net/tun
chilli    2837            root    5u         pack              18060
0t0        ALL type=SOCK_RAW
chilli    2837            root    6u        IPv4              18078
0t0        UDP *:59093
chilli    2837            root    7r         CHR                1,9
0t0       4105 /dev/urandom
chilli    2837            root    8u        IPv4              18079
0t0        TCP 10.1.1.1:3990 (LISTEN)
chilli    2837            root    9u        IPv4              18080
0t0        TCP 10.1.1.1:4990 (LISTEN)
chilli    2837            root   10u        unix 0xffff880308feeb40
0t0      18081 /var/run/chilli.eth1.ipc
chilli    2837            root   11u        unix 0xffff880308fead80
0t0      18083 /var/run/chilli.eth1.sock
chilli    2837            root   12r         FIFO                0,8
0t0      18085 pipe
chilli    2837            root   13w        FIFO                0,8
0t0      18085 pipe

And try ps -A |grep "chilli", responds:
 2837 ?        00:00:00 chilli

Before of this I try to install Chilli, I installed GRASE HOTSPOT, but I
want to get back of bases

After of read so many forums, tutorials, websites, and, another, I decide
write my question.

Somebody has any clue?

Thanks a lot.

-- 
Diego Rodriguez
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140204/5a52f107/attachment.html>

From sourav.chakraborty at netcommwireless.com  Tue Feb  4 23:33:56 2014
From: sourav.chakraborty at netcommwireless.com (Sourav)
Date: Wed, 5 Feb 2014 10:33:56 +1100
Subject: [Chilli] implementing "Enable Local LAN" and "Enable Hotspot
	Clients" options
Message-ID: <52F178E4.3080301@netcommwireless.com>

Hi Guys,
We are running coova-chilli on our routers with the attached 
/etc/chilli/config file --

root:/etc/cdcs/conf/mgr_templates# ifconfig
br0       Link encap:Ethernet  HWaddr 00:60:64:11:11:47
           inet addr:192.168.1.1  Bcast:192.168.1.255 Mask:255.255.255.0
           inet6 addr: fe80::260:64ff:fe11:1147/64 Scope:Link
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
           RX packets:3360 errors:0 dropped:0 overruns:0 frame:0
           TX packets:3226 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:0
           RX bytes:304231 (297.1 KiB)  TX bytes:2722119 (2.5 MiB)

br0:0     Link encap:Ethernet  HWaddr 00:60:64:11:11:47
           inet addr:192.168.1.253  Bcast:192.168.1.255 Mask:255.255.255.0
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1

eth0      Link encap:Ethernet  HWaddr 00:60:64:11:11:47
           inet6 addr: fe80::260:64ff:fe11:1147/64 Scope:Link
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
           RX packets:3360 errors:4 dropped:0 overruns:0 frame:0
           TX packets:3240 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:1000
           RX bytes:351327 (343.0 KiB)  TX bytes:2723067 (2.5 MiB)
           Interrupt:25 Base address:0xc000

lo        Link encap:Local Loopback
           inet addr:127.0.0.1  Mask:255.0.0.0
           inet6 addr: ::1/128 Scope:Host
           UP LOOPBACK RUNNING  MTU:16436  Metric:1
           RX packets:842 errors:0 dropped:0 overruns:0 frame:0
           TX packets:842 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:0
           RX bytes:24418 (23.8 KiB)  TX bytes:24418 (23.8 KiB)

ra0       Link encap:Ethernet  HWaddr 00:60:64:11:11:48
           inet6 addr: fe80::260:64ff:fe11:1148/64 Scope:Link
           UP BROADCAST RUNNING PROMISC MULTICAST  MTU:1500  Metric:1
           RX packets:0 errors:0 dropped:0 overruns:0 frame:0
           TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:1000
           RX bytes:4678051 (4.4 MiB)  TX bytes:94080 (91.8 KiB)

ra1       Link encap:Ethernet  HWaddr 00:60:64:11:11:49
           inet6 addr: fe80::260:64ff:fe11:1149/64 Scope:Link
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
           RX packets:0 errors:0 dropped:0 overruns:0 frame:0
           TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:1000
           RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

ra2       Link encap:Ethernet  HWaddr 00:60:64:11:11:4A
           inet6 addr: fe80::260:64ff:fe11:114a/64 Scope:Link
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
           RX packets:0 errors:0 dropped:0 overruns:0 frame:0
           TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:1000
           RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

ra3       Link encap:Ethernet  HWaddr 00:60:64:11:11:4B
           inet6 addr: fe80::260:64ff:fe11:114b/64 Scope:Link
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
           RX packets:0 errors:0 dropped:0 overruns:0 frame:0
           TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:1000
           RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

ra4       Link encap:Ethernet  HWaddr 00:60:64:11:11:4C
           inet6 addr: fe80::260:64ff:fe11:114c/64 Scope:Link
           UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
           RX packets:0 errors:0 dropped:0 overruns:0 frame:0
           TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
           collisions:0 txqueuelen:1000
           RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

*tun0      Link encap:UNSPEC  HWaddr 
00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00 **
**          inet addr:10.1.0.1  P-t-P:10.1.0.1 Mask:255.255.255.0**
**          UP POINTOPOINT RUNNING  MTU:1500  Metric:1**
**          RX packets:0 errors:0 dropped:0 overruns:0 frame:0**
**          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0**
**          collisions:0 txqueuelen:100 **
**          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)*

wwan0     Link encap:Ethernet  HWaddr 6A:0E:47:FD:01:07
           inet addr:123.209.17.117  Bcast:123.255.255.255 
Mask:255.255.255.255
           inet6 addr: fe80::680e:47ff:fefd:107/64 Scope:Link
           UP BROADCAST RUNNING NOARP MULTICAST  MTU:1358  Metric:1
           RX packets:45 errors:0 dropped:0 overruns:0 frame:0
           TX packets:41 errors:0 dropped:4294967294 overruns:0 carrier:0
           collisions:0 txqueuelen:1000
           RX bytes:4316 (4.2 KiB)  TX bytes:3833 (3.7 KiB)

We now want to implement "Enable Local LAN" and "Enable Hotspot Clients" 
options, which basically allow the clients on Local LAN(192.168.1.x) to 
access clients on the wireless hotspot(10.1.0.x) and vice versa. For 
this I checked the existing bridge on our router --
root:/etc/chilli# brctl show
bridge name     bridge id               STP enabled     interfaces
br0             8000.006064111147       no              eth0
           ra0
         ra1
           ra2
         ra3
         ra4

So I thought of adding the tun0 interface to the bridge br0 would solve 
the purpose, but I found that tun0 can't be added to bridge. Can you 
suggest how to satisfy the mentioned requirements. Also please let me 
know the significance of the coova-chilli generated tun0 interface i.e 
why is it created and what are the tunnel endpoints?

-- 
Warm Regards,
Sourav



______________________________________________________________________
This communication contains information which may be confidential or privileged. The information is intended solely for the use of the individual or entity named above.  If you are not the intended recipient, be aware that any disclosure, copying, distribution or use of the contents of this information is prohibited.  If you have received this communication in error, please notify me by telephone immediately.
______________________________________________________________________
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140205/db6c107f/attachment-0001.html>
-------------- next part --------------
# -*- mode: shell-script; -*-
#
#   Coova-Chilli Default Configurations. 
#   To customize, copy this file to /etc/chilli/config
#   and edit to your liking. This is included in shell scripts
#   that configure chilli and related programs before file 'config'. 


###
#   Local Network Configurations
# 

# HS_WANIF=eth0            # WAN Interface toward the Internet
HS_WANIF=wwan0            # WAN Interface toward the Internet
HS_LANIF=ra0               # Subscriber Interface for client devices
HS_UAMPORT=3990            # HotSpot UAM Port (on subscriber network)
HS_UAMUIPORT=4990          # HotSpot UAM "UI" Port (on subscriber network, for embedded portal)
#HS_STATIP=10.1.0.1
#HS_STATIP_MASK=255.255.255.0
#HS_DNS_DOMAIN=10.1.0.1

# OpenDNS Servers
#HS_DNS1=10.4.81.103
#HS_DNS1=192.168.1.1
HS_DNS1=10.1.0.1
#HS_DNS2=10.4.182.20

###
#   HotSpot settings for simple Captive Portal
#
HS_NASID=ntc_30w
#HS_UAMALLOW=www.coova.org,www.bbc.com
#HS_UAMSECRET=change-me     # Set to be your UAM secret
#HS_UAMSECRET="Ponutokoyu"
HS_UAMSECRET=
HS_UAMALIASNAME=chilli

#  Configure RADIUS proxy support (for 802.1x + captive portal support)
#HS_RADPROXY=on
HS_RADPROXY_PORT=1645
HS_RADPROXY_MACACCEPT=on
HS_RADPROXY_LOCATTR=32
#  Example OpenWrt /etc/config/wireless entry for hostapd
#    option encryption wpa2
#    option port $HS_RADPROXY_PORT
#    option key $HS_RADPROXY_SECRET


#   To alternatively use a HTTP URL for AAA instead of RADIUS:
# HS_UAMAAAURL=http://my-site/script.php

#   Put entire domains in the walled-garden with DNS inspection
# HS_UAMDOMAINS=".paypal.com,.paypalobjects.com"
HS_UAMDOMAINS="coova.org,bbc.com"

#   Optional initial redirect and RADIUS settings
#HS_NASMAC=00:60:64:89:20:5F  # To explicitly set Called-Station-Id

#   The server to be used in combination with HS_UAMFORMAT to 
#   create the final chilli 'uamserver' url configuration.

#   Use HS_UAMFORMAT to define the actual captive portal url.
#   Shell variable replacement takes place when evaluated, so here

#   Same principal goes for HS_UAMHOMEPAGE.

#   This option will be configured to be the WISPr LoginURL as well
#   as provide "uamService" to the ChilliController. The UAM Service is
#   described in: http://www.coova.org/CoovaChilli/UAMService
#


###
#   Features not activated per-default (default to off)
#
# HS_RADCONF=off           # Get some configurations from RADIUS or a URL ('on' and 'url' respectively)
#
HS_ANYIP=on                # Allow any IP address on subscriber LAN
#
#HS_MACAUTH=on             # To turn on MAC Authentication
#
# HS_MACAUTHDENY=on        # Put client in 'drop' state on MAC Auth Access-Reject
#
# HS_MACAUTHMODE=local     # To allow MAC Authentication based on macallowed, not RADIUS
#
# HS_MACALLOW="..."      # List of MAC addresses to authenticate (comma seperated)
#
#HS_USELOCALUSERS=on      # To use the /etc/chilli/localusers file
#
#HS_OPENIDAUTH=on          # To inform the RADIUS server to allow OpenID Auth
#
HS_WPAGUESTS=on    # To inform the RADIUS server to allow WPA Guests
#
#HS_DNSPARANOIA=on         # To drop DNS packets containing something other
#                          # than A, CNAME, SOA, or MX records
#
#HS_OPENIDAUTH=on          # To inform the RADIUS server to allow OpenID Auth
#                          # Will also configure the embedded login forms for OpenID
#
# HS_USE_MAP=on            # Short hand for allowing the required google
#                          # sites to use Google maps (adds many google sites!)
#
###
#   Other feature settings and their defaults
#
#HS_DEFSESSIONTIMEOUT=0   # Default session-timeout if not defined by RADIUS (0 for unlimited)
#
#HS_DEFIDLETIMEOUT=0       # Default idle-timeout if not defined by RADIUS (0 for unlimited)
#
# HS_DEFBANDWIDTHMAXDOWN=0   # Default WISPr-Bandwidth-Max-Down if not defined by RADIUS (0 for unlimited)
#
# HS_DEFBANDWIDTHMAXUP=0           # Default WISPr-Bandwidth-Max-Up if not defined by RADIUS (0 for unlimited)

###
# Centralized configuration options examples
# 
# HS_RADCONF=url           # requires curl
# HS_RADCONF_URL=https://coova.org/app/ap/config

#HS_RADCONF=on             # gather the ChilliSpot-Config attributes in
#                          # Administrative-User login
# HS_RADCONF_SERVER=rad01.coova.org              # RADIUS Server
#HS_RADCONF_SERVER=192.168.1.144                 # RADIUS Server
#HS_RADCONF_SECRET=coova-anonymous               # RADIUS Shared Secret 
#HS_RADCONF_AUTHPORT=1812                        # Auth port
#HS_RADCONF_USER=chillispot                      # Username
#HS_RADCONF_PWD=chillispot                       # Password


###
#   Firewall issues
#
# Uncomment the following to add ports to the allowed local ports list
# The up.sh script will allow these local ports to be used, while the default
# is to block all unwanted traffic to the tun/tap. 
#
HS_TCP_PORTS="80 8000 53 22 1812 1813 67 443"

###
#   Standard configurations
#
HS_MODE=hotspot
HS_TYPE=chillispot
HS_RADACCT=1813
#HS_ADMUSR=chillispot
#HS_ADMPWD=chillispot


###
#   Post-Auth proxy settings
#
HS_LAN_ACCESS=allow
# HS_POSTAUTH_PROXY=<host or ip>
# HS_POSTAUTH_PROXYPORT=<port>
#HS_POSTAUTH_PROXY=10.1.0.1
#HS_POSTAUTH_PROXYPORT=80

#   Directory specifying where internal web pages can be served
#   by chilli with url /www/<file name>. Only extentions like .html
#   .jpg, .gif, .png, .js are allowed. See below for using .chi as a
#   CGI extension.
HS_WWWDIR=/etc/chilli/www

#   Using this option assumes 'haserl' is installed per-default
#   but, and CGI type program can ran from wwwsh to process requests
#   to chilli with url /www/filename.chi
HS_WWWBIN=/etc/chilli/wwwsh

#   Some configurations used in certain user interfaces
#
HS_PROVIDER=Coova
HS_PROVIDER_LINK=http://www.coova.org/


###
#   WISPr RADIUS Attribute support
#

#HS_LOC_NAME="My HotSpot"          # WISPr Location Name and used in portal

#   WISPr settings (to form a proper WISPr-Location-Id)
HS_LOC_NETWORK="My Network"        # Network name
HS_LOC_AC=408                      # Phone area code
HS_LOC_CC=61                       # Phone country code
HS_LOC_ISOCC=AU            # ISO Country code

# Embedded miniportal
# HS_REG_MODE="tos" # or self, other
# HS_RAD_PROTO="pap" # or mschapv2, chap
#HS_RAD_PROTO="mschapv2"
#HS_RAD_PROTO="chap"
HS_RAD_PROTO=pap
HS_PAP_OK=on
# HS_USE_MAP=on

HS_ACCTUPDATE=on
HS_COAPORT=3779
HS_CHALLENGETIMEOUT=40000
HS_CHALLENGETIMEOUT2=40000
HS_UAMUISSL=on
HS_REDIRSSL=on
HS_SSLKEYFILE=/etc/chilli/mycert.pem
HS_SSLCERTFILE=/etc/chilli/mycert.pem
HS_SESKEEPALIVE=on
HS_DHCPRADIUS=on
HS_WEB_ADMIN=both
HS_NATANYIP=on
HS_LAYER2=on
HS_SSID="NetComm 6648"
HS_NETWORK=10.1.0.0
HS_NETMASK=255.255.255.0
HS_UAMLISTEN=10.1.0.1
HS_DYNIP=10.1.0.1
HS_DYNIP_MASK=255.255.255.0
HS_RADPROXY_LISTEN=10.1.0.1
HS_RADPROXY_CLIENT=10.1.0.0/24
HS_NASIP=10.1.0.1
HS_UAMSERVER=10.1.0.1
HS_UAMFORMAT=http://$HS_UAMLISTEN:$HS_UAMUIPORT/www/
HS_UAMHOMEPAGE=http://$HS_UAMLISTEN:$HS_UAMUIPORT/www/
HS_UAMSERVICE=http://$HS_UAMLISTEN:$HS_UAMUIPORT/www/
HS_UAMDOMAINS=www.telegesis.com
HS_RADIUS=192.168.1.176
HS_RADIUS2=192.168.1.176
HS_RADAUTH=1813
HS_RADSECRET=testing123


From fdfmacedo at gmail.com  Wed Feb  5 09:41:57 2014
From: fdfmacedo at gmail.com (Fernando Macedo)
Date: Wed, 5 Feb 2014 07:41:57 -0200
Subject: [Chilli] chilli and satellite wan
In-Reply-To: <CAJc1nuo4tCmnVjxmtCaAotVViJue3HHnREa63ZniumKjdgOUww@mail.gmail.com>
References: <CAJc1nupt+hRy4dO3auk2b5gb+QK5G_-cqY5bNxi0ydt7n6Y3=A@mail.gmail.com>
 <CAEUOhU5h6HVnruAW2j4rOb1kGocWW0a9Dh69iXcrWq46ZZVJ=Q@mail.gmail.com>
 <CAJc1nuo4tCmnVjxmtCaAotVViJue3HHnREa63ZniumKjdgOUww@mail.gmail.com>
Message-ID: <CAEUOhU5taPnXGrMP40v3Reiyd_Mtk6u6hMEr_GUkq1GDDTHDVQ@mail.gmail.com>

Why not debugging? It will not use all your resources. I debugged in a
environment with 2K active users. Just run the first instance with gdb.
When crashing again run it normally. You can use monit to do all the
monitoring/starting/restarting process.

Fernando Macedo


2014-02-04 Jed Gainer <jedgainer at gmail.com>:

> I can't recreate it in a test environment it only seems to happen in one
> of my production setups and it needs to be back up and running ASAP no time
> for debugging.
>
>
> On Tue, Feb 4, 2014 at 1:46 AM, Fernando Macedo <fdfmacedo at gmail.com>wrote:
>
>> Run it with gdb debugger and post more crash informations.
>>
>> Fernando Macedo
>>
>>
>> 2014-02-04 Jed Gainer <jedgainer at gmail.com>
>>
>>>  I am using chilli to manage users on a very limited bandwidth and high
>>> latency network. Everything fine except chilli randomly stops handing out
>>> IPs and wont let users login. I suspect its crashing and want to cron a
>>> script to check on it every 5 minutes and restart it if its not working.
>>>
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140205/28d63946/attachment.html>

From eric at craftti.com.br  Wed Feb  5 10:59:23 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Wed, 5 Feb 2014 08:59:23 -0200
Subject: [Chilli] Transparent proxy on secondary host
Message-ID: <CAF+USJ7uKC_sxwBvy=w47-Zg_NmAXmzRWeNF1hUB8yqkV=qOyw@mail.gmail.com>

Hi Folks,

I was reading about coova's transparent proxy and I would like to setup an
environment where the proxy is set on second host, but some questions came
up.

I saw (by searching old threads and forum) that I could use the HS_PROXY
and HS_POSTPROXY to enable a transparent proxy for authorized clients only.
In this case I assume that the WLAN link is at the proxy server, in a
topology like this:

[APs]----[SWITCH]-----[CHILLI CONTROLLER]---[PROXY]---[WLAN]

Is this the correct idea? In this case what value should I use for HS_WLAN
in config, would it be the interface for the proxy?


Cheers,

Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140205/da5fa3ea/attachment.html>

From peter.wagner at unwired.at  Wed Feb  5 15:54:41 2014
From: peter.wagner at unwired.at (Peter Wagner)
Date: Wed, 5 Feb 2014 16:54:41 +0100
Subject: [Chilli] Coova-Chilli Redirection Problem
Message-ID: <52f25eed.810a0f0a.3775.ffff863c@mx.google.com>

Hi,

i successfully installed Coova-Chilli on Openwrt and it works fine.

Except in a special case:

1) A user opens a webpage like "orf.at" on a mobile device. The device is connected to some other 
wifi network.

2) The user disconnects from the wifi network and connects to my Coova-Chilli wifi network.

3) The user trys to reopen the site (orf.at in this case). And has no authenticated session.
   The expected behaviour would be to get redirected to the captive portal page.

4) Instead, no redirect is sent at all. (see tcpdump - packet #55)

5) User sees the message "Website not available"

6) The user requests the site heisse.de (!= orf.at in this case) (see tcpdump package #402)

7) The redirect is sent and the user is redirected to the captive partal page.

What could be the cause of this problem? I'm using the latest version of Coova-Chilli and use this cmdline options:

/usr/sbin/chilli  -c /etc/chilli.conf --fg --dhcpnotidle
--radiusoriginalurl --lease 300 --pidfile=/var/run/chilli.pid
--definteriminterval 60 --usestatusfile /tmp/chilli.status
--seskeepalive --proxyonacct --uamgardendata --uamotherdata
--locationimmediateupdate --nousergardendata --patricia
--proxylocattr=32 --redirssl --redirurl

With kind regards,
Peter Wagner
-------------- next part --------------
A non-text attachment was scrubbed...
Name: chilli.pcapng
Type: application/octet-stream
Size: 61712 bytes
Desc: not available
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140205/3160dd32/attachment-0001.obj>

From eric at craftti.com.br  Wed Feb  5 18:45:23 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Wed, 5 Feb 2014 16:45:23 -0200
Subject: [Chilli] conup for devices connected but not authorized
Message-ID: <CAF+USJ5i6oQ-H+nmXFYyxv5rNgxGtFpNARq7G6QUAbRnfS5=4w@mail.gmail.com>

Hi guys,

I was wondering if there is an event like the conup or condown scripts but
that is triggered when a device connects into coova. In other words I'd
like to account when a device is detected even if it was not yet
authenticated within coova. Is this possible?

Cheers,

Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140205/53814f8c/attachment.html>

From xoneca at gmail.com  Wed Feb  5 19:41:13 2014
From: xoneca at gmail.com (Xabier Oneca -- xOneca)
Date: Wed, 5 Feb 2014 20:41:13 +0100
Subject: [Chilli] Coova-Chilli Redirection Problem
In-Reply-To: <52f25eed.810a0f0a.3775.ffff863c@mx.google.com>
References: <52f25eed.810a0f0a.3775.ffff863c@mx.google.com>
Message-ID: <CACkgH71zNMntXLBenkvk7kfYXikv5A-vRsNQHoToYUzogo6_1A@mail.gmail.com>

Hello Peter,

2014-02-05 Peter Wagner <peter.wagner at unwired.at>:
> Hi,
>
> i successfully installed Coova-Chilli on Openwrt and it works fine.
>
> Except in a special case:
>
> 1) A user opens a webpage like "orf.at" on a mobile device. The device is connected to some other
> wifi network.
>
> 2) The user disconnects from the wifi network and connects to my Coova-Chilli wifi network.
>
> 3) The user trys to reopen the site (orf.at in this case). And has no authenticated session.
>    The expected behaviour would be to get redirected to the captive portal page.
>
> 4) Instead, no redirect is sent at all. (see tcpdump - packet #55)

I do see a response from CoovaChilli, but the client resets the connection.

I see the first conversation in frames 57-97 (see by yourself in the
menu "Analyze ? Follow TCP Stream" in Wireshark)

Then a retry in frames 84-136 and happens the same.

Finally in frames 123-173. And client also resets the connection.

> 5) User sees the message "Website not available"

Yes. It should redirect to the captive portal, but for some reason the
client is resetting the connection...

Maybe you could run tcpdump in a client?

> 6) The user requests the site heisse.de (!= orf.at in this case) (see tcpdump package #402)
>
> 7) The redirect is sent and the user is redirected to the captive partal page.

Yes. That's seen in frames 404-468 and captive portal loading in 473-609.

> What could be the cause of this problem? I'm using the latest version of Coova-Chilli and use this cmdline options:
>
> /usr/sbin/chilli  -c /etc/chilli.conf --fg --dhcpnotidle
> --radiusoriginalurl --lease 300 --pidfile=/var/run/chilli.pid
> --definteriminterval 60 --usestatusfile /tmp/chilli.status
> --seskeepalive --proxyonacct --uamgardendata --uamotherdata
> --locationimmediateupdate --nousergardendata --patricia
> --proxylocattr=32 --redirssl --redirurl
>
> With kind regards,
> Peter Wagner

Cheers,

Xabier Oneca_,,_

From xoneca at gmail.com  Wed Feb  5 19:54:09 2014
From: xoneca at gmail.com (Xabier Oneca -- xOneca)
Date: Wed, 5 Feb 2014 20:54:09 +0100
Subject: [Chilli] conup for devices connected but not authorized
In-Reply-To: <CAF+USJ5i6oQ-H+nmXFYyxv5rNgxGtFpNARq7G6QUAbRnfS5=4w@mail.gmail.com>
References: <CAF+USJ5i6oQ-H+nmXFYyxv5rNgxGtFpNARq7G6QUAbRnfS5=4w@mail.gmail.com>
Message-ID: <CACkgH72P8Z3FZi7HA3FnamH9HqvRb-Gfmj_1VUkz+3-Q4vWQLQ@mail.gmail.com>

2014-02-05 Eric Chaves <eric at craftti.com.br>:
> Hi guys,
>
> I was wondering if there is an event like the conup or condown scripts but
> that is triggered when a device connects into coova. In other words I'd like
> to account when a device is detected even if it was not yet authenticated
> within coova. Is this possible?
>
> Cheers,
>
> Eric
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
Hello Eric,

Since CoovaChilli v1.2.5 you have options ''--macup'' and
''--macdown'' to define scripts to run during DHCP up (assignment) and
down (release).

HTH

Xabier Oneca_,,_

From eric at craftti.com.br  Wed Feb  5 19:59:32 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Wed, 5 Feb 2014 17:59:32 -0200
Subject: [Chilli] conup for devices connected but not authorized
In-Reply-To: <CACkgH72P8Z3FZi7HA3FnamH9HqvRb-Gfmj_1VUkz+3-Q4vWQLQ@mail.gmail.com>
References: <CAF+USJ5i6oQ-H+nmXFYyxv5rNgxGtFpNARq7G6QUAbRnfS5=4w@mail.gmail.com>
 <CACkgH72P8Z3FZi7HA3FnamH9HqvRb-Gfmj_1VUkz+3-Q4vWQLQ@mail.gmail.com>
Message-ID: <CAF+USJ447PN13rTaMf6w=aWytkj7Ki2M3XDHNyaNKMtsQuX76Q@mail.gmail.com>

Nice!! thanks for the tip!

--
Eric Chaves
(11) 98139-9880


2014-02-05 Xabier Oneca -- xOneca <xoneca at gmail.com>:

> 2014-02-05 Eric Chaves <eric at craftti.com.br>:
> > Hi guys,
> >
> > I was wondering if there is an event like the conup or condown scripts
> but
> > that is triggered when a device connects into coova. In other words I'd
> like
> > to account when a device is detected even if it was not yet authenticated
> > within coova. Is this possible?
> >
> > Cheers,
> >
> > Eric
> >
> > _______________________________________________
> > Chilli mailing list
> > Chilli at coova.org
> > http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> >
> Hello Eric,
>
> Since CoovaChilli v1.2.5 you have options ''--macup'' and
> ''--macdown'' to define scripts to run during DHCP up (assignment) and
> down (release).
>
> HTH
>
> Xabier Oneca_,,_
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140205/caaf1895/attachment.html>

From peter.wagner at unwired.at  Thu Feb  6 11:11:16 2014
From: peter.wagner at unwired.at (Peter Wagner)
Date: Thu, 6 Feb 2014 12:11:16 +0100
Subject: [Chilli] Coova-Chilli Redirection Problem
In-Reply-To: <CACkgH71zNMntXLBenkvk7kfYXikv5A-vRsNQHoToYUzogo6_1A@mail.gmail.com>
References: <52f25eed.810a0f0a.3775.ffff863c@mx.google.com>
 <CACkgH71zNMntXLBenkvk7kfYXikv5A-vRsNQHoToYUzogo6_1A@mail.gmail.com>
Message-ID: <52f36e02.8955c20a.7972.3c3e@mx.google.com>

Hello Xabier,

I created a tcpdump on the client but it shows the same behaviour. The device get's the redirect for orf.at 2 times, 
resets both streams in the middle of the chilli redirect response and then accepts the heisse.de redirect without
a problem.

Cheers,
Peter Wagner


Xabier Oneca  --  xOneca <xoneca at gmail.com> wrote:

> Hello Peter,
> 
> 2014-02-05 Peter Wagner <peter.wagner at unwired.at>:
> > Hi,
> >
> > i successfully installed Coova-Chilli on Openwrt and it works fine.
> >
> > Except in a special case:
> >
> > 1) A user opens a webpage like "orf.at" on a mobile device. The device is connected to some other
> > wifi network.
> >
> > 2) The user disconnects from the wifi network and connects to my Coova-Chilli wifi network.
> >
> > 3) The user trys to reopen the site (orf.at in this case). And has no authenticated session.
> >    The expected behaviour would be to get redirected to the captive portal page.
> >
> > 4) Instead, no redirect is sent at all. (see tcpdump - packet #55)
> 
> I do see a response from CoovaChilli, but the client resets the connection.
> 
> I see the first conversation in frames 57-97 (see by yourself in the
> menu "Analyze ? Follow TCP Stream" in Wireshark)
> 
> Then a retry in frames 84-136 and happens the same.
> 
> Finally in frames 123-173. And client also resets the connection.
> 
> > 5) User sees the message "Website not available"
> 
> Yes. It should redirect to the captive portal, but for some reason the
> client is resetting the connection...
> 
> Maybe you could run tcpdump in a client?
> 
> > 6) The user requests the site heisse.de (!= orf.at in this case) (see tcpdump package #402)
> >
> > 7) The redirect is sent and the user is redirected to the captive partal page.
> 
> Yes. That's seen in frames 404-468 and captive portal loading in 473-609.
> 
> > What could be the cause of this problem? I'm using the latest version of Coova-Chilli and use this cmdline options:
> >
> > /usr/sbin/chilli  -c /etc/chilli.conf --fg --dhcpnotidle
> > --radiusoriginalurl --lease 300 --pidfile=/var/run/chilli.pid
> > --definteriminterval 60 --usestatusfile /tmp/chilli.status
> > --seskeepalive --proxyonacct --uamgardendata --uamotherdata
> > --locationimmediateupdate --nousergardendata --patricia
> > --proxylocattr=32 --redirssl --redirurl
> >
> > With kind regards,
> > Peter Wagner
> 
> Cheers,
> 
> Xabier Oneca_,,_
-------------- next part --------------
A non-text attachment was scrubbed...
Name: client.pcapng
Type: application/octet-stream
Size: 825948 bytes
Desc: not available
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140206/69ce7a13/attachment-0001.obj>

From alexander.szlezak at unwired.at  Thu Feb  6 15:41:20 2014
From: alexander.szlezak at unwired.at (Alexander Szlezak)
Date: Thu, 06 Feb 2014 16:41:20 +0100
Subject: [Chilli] Radius 256 Request per port limit
Message-ID: <52F3AD20.7090104@unwired.at>

Dear All,

We're running coovachilli in a centralized way, thus one daemon is 
handing the traffic of a large number of access points bridged on layer2 
with the interface coovachilli is running on.

Since the location of the user is relevant to uns (on which ap is a 
certain cpe located), the access points send a radius accounting packet 
with the location to chilli, extracts the location id and then proxies 
the request to our radius server.

Issue is, that we have a lot of access points, and radius requests and 
to us it seems there is a protocol limitation for 256 concurrent radius 
requests per port. Since coovachilli is proxying all requests on one 
port to the radius server, we hit that limit.

Question is, if there is a workaround, or if it is imaginable to have 
chilli connect to radius on multiple ports (as this is the descibed 
workaround in the radius documentation).

Would be glad to have your ideas on this.

Thanks,
Alexander

-- 
Follow us on Twitter @
http://twitter.com/unwirednetworks
_____________________________________________________
Mag. Alexander Szlezak          Unwired Networks GmbH
Gesch?ftsf?hrer

+43 660 1350410
alexander.szlezak at unwired.at           www.unwired.at
twitter.com/unwirednetworks

Rechnungsadresse                        B?roanschrift
Reischergasse 6/2                  Gonzagagasse 11/25
1130 Vienna, Austria         A-1010 Vienna, Austria


From dbird at google.com  Sat Feb  8 19:03:30 2014
From: dbird at google.com (David Bird)
Date: Sat, 8 Feb 2014 11:03:30 -0800
Subject: [Chilli] Radius 256 Request per port limit
In-Reply-To: <52F3AD20.7090104@unwired.at>
References: <52F3AD20.7090104@unwired.at>
Message-ID: <CADo9JyXFDCrMZ7teRN5_o1BEofnWuhLSct66_cxv8-tQUhV4hw@mail.gmail.com>

I think that would be the way to go -- binding to multiple local ports,
each having their own radius id counters.


On Thu, Feb 6, 2014 at 7:41 AM, Alexander Szlezak <
alexander.szlezak at unwired.at> wrote:

> Dear All,
>
> We're running coovachilli in a centralized way, thus one daemon is handing
> the traffic of a large number of access points bridged on layer2 with the
> interface coovachilli is running on.
>
> Since the location of the user is relevant to uns (on which ap is a
> certain cpe located), the access points send a radius accounting packet
> with the location to chilli, extracts the location id and then proxies the
> request to our radius server.
>
> Issue is, that we have a lot of access points, and radius requests and to
> us it seems there is a protocol limitation for 256 concurrent radius
> requests per port. Since coovachilli is proxying all requests on one port
> to the radius server, we hit that limit.
>
> Question is, if there is a workaround, or if it is imaginable to have
> chilli connect to radius on multiple ports (as this is the descibed
> workaround in the radius documentation).
>
> Would be glad to have your ideas on this.
>
> Thanks,
> Alexander
>
> --
> Follow us on Twitter @
> http://twitter.com/unwirednetworks
> _____________________________________________________
> Mag. Alexander Szlezak          Unwired Networks GmbH
> Gesch?ftsf?hrer
>
> +43 660 1350410
> alexander.szlezak at unwired.at           www.unwired.at
> twitter.com/unwirednetworks
>
> Rechnungsadresse                        B?roanschrift
> Reischergasse 6/2                  Gonzagagasse 11/25
> 1130 Vienna, Austria         A-1010 Vienna, Austria
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140208/4624ea2a/attachment.html>

From alexander.szlezak at unwired.at  Sat Feb  8 19:42:08 2014
From: alexander.szlezak at unwired.at (Szlezak, Alexander)
Date: Sat, 8 Feb 2014 20:42:08 +0100
Subject: [Chilli] Radius 256 Request per port limit
In-Reply-To: <CADo9JyXFDCrMZ7teRN5_o1BEofnWuhLSct66_cxv8-tQUhV4hw@mail.gmail.com>
References: <52F3AD20.7090104@unwired.at>
 <CADo9JyXFDCrMZ7teRN5_o1BEofnWuhLSct66_cxv8-tQUhV4hw@mail.gmail.com>
Message-ID: <CA+jq8kqZ4bj=SZoo+7pQx0t14ET-ujzFuWfh88G8PTb7+1YZ0w@mail.gmail.com>

Hi David,

Ok great, something you can help us with ot shall we submit a patch?

Best Alex
Am 08.02.2014 20:03 schrieb "David Bird" <dbird at google.com>:

> I think that would be the way to go -- binding to multiple local ports,
> each having their own radius id counters.
>
>
> On Thu, Feb 6, 2014 at 7:41 AM, Alexander Szlezak <
> alexander.szlezak at unwired.at> wrote:
>
>> Dear All,
>>
>> We're running coovachilli in a centralized way, thus one daemon is
>> handing the traffic of a large number of access points bridged on layer2
>> with the interface coovachilli is running on.
>>
>> Since the location of the user is relevant to uns (on which ap is a
>> certain cpe located), the access points send a radius accounting packet
>> with the location to chilli, extracts the location id and then proxies the
>> request to our radius server.
>>
>> Issue is, that we have a lot of access points, and radius requests and to
>> us it seems there is a protocol limitation for 256 concurrent radius
>> requests per port. Since coovachilli is proxying all requests on one port
>> to the radius server, we hit that limit.
>>
>> Question is, if there is a workaround, or if it is imaginable to have
>> chilli connect to radius on multiple ports (as this is the descibed
>> workaround in the radius documentation).
>>
>> Would be glad to have your ideas on this.
>>
>> Thanks,
>> Alexander
>>
>> --
>> Follow us on Twitter @
>> http://twitter.com/unwirednetworks
>> _____________________________________________________
>> Mag. Alexander Szlezak          Unwired Networks GmbH
>> Gesch?ftsf?hrer
>>
>> +43 660 1350410
>> alexander.szlezak at unwired.at           www.unwired.at
>> twitter.com/unwirednetworks
>>
>> Rechnungsadresse                        B?roanschrift
>> Reischergasse 6/2                  Gonzagagasse 11/25
>> 1130 Vienna, Austria         A-1010 Vienna, Austria
>>
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140208/bd400a68/attachment.html>

From eric at craftti.com.br  Sun Feb  9 13:17:17 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Sun, 9 Feb 2014 11:17:17 -0200
Subject: [Chilli] What exactly is the any-ip feature?
Message-ID: <CAF+USJ52--0g0r3rXPj9ZfPStRDXk5zUgSYex=dtFL-ThSMs0g@mail.gmail.com>

Hi Folks,

Could someone explain to me what exactly is the any_ip feature?

I'm seeing some messages in my log saying "No more static addresses
available" and it seems related to the any_ip feature but I can't found an
explanation about what it does.

I know that the ip range I'm working was not exhausted yet so I can't
figure what this log message means.

Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140209/a4d36ea3/attachment.html>

From xoneca at gmail.com  Sun Feb  9 14:37:52 2014
From: xoneca at gmail.com (Xabier Oneca -- xOneca)
Date: Sun, 9 Feb 2014 15:37:52 +0100
Subject: [Chilli] What exactly is the any-ip feature?
In-Reply-To: <CAF+USJ52--0g0r3rXPj9ZfPStRDXk5zUgSYex=dtFL-ThSMs0g@mail.gmail.com>
References: <CAF+USJ52--0g0r3rXPj9ZfPStRDXk5zUgSYex=dtFL-ThSMs0g@mail.gmail.com>
Message-ID: <CACkgH70sFPOTsDs69z5WC+Ho_kheOYOooy3hosgHyQTXknCQvg@mail.gmail.com>

Hello Eric,

2014-02-09 14:17 GMT+01:00 Eric Chaves <eric at craftti.com.br>:
>
> Could someone explain to me what exactly is the any_ip feature?

>From the documentation:

> uamanyip:
>  Allow clients to use any IP settings they wish by spoofing ARP (experimental).

I.e. the client can choose to use any IP he wants (in the correct
subnet), and CoovaChilli will allocate and use it.

Cheers,

Xabier Oneca_,,_

From eric at craftti.com.br  Sun Feb  9 15:06:06 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Sun, 9 Feb 2014 13:06:06 -0200
Subject: [Chilli] What exactly is the any-ip feature?
In-Reply-To: <CACkgH70sFPOTsDs69z5WC+Ho_kheOYOooy3hosgHyQTXknCQvg@mail.gmail.com>
References: <CAF+USJ52--0g0r3rXPj9ZfPStRDXk5zUgSYex=dtFL-ThSMs0g@mail.gmail.com>
 <CACkgH70sFPOTsDs69z5WC+Ho_kheOYOooy3hosgHyQTXknCQvg@mail.gmail.com>
Message-ID: <CAF+USJ45SiCm5G7mjysFb=OP2PK6Eg6GdnxgpHO6kUPQGk6OPw@mail.gmail.com>

Thanks!


--
Eric Chaves
(11) 98139-9880


2014-02-09 12:37 GMT-02:00 Xabier Oneca -- xOneca <xoneca at gmail.com>:

> Hello Eric,
>
> 2014-02-09 14:17 GMT+01:00 Eric Chaves <eric at craftti.com.br>:
> >
> > Could someone explain to me what exactly is the any_ip feature?
>
> From the documentation:
>
> > uamanyip:
> >  Allow clients to use any IP settings they wish by spoofing ARP
> (experimental).
>
> I.e. the client can choose to use any IP he wants (in the correct
> subnet), and CoovaChilli will allocate and use it.
>
> Cheers,
>
> Xabier Oneca_,,_
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140209/09c4c2b9/attachment.html>

From sourav.chakraborty at netcommwireless.com  Mon Feb 10 07:14:31 2014
From: sourav.chakraborty at netcommwireless.com (Sourav)
Date: Mon, 10 Feb 2014 18:14:31 +1100
Subject: [Chilli] Implementing "Enable/Disable Local LAN" / "Enable/Disable
 Hotspot Clients"
Message-ID: <52F87C57.4080101@netcommwireless.com>

Hi,
Our router has the following interfaces and runs coovachilli on it--
wwan0 inet addr:123.209.15.48 (3G connection to internet)
tun0 inet addr:10.1.0.1(hotspot clients gw created by coovachilli)
br0 inet addr:192.168.1.1(local lan gw)
ra0 wireless interface through which the hotspot clients connect

/etc/chilli/config has --
HS_WANIF=wwan0 # WAN Interface toward the Internet
HS_LANIF=ra0 # Subscriber Interface for client devices

Basically we want to implement the following features --
Enable/Disable Local LAN ? Wifi hotspot clients(may be 10.1.0.x) 
can/cannot access devices on local lan(192.168.1.x) and vice versa.
Enable/Disable Hotspot Clients ? Hotspot Clients isolation(one hotspot 
client can/can't talk to another).
Enable/Disable Router Mgmt Interface ? Hotspot Clients can/cannot reach 
web interface of the router.

The following rule in the FORWARD chain ,added by coovachilli should 
enable all pkts from 10.1.0.x to 192.168.1.x and vice versa --
ACCEPT all -- anywhere anywhere

But it seems coovachilli is dropping the pkts from 192.168.1.x to 
10.1.0.x and vice versa inspite of the rule in place. Please suggest how 
I can achieve the 3 functionalities asap. I am pressed for time here. 
Thanks in advance.

-- 
Warm Regards,
Sourav


______________________________________________________________________
This communication contains information which may be confidential or privileged. The information is intended solely for the use of the individual or entity named above.  If you are not the intended recipient, be aware that any disclosure, copying, distribution or use of the contents of this information is prohibited.  If you have received this communication in error, please notify me by telephone immediately.
______________________________________________________________________

From eric at craftti.com.br  Mon Feb 10 15:19:49 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Mon, 10 Feb 2014 13:19:49 -0200
Subject: [Chilli] Assign IP address to AP through radius
Message-ID: <CAF+USJ4W3RO91VT-Ep=J-AFLuvMeOKZ+4meP6oQnwTNY0eT7Tw@mail.gmail.com>

Hi Folks,

The Access Points used in my hotspot environment are configured to obtain
it's IP address from DHCP and I would like to have coova assigning some
pre-defined values for it.

I though I could do this by having the AP authenticating itself via mac
address and with my radius server, so after reading the man pages and some
posts on the forum I configured my environment the following way:

At chilli controller, I have the following parameters in
/etc/chilli/local.conf

defsessiontimeout=3600
defidletimeout=600
definteriminterval=600
moreif=eth3
dhcpstart=500
macallowed=XX-XX-XX-XX-XX-XX,ZZ-ZZ-ZZ-ZZ-ZZ-ZZ
macpasswd=secret-password

And in my radius server I added two users named 'XX-XX-XX-XX-XX-XX' and
'ZZ-ZZ-ZZ-ZZ-ZZ' and I add a Framed-IP-Address and Framed-IP-Netmask values
in radius responses for, whose value dos not overlap with the dhcpstart
parameter.

I've tested my setup using radtest and confirmed that the authentication is
working and response contains those AVP mentioned however the AP is getting
a regular address from DHCP (above dhcpstart) instead of the ones sent in
the radius reply.

Did I misunderstood the macallowed feature? What should I do to have it
working as desired?

Once again thanks for all the help so far.

Cheers,

Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140210/84744c1e/attachment.html>

From eric at craftti.com.br  Mon Feb 10 18:20:52 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Mon, 10 Feb 2014 16:20:52 -0200
Subject: [Chilli] Assign IP address to AP through radius
In-Reply-To: <CAGPhq8LPcbjZ0k_4Q=5EiXMjmA0KX-mQuL9H7t98uL+ybJnspQ@mail.gmail.com>
References: <CAF+USJ4W3RO91VT-Ep=J-AFLuvMeOKZ+4meP6oQnwTNY0eT7Tw@mail.gmail.com>
 <CAGPhq8LPcbjZ0k_4Q=5EiXMjmA0KX-mQuL9H7t98uL+ybJnspQ@mail.gmail.com>
Message-ID: <CAF+USJ5UP3Q56oCUnpLBbuFehJoV6rMpyEvXzvCcxwfGcxiKXg@mail.gmail.com>

Hi Patil,

Thanks! I'll test this tomorrow and let you know the results. Just so I can
understand, how would this impact other devices not listed in my macallowed?

Cheers,

--
Eric Chaves
(11) 98139-9880


2014-02-10 16:15 GMT-02:00 Ravikant Patil <ravikant.4784 at gmail.com>:

> Hi Eric,
>
> I haven't tried it yet but adding following options to config file
> probably will work.
>
>    - macauth                 Authenticate based on MAC address
>    (default=off)
>
>
>    - strictmacauth           Be strict about MAC Auth (no DHCP reply
>    until we get RADIUS reply)  (default=off)
>
>
> Thanks and Regards,
> Ravikant
>
>
> On Mon, Feb 10, 2014 at 8:49 PM, Eric Chaves <eric at craftti.com.br> wrote:
>
>> Hi Folks,
>>
>> The Access Points used in my hotspot environment are configured to obtain
>> it's IP address from DHCP and I would like to have coova assigning some
>> pre-defined values for it.
>>
>> I though I could do this by having the AP authenticating itself via mac
>> address and with my radius server, so after reading the man pages and some
>> posts on the forum I configured my environment the following way:
>>
>> At chilli controller, I have the following parameters in
>> /etc/chilli/local.conf
>>
>> defsessiontimeout=3600
>> defidletimeout=600
>> definteriminterval=600
>>  moreif=eth3
>> dhcpstart=500
>> macallowed=XX-XX-XX-XX-XX-XX,ZZ-ZZ-ZZ-ZZ-ZZ-ZZ
>> macpasswd=secret-password
>>
>> And in my radius server I added two users named 'XX-XX-XX-XX-XX-XX' and
>> 'ZZ-ZZ-ZZ-ZZ-ZZ' and I add a Framed-IP-Address and Framed-IP-Netmask values
>> in radius responses for, whose value dos not overlap with the dhcpstart
>> parameter.
>>
>> I've tested my setup using radtest and confirmed that the authentication
>> is working and response contains those AVP mentioned however the AP is
>> getting a regular address from DHCP (above dhcpstart) instead of the ones
>> sent in the radius reply.
>>
>> Did I misunderstood the macallowed feature? What should I do to have it
>> working as desired?
>>
>> Once again thanks for all the help so far.
>>
>> Cheers,
>>
>> Eric
>>
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140210/2db26ce1/attachment.html>

From ravikant.4784 at gmail.com  Mon Feb 10 18:15:25 2014
From: ravikant.4784 at gmail.com (Ravikant Patil)
Date: Mon, 10 Feb 2014 23:45:25 +0530
Subject: [Chilli] Assign IP address to AP through radius
In-Reply-To: <CAF+USJ4W3RO91VT-Ep=J-AFLuvMeOKZ+4meP6oQnwTNY0eT7Tw@mail.gmail.com>
References: <CAF+USJ4W3RO91VT-Ep=J-AFLuvMeOKZ+4meP6oQnwTNY0eT7Tw@mail.gmail.com>
Message-ID: <CAGPhq8LPcbjZ0k_4Q=5EiXMjmA0KX-mQuL9H7t98uL+ybJnspQ@mail.gmail.com>

Hi Eric,

I haven't tried it yet but adding following options to config file probably
will work.

   - macauth                 Authenticate based on MAC address (default=off)


   - strictmacauth           Be strict about MAC Auth (no DHCP reply until
   we get RADIUS reply)  (default=off)


Thanks and Regards,
Ravikant


On Mon, Feb 10, 2014 at 8:49 PM, Eric Chaves <eric at craftti.com.br> wrote:

> Hi Folks,
>
> The Access Points used in my hotspot environment are configured to obtain
> it's IP address from DHCP and I would like to have coova assigning some
> pre-defined values for it.
>
> I though I could do this by having the AP authenticating itself via mac
> address and with my radius server, so after reading the man pages and some
> posts on the forum I configured my environment the following way:
>
> At chilli controller, I have the following parameters in
> /etc/chilli/local.conf
>
> defsessiontimeout=3600
> defidletimeout=600
> definteriminterval=600
> moreif=eth3
> dhcpstart=500
> macallowed=XX-XX-XX-XX-XX-XX,ZZ-ZZ-ZZ-ZZ-ZZ-ZZ
> macpasswd=secret-password
>
> And in my radius server I added two users named 'XX-XX-XX-XX-XX-XX' and
> 'ZZ-ZZ-ZZ-ZZ-ZZ' and I add a Framed-IP-Address and Framed-IP-Netmask values
> in radius responses for, whose value dos not overlap with the dhcpstart
> parameter.
>
> I've tested my setup using radtest and confirmed that the authentication
> is working and response contains those AVP mentioned however the AP is
> getting a regular address from DHCP (above dhcpstart) instead of the ones
> sent in the radius reply.
>
> Did I misunderstood the macallowed feature? What should I do to have it
> working as desired?
>
> Once again thanks for all the help so far.
>
> Cheers,
>
> Eric
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140210/1e275942/attachment.html>

From ravikant.4784 at gmail.com  Mon Feb 10 19:05:55 2014
From: ravikant.4784 at gmail.com (Ravikant Patil)
Date: Tue, 11 Feb 2014 00:35:55 +0530
Subject: [Chilli] Assign IP address to AP through radius
In-Reply-To: <CAF+USJ5UP3Q56oCUnpLBbuFehJoV6rMpyEvXzvCcxwfGcxiKXg@mail.gmail.com>
References: <CAF+USJ4W3RO91VT-Ep=J-AFLuvMeOKZ+4meP6oQnwTNY0eT7Tw@mail.gmail.com>
 <CAGPhq8LPcbjZ0k_4Q=5EiXMjmA0KX-mQuL9H7t98uL+ybJnspQ@mail.gmail.com>
 <CAF+USJ5UP3Q56oCUnpLBbuFehJoV6rMpyEvXzvCcxwfGcxiKXg@mail.gmail.com>
Message-ID: <CAGPhq8+TniJi=BmxsKzUkg7GPUqc1XR88Y48z+CgOfzQLjfhZw@mail.gmail.com>

?Hi Eric?
??


   - for e
   ?very?
   dhcp request, this will
   ? ?
   generate a radius request BEFORE allocating IP address
   - radius
   ? ?
   request will contain mac id as user name and macpasswd as password
   - if
   ??
   ?radius-accept, client is logged in and do not have to go through portal
   based login.
   - If
   ???radius-reject, client have to go through portal login.
   - In both cases IP address is assigned after radius response
   ? is received.?
   - macallowed list should not be needed in this setup
   ?.?
   (IMO this option is ignored by coova
   ? ?
   chilli when macauth is present)

Thanks and Regards,
Ravikant
??



On Mon, Feb 10, 2014 at 11:50 PM, Eric Chaves <eric at craftti.com.br> wrote:

> Hi Patil,
>
> Thanks! I'll test this tomorrow and let you know the results. Just so I
> can understand, how would this impact other devices not listed in my
> macallowed?
>
> Cheers,
>
> --
> Eric Chaves
> (11) 98139-9880
>
>
> 2014-02-10 16:15 GMT-02:00 Ravikant Patil <ravikant.4784 at gmail.com>:
>
> Hi Eric,
>>
>> I haven't tried it yet but adding following options to config file
>> probably will work.
>>
>>    - macauth                 Authenticate based on MAC address
>>    (default=off)
>>
>>
>>    - strictmacauth           Be strict about MAC Auth (no DHCP reply
>>    until we get RADIUS reply)  (default=off)
>>
>>
>> Thanks and Regards,
>> Ravikant
>>
>>
>> On Mon, Feb 10, 2014 at 8:49 PM, Eric Chaves <eric at craftti.com.br> wrote:
>>
>>> Hi Folks,
>>>
>>> The Access Points used in my hotspot environment are configured to
>>> obtain it's IP address from DHCP and I would like to have coova assigning
>>> some pre-defined values for it.
>>>
>>> I though I could do this by having the AP authenticating itself via mac
>>> address and with my radius server, so after reading the man pages and some
>>> posts on the forum I configured my environment the following way:
>>>
>>> At chilli controller, I have the following parameters in
>>> /etc/chilli/local.conf
>>>
>>> defsessiontimeout=3600
>>> defidletimeout=600
>>> definteriminterval=600
>>>  moreif=eth3
>>> dhcpstart=500
>>> macallowed=XX-XX-XX-XX-XX-XX,ZZ-ZZ-ZZ-ZZ-ZZ-ZZ
>>> macpasswd=secret-password
>>>
>>> And in my radius server I added two users named 'XX-XX-XX-XX-XX-XX' and
>>> 'ZZ-ZZ-ZZ-ZZ-ZZ' and I add a Framed-IP-Address and Framed-IP-Netmask values
>>> in radius responses for, whose value dos not overlap with the dhcpstart
>>> parameter.
>>>
>>> I've tested my setup using radtest and confirmed that the authentication
>>> is working and response contains those AVP mentioned however the AP is
>>> getting a regular address from DHCP (above dhcpstart) instead of the ones
>>> sent in the radius reply.
>>>
>>> Did I misunderstood the macallowed feature? What should I do to have it
>>> working as desired?
>>>
>>> Once again thanks for all the help so far.
>>>
>>> Cheers,
>>>
>>> Eric
>>>
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140211/d76c7469/attachment-0001.html>

From radius.sir at gmail.com  Tue Feb 11 10:58:40 2014
From: radius.sir at gmail.com (Russell Mike)
Date: Tue, 11 Feb 2014 10:58:40 +0000
Subject: [Chilli] CoovaChilli FreeRADIUS setup with UAM
Message-ID: <CADao4ConvAVeopz83-yWbvEaA=dp95Bk87dZrWEHyndfiL7OOw@mail.gmail.com>

Dear List Greetings

*Setup Example: *
i have CoovaChilli / FreeRADIUS setup with UAM (Universal Access Manager)
server. Basically means it is different web server than NAS it self (NAS =
CoovaChilli). UAM serve the login page for hotspot users. Saying other way,
separate web server for content management system (serving login page base
on geographical location, distance, vlan numbers etc. etc..)

When any of following condition becomes true

1.) User has fill the wrong password
2.) User calling outside of time slot
3.) User already downloaded the quota specified

FreeRADIUS reject the access, which is obvious. Fine !!!!

*Question: *
how can i configure FreeRADIUS to send the reply messages (Your
username/password is wrong) to UAM server rather than NAS ? i am very sure
there would be a way to do it and i am not coming across using google
search over a week.

Thanks / Regards
RM --
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140211/e2a554af/attachment.html>

From radius.sir at gmail.com  Wed Feb 12 09:41:23 2014
From: radius.sir at gmail.com (Russell Mike)
Date: Wed, 12 Feb 2014 09:41:23 +0000
Subject: [Chilli] CoovaChilli FreeRADIUS setup with UAM
In-Reply-To: <CADao4ConvAVeopz83-yWbvEaA=dp95Bk87dZrWEHyndfiL7OOw@mail.gmail.com>
References: <CADao4ConvAVeopz83-yWbvEaA=dp95Bk87dZrWEHyndfiL7OOw@mail.gmail.com>
Message-ID: <CADao4CqHrjo4F3qCsTAJzPerd2Kd69xYE-X1rhz3et4H5ruTNA@mail.gmail.com>

Hi Chilli List Greetings

Thanks for all kind of assistance in past from community. i learnt that is
is not RADIUS, rather NAS should forward the message to UAM.

How can i configure NAS (CC) to pass on messages to UAM ?

Thanks / Regards


On Tue, Feb 11, 2014 at 10:58 AM, Russell Mike <radius.sir at gmail.com> wrote:

> Dear List Greetings
>
> *Setup Example: *
> i have CoovaChilli / FreeRADIUS setup with UAM (Universal Access Manager)
> server. Basically means it is different web server than NAS it self (NAS =
> CoovaChilli). UAM serve the login page for hotspot users. Saying other way,
> separate web server for content management system (serving login page base
> on geographical location, distance, vlan numbers etc. etc..)
>
> When any of following condition becomes true
>
> 1.) User has fill the wrong password
> 2.) User calling outside of time slot
> 3.) User already downloaded the quota specified
>
> FreeRADIUS reject the access, which is obvious. Fine !!!!
>
> *Question: *
> how can i configure FreeRADIUS to send the reply messages (Your
> username/password is wrong) to UAM server rather than NAS ? i am very sure
> there would be a way to do it and i am not coming across using google
> search over a week.
>
> Thanks / Regards
> RM --
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140212/2264e93c/attachment.html>

From eric at craftti.com.br  Wed Feb 12 17:16:15 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Wed, 12 Feb 2014 15:16:15 -0200
Subject: [Chilli] cannot access AP behind coova
Message-ID: <CAF+USJ7k42bf_qUmYbN9FyXq3_qU+Q3gC79yRh--vA=oWx8aAQ@mail.gmail.com>

Hi Folks,

>From my how chilli controller host I would like to remotely access the AP
behind it. All AP's are getting an IP address from coova on subscriber
network and I can ping them without problem.

When I try to access any AP from the controlle, be it using telnet, ssh or
http, the connection is not established.

Since I can ping the AP (meaning routes are ok) can I assume that chilli is
the one dropping those packet and preventing me to access the AP? If so
what should I do to be able to access the AP?

Thanks again for the help and patience,

Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140212/521c2849/attachment.html>

From phyo.w.soe at frontiir.net  Thu Feb 13 05:36:51 2014
From: phyo.w.soe at frontiir.net (Phyo Wai Soe)
Date: Thu, 13 Feb 2014 05:36:51 +0000 (UTC)
Subject: [Chilli] Multiple DHCP gateways in Coova
In-Reply-To: <1915631804.334886.1392269347961.JavaMail.root@frontiir.net>
Message-ID: <873680328.335068.1392269811782.JavaMail.root@frontiir.net>

Hi All,

I know we can specify an external DHCP server to be used by Coova with the dhcpgateway option. However, we would like to use more than 1 external DHCP servers for HA such that if DHCP_server_1 fails, Coova will get addresses from DHCP_server_2 and so on. If both DHCP servers are up, Coova will send requests to both of the servers and accept only one of the replies. The 2 DHCP servers may or may not be in the same subnet.

Does Coova support this out of the box or is some code tweaking necessary?

Thanks.

Regards,
Phyo Wai Soe


From maxxer at ufficyo.com  Thu Feb 13 08:40:37 2014
From: maxxer at ufficyo.com (Lorenzo Milesi)
Date: Thu, 13 Feb 2014 09:40:37 +0100 (CET)
Subject: [Chilli] Disconnect on ChilliSpot-Max-All-Octets
In-Reply-To: <798457263.21716.1392280513388.JavaMail.zimbra@yetopen.it>
Message-ID: <1821897025.21735.1392280837689.JavaMail.zimbra@yetopen.it>

Hi.
I've configured my FreeRadius server to have Octet counters. In my sql/mysql/counters.conf I added:
+sqlcounter counterChilliSpotMaxTotalOctets {
+            counter-name = ChilliSpot-Max-All-Octets
+            check-name = ChilliSpot-Max-All-Octets
+            reply-name = ChilliSpot-Max-All-Octets
+            sqlmod-inst = sql
+            key = User-Name
+            reset = never
+            query = "SELECT SUM(acctinputoctets) + SUM(acctoutputoctets) FROM radacct WHERE username='%{%k}'"
+}

and in radiusd.conf counters stanza: 
counterChilliSpotMaxTotalOctets

Added in dictionary:
ATTRIBUTE       ChilliSpot-Max-Daily-Octets               103      integer
ATTRIBUTE       ChilliSpot-Max-Monthly-Octets             104      integer
ATTRIBUTE       ChilliSpot-Max-Weekly-Octets              105      integer
ATTRIBUTE       ChilliSpot-Max-All-Octets                 106      integer


The counter is calculated correctly, but the user doesn't get disconnected if he reaches his limit. I.e. if the user has 10 octets left and starts a 4G file download it never gets interrupted.

The radius reply looks like this:
Sending Access-Accept of id 95 to 10.22.22.159 port 47286
        Idle-Timeout := 30
        Acct-Interim-Interval := 30
        ChilliSpot-Max-All-Octets = 10


Does Coova support those properties? Is this expected or should it disconnect? I'm using 1.3.0.

Thanks
-- 
Lorenzo Milesi - lorenzo.milesi at yetopen.it

YetOpen S.r.l. - http://www.yetopen.it/

From xoneca at gmail.com  Thu Feb 13 12:59:59 2014
From: xoneca at gmail.com (Xabier Oneca -- xOneca)
Date: Thu, 13 Feb 2014 13:59:59 +0100
Subject: [Chilli] cannot access AP behind coova
In-Reply-To: <CAF+USJ7k42bf_qUmYbN9FyXq3_qU+Q3gC79yRh--vA=oWx8aAQ@mail.gmail.com>
References: <CAF+USJ7k42bf_qUmYbN9FyXq3_qU+Q3gC79yRh--vA=oWx8aAQ@mail.gmail.com>
Message-ID: <CACkgH71TYV5WGDBYSZvqGnWEZ0Pk0NzX94RQQPZEg9SDWNh18Q@mail.gmail.com>

Hello Eric,

Are the APs authenticated in chilli? If they aren't, CoovaChilli will
block the traffic from that IP to the wanif.

You can use MAC authentication with RADIUS to authenticate them.

HTH,

Xabier Oneca_,,_

2014-02-12 18:16 GMT+01:00 Eric Chaves <eric at craftti.com.br>:
> Hi Folks,
>
> From my how chilli controller host I would like to remotely access the AP
> behind it. All AP's are getting an IP address from coova on subscriber
> network and I can ping them without problem.
>
> When I try to access any AP from the controlle, be it using telnet, ssh or
> http, the connection is not established.
>
> Since I can ping the AP (meaning routes are ok) can I assume that chilli is
> the one dropping those packet and preventing me to access the AP? If so what
> should I do to be able to access the AP?
>
> Thanks again for the help and patience,
>
> Eric

From xoneca at gmail.com  Thu Feb 13 13:09:49 2014
From: xoneca at gmail.com (Xabier Oneca -- xOneca)
Date: Thu, 13 Feb 2014 14:09:49 +0100
Subject: [Chilli] CoovaChilli FreeRADIUS setup with UAM
In-Reply-To: <CADao4CqHrjo4F3qCsTAJzPerd2Kd69xYE-X1rhz3et4H5ruTNA@mail.gmail.com>
References: <CADao4ConvAVeopz83-yWbvEaA=dp95Bk87dZrWEHyndfiL7OOw@mail.gmail.com>
 <CADao4CqHrjo4F3qCsTAJzPerd2Kd69xYE-X1rhz3et4H5ruTNA@mail.gmail.com>
Message-ID: <CACkgH7324J07RYyiJdLwOWCD+0BUCyLgio_DhceBjySuzus-NA@mail.gmail.com>

Hello Mike,


2014-02-12 10:41 GMT+01:00 Russell Mike <radius.sir at gmail.com>:
> Hi Chilli List Greetings
>
> Thanks for all kind of assistance in past from community. i learnt that is
> is not RADIUS, rather NAS should forward the message to UAM.

Yes, you are correct. It's CoovaChilli who "sends" that data to the
UAM through user redirection.

> How can i configure NAS (CC) to pass on messages to UAM ?

It should already be passing that information to the UAM. Check the
'res' and 'reason' URL parameters.

>From `redir_reply()` function: statuses of the redirection (res=):

 * already (Already logged in)
 * failed (This can also set the parameter reason=)
 * reject (Login rejected by RADIUS)
 * timeout
 * mtu
 * other
 * success
 * logoff

Cheers,

Xabier Oneca_,,_

> Thanks / Regards
>
>
> On Tue, Feb 11, 2014 at 10:58 AM, Russell Mike <radius.sir at gmail.com> wrote:
>>
>> Dear List Greetings
>>
>> Setup Example:
>> i have CoovaChilli / FreeRADIUS setup with UAM (Universal Access Manager)
>> server. Basically means it is different web server than NAS it self (NAS =
>> CoovaChilli). UAM serve the login page for hotspot users. Saying other way,
>> separate web server for content management system (serving login page base
>> on geographical location, distance, vlan numbers etc. etc..)
>>
>> When any of following condition becomes true
>>
>> 1.) User has fill the wrong password
>> 2.) User calling outside of time slot
>> 3.) User already downloaded the quota specified
>>
>> FreeRADIUS reject the access, which is obvious. Fine !!!!
>>
>> Question:
>> how can i configure FreeRADIUS to send the reply messages (Your
>> username/password is wrong) to UAM server rather than NAS ? i am very sure
>> there would be a way to do it and i am not coming across using google search
>> over a week.
>>
>> Thanks / Regards
>> RM --

From xoneca at gmail.com  Thu Feb 13 13:17:48 2014
From: xoneca at gmail.com (Xabier Oneca -- xOneca)
Date: Thu, 13 Feb 2014 14:17:48 +0100
Subject: [Chilli] Disconnect on ChilliSpot-Max-All-Octets
In-Reply-To: <1821897025.21735.1392280837689.JavaMail.zimbra@yetopen.it>
References: <798457263.21716.1392280513388.JavaMail.zimbra@yetopen.it>
 <1821897025.21735.1392280837689.JavaMail.zimbra@yetopen.it>
Message-ID: <CACkgH73fuUz5AhNJnAwuPHoLv+_JP9+KEDh3vwp91N=MuAam6g@mail.gmail.com>

Hello Lorenzo,

I think it is a RADIUS problem, since he is who must authenticate the
user. Have you set `ChilliSpot-Max-All-Octets` condition in `radcheck`
for the user you want to limit?

Cheers,

Xabier Oneca_,,_

2014-02-13 9:40 GMT+01:00 Lorenzo Milesi <maxxer at ufficyo.com>:
> Hi.
> I've configured my FreeRadius server to have Octet counters. In my sql/mysql/counters.conf I added:
> +sqlcounter counterChilliSpotMaxTotalOctets {
> +            counter-name = ChilliSpot-Max-All-Octets
> +            check-name = ChilliSpot-Max-All-Octets
> +            reply-name = ChilliSpot-Max-All-Octets
> +            sqlmod-inst = sql
> +            key = User-Name
> +            reset = never
> +            query = "SELECT SUM(acctinputoctets) + SUM(acctoutputoctets) FROM radacct WHERE username='%{%k}'"
> +}
>
> and in radiusd.conf counters stanza:
> counterChilliSpotMaxTotalOctets
>
> Added in dictionary:
> ATTRIBUTE       ChilliSpot-Max-Daily-Octets               103      integer
> ATTRIBUTE       ChilliSpot-Max-Monthly-Octets             104      integer
> ATTRIBUTE       ChilliSpot-Max-Weekly-Octets              105      integer
> ATTRIBUTE       ChilliSpot-Max-All-Octets                 106      integer
>
>
> The counter is calculated correctly, but the user doesn't get disconnected if he reaches his limit. I.e. if the user has 10 octets left and starts a 4G file download it never gets interrupted.
>
> The radius reply looks like this:
> Sending Access-Accept of id 95 to 10.22.22.159 port 47286
>         Idle-Timeout := 30
>         Acct-Interim-Interval := 30
>         ChilliSpot-Max-All-Octets = 10
>
>
> Does Coova support those properties? Is this expected or should it disconnect? I'm using 1.3.0.
>
> Thanks
> --
> Lorenzo Milesi - lorenzo.milesi at yetopen.it
>
> YetOpen S.r.l. - http://www.yetopen.it/

From maxxer at ufficyo.com  Thu Feb 13 13:36:34 2014
From: maxxer at ufficyo.com (Lorenzo Milesi)
Date: Thu, 13 Feb 2014 14:36:34 +0100 (CET)
Subject: [Chilli] Disconnect on ChilliSpot-Max-All-Octets
In-Reply-To: <CACkgH73fuUz5AhNJnAwuPHoLv+_JP9+KEDh3vwp91N=MuAam6g@mail.gmail.com>
References: <798457263.21716.1392280513388.JavaMail.zimbra@yetopen.it>
 <1821897025.21735.1392280837689.JavaMail.zimbra@yetopen.it>
 <CACkgH73fuUz5AhNJnAwuPHoLv+_JP9+KEDh3vwp91N=MuAam6g@mail.gmail.com>
Message-ID: <641194362.22850.1392298594524.JavaMail.zimbra@yetopen.it>

> I think it is a RADIUS problem, since he is who must authenticate the
> user. Have you set `ChilliSpot-Max-All-Octets` condition in `radcheck`
> for the user you want to limit?


Thanks but Radius works, if the user has consumed his bytes the login will fail, but I wanted it to be disconnected if he reaches the limit during connection, like it's done for the Expiration or WISPr-Session-Terminate-Time attributes.

-- 
Lorenzo Milesi - lorenzo.milesi at yetopen.it

YetOpen S.r.l. - http://www.yetopen.it/


From radius.sir at gmail.com  Thu Feb 13 15:52:55 2014
From: radius.sir at gmail.com (Russell Mike)
Date: Thu, 13 Feb 2014 15:52:55 +0000
Subject: [Chilli] [SOLVED!!!] CoovaChilli FreeRADIUS Setup With UAM
	[SOLVED!!!]
Message-ID: <CADao4CqBbG-GUcbN0ZM06PxtkqCQMYz+ZS-E5jYAE-rZZnbkQg@mail.gmail.com>

[SOLVED!!!] [Chilli] CoovaChilli FreeRADIUS Setup With UAM Reply Messages
[SOLVED!!!]

Thank you very much guys, with your help, problem solved!!

Alan Dekok told me that NAS should send those messages to UAM & Xabier
explained from chilli list, how to achieve the goal. It is already working
while writing !!!!

Dear Jed, Thanks for your code as well, it helped me to learn few new
ideas. you have been helpful to me many times.

Great Thanks to Community

Regards


On Thu, Feb 13, 2014 at 1:09 PM, Xabier Oneca -- xOneca <xoneca at gmail.com>wrote:

> Hello Mike,
>
>
> 2014-02-12 10:41 GMT+01:00 Russell Mike <radius.sir at gmail.com>:
> > Hi Chilli List Greetings
> >
> > Thanks for all kind of assistance in past from community. i learnt that
> is
> > is not RADIUS, rather NAS should forward the message to UAM.
>
> Yes, you are correct. It's CoovaChilli who "sends" that data to the
> UAM through user redirection.
>
> > How can i configure NAS (CC) to pass on messages to UAM ?
>
> It should already be passing that information to the UAM. Check the
> 'res' and 'reason' URL parameters.
>
> From `redir_reply()` function: statuses of the redirection (res=):
>
>  * already (Already logged in)
>  * failed (This can also set the parameter reason=)
>  * reject (Login rejected by RADIUS)
>  * timeout
>  * mtu
>  * other
>  * success
>  * logoff
>
> Cheers,
>
> Xabier Oneca_,,_
>
> > Thanks / Regards
> >
> >
> > On Tue, Feb 11, 2014 at 10:58 AM, Russell Mike <radius.sir at gmail.com>
> wrote:
> >>
> >> Dear List Greetings
> >>
> >> Setup Example:
> >> i have CoovaChilli / FreeRADIUS setup with UAM (Universal Access
> Manager)
> >> server. Basically means it is different web server than NAS it self
> (NAS =
> >> CoovaChilli). UAM serve the login page for hotspot users. Saying other
> way,
> >> separate web server for content management system (serving login page
> base
> >> on geographical location, distance, vlan numbers etc. etc..)
> >>
> >> When any of following condition becomes true
> >>
> >> 1.) User has fill the wrong password
> >> 2.) User calling outside of time slot
> >> 3.) User already downloaded the quota specified
> >>
> >> FreeRADIUS reject the access, which is obvious. Fine !!!!
> >>
> >> Question:
> >> how can i configure FreeRADIUS to send the reply messages (Your
> >> username/password is wrong) to UAM server rather than NAS ? i am very
> sure
> >> there would be a way to do it and i am not coming across using google
> search
> >> over a week.
> >>
> >> Thanks / Regards
> >> RM --
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140213/c0d0496e/attachment.html>

From xoneca at gmail.com  Thu Feb 13 16:37:16 2014
From: xoneca at gmail.com (Xabier Oneca -- xOneca)
Date: Thu, 13 Feb 2014 17:37:16 +0100
Subject: [Chilli] Coova-Chilli Redirection Problem
In-Reply-To: <52f36e02.8955c20a.7972.3c3e@mx.google.com>
References: <52f25eed.810a0f0a.3775.ffff863c@mx.google.com>
 <CACkgH71zNMntXLBenkvk7kfYXikv5A-vRsNQHoToYUzogo6_1A@mail.gmail.com>
 <52f36e02.8955c20a.7972.3c3e@mx.google.com>
Message-ID: <CACkgH72invuCYaSbGgtvhX_HDxEbS0dEJsuj8s_PDQ7scmk3XQ@mail.gmail.com>

2014-02-06 12:11 GMT+01:00 Peter Wagner <peter.wagner at unwired.at>:
> Hello Xabier,
>
> I created a tcpdump on the client but it shows the same behaviour. The device get's the redirect for orf.at 2 times,
> resets both streams in the middle of the chilli redirect response and then accepts the heisse.de redirect without
> a problem.

It's so strange... :S

In packets 28..31 can be seen how CoovaChilli starts to ACK the
request, and then suddenly sends RSTs as if he had just forgotten of
that connection...

> Cheers,
> Peter Wagner
>
>
> Xabier Oneca  --  xOneca <xoneca at gmail.com> wrote:
>
>> Hello Peter,
>>
>> 2014-02-05 Peter Wagner <peter.wagner at unwired.at>:
>> > Hi,
>> >
>> > i successfully installed Coova-Chilli on Openwrt and it works fine.
>> >
>> > Except in a special case:
>> >
>> > 1) A user opens a webpage like "orf.at" on a mobile device. The device is connected to some other
>> > wifi network.
>> >
>> > 2) The user disconnects from the wifi network and connects to my Coova-Chilli wifi network.
>> >
>> > 3) The user trys to reopen the site (orf.at in this case). And has no authenticated session.
>> >    The expected behaviour would be to get redirected to the captive portal page.
>> >
>> > 4) Instead, no redirect is sent at all. (see tcpdump - packet #55)
>>
>> I do see a response from CoovaChilli, but the client resets the connection.
>>
>> I see the first conversation in frames 57-97 (see by yourself in the
>> menu "Analyze ? Follow TCP Stream" in Wireshark)
>>
>> Then a retry in frames 84-136 and happens the same.
>>
>> Finally in frames 123-173. And client also resets the connection.
>>
>> > 5) User sees the message "Website not available"
>>
>> Yes. It should redirect to the captive portal, but for some reason the
>> client is resetting the connection...
>>
>> Maybe you could run tcpdump in a client?
>>
>> > 6) The user requests the site heisse.de (!= orf.at in this case) (see tcpdump package #402)
>> >
>> > 7) The redirect is sent and the user is redirected to the captive partal page.
>>
>> Yes. That's seen in frames 404-468 and captive portal loading in 473-609.
>>
>> > What could be the cause of this problem? I'm using the latest version of Coova-Chilli and use this cmdline options:
>> >
>> > /usr/sbin/chilli  -c /etc/chilli.conf --fg --dhcpnotidle
>> > --radiusoriginalurl --lease 300 --pidfile=/var/run/chilli.pid
>> > --definteriminterval 60 --usestatusfile /tmp/chilli.status
>> > --seskeepalive --proxyonacct --uamgardendata --uamotherdata
>> > --locationimmediateupdate --nousergardendata --patricia
>> > --proxylocattr=32 --redirssl --redirurl

Try running with --debug option to see what does CoovaChilli see and
do. Also, what is the content of `/etc/chilli.conf`?

Cheers,

Xabier Oneca_,,_

From xoneca at gmail.com  Thu Feb 13 17:44:42 2014
From: xoneca at gmail.com (Xabier Oneca -- xOneca)
Date: Thu, 13 Feb 2014 18:44:42 +0100
Subject: [Chilli] Disconnect on ChilliSpot-Max-All-Octets
In-Reply-To: <641194362.22850.1392298594524.JavaMail.zimbra@yetopen.it>
References: <798457263.21716.1392280513388.JavaMail.zimbra@yetopen.it>
 <1821897025.21735.1392280837689.JavaMail.zimbra@yetopen.it>
 <CACkgH73fuUz5AhNJnAwuPHoLv+_JP9+KEDh3vwp91N=MuAam6g@mail.gmail.com>
 <641194362.22850.1392298594524.JavaMail.zimbra@yetopen.it>
Message-ID: <CACkgH720_guycwOpHJWw-ai87uLEV+WzcgtGxA9qd1dESfUTLA@mail.gmail.com>

2014-02-13 14:36 GMT+01:00 Lorenzo Milesi <maxxer at ufficyo.com>:
>> I think it is a RADIUS problem, since he is who must authenticate the
>> user. Have you set `ChilliSpot-Max-All-Octets` condition in `radcheck`
>> for the user you want to limit?
>
>
> Thanks but Radius works, if the user has consumed his bytes the login will fail, but I wanted it to be disconnected if he reaches the limit during connection, like it's done for the Expiration or WISPr-Session-Terminate-Time attributes.

Sorry, didn't realize... :P

I have found this:

> http://wiki.freeradius.org/protocol/Disconnect-Messages

And CoovaChilli supports it since v1.0.3. So, I think you have to make
RADIUS send `Disconnect-Request` when the limit is reached. But I
honestly don't know much about FreeRADIUS...

HTH,

Xabier Oneca_,,_

From eric at craftti.com.br  Thu Feb 13 23:08:50 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Thu, 13 Feb 2014 21:08:50 -0200
Subject: [Chilli] cannot access AP behind coova
In-Reply-To: <CACkgH71TYV5WGDBYSZvqGnWEZ0Pk0NzX94RQQPZEg9SDWNh18Q@mail.gmail.com>
References: <CAF+USJ7k42bf_qUmYbN9FyXq3_qU+Q3gC79yRh--vA=oWx8aAQ@mail.gmail.com>
 <CACkgH71TYV5WGDBYSZvqGnWEZ0Pk0NzX94RQQPZEg9SDWNh18Q@mail.gmail.com>
Message-ID: <CAF+USJ4_Z-ufG-A4p12nzSDUh72e5GRA0vz5ts+dHa2L02YsUg@mail.gmail.com>

Hi Xabier,

Yes, the AP are authenticated with radius server. Tomorrow I'll go on site
(I'm now on remote access) to see if I can spot anything.

Cheers,

--
Eric Chaves
(11) 98139-9880


2014-02-13 10:59 GMT-02:00 Xabier Oneca -- xOneca <xoneca at gmail.com>:

> Hello Eric,
>
> Are the APs authenticated in chilli? If they aren't, CoovaChilli will
> block the traffic from that IP to the wanif.
>
> You can use MAC authentication with RADIUS to authenticate them.
>
> HTH,
>
> Xabier Oneca_,,_
>
> 2014-02-12 18:16 GMT+01:00 Eric Chaves <eric at craftti.com.br>:
> > Hi Folks,
> >
> > From my how chilli controller host I would like to remotely access the AP
> > behind it. All AP's are getting an IP address from coova on subscriber
> > network and I can ping them without problem.
> >
> > When I try to access any AP from the controlle, be it using telnet, ssh
> or
> > http, the connection is not established.
> >
> > Since I can ping the AP (meaning routes are ok) can I assume that chilli
> is
> > the one dropping those packet and preventing me to access the AP? If so
> what
> > should I do to be able to access the AP?
> >
> > Thanks again for the help and patience,
> >
> > Eric
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140213/bc4ed695/attachment.html>

From eric at craftti.com.br  Fri Feb 14 16:29:20 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Fri, 14 Feb 2014 14:29:20 -0200
Subject: [Chilli] Almost there.
Message-ID: <CAF+USJ5FqEBw-LPRC5=dLW0_+LW3PwGBVAajtQf-h1aZ-ySByg@mail.gmail.com>

Hi guys,

I'm coming closer to the deployment off my Coova chilli in production. I
got almost everything in place except for a few things that I haven't
managed to make it work. If some of the experts in here could help me out
I'll greatly appreciate that.

My environment is made of two servers:
    1) controller - has four ethernet interfaces being two of them used by
chilli (with aid of moreif option), one is my uplink to a roxy/router
server and the remaining one is used as a "services network" although most
of the time it's down.
    2) proxy - also has four ethernet interfaces being two of them my WAN
links (dedicated links with public IPs, not DSL) configured for load
balance and fail-over, one is the downlink to coova and the last one also
in services network.

Coova is configured to use network 172.16.x.x (subscriber network) while,
the uplink network is 10.1.0.x and services is 10.0.1.x. As far as I can
tell all routes are properly configured on both servers and proxy server
does SNAT masquerading on outgoing traffic. Our authentication portal is
hosted on the cloud. We have 2 Access Points in place and soon we will
expand those to a lot more.

So far soo god. The problems I'm facing are:

1) I'm performing NAT from coova to proxy and if I turn it off (which I'd
like to) clients on subscriber network stop being redirected to the
authentication portal.

2) Clients connected on coova can access local network (10.1.1.x) and
services (10.1.0.x) even when HS_LAN_ACCESS is commented.

3) Access Points on subscriber network are getting IP address before being
mac authenticated, which prevent them to receive the IP address provided on
the authentication response.

4) When I'm logged on the controller host using ssh I can ping AP addresses
but I cannot access them via telnet, ssh or http, even when the AP is
successfully authenticated.

5) chilli_query lists AP as authenticated (status pass) however only in one
of them the username matches the mac address, the other one has a username
of '-'. Not really a problem but could this be a bug?

For now, my major concern is item number 1. Does anyone knows what could be
the problem?

Also, a last question so I can understood coova chilli's role a bit better.
when a packet reaches coova via the tun0 interface, does coova read it and
drop/forward it like a firewall (his decision what to do), or does it only
perform some accounting like a pcap tool (all decisions are left for
kernel)?

Once again thanks for the patience and help with all my questions and
troubles so far. You guys have being great I'm certainly in debt of several
beers here. ;)

Cheers,

Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140214/e6b0fe64/attachment.html>

From dbird at google.com  Fri Feb 14 16:38:04 2014
From: dbird at google.com (David Bird)
Date: Fri, 14 Feb 2014 08:38:04 -0800
Subject: [Chilli] Multiple DHCP gateways in Coova
In-Reply-To: <873680328.335068.1392269811782.JavaMail.root@frontiir.net>
References: <1915631804.334886.1392269347961.JavaMail.root@frontiir.net>
 <873680328.335068.1392269811782.JavaMail.root@frontiir.net>
Message-ID: <CADo9JyWgSeqvuLPYezOGZ2cx9bVmH1AURhFNa437cH-bDXCDKw@mail.gmail.com>

Code tweaking would be necessary...


On Wed, Feb 12, 2014 at 9:36 PM, Phyo Wai Soe <phyo.w.soe at frontiir.net>wrote:

> Hi All,
>
> I know we can specify an external DHCP server to be used by Coova with the
> dhcpgateway option. However, we would like to use more than 1 external DHCP
> servers for HA such that if DHCP_server_1 fails, Coova will get addresses
> from DHCP_server_2 and so on. If both DHCP servers are up, Coova will send
> requests to both of the servers and accept only one of the replies. The 2
> DHCP servers may or may not be in the same subnet.
>
> Does Coova support this out of the box or is some code tweaking necessary?
>
> Thanks.
>
> Regards,
> Phyo Wai Soe
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140214/c916fdb1/attachment.html>

From dbird at google.com  Fri Feb 14 16:51:22 2014
From: dbird at google.com (David Bird)
Date: Fri, 14 Feb 2014 08:51:22 -0800
Subject: [Chilli] Implementing "Enable/Disable Local LAN" /
 "Enable/Disable Hotspot Clients"
In-Reply-To: <52F87C57.4080101@netcommwireless.com>
References: <52F87C57.4080101@netcommwireless.com>
Message-ID: <CADo9JyXH=yL37zr9a-37CewYVBeVtqpk1H9o3yaZK7jxQ8yBMQ@mail.gmail.com>

Are you wanting hotspot client to access 192.168.1.x before authentication?
If so, it needs to be in the FORWARD and in chilli's walled garden.


On Sun, Feb 9, 2014 at 11:14 PM, Sourav <
sourav.chakraborty at netcommwireless.com> wrote:

> Hi,
> Our router has the following interfaces and runs coovachilli on it--
> wwan0 inet addr:123.209.15.48 (3G connection to internet)
> tun0 inet addr:10.1.0.1(hotspot clients gw created by coovachilli)
> br0 inet addr:192.168.1.1(local lan gw)
> ra0 wireless interface through which the hotspot clients connect
>
> /etc/chilli/config has --
> HS_WANIF=wwan0 # WAN Interface toward the Internet
> HS_LANIF=ra0 # Subscriber Interface for client devices
>
> Basically we want to implement the following features --
> Enable/Disable Local LAN ? Wifi hotspot clients(may be 10.1.0.x)
> can/cannot access devices on local lan(192.168.1.x) and vice versa.
> Enable/Disable Hotspot Clients ? Hotspot Clients isolation(one hotspot
> client can/can't talk to another).
> Enable/Disable Router Mgmt Interface ? Hotspot Clients can/cannot reach
> web interface of the router.
>
> The following rule in the FORWARD chain ,added by coovachilli should
> enable all pkts from 10.1.0.x to 192.168.1.x and vice versa --
> ACCEPT all -- anywhere anywhere
>
> But it seems coovachilli is dropping the pkts from 192.168.1.x to 10.1.0.x
> and vice versa inspite of the rule in place. Please suggest how I can
> achieve the 3 functionalities asap. I am pressed for time here. Thanks in
> advance.
>
> --
> Warm Regards,
> Sourav
>
>
> ______________________________________________________________________
> This communication contains information which may be confidential or
> privileged. The information is intended solely for the use of the
> individual or entity named above.  If you are not the intended recipient,
> be aware that any disclosure, copying, distribution or use of the contents
> of this information is prohibited.  If you have received this communication
> in error, please notify me by telephone immediately.
> ______________________________________________________________________
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140214/03b05ea7/attachment.html>

From peter.wagner at unwired.at  Mon Feb 17 18:36:42 2014
From: peter.wagner at unwired.at (Peter Wagner)
Date: Mon, 17 Feb 2014 19:36:42 +0100
Subject: [Chilli] Radsec config
Message-ID: <530256cd.42da0e0a.3152.ffffb9c6@mx.google.com>

Hi,

i configured chilli to use radsec

radiusserver1   "192.168.1.1"
radiusserver2   "192.168.1.1"
radiusauthport  2084
radiusacctport  2084
sslkeyfile      /etc/ssl/radsec/radsec.key
sslcertfile     /etc/ssl/radsec/radsec_certificate.crt
sslcafile       /etc/ssl/radsec/radsec_certificate.crt
radiussecret    radsec
radsec


and radsecproxy is listening on 192.168.1.1:2084 and waiting for requests.

As it seems chilli trys to bind to 0.0.0.0

as i get this message on startup:

radius.c: 1315: 0 (Debug) RADIUS client 0.0.0.0:2084
radius.c: 1315: 0 (Debug) RADIUS client 0.0.0.0:2084
radius.c: 1318: 98 (Address already in use) bind() failed!


What am i doing wrong?

With kind regards
Peter

From dbird at google.com  Tue Feb 18 17:49:19 2014
From: dbird at google.com (David Bird)
Date: Tue, 18 Feb 2014 09:49:19 -0800
Subject: [Chilli] Radsec config
In-Reply-To: <530256cd.42da0e0a.3152.ffffb9c6@mx.google.com>
References: <530256cd.42da0e0a.3152.ffffb9c6@mx.google.com>
Message-ID: <CADo9JyWemt4rpHYq2_sOoY4XVSxC8nML4ms0nNs3fJ5M00kteQ@mail.gmail.com>

Chilli in radsec mode will connect to port 2083 at radiusserver1. The
radiusauth/acctport are used to control what local ports the radsec proxy
binds to. You can leave them on the default RADIUS ports. Then move your
radsecproxy server to port 2083 instead.


On Mon, Feb 17, 2014 at 10:36 AM, Peter Wagner <peter.wagner at unwired.at>wrote:

> Hi,
>
> i configured chilli to use radsec
>
> radiusserver1   "192.168.1.1"
> radiusserver2   "192.168.1.1"
> radiusauthport  2084
> radiusacctport  2084
> sslkeyfile      /etc/ssl/radsec/radsec.key
> sslcertfile     /etc/ssl/radsec/radsec_certificate.crt
> sslcafile       /etc/ssl/radsec/radsec_certificate.crt
> radiussecret    radsec
> radsec
>
>
> and radsecproxy is listening on 192.168.1.1:2084 and waiting for requests.
>
> As it seems chilli trys to bind to 0.0.0.0
>
> as i get this message on startup:
>
> radius.c: 1315: 0 (Debug) RADIUS client 0.0.0.0:2084
> radius.c: 1315: 0 (Debug) RADIUS client 0.0.0.0:2084
> radius.c: 1318: 98 (Address already in use) bind() failed!
>
>
> What am i doing wrong?
>
> With kind regards
> Peter
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140218/5b0b5233/attachment.html>

From eric at craftti.com.br  Tue Feb 18 22:36:20 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Tue, 18 Feb 2014 19:36:20 -0300
Subject: [Chilli] chilli_query dhcp-relase problem
Message-ID: <CAF+USJ4AJx-R8KiuCys+wJn_yOBTJ8mUe9vEYitw-QXBBXzprQ@mail.gmail.com>

Hi Folks,

I'm issuing commands "chilli_query dhcp-release <ip address>" but this does
not seem to have any effect. Is this command working?

Cheers,

Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140218/71bc6d10/attachment.html>

From peter.wagner at unwired.at  Wed Feb 19 20:18:10 2014
From: peter.wagner at unwired.at (Peter Wagner)
Date: Wed, 19 Feb 2014 21:18:10 +0100
Subject: [Chilli] Radsec config
In-Reply-To: <CADo9JyWemt4rpHYq2_sOoY4XVSxC8nML4ms0nNs3fJ5M00kteQ@mail.gmail.com>
References: <530256cd.42da0e0a.3152.ffffb9c6@mx.google.com>
 <CADo9JyWemt4rpHYq2_sOoY4XVSxC8nML4ms0nNs3fJ5M00kteQ@mail.gmail.com>
Message-ID: <53051196.42da0e0a.5e5f.158c@mx.google.com>

Thank you very much, it works like a charm.

Have a nice day,
Peter

On Tue, 18 Feb 2014 09:49:19 -0800
David Bird <dbird at google.com> wrote:

> Chilli in radsec mode will connect to port 2083 at radiusserver1. The
> radiusauth/acctport are used to control what local ports the radsec proxy
> binds to. You can leave them on the default RADIUS ports. Then move your
> radsecproxy server to port 2083 instead.
> 
> 
> On Mon, Feb 17, 2014 at 10:36 AM, Peter Wagner <peter.wagner at unwired.at>wrote:
> 
> > Hi,
> >
> > i configured chilli to use radsec
> >
> > radiusserver1   "192.168.1.1"
> > radiusserver2   "192.168.1.1"
> > radiusauthport  2084
> > radiusacctport  2084
> > sslkeyfile      /etc/ssl/radsec/radsec.key
> > sslcertfile     /etc/ssl/radsec/radsec_certificate.crt
> > sslcafile       /etc/ssl/radsec/radsec_certificate.crt
> > radiussecret    radsec
> > radsec
> >
> >
> > and radsecproxy is listening on 192.168.1.1:2084 and waiting for requests.
> >
> > As it seems chilli trys to bind to 0.0.0.0
> >
> > as i get this message on startup:
> >
> > radius.c: 1315: 0 (Debug) RADIUS client 0.0.0.0:2084
> > radius.c: 1315: 0 (Debug) RADIUS client 0.0.0.0:2084
> > radius.c: 1318: 98 (Address already in use) bind() failed!
> >
> >
> > What am i doing wrong?
> >
> > With kind regards
> > Peter
> > _______________________________________________
> > Chilli mailing list
> > Chilli at coova.org
> > http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> >

From eric at craftti.com.br  Wed Feb 19 23:51:31 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Wed, 19 Feb 2014 20:51:31 -0300
Subject: [Chilli] Terminate cause constant values
Message-ID: <CAF+USJ7rrhGMCSZMNbL6qc_m32nra1G-jAAxxJKbtxuJqmtDyw@mail.gmail.com>

Hi Folks,

Chilli docs mention some terminate cause values but it seems that are some
other values beyond the ones mentioned.  grep trough the source code but
didn't found it.

Where can I found all possible values? I

Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140219/03219a4f/attachment.html>

From eric at craftti.com.br  Thu Feb 20 01:41:35 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Wed, 19 Feb 2014 22:41:35 -0300
Subject: [Chilli] Is it possible to know from which access point a device is
	connected?
Message-ID: <CAF+USJ62NmJn=1YyhHw+EKDxhzZrTeAj-Kj2n7AKrb+1s40ydw@mail.gmail.com>

Hi folks,

I'm using the macup/macdown/conup/condown events to create some statistics
about our wifi usage. Is it possible to identify which AP the device is
connected in those scripts?

Thanks,

Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140219/182d9622/attachment.html>

From eric at craftti.com.br  Fri Feb 21 01:55:31 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Thu, 20 Feb 2014 22:55:31 -0300
Subject: [Chilli] Can I use Vlans to tag AP source in coova chilli?
Message-ID: <CAF+USJ5F=e4NSW_obrA+VLt5edRjoBepee9145Ks9e0Qbndx9A@mail.gmail.com>

Hi Guys,

Does coova exports the VLAN tag as environment variable in the
conup/condown/macup/macdon scripts? I was wondering if could use this
tagging as way to detect from which AP a device used when it connected to
our hotspot network.

Would that be possible?

Thanks in advance,

Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140220/4b23f339/attachment.html>

From xoneca at gmail.com  Fri Feb 21 16:31:02 2014
From: xoneca at gmail.com (Xabier Oneca -- xOneca)
Date: Fri, 21 Feb 2014 17:31:02 +0100
Subject: [Chilli] Can I use Vlans to tag AP source in coova chilli?
In-Reply-To: <CAF+USJ5F=e4NSW_obrA+VLt5edRjoBepee9145Ks9e0Qbndx9A@mail.gmail.com>
References: <CAF+USJ5F=e4NSW_obrA+VLt5edRjoBepee9145Ks9e0Qbndx9A@mail.gmail.com>
Message-ID: <CACkgH73zHSmMCD7j8mKe5akgkQHQom7xcyCJ5+u257rrNXqqyg@mail.gmail.com>

Hello Eric,

> Does coova exports the VLAN tag as environment variable in the
> conup/condown/macup/macdon scripts?

https://github.com/coova/coova-chilli/blob/master/src/chilli.c#L767
(function runscript)

There you have all environment variables that are set prior to calling
user script (conup/condown).

Unfortunately, there doesn't seem to be any variable that could have
the VLAN tag value...

HTH,

Xabier Oneca_,,_

From dbird at google.com  Sat Feb 22 16:54:18 2014
From: dbird at google.com (David Bird)
Date: Sat, 22 Feb 2014 08:54:18 -0800
Subject: [Chilli] Can I use Vlans to tag AP source in coova chilli?
In-Reply-To: <CACkgH73zHSmMCD7j8mKe5akgkQHQom7xcyCJ5+u257rrNXqqyg@mail.gmail.com>
References: <CAF+USJ5F=e4NSW_obrA+VLt5edRjoBepee9145Ks9e0Qbndx9A@mail.gmail.com>
 <CACkgH73zHSmMCD7j8mKe5akgkQHQom7xcyCJ5+u257rrNXqqyg@mail.gmail.com>
Message-ID: <CADo9JyUSoxr1Ts17DLm-O4+Po6kYLsCjO1mBzXxVaSDkcrVfVQ@mail.gmail.com>

What you can do is use --vlanlocation so that the VLAN tag is considered
the "location" and that does come through the runscript env parameters.


On Fri, Feb 21, 2014 at 8:31 AM, Xabier Oneca -- xOneca <xoneca at gmail.com>wrote:

> Hello Eric,
>
> > Does coova exports the VLAN tag as environment variable in the
> > conup/condown/macup/macdon scripts?
>
> https://github.com/coova/coova-chilli/blob/master/src/chilli.c#L767
> (function runscript)
>
> There you have all environment variables that are set prior to calling
> user script (conup/condown).
>
> Unfortunately, there doesn't seem to be any variable that could have
> the VLAN tag value...
>
> HTH,
>
> Xabier Oneca_,,_
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140222/5fad5c33/attachment.html>

From eric at craftti.com.br  Sun Feb 23 16:20:47 2014
From: eric at craftti.com.br (Eric Chaves)
Date: Sun, 23 Feb 2014 13:20:47 -0300
Subject: [Chilli] Can I use Vlans to tag AP source in coova chilli?
In-Reply-To: <CADo9JyUSoxr1Ts17DLm-O4+Po6kYLsCjO1mBzXxVaSDkcrVfVQ@mail.gmail.com>
References: <CAF+USJ5F=e4NSW_obrA+VLt5edRjoBepee9145Ks9e0Qbndx9A@mail.gmail.com>
 <CACkgH73zHSmMCD7j8mKe5akgkQHQom7xcyCJ5+u257rrNXqqyg@mail.gmail.com>
 <CADo9JyUSoxr1Ts17DLm-O4+Po6kYLsCjO1mBzXxVaSDkcrVfVQ@mail.gmail.com>
Message-ID: <CAF+USJ567-X4vqFVuq4A49tD3DJvCxJ73hPk18Eq7YHky_p_7Q@mail.gmail.com>

Thanks david. I'll try it tomorrow.

--
Eric Chaves
(11) 98139-9880


2014-02-22 13:54 GMT-03:00 David Bird <dbird at google.com>:

> What you can do is use --vlanlocation so that the VLAN tag is considered
> the "location" and that does come through the runscript env parameters.
>
>
> On Fri, Feb 21, 2014 at 8:31 AM, Xabier Oneca -- xOneca <xoneca at gmail.com>wrote:
>
>> Hello Eric,
>>
>> > Does coova exports the VLAN tag as environment variable in the
>> > conup/condown/macup/macdon scripts?
>>
>> https://github.com/coova/coova-chilli/blob/master/src/chilli.c#L767
>> (function runscript)
>>
>> There you have all environment variables that are set prior to calling
>> user script (conup/condown).
>>
>> Unfortunately, there doesn't seem to be any variable that could have
>> the VLAN tag value...
>>
>> HTH,
>>
>> Xabier Oneca_,,_
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20140223/a69da705/attachment.html>

From list.coovachilli at mac.com  Fri Feb 28 18:03:39 2014
From: list.coovachilli at mac.com (Sam)
Date: Fri, 28 Feb 2014 19:03:39 +0100
Subject: [Chilli] RadSec and MAC auth
Message-ID: <4190DB88-64DD-40CE-95E2-C16ECD26944F@mac.com>

Hello!

I'm having troubles using CoovaChilli with RadSec and MAC auth both enabled.

As soon as a client accesses the network, the radius server gets bombarded with access requests from Chilli, which is apparently neither tracking the state of these requests, nor waiting for a reply before sending the next one. If the radius server replies with access accept, I also see several accounting starts (with the same accounting id) in the logs.

In addition, I can see "bad idx" errors in the Chilli log, which supports my assumption that Chilli is kind of "confused" about how to associate the Radius packets.

As soon as I turn off RadSec, the problem is gone. Then, I only see one MAC auth request, and in case of an accept reply, only one start accounting in the log.

Can someone take a look at this?

Thank you!
Sam


