From krishnanvr4u at gmail.com  Wed Feb  4 15:20:34 2015
From: krishnanvr4u at gmail.com (Krishnan V R)
Date: Wed, 4 Feb 2015 20:50:34 +0530
Subject: [Chilli] Separate access for webserver and internet.
Message-ID: <CAHc8OCdh0B7UshT+uxFRAVGctv9=hiKBvY6MyzO1c-fjWAxnTQ@mail.gmail.com>

Hi,

        I have coova chilli(version 1.3.0) , free radius running in
one machine and webserver running in a other machine. For the same
user, Is it possible to give separate access for webserver and
separate access for the internet.

        Thanks in advance for any suggestions.

Thanks
Krishnan

From sijisunny at gmail.com  Wed Feb  4 15:35:25 2015
From: sijisunny at gmail.com (Siji Sunny)
Date: Wed, 4 Feb 2015 21:05:25 +0530
Subject: [Chilli] Separate access for webserver and internet.
In-Reply-To: <CAHc8OCdh0B7UshT+uxFRAVGctv9=hiKBvY6MyzO1c-fjWAxnTQ@mail.gmail.com>
References: <CAHc8OCdh0B7UshT+uxFRAVGctv9=hiKBvY6MyzO1c-fjWAxnTQ@mail.gmail.com>
Message-ID: <CADtvZWDh1YdJPsy+mPw2JJEnbx_PB2YRWYso9A7-2219Q_juhw@mail.gmail.com>

> Hi,
>
>         I have coova chilli(version 1.3.0) , free radius running in
> one machine and webserver running in a other machine. For the same
> user, Is it possible to give separate access for webserver and
> separate access for the internet.
>

Hi Krishan,

You mean to say you have two different group of users, where one group can
only access local network and the webserver running (Intranet) and other
group can access Internet ?



>         Thanks in advance for any suggestions.
>
> Thanks
> Krishnan
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>



-- 
Siji Sunny
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150204/d8bf9f28/attachment.html>

From krishnanvr4u at gmail.com  Wed Feb  4 15:49:31 2015
From: krishnanvr4u at gmail.com (Krishnan V R)
Date: Wed, 4 Feb 2015 21:19:31 +0530
Subject: [Chilli] Separate access for webserver and internet.
In-Reply-To: <CADtvZWDh1YdJPsy+mPw2JJEnbx_PB2YRWYso9A7-2219Q_juhw@mail.gmail.com>
References: <CAHc8OCdh0B7UshT+uxFRAVGctv9=hiKBvY6MyzO1c-fjWAxnTQ@mail.gmail.com>
 <CADtvZWDh1YdJPsy+mPw2JJEnbx_PB2YRWYso9A7-2219Q_juhw@mail.gmail.com>
Message-ID: <CAHc8OCdC0d7dE3cf3g5WS7uSYVpvLx4VxvNbbboxkske92DFjA@mail.gmail.com>

Hi,

    No. I need a mechanism of two types of authentication for the same
user. one authentication for the webserver access and the other
authentication for the internet access.

On Wed, Feb 4, 2015 at 9:05 PM, Siji Sunny <sijisunny at gmail.com> wrote:
>
>> Hi,
>>
>>         I have coova chilli(version 1.3.0) , free radius running in
>> one machine and webserver running in a other machine. For the same
>> user, Is it possible to give separate access for webserver and
>> separate access for the internet.
>
>
> Hi Krishan,
>
> You mean to say you have two different group of users, where one group can
> only access local network and the webserver running (Intranet) and other
> group can access Internet ?
>
>
>>
>>         Thanks in advance for any suggestions.
>>
>> Thanks
>> Krishnan
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
>
>
> --
> Siji Sunny
>

From krishnanvr4u at gmail.com  Wed Feb  4 15:53:28 2015
From: krishnanvr4u at gmail.com (Krishnan V R)
Date: Wed, 4 Feb 2015 21:23:28 +0530
Subject: [Chilli] Separate access for webserver and internet.
In-Reply-To: <CADtvZWBxpLZ-HyOMR0PPJgqDnim+kiASKciJQgLs0aBiJj8AmQ@mail.gmail.com>
References: <CAHc8OCdh0B7UshT+uxFRAVGctv9=hiKBvY6MyzO1c-fjWAxnTQ@mail.gmail.com>
 <CADtvZWDh1YdJPsy+mPw2JJEnbx_PB2YRWYso9A7-2219Q_juhw@mail.gmail.com>
 <CAHc8OCd7A2S6D-e49R0K-d2Sz0ecyQQO+81V87EEyHOj3UKdxw@mail.gmail.com>
 <CADtvZWBxpLZ-HyOMR0PPJgqDnim+kiASKciJQgLs0aBiJj8AmQ@mail.gmail.com>
Message-ID: <CAHc8OCfSRwae9th88DLi6b8UvRBSEHdwPJHdKi4-TjES28VuUA@mail.gmail.com>

Hi Siji,

       Thanks for the solution. I have tried populating the "radcheck"
table for authentication. But, How can we tell the radius that this
login/password combination is for webserver authentication or internet
?

On Wed, Feb 4, 2015 at 9:17 PM, Siji Sunny <sijisunny at gmail.com> wrote:
> Hi Krishnan,
>
> You may able to define this in radius database table.
>
>
>
> On Wed, Feb 4, 2015 at 9:14 PM, Krishnan V R <krishnanvr4u at gmail.com> wrote:
>>
>> Hi,
>>
>>     No. I need a mechanism of two types of authentication for the same
>> user. one authentication for the webserver access and the other
>> authentication for the internet access.
>>
>> On Wed, Feb 4, 2015 at 9:05 PM, Siji Sunny <sijisunny at gmail.com> wrote:
>> >
>> >> Hi,
>> >>
>> >>         I have coova chilli(version 1.3.0) , free radius running in
>> >> one machine and webserver running in a other machine. For the same
>> >> user, Is it possible to give separate access for webserver and
>> >> separate access for the internet.
>> >
>> >
>> > Hi Krishan,
>> >
>> > You mean to say you have two different group of users, where one group
>> > can
>> > only access local network and the webserver running (Intranet) and other
>> > group can access Internet ?
>> >
>> >
>> >>
>> >>         Thanks in advance for any suggestions.
>> >>
>> >> Thanks
>> >> Krishnan
>> >> _______________________________________________
>> >> Chilli mailing list
>> >> Chilli at coova.org
>> >> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>> >
>> >
>> >
>> >
>> > --
>> > Siji Sunny
>> >
>
>
>
>
> --
> Siji Sunny
>

From alghe.global at gmail.com  Wed Feb  4 16:49:56 2015
From: alghe.global at gmail.com (Alexandru Gheorghe)
Date: Wed, 04 Feb 2015 18:49:56 +0200
Subject: [Chilli] Switching logging mechanism in coova - need
	testers/feedback
In-Reply-To: <CA+U3Mf69VCnEw98j_VHq+iJ-0V59sKXfxCvKkuYPDC3KQfhbwA@mail.gmail.com>
References: <CA+U3Mf4ZNZ7idvoegxQE1EbknmHqhk=12-SJZ8E1MVFxZRxE7g@mail.gmail.com>
 <CADo9JyVFzhn9PXTcqLVQ2BXi1_QYTVtwic7mSvKUmdbjJYV9hQ@mail.gmail.com>
 <CA+U3Mf5uOoh7h1uZRUJ9Vjr1OBxecgQeK094yt1PdVX13pR-zg@mail.gmail.com>
 <CADo9JyX1N2h2e1UfH5sf=gJrg1PxaJBzuKL17VQYCHL6wC+p4w@mail.gmail.com>
 <647126566.1353514.1421272850159.JavaMail.yahoo@jws11109.mail.ir2.yahoo.com>
 <CA+U3Mf5rnzeu2A9aWAYV+pXqqfaNqQST=HXt_pnCkV2tFJTMrg@mail.gmail.com>
 <CA+U3Mf69VCnEw98j_VHq+iJ-0V59sKXfxCvKkuYPDC3KQfhbwA@mail.gmail.com>
Message-ID: <54D24DB4.2070608@gmail.com>

On 01/25/2015 03:42 AM, Sevan / Venture37 wrote:
> On 25 January 2015 at 00:21, Sevan / Venture37 <venture37 at gmail.com> wrote:
>> Any of you guys fancy testing?
>> https://github.com/sevan/coova-chilli/tree/use-syslog


I'll try to test your changes when I've got some spare time, hopefully
this weekend in VMs.


> Created a new branch which has these changes & what's in the upstream
> coova repo merged together so that everything is up to date, branch is
> called my-tip.
>
> https://github.com/sevan/coova-chilli/tree/my-tip
>
>
> Clone https://github.com/sevan/coova-chilli
> git checkout my-tip
> sh bootstrap
> ./configure
> make
> off you go
>
>
> Sevan / Venture37
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli

-- 
; Alexandru Gheorghe
; alghe.global {at} gmail {dot} com
; OpenPGP key ID 0xCAF985D2


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 836 bytes
Desc: OpenPGP digital signature
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150204/f462aeee/attachment.pgp>

From krishnanvr4u at gmail.com  Thu Feb  5 09:59:15 2015
From: krishnanvr4u at gmail.com (Krishnan V R)
Date: Thu, 5 Feb 2015 15:29:15 +0530
Subject: [Chilli] Separate access for webserver and internet.
In-Reply-To: <CAHc8OCdh0B7UshT+uxFRAVGctv9=hiKBvY6MyzO1c-fjWAxnTQ@mail.gmail.com>
References: <CAHc8OCdh0B7UshT+uxFRAVGctv9=hiKBvY6MyzO1c-fjWAxnTQ@mail.gmail.com>
Message-ID: <CAHc8OCdA8rXq6R-tgyeOhcHgJfV9eGYVX2mL99RDm+g1L3=dUA@mail.gmail.com>

Hi,

        Please can anyone give a work around/solution for my requirement.

On Wed, Feb 4, 2015 at 8:50 PM, Krishnan V R <krishnanvr4u at gmail.com> wrote:
> Hi,
>
>         I have coova chilli(version 1.3.0) , free radius running in
> one machine and webserver running in a other machine. For the same
> user, Is it possible to give separate access for webserver and
> separate access for the internet.
>
>         Thanks in advance for any suggestions.
>
> Thanks
> Krishnan

From maxxer at ufficyo.com  Thu Feb  5 13:12:26 2015
From: maxxer at ufficyo.com (Lorenzo Milesi)
Date: Thu, 5 Feb 2015 14:12:26 +0100 (CET)
Subject: [Chilli] Safari not loading https login page
Message-ID: <1699676754.5877.1423141946344.JavaMail.zimbra@yetopen.it>

hi. I recently found out that some MacBooks fail to load login page using Safari. The page fails to load saying it cannot establish an HTTPS connection to the site. In the same situation, Firefox and the captive portal window which appears loads fine.

I suspect it's trying to load CA certs or something related to the certificate. Could it be? anyone having the same issue? thanks

-- 
Lorenzo Milesi - lorenzo.milesi at yetopen.it

YetOpen S.r.l. - http://www.yetopen.it/

From jedgainer at gmail.com  Thu Feb  5 17:40:44 2015
From: jedgainer at gmail.com (Jed Gainer)
Date: Thu, 5 Feb 2015 09:40:44 -0800
Subject: [Chilli] Safari not loading https login page
In-Reply-To: <1699676754.5877.1423141946344.JavaMail.zimbra@yetopen.it>
References: <1699676754.5877.1423141946344.JavaMail.zimbra@yetopen.it>
Message-ID: <CAJc1nuqZCEDRp9PVV4y2ojRVbLE_N7xi8UPfakM6Keg-vdZPbQ@mail.gmail.com>

Apple users seem to have a lot of troubles with chilli I never figured it
out
On Feb 5, 2015 5:21 AM, "Lorenzo Milesi" <maxxer at ufficyo.com> wrote:

> hi. I recently found out that some MacBooks fail to load login page using
> Safari. The page fails to load saying it cannot establish an HTTPS
> connection to the site. In the same situation, Firefox and the captive
> portal window which appears loads fine.
>
> I suspect it's trying to load CA certs or something related to the
> certificate. Could it be? anyone having the same issue? thanks
>
> --
> Lorenzo Milesi - lorenzo.milesi at yetopen.it
>
> YetOpen S.r.l. - http://www.yetopen.it/
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150205/a5f5b528/attachment.html>

From venture37 at gmail.com  Fri Feb  6 22:11:57 2015
From: venture37 at gmail.com (Sevan / Venture37)
Date: Fri, 6 Feb 2015 22:11:57 +0000
Subject: [Chilli] Switching logging mechanism in coova - need
	testers/feedback
In-Reply-To: <54D24DB4.2070608@gmail.com>
References: <CA+U3Mf4ZNZ7idvoegxQE1EbknmHqhk=12-SJZ8E1MVFxZRxE7g@mail.gmail.com>
 <CADo9JyVFzhn9PXTcqLVQ2BXi1_QYTVtwic7mSvKUmdbjJYV9hQ@mail.gmail.com>
 <CA+U3Mf5uOoh7h1uZRUJ9Vjr1OBxecgQeK094yt1PdVX13pR-zg@mail.gmail.com>
 <CADo9JyX1N2h2e1UfH5sf=gJrg1PxaJBzuKL17VQYCHL6wC+p4w@mail.gmail.com>
 <647126566.1353514.1421272850159.JavaMail.yahoo@jws11109.mail.ir2.yahoo.com>
 <CA+U3Mf5rnzeu2A9aWAYV+pXqqfaNqQST=HXt_pnCkV2tFJTMrg@mail.gmail.com>
 <CA+U3Mf69VCnEw98j_VHq+iJ-0V59sKXfxCvKkuYPDC3KQfhbwA@mail.gmail.com>
 <54D24DB4.2070608@gmail.com>
Message-ID: <CA+U3Mf5-k98TcmzaS3YXNr3+-00-MTihXdW00smRQc7FnKA+iA@mail.gmail.com>

On 4 February 2015 at 16:49, Alexandru Gheorghe <alghe.global at gmail.com> wrote:
> On 01/25/2015 03:42 AM, Sevan / Venture37 wrote:
>> On 25 January 2015 at 00:21, Sevan / Venture37 <venture37 at gmail.com> wrote:
>>> Any of you guys fancy testing?
>>> https://github.com/sevan/coova-chilli/tree/use-syslog
>
>
> I'll try to test your changes when I've got some spare time, hopefully
> this weekend in VMs.
>
>
>> Created a new branch which has these changes & what's in the upstream
>> coova repo merged together so that everything is up to date, branch is
>> called my-tip.
>>
>> https://github.com/sevan/coova-chilli/tree/my-tip
>>
>>
>> Clone https://github.com/sevan/coova-chilli
>> git checkout my-tip
>> sh bootstrap
>> ./configure
>> make
>> off you go

These changes are not part of of upstream so you can just clone/pull
the main coova repository & you'll obtain these changes to test with.
Use
https://github.com/coova/coova-chilli


Sevan / Venture37

From krishnanvr4u at gmail.com  Wed Feb 11 14:57:13 2015
From: krishnanvr4u at gmail.com (Krishnan V R)
Date: Wed, 11 Feb 2015 20:27:13 +0530
Subject: [Chilli] Access to the resource based on user.
Message-ID: <CAHc8OCfSBaUbOq6tzV8LLqtf-Z4s15DRF40yKh3UmEwLUdLQyA@mail.gmail.com>

Hi,

        I am using coova-chilli and freeradius.

        I have user A and B. I am treating internet and a audio stream
from a local PC as two different resource.

       When user A logs-in, he can access only to internet. When B
logs-in, he can access only to the audio stream. I am planning to
implement this requirement using the iptables in the conup.sh based on
username. I am new to iptables and coova chilli. Please can you
confirm if it is possible.

      I have one more requirement where user A have logged in and want
the access the audio stream also. Is it possible using coova
chilli/freeradius?

       Please let me know if the requirements are not clear.

Thanks in advance.
Krishnan

From dbird at google.com  Wed Feb 11 20:26:27 2015
From: dbird at google.com (David Bird)
Date: Wed, 11 Feb 2015 12:26:27 -0800
Subject: [Chilli] Access to the resource based on user.
In-Reply-To: <CAHc8OCfSBaUbOq6tzV8LLqtf-Z4s15DRF40yKh3UmEwLUdLQyA@mail.gmail.com>
References: <CAHc8OCfSBaUbOq6tzV8LLqtf-Z4s15DRF40yKh3UmEwLUdLQyA@mail.gmail.com>
Message-ID: <CADo9JyX+7HA+iDFrksOE-3isQ1tBfxevpPCXyAvBPS-41SEhiQ@mail.gmail.com>

For the more restrictive login, what you can do it return an Access-Reject
with additional walled garden entries for that station -- so, not full
access, but you can add resources to the garden based on ip and/or port.

On Wed, Feb 11, 2015 at 6:57 AM, Krishnan V R <krishnanvr4u at gmail.com>
wrote:

> Hi,
>
>         I am using coova-chilli and freeradius.
>
>         I have user A and B. I am treating internet and a audio stream
> from a local PC as two different resource.
>
>        When user A logs-in, he can access only to internet. When B
> logs-in, he can access only to the audio stream. I am planning to
> implement this requirement using the iptables in the conup.sh based on
> username. I am new to iptables and coova chilli. Please can you
> confirm if it is possible.
>
>       I have one more requirement where user A have logged in and want
> the access the audio stream also. Is it possible using coova
> chilli/freeradius?
>
>        Please let me know if the requirements are not clear.
>
> Thanks in advance.
> Krishnan
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150211/2f69d8fb/attachment.html>

From krishnanvr4u at gmail.com  Thu Feb 12 09:47:12 2015
From: krishnanvr4u at gmail.com (Krishnan V R)
Date: Thu, 12 Feb 2015 15:17:12 +0530
Subject: [Chilli] Access to the resource based on user.
In-Reply-To: <CADo9JyX+7HA+iDFrksOE-3isQ1tBfxevpPCXyAvBPS-41SEhiQ@mail.gmail.com>
References: <CAHc8OCfSBaUbOq6tzV8LLqtf-Z4s15DRF40yKh3UmEwLUdLQyA@mail.gmail.com>
 <CADo9JyX+7HA+iDFrksOE-3isQ1tBfxevpPCXyAvBPS-41SEhiQ@mail.gmail.com>
Message-ID: <CAHc8OCcScRxriLzFnoURHZfVbXfarYyvPd5VSOz+L0vakAyqfA@mail.gmail.com>

Hi David,

        Thanks for the solution. This is my understanding on your
response. Please can you confirm if it is right?

       This will work like dynamic wall garden. When I need to give
the access of a IP address or port of the IP address to the user, I
can run the chilli_query which will dynamically add the IP address to
the wall garden.

chilli_query addgarden ip 10.0.0.1 data 192.168.100.10

Thanks
Krishnan



On Thu, Feb 12, 2015 at 1:56 AM, David Bird <dbird at google.com> wrote:
> For the more restrictive login, what you can do it return an Access-Reject
> with additional walled garden entries for that station -- so, not full
> access, but you can add resources to the garden based on ip and/or port.
>
> On Wed, Feb 11, 2015 at 6:57 AM, Krishnan V R <krishnanvr4u at gmail.com>
> wrote:
>>
>> Hi,
>>
>>         I am using coova-chilli and freeradius.
>>
>>         I have user A and B. I am treating internet and a audio stream
>> from a local PC as two different resource.
>>
>>        When user A logs-in, he can access only to internet. When B
>> logs-in, he can access only to the audio stream. I am planning to
>> implement this requirement using the iptables in the conup.sh based on
>> username. I am new to iptables and coova chilli. Please can you
>> confirm if it is possible.
>>
>>       I have one more requirement where user A have logged in and want
>> the access the audio stream also. Is it possible using coova
>> chilli/freeradius?
>>
>>        Please let me know if the requirements are not clear.
>>
>> Thanks in advance.
>> Krishnan
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>

From ben at gowasabi.net  Fri Feb 13 22:55:29 2015
From: ben at gowasabi.net (Ben West)
Date: Fri, 13 Feb 2015 16:55:29 -0600
Subject: [Chilli] Correct chilli_query usage for resetting client's session,
 directing them back to portal
Message-ID: <CADSh-SNyXBhMwzr_K4HRmq6OhWUxbMw_YjJH22uPPGqa5HYdEA@mail.gmail.com>

I am curious what is the correct "chilli_query" invocation to reset a
particular client's authorized session and force them back to the portal,
without affecting other clients on that same AP.

This is the usage info which chilli_query reports:

root at Openwrt:~# chilli_query
Usage: chilli_query [ -s <socket> ] [ -P <port> ] <command> [<arguments>]
  socket = full path to UNIX domain socket (e.g. /var/run/chilli.sock)
  port = TCP socket port to connect to. Default is 42424
  Available Commands:
    list, listippool, listradqueue, listgarden, reload, dhcp-list,
dhcp-release, authorize, login, update, logout, logoff, drop, block, procs,
addgarden, remgarden
  Available Arguments:
    ip                <value> - type: ip   [   4] - IP address of session
to perform action on
    mac               <value> - type: mac  [   6] - MAC address of session
to perform action on
    sessionid         <value> - type: char [  17] - Session-id of session
to perform action on
    username          <value> - type: char [ 256] - Username to use in
RADIUS 'login' or authorization
    password          <value> - type: char [ 256] - Password to be used for
'login' command
    sessiontimeout    <value> - type: int  [   8] - Max session time (in
seconds)
    idletimeout       <value> - type: int  [   4] - Max idle time (in
seconds)
    interiminterval   <value> - type: int  [   2] - Accounting interim
interval
    maxoctets         <value> - type: int  [   8] - Max input + output
octets (bytes)
    maxinputoctets    <value> - type: int  [   8] - Max input octets (bytes)
    maxoutputoctets   <value> - type: int  [   8] - Max output octets
(bytes)
    maxbwup           <value> - type: int  [   8] - Max bandwidth up
    maxbwdown         <value> - type: int  [   8] - Max bandwidth down
    splash            <value> - type: char [2048] - Set splash page
    url               <value> - type: char [2048] - Set redirect url
    noacct                    - type: flag [   0] - No accounting flag
    data              <value> - type: char [1024] - Text configuration line
The ip and/or sessionid is required.

Say this the active session list (anonymized):

root at Openwrt:~# chilli_query list
50-55-27-XX-XX-XX 101.2.233.37 dnat 54de762f00000007 0 50-55-27-XX-XX-XX
0/7200 0/3600 0/0 0/0 0 1 0/0 0/0 http://domain.com
10-68-3F-XX-XX-XX 101.2.233.40 pass 54de742800000006 1 guest 2140/7200
1/3600 1155289/0 5056945/0 524288000 1 0%/384000 0%/1000000
http://somewhere.com
C8-3A-35-XX-XX-XX 101.2.233.27 pass 54de7e9a00000003 1 guest 113/7200
0/3600 310508/0 3970351/0 524288000 1 2%/384000 32%/1000000
http://somewhereelse.com
CC-D2-9B-XX-XX-XX 101.2.233.25 dnat 54de3ed700000004 0 CC-D2-9B-XX-XX-XX
0/7200 0/3600 0/0 0/0 0 1 0/0 0/0 http://nowhere.com
DE-9F-DB-XX-XX-XX 101.2.233.2 dnat 54ddcb2300000002 0 DE-9F-DB-XX-XX-XX
0/7200 0/3600 0/0 0/0 0 1 0/0 0/0 -

To reset the session for client at MAC address C8-3A-35-XX-XX-XX, forcing
him to log back into the captive portal again as user "guest," would this
be correct usage?

# chilli_query logoff C8-3A-35-XX-XX-XX

chilli_query has the commands logout, logoff, block, and drop, and I'm
having difficulty locating documentation about precisely what those
commands do.

Thank you.

-- 
Ben West
http://gowasabi.net
ben at gowasabi.net
314-246-9434
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150213/dc803cdf/attachment.html>

From xoneca at gmail.com  Sat Feb 14 12:36:16 2015
From: xoneca at gmail.com (Xabier Oneca -- xOneca)
Date: Sat, 14 Feb 2015 13:36:16 +0100
Subject: [Chilli] Correct chilli_query usage for resetting client's
 session, directing them back to portal
In-Reply-To: <CADSh-SNyXBhMwzr_K4HRmq6OhWUxbMw_YjJH22uPPGqa5HYdEA@mail.gmail.com>
References: <CADSh-SNyXBhMwzr_K4HRmq6OhWUxbMw_YjJH22uPPGqa5HYdEA@mail.gmail.com>
Message-ID: <CACkgH72xsNXk7E16mObQ5Tz2Y_WFL7brs_dv8cyQDT3u0hAfNA@mail.gmail.com>

Hello Ben,

2015-02-13 23:55 GMT+01:00 Ben West <ben at gowasabi.net>:
> I am curious what is the correct "chilli_query" invocation to reset a
> particular client's authorized session and force them back to the portal,
> without affecting other clients on that same AP.
>
> This is the usage info which chilli_query reports:
>
> [...]
>
> Say this the active session list (anonymized):
>
> root at Openwrt:~# chilli_query list
> 50-55-27-XX-XX-XX 101.2.233.37 dnat 54de762f00000007 0 50-55-27-XX-XX-XX
> 0/7200 0/3600 0/0 0/0 0 1 0/0 0/0 http://domain.com
> 10-68-3F-XX-XX-XX 101.2.233.40 pass 54de742800000006 1 guest 2140/7200
> 1/3600 1155289/0 5056945/0 524288000 1 0%/384000 0%/1000000
> http://somewhere.com
> C8-3A-35-XX-XX-XX 101.2.233.27 pass 54de7e9a00000003 1 guest 113/7200 0/3600
> 310508/0 3970351/0 524288000 1 2%/384000 32%/1000000
> http://somewhereelse.com
> CC-D2-9B-XX-XX-XX 101.2.233.25 dnat 54de3ed700000004 0 CC-D2-9B-XX-XX-XX
> 0/7200 0/3600 0/0 0/0 0 1 0/0 0/0 http://nowhere.com
> DE-9F-DB-XX-XX-XX 101.2.233.2 dnat 54ddcb2300000002 0 DE-9F-DB-XX-XX-XX
> 0/7200 0/3600 0/0 0/0 0 1 0/0 0/0 -
>
> To reset the session for client at MAC address C8-3A-35-XX-XX-XX, forcing
> him to log back into the captive portal again as user "guest," would this be
> correct usage?
>
> # chilli_query logoff C8-3A-35-XX-XX-XX
>
> chilli_query has the commands logout, logoff, block, and drop, and I'm
> having difficulty locating documentation about precisely what those commands
> do.

The commands 'logout' and 'logoff' are synonyms. The same is for
'block' and 'drop'.

To reset sessions I used to use 'logoff'. It terminates the user
session with cause RADIUS_TERMINATE_CAUSE_ADMIN_RESET.

Not sure what 'block' does. I think it denies access indefinitely
(even to the UAM).

HTH,

Xabier Oneca_,,_

From ben at gowasabi.net  Sun Feb 15 21:35:00 2015
From: ben at gowasabi.net (Ben West)
Date: Sun, 15 Feb 2015 15:35:00 -0600
Subject: [Chilli] Apparent intrusion attempt on AP running coova-chilli
	1.2.9, ways to mitigate?
Message-ID: <CADSh-SNYtS7ZYy-ktCs8nzJ-NNFY_oZ7n5NBpS2=-ViHhc3gDQ@mail.gmail.com>

A Nanostation M2 running Openwrt AA with coova-chilli v1.2.9 stopped its
periodic heartbeat, and I had a chance to SSH in locally w/in 1 hour of the
last heartbeat.

I didn't get a chance to inspect the APs local state very well before
having to issue a "reboot -f" after the initial SSH session appeared to
freeze.

Besides, the device only have 1Mbyte of remaining free memory, I did notice
these log messages from coova-chilli (trimmed and anonymized):

Feb 15 20:43:56 Openwrt local6.notice coova-chilli[2056]: chilli.c: 5005:
Client MAC=8C-84-01-XX-XX-XX assigned IP 101.209.43.124
Feb 15 20:44:16 Openwrt local6.err coova-chilli[18240]: redir.c: 3462:
invalid file extension! [wwwroot/apkupdate.php]
Feb 15 20:44:19 Openwrt local6.err coova-chilli[18243]: redir.c: 3462:
invalid file extension! [wwwroot/xmlupdate.php]
...
Feb 15 20:44:42 Openwrt local6.err coova-chilli[18283]: redir.c: 3462:
invalid file extension! [getTasklist.php]
Feb 15 20:44:42 Openwrt local6.err coova-chilli[18284]: redir.c: 3462:
invalid file extension! [getAccountNum.php]
Feb 15 20:44:46 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX
IEEE 802.11: authenticated
Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX
IEEE 802.11: authenticated
Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX
IEEE 802.11: associated (aid 3)
Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX
RADIUS: starting accounting session 0000002F-000001AD
Feb 15 20:59:46 Openwrt local6.err coova-chilli[18919]: redir.c: 3462:
invalid file extension! [getTasklist.php]
...
Feb 15 20:59:49 Openwrt local6.err coova-chilli[18923]: redir.c: 3462:
invalid file extension! [getTasklist2.php]
...

The "invalid file extension" instances, if which there are a couple dozen,
are only a few seconds apart.  The URL parts like "getTasklist.php" and
"getAccountNum.php" seem to suggest whatever the client is doing (i.e.
hammering the chilli agent with lots of bogus port 80 requests) is
abusive.  These log messages did coincide with this particular Nanostation
verging on unresponsive, although I didn't get a chance to run "top" or
"uptime" before needing to force a reboot.

Besides simply blocking this particular MAC from associating, are the other
measures to ward off intrusions like this?

-- 
Ben West
http://gowasabi.net
ben at gowasabi.net
314-246-9434
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150215/5cf4ae2a/attachment.html>

From xoneca at gmail.com  Sun Feb 15 22:13:44 2015
From: xoneca at gmail.com (Xabier Oneca -- xOneca)
Date: Sun, 15 Feb 2015 23:13:44 +0100
Subject: [Chilli] Apparent intrusion attempt on AP running coova-chilli
 1.2.9, ways to mitigate?
In-Reply-To: <CADSh-SNYtS7ZYy-ktCs8nzJ-NNFY_oZ7n5NBpS2=-ViHhc3gDQ@mail.gmail.com>
References: <CADSh-SNYtS7ZYy-ktCs8nzJ-NNFY_oZ7n5NBpS2=-ViHhc3gDQ@mail.gmail.com>
Message-ID: <CACkgH73gg7tv3AQfi8UkB5OKnoLutbiJGzmQ7P_ngUBxofF-sQ@mail.gmail.com>

Hello Ben,

2015-02-15 22:35 GMT+01:00 Ben West <ben at gowasabi.net>:
> A Nanostation M2 running Openwrt AA with coova-chilli v1.2.9 stopped its
> periodic heartbeat, and I had a chance to SSH in locally w/in 1 hour of the
> last heartbeat.
>
> I didn't get a chance to inspect the APs local state very well before having
> to issue a "reboot -f" after the initial SSH session appeared to freeze.
>
> Besides, the device only have 1Mbyte of remaining free memory, I did notice
> these log messages from coova-chilli (trimmed and anonymized):
>
> Feb 15 20:43:56 Openwrt local6.notice coova-chilli[2056]: chilli.c: 5005:
> Client MAC=8C-84-01-XX-XX-XX assigned IP 101.209.43.124
> Feb 15 20:44:16 Openwrt local6.err coova-chilli[18240]: redir.c: 3462:
> invalid file extension! [wwwroot/apkupdate.php]
> Feb 15 20:44:19 Openwrt local6.err coova-chilli[18243]: redir.c: 3462:
> invalid file extension! [wwwroot/xmlupdate.php]
> ...
> Feb 15 20:44:42 Openwrt local6.err coova-chilli[18283]: redir.c: 3462:
> invalid file extension! [getTasklist.php]
> Feb 15 20:44:42 Openwrt local6.err coova-chilli[18284]: redir.c: 3462:
> invalid file extension! [getAccountNum.php]
> Feb 15 20:44:46 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX
> IEEE 802.11: authenticated
> Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX
> IEEE 802.11: authenticated
> Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX
> IEEE 802.11: associated (aid 3)
> Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX
> RADIUS: starting accounting session 0000002F-000001AD
> Feb 15 20:59:46 Openwrt local6.err coova-chilli[18919]: redir.c: 3462:
> invalid file extension! [getTasklist.php]
> ...
> Feb 15 20:59:49 Openwrt local6.err coova-chilli[18923]: redir.c: 3462:
> invalid file extension! [getTasklist2.php]
> ...

The PHP file names seem like Android API function calls. Maybe it's
some sort of Android managing software that has a web interface, and
the App is making calls to it, thinking Chilli is the manager
server...

I googled those names, but the searches came empty.

Cheers,

Xabier Oneca_,,_

From ben at gowasabi.net  Sun Feb 15 22:57:55 2015
From: ben at gowasabi.net (Ben West)
Date: Sun, 15 Feb 2015 16:57:55 -0600
Subject: [Chilli] Apparent intrusion attempt on AP running coova-chilli
 1.2.9, ways to mitigate?
In-Reply-To: <CACkgH73gg7tv3AQfi8UkB5OKnoLutbiJGzmQ7P_ngUBxofF-sQ@mail.gmail.com>
References: <CADSh-SNYtS7ZYy-ktCs8nzJ-NNFY_oZ7n5NBpS2=-ViHhc3gDQ@mail.gmail.com>
 <CACkgH73gg7tv3AQfi8UkB5OKnoLutbiJGzmQ7P_ngUBxofF-sQ@mail.gmail.com>
Message-ID: <CADSh-SNMXbAoh690tRgWZcM2u4wS6gVy7rjO_M0DN0RgPaGfEQ@mail.gmail.com>

Thank you, Xavier, for the tip about possible API calls from a wayward
Android client.  I also couldn't Google anything meaningful about the
filenames"apkupdate.php," etc and assumed the client was malicious.

Are there options for dealing with chilli clients who open many many many
simultaneous connections, for whatever reason?  For example use iptables
connlimit module to limit the number of new connections per unit time on
unauthenticated clients?
https://unix.stackexchange.com/questions/139285/limit-max-connections-per-ip-address-and-new-connections-per-second-with-iptable

I'd hate to apply filters that could potentially impede portal
authentication for all clients, but having a small handful of misbehaving
clients (whether intentional or not) crash the AP is also problematic.

P.S. Thank you also for your answer to my question about chilli_query in
the previous thread!


On Sun, Feb 15, 2015 at 4:13 PM, Xabier Oneca -- xOneca <xoneca at gmail.com>
wrote:

> Hello Ben,
>
> 2015-02-15 22:35 GMT+01:00 Ben West <ben at gowasabi.net>:
> > A Nanostation M2 running Openwrt AA with coova-chilli v1.2.9 stopped its
> > periodic heartbeat, and I had a chance to SSH in locally w/in 1 hour of
> the
> > last heartbeat.
> >
> > I didn't get a chance to inspect the APs local state very well before
> having
> > to issue a "reboot -f" after the initial SSH session appeared to freeze.
> >
> > Besides, the device only have 1Mbyte of remaining free memory, I did
> notice
> > these log messages from coova-chilli (trimmed and anonymized):
> >
> > Feb 15 20:43:56 Openwrt local6.notice coova-chilli[2056]: chilli.c: 5005:
> > Client MAC=8C-84-01-XX-XX-XX assigned IP 101.209.43.124
> > Feb 15 20:44:16 Openwrt local6.err coova-chilli[18240]: redir.c: 3462:
> > invalid file extension! [wwwroot/apkupdate.php]
> > Feb 15 20:44:19 Openwrt local6.err coova-chilli[18243]: redir.c: 3462:
> > invalid file extension! [wwwroot/xmlupdate.php]
> > ...
> > Feb 15 20:44:42 Openwrt local6.err coova-chilli[18283]: redir.c: 3462:
> > invalid file extension! [getTasklist.php]
> > Feb 15 20:44:42 Openwrt local6.err coova-chilli[18284]: redir.c: 3462:
> > invalid file extension! [getAccountNum.php]
> > Feb 15 20:44:46 Openwrt daemon.info hostapd: wlan0: STA
> 8c:84:01:XX:XX:XX
> > IEEE 802.11: authenticated
> > Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA
> 8c:84:01:XX:XX:XX
> > IEEE 802.11: authenticated
> > Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA
> 8c:84:01:XX:XX:XX
> > IEEE 802.11: associated (aid 3)
> > Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA
> 8c:84:01:XX:XX:XX
> > RADIUS: starting accounting session 0000002F-000001AD
> > Feb 15 20:59:46 Openwrt local6.err coova-chilli[18919]: redir.c: 3462:
> > invalid file extension! [getTasklist.php]
> > ...
> > Feb 15 20:59:49 Openwrt local6.err coova-chilli[18923]: redir.c: 3462:
> > invalid file extension! [getTasklist2.php]
> > ...
>
> The PHP file names seem like Android API function calls. Maybe it's
> some sort of Android managing software that has a web interface, and
> the App is making calls to it, thinking Chilli is the manager
> server...
>
> I googled those names, but the searches came empty.
>
> Cheers,
>
> Xabier Oneca_,,_
>



-- 
Ben West
http://gowasabi.net
ben at gowasabi.net
314-246-9434
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150215/6803e08c/attachment.html>

From xoneca at gmail.com  Sun Feb 15 23:36:08 2015
From: xoneca at gmail.com (Xabier Oneca -- xOneca)
Date: Mon, 16 Feb 2015 00:36:08 +0100
Subject: [Chilli] Apparent intrusion attempt on AP running coova-chilli
 1.2.9, ways to mitigate?
In-Reply-To: <CADSh-SNMXbAoh690tRgWZcM2u4wS6gVy7rjO_M0DN0RgPaGfEQ@mail.gmail.com>
References: <CADSh-SNYtS7ZYy-ktCs8nzJ-NNFY_oZ7n5NBpS2=-ViHhc3gDQ@mail.gmail.com>
 <CACkgH73gg7tv3AQfi8UkB5OKnoLutbiJGzmQ7P_ngUBxofF-sQ@mail.gmail.com>
 <CADSh-SNMXbAoh690tRgWZcM2u4wS6gVy7rjO_M0DN0RgPaGfEQ@mail.gmail.com>
Message-ID: <CACkgH72BF66SON89U88oSA_WmvT3ZnTMiET9hufPxNAot1yoRw@mail.gmail.com>

2015-02-15 23:57 GMT+01:00 Ben West <ben at gowasabi.net>:
> Thank you, Xavier, for the tip about possible API calls from a wayward
> Android client.  I also couldn't Google anything meaningful about the
> filenames"apkupdate.php," etc and assumed the client was malicious.

Misbehaved App/user? It seems so. Malicious? Probably not. But if you
are not running PHP on that AP, I would not worry.

> Are there options for dealing with chilli clients who open many many many
> simultaneous connections, for whatever reason?  For example use iptables
> connlimit module to limit the number of new connections per unit time on
> unauthenticated clients?
> https://unix.stackexchange.com/questions/139285/limit-max-connections-per-ip-address-and-new-connections-per-second-with-iptable

Only on unauthenticated clients? Authenticated clients can also be
rogue. I would simply set the limit so high that normal clients will
never reach it. You should probably do a load test to see where's the
limit of the Nanostation. I am not sure those requests brought down
your AP, unless they were in the order of tens/hundreds per second.

> I'd hate to apply filters that could potentially impede portal
> authentication for all clients, but having a small handful of misbehaving
> clients (whether intentional or not) crash the AP is also problematic.
>
> P.S. Thank you also for your answer to my question about chilli_query in the
> previous thread!

You are welcome!

Cheers,

Xabier Oneca_,,_

P.S.: Are you using public IP addresses for your clients? (Client
MAC=8C-84-01-XX-XX-XX assigned IP *101.209.43.124*)

From augustus_meyer at yahoo.de  Mon Feb 16 00:03:58 2015
From: augustus_meyer at yahoo.de (reiner otto)
Date: Mon, 16 Feb 2015 00:03:58 +0000 (UTC)
Subject: [Chilli] Apparent intrusion attempt on AP running
	coova-chilli	1.2.9, ways to mitigate?
In-Reply-To: <CADSh-SNYtS7ZYy-ktCs8nzJ-NNFY_oZ7n5NBpS2=-ViHhc3gDQ@mail.gmail.com>
References: <CADSh-SNYtS7ZYy-ktCs8nzJ-NNFY_oZ7n5NBpS2=-ViHhc3gDQ@mail.gmail.com>
Message-ID: <1933869555.6653619.1424045038317.JavaMail.yahoo@mail.yahoo.com>

You might have a look at "logtrigger" or "fail2ban".
 

     Ben West <ben at gowasabi.net> schrieb am 22:35 Sonntag, 15.Februar 2015:
   

 A Nanostation M2 running Openwrt AA with coova-chilli v1.2.9 stopped its periodic heartbeat, and I had a chance to SSH in locally w/in 1 hour of the last heartbeat.

I didn't get a chance to inspect the APs local state very well before having to issue a "reboot -f" after the initial SSH session appeared to freeze.

Besides, the device only have 1Mbyte of remaining free memory, I did notice these log messages from coova-chilli (trimmed and anonymized):

Feb 15 20:43:56 Openwrt local6.notice coova-chilli[2056]: chilli.c: 5005: Client MAC=8C-84-01-XX-XX-XX assigned IP 101.209.43.124
Feb 15 20:44:16 Openwrt local6.err coova-chilli[18240]: redir.c: 3462: invalid file extension! [wwwroot/apkupdate.php]
Feb 15 20:44:19 Openwrt local6.err coova-chilli[18243]: redir.c: 3462: invalid file extension! [wwwroot/xmlupdate.php]
...
Feb 15 20:44:42 Openwrt local6.err coova-chilli[18283]: redir.c: 3462: invalid file extension! [getTasklist.php]
Feb 15 20:44:42 Openwrt local6.err coova-chilli[18284]: redir.c: 3462: invalid file extension! [getAccountNum.php]
Feb 15 20:44:46 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX IEEE 802.11: authenticated
Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX IEEE 802.11: authenticated
Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX IEEE 802.11: associated (aid 3)
Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX RADIUS: starting accounting session 0000002F-000001AD
Feb 15 20:59:46 Openwrt local6.err coova-chilli[18919]: redir.c: 3462: invalid file extension! [getTasklist.php]
...
Feb 15 20:59:49 Openwrt local6.err coova-chilli[18923]: redir.c: 3462: invalid file extension! [getTasklist2.php]
...

The "invalid file extension" instances, if which there are a couple dozen, are only a few seconds apart.? The URL parts like "getTasklist.php" and "getAccountNum.php" seem to suggest whatever the client is doing (i.e. hammering the chilli agent with lots of bogus port 80 requests) is abusive.? These log messages did coincide with this particular Nanostation verging on unresponsive, although I didn't get a chance to run "top" or "uptime" before needing to force a reboot.

Besides simply blocking this particular MAC from associating, are the other measures to ward off intrusions like this?

-- 
Ben Westhttp://gowasabi.net
ben at gowasabi.net
314-246-9434

_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150216/c699cf22/attachment-0001.html>

From krishnanvr4u at gmail.com  Mon Feb 16 07:25:34 2015
From: krishnanvr4u at gmail.com (Krishnan V R)
Date: Mon, 16 Feb 2015 12:55:34 +0530
Subject: [Chilli] Access to the resource based on user.
In-Reply-To: <CADo9JyX+7HA+iDFrksOE-3isQ1tBfxevpPCXyAvBPS-41SEhiQ@mail.gmail.com>
References: <CAHc8OCfSBaUbOq6tzV8LLqtf-Z4s15DRF40yKh3UmEwLUdLQyA@mail.gmail.com>
 <CADo9JyX+7HA+iDFrksOE-3isQ1tBfxevpPCXyAvBPS-41SEhiQ@mail.gmail.com>
Message-ID: <CAHc8OCeNkpiOK8R+uHDNuRiXD0+7pfBWnkngz0rU5AZ0uqHjbQ@mail.gmail.com>

Sir,

         Please can you explain your reply little further.

On Thu, Feb 12, 2015 at 1:56 AM, David Bird <dbird at google.com> wrote:
> For the more restrictive login, what you can do it return an Access-Reject
> with additional walled garden entries for that station -- so, not full
> access, but you can add resources to the garden based on ip and/or port.
>
> On Wed, Feb 11, 2015 at 6:57 AM, Krishnan V R <krishnanvr4u at gmail.com>
> wrote:
>>
>> Hi,
>>
>>         I am using coova-chilli and freeradius.
>>
>>         I have user A and B. I am treating internet and a audio stream
>> from a local PC as two different resource.
>>
>>        When user A logs-in, he can access only to internet. When B
>> logs-in, he can access only to the audio stream. I am planning to
>> implement this requirement using the iptables in the conup.sh based on
>> username. I am new to iptables and coova chilli. Please can you
>> confirm if it is possible.
>>
>>       I have one more requirement where user A have logged in and want
>> the access the audio stream also. Is it possible using coova
>> chilli/freeradius?
>>
>>        Please let me know if the requirements are not clear.
>>
>> Thanks in advance.
>> Krishnan
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>

From claus at stjerno.dk  Mon Feb 16 09:13:58 2015
From: claus at stjerno.dk (=?iso-8859-1?Q?Claus_Stjern=F8?=)
Date: Mon, 16 Feb 2015 10:13:58 +0100
Subject: [Chilli] Apparent intrusion attempt on AP running
Message-ID: <008f01d049c8$e5bb2b40$b13181c0$@stjerno.dk>

Hi Ben,

 

My guess is that you got a virus infected client.

The client is trying to reach a site and is requesting a tasklist from a
predefined server. Your Chilli daemon is redirecting his http call?s but the
users request for the particular php code throws an error in the redir.c
code.

 

See the request for that particular php code here:
http://lists.clean-mx.com/pipermail/viruswatch/20120206/031018.html

 

The other could php calls could also be part of the virus but like others
have said, Google did not help here :)

 

Kind regards,

Claus

 

A Nanostation M2 running Openwrt AA with coova-chilli v1.2.9 stopped its
periodic heartbeat, and I had a chance to SSH in locally w/in 1 hour of the
last heartbeat.

 

I didn't get a chance to inspect the APs local state very well before having
to issue a "reboot -f" after the initial SSH session appeared to freeze.

 

Besides, the device only have 1Mbyte of remaining free memory, I did notice
these log messages from coova-chilli (trimmed and anonymized):

 

Feb 15 20:43:56 Openwrt local6.notice coova-chilli[2056]: chilli.c: 5005:

Client MAC=8C-84-01-XX-XX-XX assigned IP 101.209.43.124 Feb 15 20:44:16
Openwrt local6.err coova-chilli[18240]: redir.c: 3462:

invalid file extension! [wwwroot/apkupdate.php] Feb 15 20:44:19 Openwrt
local6.err coova-chilli[18243]: redir.c: 3462:

invalid file extension! [wwwroot/xmlupdate.php] ...

Feb 15 20:44:42 Openwrt local6.err coova-chilli[18283]: redir.c: 3462:

invalid file extension! [getTasklist.php] Feb 15 20:44:42 Openwrt local6.err
coova-chilli[18284]: redir.c: 3462:

invalid file extension! [getAccountNum.php] Feb 15 20:44:46 Openwrt
daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX IEEE 802.11: authenticated
Feb 15 20:44:48 Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX
IEEE 802.11: authenticated Feb 15 20:44:48 Openwrt daemon.info hostapd:
wlan0: STA 8c:84:01:XX:XX:XX IEEE 802.11: associated (aid 3) Feb 15 20:44:48
Openwrt daemon.info hostapd: wlan0: STA 8c:84:01:XX:XX:XX

RADIUS: starting accounting session 0000002F-000001AD Feb 15 20:59:46
Openwrt local6.err coova-chilli[18919]: redir.c: 3462:

invalid file extension! [getTasklist.php] ...

Feb 15 20:59:49 Openwrt local6.err coova-chilli[18923]: redir.c: 3462:

invalid file extension! [getTasklist2.php] ...

 

The "invalid file extension" instances, if which there are a couple dozen,
are only a few seconds apart.  The URL parts like "getTasklist.php" and
"getAccountNum.php" seem to suggest whatever the client is doing (i.e.

hammering the chilli agent with lots of bogus port 80 requests) is abusive.
These log messages did coincide with this particular Nanostation verging on
unresponsive, although I didn't get a chance to run "top" or "uptime" before
needing to force a reboot.

 

Besides simply blocking this particular MAC from associating, are the other
measures to ward off intrusions like this?

 

--

Ben West

http://gowasabi.net

ben at gowasabi.net <mailto:ben at gowasabi.net> 

314-246-9434

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150216/56138eb4/attachment.html>

From krishnanvr4u at gmail.com  Mon Feb 16 14:24:06 2015
From: krishnanvr4u at gmail.com (Krishnan V R)
Date: Mon, 16 Feb 2015 19:54:06 +0530
Subject: [Chilli] How to adjust the wall garden with Access-Reject from
	radius.
Message-ID: <CAHc8OCcFtX7Jzmw+Np6GLAc1O-u--E6w3hd7jj7VoR2ZpVdFnQ@mail.gmail.com>

Hi,

       While providing the solution for the query mentioned in the
below URL, David suggested the below point.

"You can adjust the walled garden on a per device/session basis with
RADIUS attributes returned in an Access-Reject or by a CoA RADIUS
request."

https://www.linkedin.com/groups/Coova-chilli-facebook-login-158903.S.248435360


       I have the similar requirement. Please can any one tell me how
to adjust the wall garden with RADIUS attributes returned in an
Access-Reject. Please can you specify some link.

Thanks & Regards
Krishnan

From ricklee077 at gmail.com  Tue Feb 17 15:42:26 2015
From: ricklee077 at gmail.com (rick lee)
Date: Tue, 17 Feb 2015 21:12:26 +0530
Subject: [Chilli] Wall garden.
Message-ID: <CAFVGs6v2Bnks6GZiG=1_TnQZKLG95AxAHqS-WNOR+_tTOSWqpw@mail.gmail.com>

Hi,

      I have a query. Suppose I have added www.xyz.com in uamallowed.
When the user gets authenticated and request for www.xyz.com, will the
wall garden module of chilli handle the request or the request doesn't
reach the wall garden module at all?


Thanks
Rick

From dbird at google.com  Tue Feb 17 17:47:37 2015
From: dbird at google.com (David Bird)
Date: Tue, 17 Feb 2015 09:47:37 -0800
Subject: [Chilli] Access to the resource based on user.
In-Reply-To: <CAHc8OCeNkpiOK8R+uHDNuRiXD0+7pfBWnkngz0rU5AZ0uqHjbQ@mail.gmail.com>
References: <CAHc8OCfSBaUbOq6tzV8LLqtf-Z4s15DRF40yKh3UmEwLUdLQyA@mail.gmail.com>
 <CADo9JyX+7HA+iDFrksOE-3isQ1tBfxevpPCXyAvBPS-41SEhiQ@mail.gmail.com>
 <CAHc8OCeNkpiOK8R+uHDNuRiXD0+7pfBWnkngz0rU5AZ0uqHjbQ@mail.gmail.com>
Message-ID: <CADo9JyVSFkjT0=Wx7USGS88nZSGHHmmAZtJXiz=PGAKA7RKmuw@mail.gmail.com>

You can send back an Access-Reject with ChilliSpot-Config attribute(s) that
can contain uamallowed=...

You do need to compile with --enable-sessgarden

On Sun, Feb 15, 2015 at 11:25 PM, Krishnan V R <krishnanvr4u at gmail.com>
wrote:

> Sir,
>
>          Please can you explain your reply little further.
>
> On Thu, Feb 12, 2015 at 1:56 AM, David Bird <dbird at google.com> wrote:
> > For the more restrictive login, what you can do it return an
> Access-Reject
> > with additional walled garden entries for that station -- so, not full
> > access, but you can add resources to the garden based on ip and/or port.
> >
> > On Wed, Feb 11, 2015 at 6:57 AM, Krishnan V R <krishnanvr4u at gmail.com>
> > wrote:
> >>
> >> Hi,
> >>
> >>         I am using coova-chilli and freeradius.
> >>
> >>         I have user A and B. I am treating internet and a audio stream
> >> from a local PC as two different resource.
> >>
> >>        When user A logs-in, he can access only to internet. When B
> >> logs-in, he can access only to the audio stream. I am planning to
> >> implement this requirement using the iptables in the conup.sh based on
> >> username. I am new to iptables and coova chilli. Please can you
> >> confirm if it is possible.
> >>
> >>       I have one more requirement where user A have logged in and want
> >> the access the audio stream also. Is it possible using coova
> >> chilli/freeradius?
> >>
> >>        Please let me know if the requirements are not clear.
> >>
> >> Thanks in advance.
> >> Krishnan
> >> _______________________________________________
> >> Chilli mailing list
> >> Chilli at coova.org
> >> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150217/21d1f622/attachment.html>

From andrew at polkaspots.com  Thu Feb 19 13:00:16 2015
From: andrew at polkaspots.com (andrew@PolkaSpots.com)
Date: Thu, 19 Feb 2015 13:00:16 +0000
Subject: [Chilli] Chilli Multiple processes on OpenWRT
In-Reply-To: <CADo9JyVSFkjT0=Wx7USGS88nZSGHHmmAZtJXiz=PGAKA7RKmuw@mail.gmail.com>
References: <CAHc8OCfSBaUbOq6tzV8LLqtf-Z4s15DRF40yKh3UmEwLUdLQyA@mail.gmail.com>
 <CADo9JyX+7HA+iDFrksOE-3isQ1tBfxevpPCXyAvBPS-41SEhiQ@mail.gmail.com>
 <CAHc8OCeNkpiOK8R+uHDNuRiXD0+7pfBWnkngz0rU5AZ0uqHjbQ@mail.gmail.com>
 <CADo9JyVSFkjT0=Wx7USGS88nZSGHHmmAZtJXiz=PGAKA7RKmuw@mail.gmail.com>
Message-ID: <54E5DE60.8000701@polkaspots.com>

Hi guys,

Question 1)
Is this a normal behavior of chilli? Seeing multiple Processes?
Some of the have the same PID.
There are times when I'm seeing 8-10 process.

CoovaChilli 1.2.9 on OpenWRT BB.


15902 14074 root     S     6544  11%   0% /usr/sbin/chilli
15910 14074 root     S     6544  11%   0% /usr/sbin/chilli
14074         1 root     S     6328  10%   0% /usr/sbin/chilli

Question 2)

Sometimes I get redirect loops on the external captive portal.
Going into the issue, it looks like sometimes the Walled Gardens are not 
resolved.
Is this something that you have seen as well?

Cheers,
Andrew

From andrew at polkaspots.com  Thu Feb 19 13:00:33 2015
From: andrew at polkaspots.com (andrew@PolkaSpots.com)
Date: Thu, 19 Feb 2015 13:00:33 +0000
Subject: [Chilli] Chilli Multiple processes on OpenWRT
In-Reply-To: <CADo9JyVSFkjT0=Wx7USGS88nZSGHHmmAZtJXiz=PGAKA7RKmuw@mail.gmail.com>
References: <CAHc8OCfSBaUbOq6tzV8LLqtf-Z4s15DRF40yKh3UmEwLUdLQyA@mail.gmail.com>
 <CADo9JyX+7HA+iDFrksOE-3isQ1tBfxevpPCXyAvBPS-41SEhiQ@mail.gmail.com>
 <CAHc8OCeNkpiOK8R+uHDNuRiXD0+7pfBWnkngz0rU5AZ0uqHjbQ@mail.gmail.com>
 <CADo9JyVSFkjT0=Wx7USGS88nZSGHHmmAZtJXiz=PGAKA7RKmuw@mail.gmail.com>
Message-ID: <54E5DE71.50403@polkaspots.com>

Hi guys,

Question 1)
Is this a normal behavior of chilli? Seeing multiple Processes?
Some of the have the same PID.
There are times when I'm seeing 8-10 process.

CoovaChilli 1.2.9 on OpenWRT BB.


15902 14074 root     S     6544  11%   0% /usr/sbin/chilli
15910 14074 root     S     6544  11%   0% /usr/sbin/chilli
14074         1 root     S     6328  10%   0% /usr/sbin/chilli

Question 2)

Sometimes I get redirect loops on the external captive portal.
Going into the issue, it looks like sometimes the Walled Gardens are not 
resolved.
Is this something that you have seen as well?

Cheers,
Andrew

From kl522 at yahoo.com  Sun Feb 22 02:21:53 2015
From: kl522 at yahoo.com (kl)
Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
Subject: [Chilli] Too sharp upload bandwidth limit on 1gbps wired network
Message-ID: <122480453.6349415.1424571713923.JavaMail.yahoo@mail.yahoo.com>



Nobody is facing this issue with coova chilli ?

http://www.coova.org/node/5171

https://github.com/coova/coova-chilli/issues/32

Happens only on Gigabit wired network and certain kernel verson. Applies to 1.2.9, 1.3.0 and other versions ....

From danny at sb-ps.ae  Mon Feb 23 07:13:28 2015
From: danny at sb-ps.ae (Danny Magat)
Date: Mon, 23 Feb 2015 11:13:28 +0400
Subject: [Chilli] Chilli Digest, Vol 63, Issue 12
In-Reply-To: <mailman.1.1424606402.13115.chilli@coova.org>
References: <mailman.1.1424606402.13115.chilli@coova.org>
Message-ID: <003901d04f38$3961fbb0$ac25f310$@sb-ps.ae>

This problem is still exist on my setup.
http://lists.coova.org/pipermail/chilli/2013-November/002437.html

I hope that somebody will give us a hint on how to solve this.

Regards,
Danny

-----Original Message-----
From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On Behalf
Of chilli-request at coova.org
Sent: Sunday, February 22, 2015 4:00 PM
To: chilli at coova.org
Subject: Chilli Digest, Vol 63, Issue 12

Send Chilli mailing list submissions to
	chilli at coova.org

To subscribe or unsubscribe via the World Wide Web, visit
	http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
or, via email, send a message with subject or body 'help' to
	chilli-request at coova.org

You can reach the person managing the list at
	chilli-owner at coova.org

When replying, please edit your Subject line so it is more specific than
"Re: Contents of Chilli digest..."


Today's Topics:

   1. Too sharp upload bandwidth limit on 1gbps wired network (kl)


----------------------------------------------------------------------

Message: 1
Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
From: kl <kl522 at yahoo.com>
To: Chilli List <chilli at coova.org>
Subject: [Chilli] Too sharp upload bandwidth limit on 1gbps wired
	network
Message-ID:
	<122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com>
Content-Type: text/plain; charset=UTF-8



Nobody is facing this issue with coova chilli ?

http://www.coova.org/node/5171

https://github.com/coova/coova-chilli/issues/32

Happens only on Gigabit wired network and certain kernel verson. Applies to
1.2.9, 1.3.0 and other versions ....


------------------------------

_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


End of Chilli Digest, Vol 63, Issue 12
**************************************



From kl522 at yahoo.com  Mon Feb 23 07:59:43 2015
From: kl522 at yahoo.com (kl)
Date: Mon, 23 Feb 2015 07:59:43 +0000 (UTC)
Subject: [Chilli] Chilli Digest, Vol 63, Issue 12
In-Reply-To: <003901d04f38$3961fbb0$ac25f310$@sb-ps.ae>
References: <003901d04f38$3961fbb0$ac25f310$@sb-ps.ae>
Message-ID: <179401493.7495677.1424678383836.JavaMail.yahoo@mail.yahoo.com>

I see problem on kernel version > 3.7 right up to 3.10.  Above 3.10 not tested.
However, in the other quoted post, it says kernel 2.6.39 upto 3.3.4. Above that not tested.
Something not consist here.

So which kernel version you guys are using which are seeing this problem ?


On Monday, February 23, 2015 3:13 PM, Danny Magat <danny at sb-ps.ae> wrote:
This problem is still exist on my setup.
http://lists.coova.org/pipermail/chilli/2013-November/002437.html

I hope that somebody will give us a hint on how to solve this.

Regards,
Danny

-----Original Message-----
From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On Behalf
Of chilli-request at coova.org
Sent: Sunday, February 22, 2015 4:00 PM
To: chilli at coova.org
Subject: Chilli Digest, Vol 63, Issue 12

Send Chilli mailing list submissions to
    chilli at coova.org

To subscribe or unsubscribe via the World Wide Web, visit
    http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
or, via email, send a message with subject or body 'help' to
    chilli-request at coova.org

You can reach the person managing the list at
    chilli-owner at coova.org

When replying, please edit your Subject line so it is more specific than
"Re: Contents of Chilli digest..."


Today's Topics:

   1. Too sharp upload bandwidth limit on 1gbps wired network (kl)


----------------------------------------------------------------------

Message: 1
Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
From: kl <kl522 at yahoo.com>
To: Chilli List <chilli at coova.org>
Subject: [Chilli] Too sharp upload bandwidth limit on 1gbps wired
    network
Message-ID:
    <122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com>
Content-Type: text/plain; charset=UTF-8



Nobody is facing this issue with coova chilli ?

http://www.coova.org/node/5171

https://github.com/coova/coova-chilli/issues/32

Happens only on Gigabit wired network and certain kernel verson. Applies to
1.2.9, 1.3.0 and other versions ....


------------------------------

_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


End of Chilli Digest, Vol 63, Issue 12
**************************************


_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli

From richard at rexy.fr  Wed Feb 25 21:48:56 2015
From: richard at rexy.fr (Richard REY)
Date: Wed, 25 Feb 2015 22:48:56 +0100
Subject: [Chilli] Chilli Digest, Vol 63, Issue 12
In-Reply-To: <179401493.7495677.1424678383836.JavaMail.yahoo@mail.yahoo.com>
References: <003901d04f38$3961fbb0$ac25f310$@sb-ps.ae>
 <179401493.7495677.1424678383836.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <54EE4348.2090503@rexy.fr>

Hi,
I use COOVA in its last version (SVN revision 492) running on an ALCASAR 
appliance (mageia 4.1 - kernel 3.14.32), all is OK excepted a flow issue.
When a TCP stream goes across the appliance there isn't any flow issue 
(forward mode). BUT when a TCP stream is sent inside the appliance (to a 
HTTP proxy for example) the observed flow is very weak (Input mode). The 
problem is maximal when the card connected to COOVA is in the Gigabit mode.

Our investigation :
 From the appliance, we try to download a file located on a FTP server 
connected on the network controlled by COOVA. Without COOVA the observed 
flow in gigabit mode is about 888Mb/s whereas with COOVA we can see just 
68 Kb/s (YES 68 Kb/s). Regarding the packets exchanged we can see ICMP 
packets sent by the appliance (Destination unreachable (Fragmentation 
needed).
We found a by-pass ?solution? by fixing the speed of the card to 
100Mb/s. At this speed the phenomenon is practically invisible (just one 
ICMP packet sent) and the flow approaches the maximum supported by the 
network card. On a virtual machine where we can't fix Ethernet speed, we 
must choose a 100Mb/s virtual Ethernet card when building the VM.
We have the Pcap file of our investigation. I say it again, this issue 
is seen only when the TCP flows is sent to an internal processes (in 
'forward' mode all is ok).

Regards
Rexy & ALCASAR team

Le 23/02/2015 08:59, kl a ?crit :
> I see problem on kernel version > 3.7 right up to 3.10.  Above 3.10 not tested.
> However, in the other quoted post, it says kernel 2.6.39 upto 3.3.4. Above that not tested.
> Something not consist here.
>
> So which kernel version you guys are using which are seeing this problem ?
>
>
> On Monday, February 23, 2015 3:13 PM, Danny Magat <danny at sb-ps.ae> wrote:
> This problem is still exist on my setup.
> http://lists.coova.org/pipermail/chilli/2013-November/002437.html
>
> I hope that somebody will give us a hint on how to solve this.
>
> Regards,
> Danny
>
> -----Original Message-----
> From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On Behalf
> Of chilli-request at coova.org
> Sent: Sunday, February 22, 2015 4:00 PM
> To: chilli at coova.org
> Subject: Chilli Digest, Vol 63, Issue 12
>
> Send Chilli mailing list submissions to
>      chilli at coova.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>      http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> or, via email, send a message with subject or body 'help' to
>      chilli-request at coova.org
>
> You can reach the person managing the list at
>      chilli-owner at coova.org
>
> When replying, please edit your Subject line so it is more specific than
> "Re: Contents of Chilli digest..."
>
>
> Today's Topics:
>
>     1. Too sharp upload bandwidth limit on 1gbps wired network (kl)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
> From: kl <kl522 at yahoo.com>
> To: Chilli List <chilli at coova.org>
> Subject: [Chilli] Too sharp upload bandwidth limit on 1gbps wired
>      network
> Message-ID:
>      <122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com>
> Content-Type: text/plain; charset=UTF-8
>
>
>
> Nobody is facing this issue with coova chilli ?
>
> http://www.coova.org/node/5171
>
> https://github.com/coova/coova-chilli/issues/32
>
> Happens only on Gigabit wired network and certain kernel verson. Applies to
> 1.2.9, 1.3.0 and other versions ....
>
>
> ------------------------------
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
> End of Chilli Digest, Vol 63, Issue 12
> **************************************
>
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>

From claus.stjernoe at nomadrail.com  Thu Feb 26 12:30:33 2015
From: claus.stjernoe at nomadrail.com (Claus Stjernoe)
Date: Thu, 26 Feb 2015 12:30:33 +0000
Subject: [Chilli] Chilli Digest, Vol 63, Issue 14
In-Reply-To: <mailman.1.1424952002.815.chilli@coova.org>
References: <mailman.1.1424952002.815.chilli@coova.org>
Message-ID: <AM2PR05MB0788EC067BEB3D13B821844492140@AM2PR05MB0788.eurprd05.prod.outlook.com>

Hi Richard,

Try to disable packet off-loading on the Gigabit NIC.

Kind regards,
Claus

-----Oprindelig meddelelse-----
Fra: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] P? vegne af chilli-request at coova.org
Sendt: 26. februar 2015 13:00
Til: chilli at coova.org
Emne: Chilli Digest, Vol 63, Issue 14

Send Chilli mailing list submissions to
	chilli at coova.org

To subscribe or unsubscribe via the World Wide Web, visit
	http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
or, via email, send a message with subject or body 'help' to
	chilli-request at coova.org

You can reach the person managing the list at
	chilli-owner at coova.org

When replying, please edit your Subject line so it is more specific than "Re: Contents of Chilli digest..."


Today's Topics:

   1. Re: Chilli Digest, Vol 63, Issue 12 (Richard REY)


----------------------------------------------------------------------

Message: 1
Date: Wed, 25 Feb 2015 22:48:56 +0100
From: Richard REY <richard at rexy.fr>
To: chilli at coova.org
Subject: Re: [Chilli] Chilli Digest, Vol 63, Issue 12
Message-ID: <54EE4348.2090503 at rexy.fr>
Content-Type: text/plain; charset=windows-1252; format=flowed

Hi,
I use COOVA in its last version (SVN revision 492) running on an ALCASAR appliance (mageia 4.1 - kernel 3.14.32), all is OK excepted a flow issue.
When a TCP stream goes across the appliance there isn't any flow issue (forward mode). BUT when a TCP stream is sent inside the appliance (to a HTTP proxy for example) the observed flow is very weak (Input mode). The problem is maximal when the card connected to COOVA is in the Gigabit mode.

Our investigation :
 From the appliance, we try to download a file located on a FTP server connected on the network controlled by COOVA. Without COOVA the observed flow in gigabit mode is about 888Mb/s whereas with COOVA we can see just
68 Kb/s (YES 68 Kb/s). Regarding the packets exchanged we can see ICMP packets sent by the appliance (Destination unreachable (Fragmentation needed).
We found a by-pass ?solution? by fixing the speed of the card to 100Mb/s. At this speed the phenomenon is practically invisible (just one ICMP packet sent) and the flow approaches the maximum supported by the network card. On a virtual machine where we can't fix Ethernet speed, we must choose a 100Mb/s virtual Ethernet card when building the VM.
We have the Pcap file of our investigation. I say it again, this issue is seen only when the TCP flows is sent to an internal processes (in 'forward' mode all is ok).

Regards
Rexy & ALCASAR team

Le 23/02/2015 08:59, kl a ?crit :
> I see problem on kernel version > 3.7 right up to 3.10.  Above 3.10 not tested.
> However, in the other quoted post, it says kernel 2.6.39 upto 3.3.4. Above that not tested.
> Something not consist here.
>
> So which kernel version you guys are using which are seeing this problem ?
>
>
> On Monday, February 23, 2015 3:13 PM, Danny Magat <danny at sb-ps.ae> wrote:
> This problem is still exist on my setup.
> http://lists.coova.org/pipermail/chilli/2013-November/002437.html
>
> I hope that somebody will give us a hint on how to solve this.
>
> Regards,
> Danny
>
> -----Original Message-----
> From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On 
> Behalf Of chilli-request at coova.org
> Sent: Sunday, February 22, 2015 4:00 PM
> To: chilli at coova.org
> Subject: Chilli Digest, Vol 63, Issue 12
>
> Send Chilli mailing list submissions to
>      chilli at coova.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>      http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> or, via email, send a message with subject or body 'help' to
>      chilli-request at coova.org
>
> You can reach the person managing the list at
>      chilli-owner at coova.org
>
> When replying, please edit your Subject line so it is more specific 
> than
> "Re: Contents of Chilli digest..."
>
>
> Today's Topics:
>
>     1. Too sharp upload bandwidth limit on 1gbps wired network (kl)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
> From: kl <kl522 at yahoo.com>
> To: Chilli List <chilli at coova.org>
> Subject: [Chilli] Too sharp upload bandwidth limit on 1gbps wired
>      network
> Message-ID:
>      <122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com>
> Content-Type: text/plain; charset=UTF-8
>
>
>
> Nobody is facing this issue with coova chilli ?
>
> http://www.coova.org/node/5171
>
> https://github.com/coova/coova-chilli/issues/32
>
> Happens only on Gigabit wired network and certain kernel verson. 
> Applies to 1.2.9, 1.3.0 and other versions ....
>
>
> ------------------------------
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
> End of Chilli Digest, Vol 63, Issue 12
> **************************************
>
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>


------------------------------

_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli


End of Chilli Digest, Vol 63, Issue 14
**************************************

From alghe.global at gmail.com  Fri Feb 27 19:50:36 2015
From: alghe.global at gmail.com (Alexandru Gheorghe)
Date: Fri, 27 Feb 2015 21:50:36 +0200
Subject: [Chilli] Chilli Digest, Vol 63, Issue 14
In-Reply-To: <AM2PR05MB0788EC067BEB3D13B821844492140@AM2PR05MB0788.eurprd05.prod.outlook.com>
References: <mailman.1.1424952002.815.chilli@coova.org>
 <AM2PR05MB0788EC067BEB3D13B821844492140@AM2PR05MB0788.eurprd05.prod.outlook.com>
Message-ID: <54F0CA8C.8020901@gmail.com>

Usually fragmentation needed means you need to adjust the MTU of your nic.

Alex


On 02/26/2015 02:30 PM, Claus Stjernoe wrote:
> Hi Richard,
>
> Try to disable packet off-loading on the Gigabit NIC.
>
> Kind regards,
> Claus
>
> -----Oprindelig meddelelse-----
> Fra: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] P? vegne af chilli-request at coova.org
> Sendt: 26. februar 2015 13:00
> Til: chilli at coova.org
> Emne: Chilli Digest, Vol 63, Issue 14
>
> Send Chilli mailing list submissions to
> 	chilli at coova.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
> 	http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
> or, via email, send a message with subject or body 'help' to
> 	chilli-request at coova.org
>
> You can reach the person managing the list at
> 	chilli-owner at coova.org
>
> When replying, please edit your Subject line so it is more specific than "Re: Contents of Chilli digest..."
>
>
> Today's Topics:
>
>    1. Re: Chilli Digest, Vol 63, Issue 12 (Richard REY)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Wed, 25 Feb 2015 22:48:56 +0100
> From: Richard REY <richard at rexy.fr>
> To: chilli at coova.org
> Subject: Re: [Chilli] Chilli Digest, Vol 63, Issue 12
> Message-ID: <54EE4348.2090503 at rexy.fr>
> Content-Type: text/plain; charset=windows-1252; format=flowed
>
> Hi,
> I use COOVA in its last version (SVN revision 492) running on an ALCASAR appliance (mageia 4.1 - kernel 3.14.32), all is OK excepted a flow issue.
> When a TCP stream goes across the appliance there isn't any flow issue (forward mode). BUT when a TCP stream is sent inside the appliance (to a HTTP proxy for example) the observed flow is very weak (Input mode). The problem is maximal when the card connected to COOVA is in the Gigabit mode.
>
> Our investigation :
>  From the appliance, we try to download a file located on a FTP server connected on the network controlled by COOVA. Without COOVA the observed flow in gigabit mode is about 888Mb/s whereas with COOVA we can see just
> 68 Kb/s (YES 68 Kb/s). Regarding the packets exchanged we can see ICMP packets sent by the appliance (Destination unreachable (Fragmentation needed).
> We found a by-pass ?solution? by fixing the speed of the card to 100Mb/s. At this speed the phenomenon is practically invisible (just one ICMP packet sent) and the flow approaches the maximum supported by the network card. On a virtual machine where we can't fix Ethernet speed, we must choose a 100Mb/s virtual Ethernet card when building the VM.
> We have the Pcap file of our investigation. I say it again, this issue is seen only when the TCP flows is sent to an internal processes (in 'forward' mode all is ok).
>
> Regards
> Rexy & ALCASAR team
>
> Le 23/02/2015 08:59, kl a ?crit :
>> I see problem on kernel version > 3.7 right up to 3.10.  Above 3.10 not tested.
>> However, in the other quoted post, it says kernel 2.6.39 upto 3.3.4. Above that not tested.
>> Something not consist here.
>>
>> So which kernel version you guys are using which are seeing this problem ?
>>
>>
>> On Monday, February 23, 2015 3:13 PM, Danny Magat <danny at sb-ps.ae> wrote:
>> This problem is still exist on my setup.
>> http://lists.coova.org/pipermail/chilli/2013-November/002437.html
>>
>> I hope that somebody will give us a hint on how to solve this.
>>
>> Regards,
>> Danny
>>
>> -----Original Message-----
>> From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On 
>> Behalf Of chilli-request at coova.org
>> Sent: Sunday, February 22, 2015 4:00 PM
>> To: chilli at coova.org
>> Subject: Chilli Digest, Vol 63, Issue 12
>>
>> Send Chilli mailing list submissions to
>>      chilli at coova.org
>>
>> To subscribe or unsubscribe via the World Wide Web, visit
>>      http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>> or, via email, send a message with subject or body 'help' to
>>      chilli-request at coova.org
>>
>> You can reach the person managing the list at
>>      chilli-owner at coova.org
>>
>> When replying, please edit your Subject line so it is more specific 
>> than
>> "Re: Contents of Chilli digest..."
>>
>>
>> Today's Topics:
>>
>>     1. Too sharp upload bandwidth limit on 1gbps wired network (kl)
>>
>>
>> ----------------------------------------------------------------------
>>
>> Message: 1
>> Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
>> From: kl <kl522 at yahoo.com>
>> To: Chilli List <chilli at coova.org>
>> Subject: [Chilli] Too sharp upload bandwidth limit on 1gbps wired
>>      network
>> Message-ID:
>>      <122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com>
>> Content-Type: text/plain; charset=UTF-8
>>
>>
>>
>> Nobody is facing this issue with coova chilli ?
>>
>> http://www.coova.org/node/5171
>>
>> https://github.com/coova/coova-chilli/issues/32
>>
>> Happens only on Gigabit wired network and certain kernel verson. 
>> Applies to 1.2.9, 1.3.0 and other versions ....
>>
>>
>> ------------------------------
>>
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>
>>
>> End of Chilli Digest, Vol 63, Issue 12
>> **************************************
>>
>>
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>
>
> ------------------------------
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
> End of Chilli Digest, Vol 63, Issue 14
> **************************************
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli

-- 
; Alexandru Gheorghe
; alghe.global {at} gmail {dot} com
; OpenPGP key ID 0xCAF985D2


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 836 bytes
Desc: OpenPGP digital signature
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150227/83417a5a/attachment.pgp>

From richard at rexy.fr  Fri Feb 27 22:00:54 2015
From: richard at rexy.fr (Richard REY)
Date: Fri, 27 Feb 2015 23:00:54 +0100
Subject: [Chilli] Chilli Digest, Vol 63, Issue 14
In-Reply-To: <54F0CA8C.8020901@gmail.com>
References: <mailman.1.1424952002.815.chilli@coova.org>
 <AM2PR05MB0788EC067BEB3D13B821844492140@AM2PR05MB0788.eurprd05.prod.outlook.com>
 <54F0CA8C.8020901@gmail.com>
Message-ID: <54F0E916.9060702@rexy.fr>

Yes, but this doesn't explain why there isn't any problem when the flows 
pass through the appliance. this issue is seen only when the TCP flows 
is sent to an internal processes

I'll try to disable packet off-loading next monday.
I'll also try to forbid the "jumbo frame" on NIC

Rexy

Le 27/02/2015 20:50, Alexandru Gheorghe a ?crit :
> Usually fragmentation needed means you need to adjust the MTU of your nic.
>
> Alex
>
>
> On 02/26/2015 02:30 PM, Claus Stjernoe wrote:
>> Hi Richard,
>>
>> Try to disable packet off-loading on the Gigabit NIC.
>>
>> Kind regards,
>> Claus
>>
>> -----Oprindelig meddelelse-----
>> Fra: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] P? vegne af chilli-request at coova.org
>> Sendt: 26. februar 2015 13:00
>> Til: chilli at coova.org
>> Emne: Chilli Digest, Vol 63, Issue 14
>>
>> Send Chilli mailing list submissions to
>> 	chilli at coova.org
>>
>> To subscribe or unsubscribe via the World Wide Web, visit
>> 	http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>> or, via email, send a message with subject or body 'help' to
>> 	chilli-request at coova.org
>>
>> You can reach the person managing the list at
>> 	chilli-owner at coova.org
>>
>> When replying, please edit your Subject line so it is more specific than "Re: Contents of Chilli digest..."
>>
>>
>> Today's Topics:
>>
>>     1. Re: Chilli Digest, Vol 63, Issue 12 (Richard REY)
>>
>>
>> ----------------------------------------------------------------------
>>
>> Message: 1
>> Date: Wed, 25 Feb 2015 22:48:56 +0100
>> From: Richard REY <richard at rexy.fr>
>> To: chilli at coova.org
>> Subject: Re: [Chilli] Chilli Digest, Vol 63, Issue 12
>> Message-ID: <54EE4348.2090503 at rexy.fr>
>> Content-Type: text/plain; charset=windows-1252; format=flowed
>>
>> Hi,
>> I use COOVA in its last version (SVN revision 492) running on an ALCASAR appliance (mageia 4.1 - kernel 3.14.32), all is OK excepted a flow issue.
>> When a TCP stream goes across the appliance there isn't any flow issue (forward mode). BUT when a TCP stream is sent inside the appliance (to a HTTP proxy for example) the observed flow is very weak (Input mode). The problem is maximal when the card connected to COOVA is in the Gigabit mode.
>>
>> Our investigation :
>>   From the appliance, we try to download a file located on a FTP server connected on the network controlled by COOVA. Without COOVA the observed flow in gigabit mode is about 888Mb/s whereas with COOVA we can see just
>> 68 Kb/s (YES 68 Kb/s). Regarding the packets exchanged we can see ICMP packets sent by the appliance (Destination unreachable (Fragmentation needed).
>> We found a by-pass ?solution? by fixing the speed of the card to 100Mb/s. At this speed the phenomenon is practically invisible (just one ICMP packet sent) and the flow approaches the maximum supported by the network card. On a virtual machine where we can't fix Ethernet speed, we must choose a 100Mb/s virtual Ethernet card when building the VM.
>> We have the Pcap file of our investigation. I say it again, this issue is seen only when the TCP flows is sent to an internal processes (in 'forward' mode all is ok).
>>
>> Regards
>> Rexy & ALCASAR team
>>
>> Le 23/02/2015 08:59, kl a ?crit :
>>> I see problem on kernel version > 3.7 right up to 3.10.  Above 3.10 not tested.
>>> However, in the other quoted post, it says kernel 2.6.39 upto 3.3.4. Above that not tested.
>>> Something not consist here.
>>>
>>> So which kernel version you guys are using which are seeing this problem ?
>>>
>>>
>>> On Monday, February 23, 2015 3:13 PM, Danny Magat <danny at sb-ps.ae> wrote:
>>> This problem is still exist on my setup.
>>> http://lists.coova.org/pipermail/chilli/2013-November/002437.html
>>>
>>> I hope that somebody will give us a hint on how to solve this.
>>>
>>> Regards,
>>> Danny
>>>
>>> -----Original Message-----
>>> From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On
>>> Behalf Of chilli-request at coova.org
>>> Sent: Sunday, February 22, 2015 4:00 PM
>>> To: chilli at coova.org
>>> Subject: Chilli Digest, Vol 63, Issue 12
>>>
>>> Send Chilli mailing list submissions to
>>>       chilli at coova.org
>>>
>>> To subscribe or unsubscribe via the World Wide Web, visit
>>>       http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>> or, via email, send a message with subject or body 'help' to
>>>       chilli-request at coova.org
>>>
>>> You can reach the person managing the list at
>>>       chilli-owner at coova.org
>>>
>>> When replying, please edit your Subject line so it is more specific
>>> than
>>> "Re: Contents of Chilli digest..."
>>>
>>>
>>> Today's Topics:
>>>
>>>      1. Too sharp upload bandwidth limit on 1gbps wired network (kl)
>>>
>>>
>>> ----------------------------------------------------------------------
>>>
>>> Message: 1
>>> Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
>>> From: kl <kl522 at yahoo.com>
>>> To: Chilli List <chilli at coova.org>
>>> Subject: [Chilli] Too sharp upload bandwidth limit on 1gbps wired
>>>       network
>>> Message-ID:
>>>       <122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com>
>>> Content-Type: text/plain; charset=UTF-8
>>>
>>>
>>>
>>> Nobody is facing this issue with coova chilli ?
>>>
>>> http://www.coova.org/node/5171
>>>
>>> https://github.com/coova/coova-chilli/issues/32
>>>
>>> Happens only on Gigabit wired network and certain kernel verson.
>>> Applies to 1.2.9, 1.3.0 and other versions ....
>>>
>>>
>>> ------------------------------
>>>
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>
>>>
>>> End of Chilli Digest, Vol 63, Issue 12
>>> **************************************
>>>
>>>
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>
>>
>> ------------------------------
>>
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>
>>
>> End of Chilli Digest, Vol 63, Issue 14
>> **************************************
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>

From dbird at google.com  Sat Feb 28 00:28:01 2015
From: dbird at google.com (David Bird)
Date: Fri, 27 Feb 2015 16:28:01 -0800
Subject: [Chilli] Chilli Digest, Vol 63, Issue 14
In-Reply-To: <54F0E916.9060702@rexy.fr>
References: <mailman.1.1424952002.815.chilli@coova.org>
 <AM2PR05MB0788EC067BEB3D13B821844492140@AM2PR05MB0788.eurprd05.prod.outlook.com>
 <54F0CA8C.8020901@gmail.com> <54F0E916.9060702@rexy.fr>
Message-ID: <CADo9JyUmqR8MB6QVi6Nv_OPuEqfDAMfp1xbijD5gKqXSox=chg@mail.gmail.com>

You can use --tcpmss to clamp the TCP MSS. But, I agree, your issue is very
likely gso related. Something like "sudo ethtool -K eth1 gro off"

On Fri, Feb 27, 2015 at 2:00 PM, Richard REY <richard at rexy.fr> wrote:

> Yes, but this doesn't explain why there isn't any problem when the flows
> pass through the appliance. this issue is seen only when the TCP flows is
> sent to an internal processes
>
> I'll try to disable packet off-loading next monday.
> I'll also try to forbid the "jumbo frame" on NIC
>
> Rexy
>
> Le 27/02/2015 20:50, Alexandru Gheorghe a ?crit :
>
>  Usually fragmentation needed means you need to adjust the MTU of your nic.
>>
>> Alex
>>
>>
>> On 02/26/2015 02:30 PM, Claus Stjernoe wrote:
>>
>>> Hi Richard,
>>>
>>> Try to disable packet off-loading on the Gigabit NIC.
>>>
>>> Kind regards,
>>> Claus
>>>
>>> -----Oprindelig meddelelse-----
>>> Fra: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] P?
>>> vegne af chilli-request at coova.org
>>> Sendt: 26. februar 2015 13:00
>>> Til: chilli at coova.org
>>> Emne: Chilli Digest, Vol 63, Issue 14
>>>
>>> Send Chilli mailing list submissions to
>>>         chilli at coova.org
>>>
>>> To subscribe or unsubscribe via the World Wide Web, visit
>>>         http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>> or, via email, send a message with subject or body 'help' to
>>>         chilli-request at coova.org
>>>
>>> You can reach the person managing the list at
>>>         chilli-owner at coova.org
>>>
>>> When replying, please edit your Subject line so it is more specific than
>>> "Re: Contents of Chilli digest..."
>>>
>>>
>>> Today's Topics:
>>>
>>>     1. Re: Chilli Digest, Vol 63, Issue 12 (Richard REY)
>>>
>>>
>>> ----------------------------------------------------------------------
>>>
>>> Message: 1
>>> Date: Wed, 25 Feb 2015 22:48:56 +0100
>>> From: Richard REY <richard at rexy.fr>
>>> To: chilli at coova.org
>>> Subject: Re: [Chilli] Chilli Digest, Vol 63, Issue 12
>>> Message-ID: <54EE4348.2090503 at rexy.fr>
>>> Content-Type: text/plain; charset=windows-1252; format=flowed
>>>
>>> Hi,
>>> I use COOVA in its last version (SVN revision 492) running on an ALCASAR
>>> appliance (mageia 4.1 - kernel 3.14.32), all is OK excepted a flow issue.
>>> When a TCP stream goes across the appliance there isn't any flow issue
>>> (forward mode). BUT when a TCP stream is sent inside the appliance (to a
>>> HTTP proxy for example) the observed flow is very weak (Input mode). The
>>> problem is maximal when the card connected to COOVA is in the Gigabit mode.
>>>
>>> Our investigation :
>>>   From the appliance, we try to download a file located on a FTP server
>>> connected on the network controlled by COOVA. Without COOVA the observed
>>> flow in gigabit mode is about 888Mb/s whereas with COOVA we can see just
>>> 68 Kb/s (YES 68 Kb/s). Regarding the packets exchanged we can see ICMP
>>> packets sent by the appliance (Destination unreachable (Fragmentation
>>> needed).
>>> We found a by-pass ?solution? by fixing the speed of the card to
>>> 100Mb/s. At this speed the phenomenon is practically invisible (just one
>>> ICMP packet sent) and the flow approaches the maximum supported by the
>>> network card. On a virtual machine where we can't fix Ethernet speed, we
>>> must choose a 100Mb/s virtual Ethernet card when building the VM.
>>> We have the Pcap file of our investigation. I say it again, this issue
>>> is seen only when the TCP flows is sent to an internal processes (in
>>> 'forward' mode all is ok).
>>>
>>> Regards
>>> Rexy & ALCASAR team
>>>
>>> Le 23/02/2015 08:59, kl a ?crit :
>>>
>>>> I see problem on kernel version > 3.7 right up to 3.10.  Above 3.10 not
>>>> tested.
>>>> However, in the other quoted post, it says kernel 2.6.39 upto 3.3.4.
>>>> Above that not tested.
>>>> Something not consist here.
>>>>
>>>> So which kernel version you guys are using which are seeing this
>>>> problem ?
>>>>
>>>>
>>>> On Monday, February 23, 2015 3:13 PM, Danny Magat <danny at sb-ps.ae>
>>>> wrote:
>>>> This problem is still exist on my setup.
>>>> http://lists.coova.org/pipermail/chilli/2013-November/002437.html
>>>>
>>>> I hope that somebody will give us a hint on how to solve this.
>>>>
>>>> Regards,
>>>> Danny
>>>>
>>>> -----Original Message-----
>>>> From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On
>>>> Behalf Of chilli-request at coova.org
>>>> Sent: Sunday, February 22, 2015 4:00 PM
>>>> To: chilli at coova.org
>>>> Subject: Chilli Digest, Vol 63, Issue 12
>>>>
>>>> Send Chilli mailing list submissions to
>>>>       chilli at coova.org
>>>>
>>>> To subscribe or unsubscribe via the World Wide Web, visit
>>>>       http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>> or, via email, send a message with subject or body 'help' to
>>>>       chilli-request at coova.org
>>>>
>>>> You can reach the person managing the list at
>>>>       chilli-owner at coova.org
>>>>
>>>> When replying, please edit your Subject line so it is more specific
>>>> than
>>>> "Re: Contents of Chilli digest..."
>>>>
>>>>
>>>> Today's Topics:
>>>>
>>>>      1. Too sharp upload bandwidth limit on 1gbps wired network (kl)
>>>>
>>>>
>>>> ----------------------------------------------------------------------
>>>>
>>>> Message: 1
>>>> Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
>>>> From: kl <kl522 at yahoo.com>
>>>> To: Chilli List <chilli at coova.org>
>>>> Subject: [Chilli] Too sharp upload bandwidth limit on 1gbps wired
>>>>       network
>>>> Message-ID:
>>>>       <122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com>
>>>> Content-Type: text/plain; charset=UTF-8
>>>>
>>>>
>>>>
>>>> Nobody is facing this issue with coova chilli ?
>>>>
>>>> http://www.coova.org/node/5171
>>>>
>>>> https://github.com/coova/coova-chilli/issues/32
>>>>
>>>> Happens only on Gigabit wired network and certain kernel verson.
>>>> Applies to 1.2.9, 1.3.0 and other versions ....
>>>>
>>>>
>>>> ------------------------------
>>>>
>>>> _______________________________________________
>>>> Chilli mailing list
>>>> Chilli at coova.org
>>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>>
>>>>
>>>> End of Chilli Digest, Vol 63, Issue 12
>>>> **************************************
>>>>
>>>>
>>>> _______________________________________________
>>>> Chilli mailing list
>>>> Chilli at coova.org
>>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>> _______________________________________________
>>>> Chilli mailing list
>>>> Chilli at coova.org
>>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>>
>>>>
>>> ------------------------------
>>>
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>
>>>
>>> End of Chilli Digest, Vol 63, Issue 14
>>> **************************************
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>
>>
>>
>>
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>
>>  _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.coova.org/pipermail/chilli/attachments/20150227/0299adfe/attachment-0001.html>

From kl522 at yahoo.com  Sat Feb 28 02:37:02 2015
From: kl522 at yahoo.com (kl)
Date: Sat, 28 Feb 2015 02:37:02 +0000 (UTC)
Subject: [Chilli] Too sharp upload bandwidth limit on 1gbps wired network
In-Reply-To: <54F0E916.9060702@rexy.fr>
References: <54F0E916.9060702@rexy.fr>
Message-ID: <224842392.61573.1425091022824.JavaMail.yahoo@mail.yahoo.com>



Based on my testing, turn off generic receive offload fixes my issue of too sharp upload bandwidth limit on 1 Gb wired network.

But the strange thing is older kernel has the same setting 'on' and without problem, while newer kernel has to turn it 'off'. 


On Saturday, February 28, 2015 6:01 AM, Richard REY <richard at rexy.fr> wrote:
Yes, but this doesn't explain why there isn't any problem when the flows 
pass through the appliance. this issue is seen only when the TCP flows 
is sent to an internal processes

I'll try to disable packet off-loading next monday.
I'll also try to forbid the "jumbo frame" on NIC

Rexy

Le 27/02/2015 20:50, Alexandru Gheorghe a ?crit :
> Usually fragmentation needed means you need to adjust the MTU of your nic.
>
> Alex
>
>
> On 02/26/2015 02:30 PM, Claus Stjernoe wrote:
>> Hi Richard,
>>
>> Try to disable packet off-loading on the Gigabit NIC.
>>
>> Kind regards,
>> Claus
>>
>> -----Oprindelig meddelelse-----
>> Fra: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] P? vegne af chilli-request at coova.org
>> Sendt: 26. februar 2015 13:00
>> Til: chilli at coova.org
>> Emne: Chilli Digest, Vol 63, Issue 14
>>
>> Send Chilli mailing list submissions to
>>     chilli at coova.org
>>
>> To subscribe or unsubscribe via the World Wide Web, visit
>>     http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>> or, via email, send a message with subject or body 'help' to
>>     chilli-request at coova.org
>>
>> You can reach the person managing the list at
>>     chilli-owner at coova.org
>>
>> When replying, please edit your Subject line so it is more specific than "Re: Contents of Chilli digest..."
>>
>>
>> Today's Topics:
>>
>>     1. Re: Chilli Digest, Vol 63, Issue 12 (Richard REY)
>>
>>
>> ----------------------------------------------------------------------
>>
>> Message: 1
>> Date: Wed, 25 Feb 2015 22:48:56 +0100
>> From: Richard REY <richard at rexy.fr>
>> To: chilli at coova.org
>> Subject: Re: [Chilli] Chilli Digest, Vol 63, Issue 12
>> Message-ID: <54EE4348.2090503 at rexy.fr>
>> Content-Type: text/plain; charset=windows-1252; format=flowed
>>
>> Hi,
>> I use COOVA in its last version (SVN revision 492) running on an ALCASAR appliance (mageia 4.1 - kernel 3.14.32), all is OK excepted a flow issue.
>> When a TCP stream goes across the appliance there isn't any flow issue (forward mode). BUT when a TCP stream is sent inside the appliance (to a HTTP proxy for example) the observed flow is very weak (Input mode). The problem is maximal when the card connected to COOVA is in the Gigabit mode.
>>
>> Our investigation :
>>   From the appliance, we try to download a file located on a FTP server connected on the network controlled by COOVA. Without COOVA the observed flow in gigabit mode is about 888Mb/s whereas with COOVA we can see just
>> 68 Kb/s (YES 68 Kb/s). Regarding the packets exchanged we can see ICMP packets sent by the appliance (Destination unreachable (Fragmentation needed).
>> We found a by-pass ?solution? by fixing the speed of the card to 100Mb/s. At this speed the phenomenon is practically invisible (just one ICMP packet sent) and the flow approaches the maximum supported by the network card. On a virtual machine where we can't fix Ethernet speed, we must choose a 100Mb/s virtual Ethernet card when building the VM.
>> We have the Pcap file of our investigation. I say it again, this issue is seen only when the TCP flows is sent to an internal processes (in 'forward' mode all is ok).
>>
>> Regards
>> Rexy & ALCASAR team
>>
>> Le 23/02/2015 08:59, kl a ?crit :
>>> I see problem on kernel version > 3.7 right up to 3.10.  Above 3.10 not tested.
>>> However, in the other quoted post, it says kernel 2.6.39 upto 3.3.4. Above that not tested.
>>> Something not consist here.
>>>
>>> So which kernel version you guys are using which are seeing this problem ?
>>>
>>>
>>> On Monday, February 23, 2015 3:13 PM, Danny Magat <danny at sb-ps.ae> wrote:
>>> This problem is still exist on my setup.
>>> http://lists.coova.org/pipermail/chilli/2013-November/002437.html
>>>
>>> I hope that somebody will give us a hint on how to solve this.
>>>
>>> Regards,
>>> Danny
>>>
>>> -----Original Message-----
>>> From: chilli-bounces at coova.org [mailto:chilli-bounces at coova.org] On
>>> Behalf Of chilli-request at coova.org
>>> Sent: Sunday, February 22, 2015 4:00 PM
>>> To: chilli at coova.org
>>> Subject: Chilli Digest, Vol 63, Issue 12
>>>
>>> Send Chilli mailing list submissions to
>>>      chilli at coova.org
>>>
>>> To subscribe or unsubscribe via the World Wide Web, visit
>>>      http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>> or, via email, send a message with subject or body 'help' to
>>>      chilli-request at coova.org
>>>
>>> You can reach the person managing the list at
>>>      chilli-owner at coova.org
>>>
>>> When replying, please edit your Subject line so it is more specific
>>> than
>>> "Re: Contents of Chilli digest..."
>>>
>>>
>>> Today's Topics:
>>>
>>>      1. Too sharp upload bandwidth limit on 1gbps wired network (kl)
>>>
>>>
>>> ----------------------------------------------------------------------
>>>
>>> Message: 1
>>> Date: Sun, 22 Feb 2015 02:21:53 +0000 (UTC)
>>> From: kl <kl522 at yahoo.com>
>>> To: Chilli List <chilli at coova.org>
>>> Subject: [Chilli] Too sharp upload bandwidth limit on 1gbps wired
>>>       network
>>> Message-ID:
>>>       <122480453.6349415.1424571713923.JavaMail.yahoo at mail.yahoo.com>
>>> Content-Type: text/plain; charset=UTF-8
>>>
>>>
>>>
>>> Nobody is facing this issue with coova chilli ?
>>>
>>> http://www.coova.org/node/5171
>>>
>>> https://github.com/coova/coova-chilli/issues/32
>>>
>>> Happens only on Gigabit wired network and certain kernel verson.
>>> Applies to 1.2.9, 1.3.0 and other versions ....
>>>
>>>
>>> ------------------------------
>>>
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>
>>>
>>> End of Chilli Digest, Vol 63, Issue 12
>>> **************************************
>>>
>>>
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>> _______________________________________________
>>> Chilli mailing list
>>> Chilli at coova.org
>>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>>
>>
>> ------------------------------
>>
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>>
>>
>> End of Chilli Digest, Vol 63, Issue 14

>> **************************************
>> _______________________________________________
>> Chilli mailing list
>> Chilli at coova.org
>> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
>
>
> _______________________________________________
> Chilli mailing list
> Chilli at coova.org
> http://lists.coova.org/cgi-bin/mailman/listinfo/chilli
>
_______________________________________________
Chilli mailing list
Chilli at coova.org
http://lists.coova.org/cgi-bin/mailman/listinfo/chilli

