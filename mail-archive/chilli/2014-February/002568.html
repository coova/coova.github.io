<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Chilli] Coova-Chilli Redirection Problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:chilli%40coova.org?Subject=Re%3A%20%5BChilli%5D%20Coova-Chilli%20Redirection%20Problem&In-Reply-To=%3C52f25eed.810a0f0a.3775.ffff863c%40mx.google.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002567.html">
   <LINK REL="Next"  HREF="002570.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Chilli] Coova-Chilli Redirection Problem</H1>
    <B>Peter Wagner</B> 
    <A HREF="mailto:chilli%40coova.org?Subject=Re%3A%20%5BChilli%5D%20Coova-Chilli%20Redirection%20Problem&In-Reply-To=%3C52f25eed.810a0f0a.3775.ffff863c%40mx.google.com%3E"
       TITLE="[Chilli] Coova-Chilli Redirection Problem">peter.wagner at unwired.at
       </A><BR>
    <I>Wed Feb  5 15:54:41 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="002567.html">[Chilli] Transparent proxy on secondary host
</A></li>
        <LI>Next message: <A HREF="002570.html">[Chilli] Coova-Chilli Redirection Problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2568">[ date ]</a>
              <a href="thread.html#2568">[ thread ]</a>
              <a href="subject.html#2568">[ subject ]</a>
              <a href="author.html#2568">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

i successfully installed Coova-Chilli on Openwrt and it works fine.

Except in a special case:

1) A user opens a webpage like &quot;orf.at&quot; on a mobile device. The device is connected to some other 
wifi network.

2) The user disconnects from the wifi network and connects to my Coova-Chilli wifi network.

3) The user trys to reopen the site (orf.at in this case). And has no authenticated session.
   The expected behaviour would be to get redirected to the captive portal page.

4) Instead, no redirect is sent at all. (see tcpdump - packet #55)

5) User sees the message &quot;Website not available&quot;

6) The user requests the site heisse.de (!= orf.at in this case) (see tcpdump package #402)

7) The redirect is sent and the user is redirected to the captive partal page.

What could be the cause of this problem? I'm using the latest version of Coova-Chilli and use this cmdline options:

/usr/sbin/chilli  -c /etc/chilli.conf --fg --dhcpnotidle
--radiusoriginalurl --lease 300 --pidfile=/var/run/chilli.pid
--definteriminterval 60 --usestatusfile /tmp/chilli.status
--seskeepalive --proxyonacct --uamgardendata --uamotherdata
--locationimmediateupdate --nousergardendata --patricia
--proxylocattr=32 --redirssl --redirurl

With kind regards,
Peter Wagner
-------------- next part --------------
A non-text attachment was scrubbed...
Name: chilli.pcapng
Type: application/octet-stream
Size: 61712 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.coova.org/pipermail/chilli/attachments/20140205/3160dd32/attachment-0001.obj">http://lists.coova.org/pipermail/chilli/attachments/20140205/3160dd32/attachment-0001.obj</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002567.html">[Chilli] Transparent proxy on secondary host
</A></li>
	<LI>Next message: <A HREF="002570.html">[Chilli] Coova-Chilli Redirection Problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2568">[ date ]</a>
              <a href="thread.html#2568">[ thread ]</a>
              <a href="subject.html#2568">[ subject ]</a>
              <a href="author.html#2568">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">More information about the Chilli
mailing list</a><br>
</body></html>
