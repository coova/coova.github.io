<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Chilli] chilli as proxy for 802.1X
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:chilli%40coova.org?Subject=Re%3A%20%5BChilli%5D%20chilli%20as%20proxy%20for%20802.1X&In-Reply-To=%3CPine.LNX.4.62.1004071855450.7183%40mail.pnpi.spb.ru%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001236.html">
   <LINK REL="Next"  HREF="001238.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Chilli] chilli as proxy for 802.1X</H1>
    <B>Anatoly Oreshkin</B> 
    <A HREF="mailto:chilli%40coova.org?Subject=Re%3A%20%5BChilli%5D%20chilli%20as%20proxy%20for%20802.1X&In-Reply-To=%3CPine.LNX.4.62.1004071855450.7183%40mail.pnpi.spb.ru%3E"
       TITLE="[Chilli] chilli as proxy for 802.1X">Anatoly.Oreshkin at pnpi.spb.ru
       </A><BR>
    <I>Wed Apr  7 14:57:12 UTC 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="001236.html">[Chilli] chilli as proxy for 802.1X
</A></li>
        <LI>Next message: <A HREF="001238.html">[Chilli] MAC blacklist and other security measures
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1252">[ date ]</a>
              <a href="thread.html#1252">[ thread ]</a>
              <a href="subject.html#1252">[ subject ]</a>
              <a href="author.html#1252">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I've run chilli and radius in debug mode.

Here is chilli debug output:
---------------------------

Starting chilli: 
main-opt.c: 307: 0 (Debug) DHCP Listen: 10.2.3.1
main-opt.c: 308: 0 (Debug) UAM Listen: 10.2.3.1
...

chilli.c: 1946: 0 (Debug) RADIUS Access-Request received
chilli.c: 1975: 0 (Debug) Calling Station ID is: 00-16-EA-8A-DE-38
dhcp.c: 389: 0 (Debug) DHCP newconn: 00:16:ea:8a:de:38
chilli.c: 3274: 0 (Debug) New DHCP request from MAC=00-16-EA-8A-DE-38
chilli.c: 3277: 0 (Debug) New DHCP connection established
radius.c: 1446: 0 (Debug) RADIUS to 212.193.96.134:1812
chilli.c: 2781: 0 (Debug) Received access request confirmation from radius server

chilli.c: 2817: 0 (Debug) Received access challenge from radius server
chilli.c: 913: 0 (Debug) Sending RADIUS AccessChallenge to client
chilli.c: 1946: 0 (Debug) RADIUS Access-Request received
chilli.c: 1975: 0 (Debug) Calling Station ID is: 00-16-EA-8A-DE-38
radius.c: 1446: 0 (Debug) RADIUS to 212.193.96.134:1812
chilli.c: 2781: 0 (Debug) Received access request confirmation from radius server

chilli.c: 2817: 0 (Debug) Received access challenge from radius server
chilli.c: 913: 0 (Debug) Sending RADIUS AccessChallenge to client
chilli.c: 1946: 0 (Debug) RADIUS Access-Request received
chilli.c: 1975: 0 (Debug) Calling Station ID is: 00-16-EA-8A-DE-38
radius.c: 1446: 0 (Debug) RADIUS to 212.193.96.134:1812
chilli.c: 2781: 0 (Debug) Received access request confirmation from radius server

chilli.c: 2817: 0 (Debug) Received access challenge from radius server
chilli.c: 913: 0 (Debug) Sending RADIUS AccessChallenge to client
chilli.c: 1946: 0 (Debug) RADIUS Access-Request received
chilli.c: 1975: 0 (Debug) Calling Station ID is: 00-16-EA-8A-DE-38
radius.c: 1446: 0 (Debug) RADIUS to 212.193.96.134:1812
chilli.c: 2781: 0 (Debug) Received access request confirmation from radius server

chilli.c: 2817: 0 (Debug) Received access challenge from radius server
chilli.c: 913: 0 (Debug) Sending RADIUS AccessChallenge to client
chilli.c: 1946: 0 (Debug) RADIUS Access-Request received
chilli.c: 1975: 0 (Debug) Calling Station ID is: 00-16-EA-8A-DE-38
radius.c: 1446: 0 (Debug) RADIUS to 212.193.96.134:1812
chilli.c: 2781: 0 (Debug) Received access request confirmation from radius server

chilli.c: 2817: 0 (Debug) Received access challenge from radius server
chilli.c: 913: 0 (Debug) Sending RADIUS AccessChallenge to client
chilli.c: 1946: 0 (Debug) RADIUS Access-Request received
chilli.c: 1975: 0 (Debug) Calling Station ID is: 00-16-EA-8A-DE-38
radius.c: 1446: 0 (Debug) RADIUS to 212.193.96.134:1812
chilli.c: 2781: 0 (Debug) Received access request confirmation from radius server

chilli.c: 2817: 0 (Debug) Received access challenge from radius server
chilli.c: 913: 0 (Debug) Sending RADIUS AccessChallenge to client
chilli.c: 1946: 0 (Debug) RADIUS Access-Request received
chilli.c: 1975: 0 (Debug) Calling Station ID is: 00-16-EA-8A-DE-38
radius.c: 1446: 0 (Debug) RADIUS to 212.193.96.134:1812
chilli.c: 2781: 0 (Debug) Received access request confirmation from radius server

chilli.c: 2817: 0 (Debug) Received access challenge from radius server
chilli.c: 913: 0 (Debug) Sending RADIUS AccessChallenge to client
chilli.c: 1946: 0 (Debug) RADIUS Access-Request received
chilli.c: 1975: 0 (Debug) Calling Station ID is: 00-16-EA-8A-DE-38
radius.c: 1446: 0 (Debug) RADIUS to 212.193.96.134:1812
chilli.c: 2781: 0 (Debug) Received access request confirmation from radius server

chilli.c: 2817: 0 (Debug) Received access challenge from radius server
chilli.c: 913: 0 (Debug) Sending RADIUS AccessChallenge to client
chilli.c: 1946: 0 (Debug) RADIUS Access-Request received
chilli.c: 1975: 0 (Debug) Calling Station ID is: 00-16-EA-8A-DE-38
radius.c: 1446: 0 (Debug) RADIUS to 212.193.96.134:1812
chilli.c: 2781: 0 (Debug) Received access request confirmation from radius server

chilli.c: 2817: 0 (Debug) Received access challenge from radius server
chilli.c: 913: 0 (Debug) Sending RADIUS AccessChallenge to client
chilli.c: 1946: 0 (Debug) RADIUS Access-Request received
chilli.c: 1975: 0 (Debug) Calling Station ID is: 00-16-EA-8A-DE-38
radius.c: 1446: 0 (Debug) RADIUS to 212.193.96.134:1812
chilli.c: 2781: 0 (Debug) Received access request confirmation from radius server

radius.c: 1446: 0 (Debug) RADIUS to 212.193.96.134:1813
chilli.c: 1946: 0 (Debug) RADIUS Access-Request received
chilli.c: 1975: 0 (Debug) Calling Station ID is: 00-16-EA-8A-DE-38
radius.c: 1446: 0 (Debug) RADIUS to 212.193.96.134:1813
radius.c: 1446: 0 (Debug) RADIUS to 212.193.96.134:1812
radius.c: 1703: 0 (Debug) Authenticator does not match request!
radius.c: 337: 0 (Debug) No such id in radius queue: id=12!
radius.c: 1698: 0 (Debug) Matching request was not found in queue: 12!

chilli.c: 1946: 0 (Debug) RADIUS Access-Request received
chilli.c: 1975: 0 (Debug) Calling Station ID is: 00-16-EA-8A-DE-38
chilli.c: 2047: 0 (Debug) Dropping RADIUS while waiting
chilli.c: 92: 0 (Debug) SIGTERM: shutdown


Radius debug is very big so I provide  only extract from radius log:
--------------------------------------------------------------------


rad_recv: Access-Request packet from host 195.19.214.216 port 34666, id=1, length=176
         Vendor-14559-Attr-8 = 0x312e322e332d726331
         User-Name = &quot;csd-notebook\\oreshkin&quot;
         EAP-Message = 0x0200001a016373642d6e6f7465626f6f6b5c6f726573686b696e
         Calling-Station-Id = &quot;00-16-EA-8A-DE-38&quot;
         Called-Station-Id = &quot;00-0E-0C-36-AE-AA&quot;
         NAS-Port-Type = Wireless-802.11
         NAS-Port = 22
         Service-Type = Login-User
         NAS-IP-Address = 10.2.3.1
         NAS-Identifier = &quot;nas01&quot;
         Message-Authenticator = 0xa196cb3c72607c5a911c0d818fbf849d
+- entering group authorize {...}
++[preprocess] returns ok
++[chap] returns noop
++[mschap] returns noop
[suffix] No '@' in User-Name = &quot;csd-notebook\oreshkin&quot;, looking up realm NULL
[suffix] Found realm &quot;DEFAULT&quot;
[suffix] Adding Stripped-User-Name = &quot;csd-notebook\oreshkin&quot;
[suffix] Adding Realm = &quot;DEFAULT&quot;
[suffix] Authentication realm is LOCAL.
++[suffix] returns ok

...

Sending Access-Challenge of id 1 to 195.19.214.216 port 34666
         EAP-Message = 0x010100061920
         Message-Authenticator = 0x00000000000000000000000000000000
         State = 0xb4a908b4b4a811d634d2e603ef8b3686
Finished request 1.
Going to the next request
Waking up in 4.9 seconds.
rad_recv: Access-Request packet from host 195.19.214.216 port 34666, id=2, length=300
         Vendor-14559-Attr-8 = 0x312e322e332d726331
         User-Name = &quot;csd-notebook\\oreshkin&quot;
         State = 0xb4a908b4b4a811d634d2e603ef8b3686
         EAP-Message = 
0x0201008419800000007a16030100750100007103014bbc8ca76a6a0af22c248b376d914e3b1bd333d1d667531662313ed
82eddda12000018002f00350005000ac009c00ac013c0140032003800130004010000300000001a00180000156373642d6e6f7465626f6f6b5c6f7265
73686b696e000a00080006001700180019000b00020100
         Calling-Station-Id = &quot;00-16-EA-8A-DE-38&quot;
         Called-Station-Id = &quot;00-0E-0C-36-AE-AA&quot;
         NAS-Port-Type = Wireless-802.11
         NAS-Port = 22
         Service-Type = Login-User
         NAS-IP-Address = 10.2.3.1
         NAS-Identifier = &quot;nas01&quot;
         Message-Authenticator = 0x5c5c2b874fa4a310fba8a70cf5ca495b
+- entering group authorize {...}

...

eap] Request found, released from the list
[eap] EAP/peap
[eap] processing type peap
[peap] processing EAP-TLS
   TLS Length 122
[peap] Length Included
[peap] eaptls_verify returned 11 
[peap]     (other): before/accept initialization 
[peap]     TLS_accept: before/accept initialization 
[peap] &lt;&lt;&lt; TLS 1.0 Handshake [length 0075], ClientHello 
[peap]     TLS_accept: SSLv3 read client hello A 
[peap] &gt;&gt;&gt; TLS 1.0 Handshake [length 002a], ServerHello 
[peap]     TLS_accept: SSLv3 write server hello A 
[peap] &gt;&gt;&gt; TLS 1.0 Handshake [length 084e], Certificate 
[peap]     TLS_accept: SSLv3 write certificate A 
[peap] &gt;&gt;&gt; TLS 1.0 Handshake [length 0004], ServerHelloDone 
[peap]     TLS_accept: SSLv3 write server done A 
[peap]     TLS_accept: SSLv3 flush data 
[peap]     TLS_accept: Need to read more data: SSLv3 read client certificate A
In SSL Handshake Phase 
In SSL Accept mode 
[peap] eaptls_process returned 13

Sending Access-Challenge of id 2 to 195.19.214.216 port 34666
         EAP-Message = 0x0102040019c00000088b160301002a02
....

rad_recv: Access-Request packet from host 195.19.214.216 port 34666, id=3, length=174
         Vendor-14559-Attr-8 = 0x312e322e332d726331
         User-Name = &quot;csd-notebook\\oreshkin&quot;
         State = 0xb4a908b4b5ab11d634d2e603ef8b3686
         EAP-Message = 0x020200061900
         Calling-Station-Id = &quot;00-16-EA-8A-DE-38&quot;
         Called-Station-Id = &quot;00-0E-0C-36-AE-AA&quot;
         NAS-Port-Type = Wireless-802.11
         NAS-Port = 22
         Service-Type = Login-User
         NAS-IP-Address = 10.2.3.1
         NAS-Identifier = &quot;nas01&quot;
         Message-Authenticator = 0x2134d380e3d668d43346116f694eaa5a
+- entering group authorize {...}
++[preprocess] returns ok

...

Sending Access-Challenge of id 3 to 195.19.214.216 port 34666
         EAP-Message = 0x010303fc194000300d06092a864886f70d

...

rad_recv: Access-Request packet from host 195.19.214.216 port 34666, id=4, length=174
         Vendor-14559-Attr-8 = 0x312e322e332d726331
         User-Name = &quot;csd-notebook\\oreshkin&quot;
         State = 0xb4a908b4b6aa11d634d2e603ef8b3686
         EAP-Message = 0x020300061900
         Calling-Station-Id = &quot;00-16-EA-8A-DE-38&quot;
         Called-Station-Id = &quot;00-0E-0C-36-AE-AA&quot;
         NAS-Port-Type = Wireless-802.11
         NAS-Port = 22
         Service-Type = Login-User
         NAS-IP-Address = 10.2.3.1
         NAS-Identifier = &quot;nas01&quot;
         Message-Authenticator = 0x0ba6de3feb6774afb1682c78ee26b3f5
+- entering group authorize {...}
++[preprocess] returns ok

...


Sending Access-Challenge of id 5 to 195.19.214.216 port 34666
         EAP-Message = 0x010500411900140301000101160301
...

Login OK: [csd-notebook\\oreshkin] (from client Chilli port 22 cli 00-16-EA-8A-DE-38 via TLS 
tunnel)
} # server inner-tunnel
[peap] Got tunneled reply code 2
         EAP-Message = 0x03080004
         Message-Authenticator = 0x00000000000000000000000000000000
         User-Name = &quot;oreshkin&quot;
[peap] Got tunneled reply RADIUS code 2
         EAP-Message = 0x03080004
         Message-Authenticator = 0x00000000000000000000000000000000
         User-Name = &quot;oreshkin&quot;
[peap] Tunneled authentication was successful.
[peap] SUCCESS
++[eap] returns handled
Sending Access-Challenge of id 9 to 195.19.214.216 port 34666
         EAP-Message = 
0x0109002b190017030100207a551685a86341f23608b1e782e24ba9952823075fe750bc7cd4a3a630d78b3a
         Message-Authenticator = 0x00000000000000000000000000000000
         State = 0xb4a908b4bca011d634d2e603ef8b3686
Finished request 9.

...

Sending Access-Accept of id 10 to 195.19.214.216 port 34666
         MS-MPPE-Recv-Key = 0x74131f24dd18434ebc00b17e4de36927023adb596def04cf80f05b8639ef7bfc
         MS-MPPE-Send-Key = 0x292842662ebec27e20e94036aba5d3526e1bb29eb016fa290734e4df500349e1
         EAP-Message = 0x03090004
         Message-Authenticator = 0x00000000000000000000000000000000
         User-Name = &quot;csd-notebook\\oreshkin&quot;
Finished request 10.

...

rad_recv: Accounting-Request packet from host 195.19.214.216 port 34666, id=11, length=230
         Vendor-14559-Attr-8 = 0x312e322e332d726331
         Vendor-14559-Attr-10 = 0x00000002
         Acct-Status-Type = Start
         User-Name = &quot;csd-notebook\\oreshkin&quot;
         Calling-Station-Id = &quot;00-16-EA-8A-DE-38&quot;
         NAS-Port-Type = Wireless-802.11
         NAS-Port = 22
         NAS-Port-Id = &quot;00000022&quot;
         Framed-IP-Address = 10.2.3.11
         Acct-Session-Id = &quot;4bbc8ca200000016&quot;
         NAS-IP-Address = 10.2.3.1
         Called-Station-Id = &quot;00-0E-0C-36-AE-AA&quot;
         NAS-Identifier = &quot;nas01&quot;
         WISPr-Location-ID = &quot;isocc=,cc=,ac=,network=Coova,&quot;
         WISPr-Location-Name = &quot;My_HotSpot&quot;
+- entering group preacct {...}
++[preprocess] returns ok

[acct_unique] Hashing 'NAS-Port = 22,Client-IP-Address = 195.19.214.216,NAS-IP-Address = 
10.2.3.1,Acct-Session-Id = &quot;4bbc
8ca200000016&quot;,User-Name = &quot;csd-notebook\\oreshkin&quot;'
[acct_unique] Acct-Unique-Session-ID = &quot;7891c6f25ae215b3&quot;.
++[acct_unique] returns ok
[suffix] No '@' in User-Name = &quot;csd-notebook\oreshkin&quot;, looking up realm NULL
[suffix] Found realm &quot;DEFAULT&quot;
[suffix] Adding Stripped-User-Name = &quot;csd-notebook\oreshkin&quot;
[suffix] Adding Realm = &quot;DEFAULT&quot;
[suffix] Accounting realm is LOCAL.
++[suffix] returns ok
++[files] returns noop
+- entering group accounting {...}
[detail]        expand: /usr/local/var/log/radius/radacct/%{Client-IP-Address}/detail-%Y%m%d 
-&gt; /usr/local/var/log/radius
/radacct/195.19.214.216/detail-20100407
[detail] /usr/local/var/log/radius/radacct/%{Client-IP-Address}/detail-%Y%m%d expands to 
/usr/local/var/log/radius/radacc
t/195.19.214.216/detail-20100407
[detail]        expand: %t -&gt; Wed Apr  7 17:46:10 2010
++[detail] returns ok
++[unix] returns ok
[radutmp]       expand: /usr/local/var/log/radius/radutmp -&gt; /usr/local/var/log/radius/radutmp
[radutmp]       expand: %{User-Name} -&gt; csd-notebook\oreshkin
++[radutmp] returns ok
[attr_filter.accounting_response]       expand: %{User-Name} -&gt; csd-notebook\oreshkin

  attr_filter: Matched entry DEFAULT at line 12
++[attr_filter.accounting_response] returns updated
Sending Accounting-Response of id 11 to 195.19.214.216 port 34666
Finished request 11.
Cleaning up request 11 ID 11 with timestamp +71
Going to the next request
Waking up in 4.9 seconds.
rad_recv: Access-Request packet from host 195.19.214.216 port 34666, id=12, length=176
         Vendor-14559-Attr-8 = 0x312e322e332d726331
         User-Name = &quot;csd-notebook\\oreshkin&quot;
         EAP-Message = 0x0200001a016373642d6e6f7465626f6f6b5c6f726573686b696e
         Calling-Station-Id = &quot;00-16-EA-8A-DE-38&quot;
         Called-Station-Id = &quot;00-0E-0C-36-AE-AA&quot;
         NAS-Port-Type = Wireless-802.11
         NAS-Port = 22
         Service-Type = Login-User
         NAS-IP-Address = 10.2.3.1
         NAS-Identifier = &quot;nas01&quot;
         Message-Authenticator = 0xa159e7391af38849331fcee9aa4d4126
+- entering group authorize {...}

...

Sending Access-Challenge of id 12 to 195.19.214.216 port 34666
         EAP-Message = 0x010100061920
         Message-Authenticator = 0x00000000000000000000000000000000
         State = 0x806bce12806ad75a757217b94df2bf0a

...

rad_recv: Accounting-Request packet from host 195.19.214.216 port 34666, id=12, length=278
         Vendor-14559-Attr-8 = 0x312e322e332d726331
         Vendor-14559-Attr-10 = 0x00000002
         Acct-Status-Type = Stop
         User-Name = &quot;csd-notebook\\oreshkin&quot;
         Calling-Station-Id = &quot;00-16-EA-8A-DE-38&quot;
         NAS-Port-Type = Wireless-802.11
         NAS-Port = 22
         NAS-Port-Id = &quot;00000022&quot;
         Framed-IP-Address = 10.2.3.11
         Acct-Session-Id = &quot;4bbc8ca200000016&quot;
         NAS-IP-Address = 10.2.3.1
         Called-Station-Id = &quot;00-0E-0C-36-AE-AA&quot;
         NAS-Identifier = &quot;nas01&quot;
         Acct-Input-Octets = 0
         Acct-Output-Octets = 0
         Acct-Input-Gigawords = 0
         Acct-Output-Gigawords = 0
         Acct-Input-Packets = 0
         Acct-Output-Packets = 0
         Acct-Session-Time = 4
         WISPr-Location-ID = &quot;isocc=,cc=,ac=,network=Coova,&quot;
         WISPr-Location-Name = &quot;My_HotSpot&quot;
         Acct-Terminate-Cause = User-Request
...

rad_recv: Accounting-Request packet from host 195.19.214.216 port 34666, id=14, length=148
         Vendor-14559-Attr-8 = 0x312e322e332d726331
         Vendor-14559-Attr-10 = 0x00000002
         Acct-Status-Type = Accounting-Off
         NAS-IP-Address = 10.2.3.1
         Called-Station-Id = &quot;00-0E-0C-36-AE-AA&quot;
         NAS-Identifier = &quot;nas01&quot;
         WISPr-Location-ID = &quot;isocc=,cc=,ac=,network=Coova,&quot;
         WISPr-Location-Name = &quot;My_HotSpot&quot;
         Acct-Terminate-Cause = 0
+- entering group preacct {...}
++[preprocess] returns ok

...





On Tue, 6 Apr 2010, David Bird wrote:

&gt;<i> Date: Tue, 06 Apr 2010 10:38:15 +0200
</I>&gt;<i> From: David Bird &lt;<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">david at coova.com</A>&gt;
</I>&gt;<i> To: Anatoly Oreshkin &lt;<A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">Anatoly.Oreshkin at pnpi.spb.ru</A>&gt;
</I>&gt;<i> Cc: <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli at coova.org</A>
</I>&gt;<i> Subject: Re: [Chilli] chilli as proxy for 802.1X
</I>&gt;<i> 
</I>&gt;<i> The chilli log suggests a bad shared secret. Of course, the auth success
</I>&gt;<i> doesn't. Though, you would have seen more than just one packet to
</I>&gt;<i> accomplish the EAP success, so the secret must be correct (and working).
</I>&gt;<i> Run chilli and FreeRADIUS in debug mode for additional debugging.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Mon, 2010-04-05 at 18:29 +0400, Anatoly Oreshkin wrote:
</I>&gt;&gt;<i> Hello,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I would like to use chilli as proxy between Access Point (AP) and
</I>&gt;&gt;<i> Radius server.
</I>&gt;&gt;<i> AP (not CoovaAP) is configured for WPA2/AES security with
</I>&gt;&gt;<i> 802.1X/EAP/PEAP/MSCHAPv2
</I>&gt;&gt;<i> authentication. Chilli address is specified as radius server in AP.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Coovachilli is configured as follows.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> /usr/local/etc/chilli/config have the lines:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> HS_WANIF=eth0     # has 195.19.214.216 address
</I>&gt;&gt;<i> HS_LANIF=eth1
</I>&gt;&gt;<i> HS_NETWORK=10.2.3.0
</I>&gt;&gt;<i> HS_NETMASK=255.255.255.0
</I>&gt;&gt;<i> HS_UAMLISTEN=10.2.3.1
</I>&gt;&gt;<i> HS_UAMPORT=3990
</I>&gt;&gt;<i> HS_UAMUIPORT=4990
</I>&gt;&gt;<i> HS_DNS_DOMAIN=&lt;my domain&gt;
</I>&gt;&gt;<i> HS_DNS1=ipaddress1
</I>&gt;&gt;<i> HS_DNS2=ipaddress2
</I>&gt;&gt;<i> HS_RADIUS=&lt;radius server address&gt;
</I>&gt;&gt;<i> HS_RADIUS2=&lt;radius server address&gt;
</I>&gt;&gt;<i> HS_UAMALLOW=&quot;10.2.3.1/24,195.19.214.216&quot;
</I>&gt;&gt;<i> HS_RADSECRET=&lt;radius secret&gt;
</I>&gt;&gt;<i> HS_UAMSECRET=&lt;uam secret&gt;
</I>&gt;&gt;<i> HS_UAMALIASNAME=chilli
</I>&gt;&gt;<i> HS_UAMSERVER=&lt;uam server&gt;
</I>&gt;&gt;<i> HS_UAMFORMAT=<A HREF="https://\$HS_UAMSERVER/cgi-bin/hotspotlogin.cgi">https://\$HS_UAMSERVER/cgi-bin/hotspotlogin.cgi</A>
</I>&gt;&gt;<i> HS_TCP_PORTS=&quot;80 443&quot;
</I>&gt;&gt;<i> HS_MODE=hotspot
</I>&gt;&gt;<i> HS_TYPE=chillispot
</I>&gt;&gt;<i> HS_WWWDIR=/usr/local/etc/chilli/www
</I>&gt;&gt;<i> HS_WWWBIN=/usr/local/etc/chilli/wwwsh
</I>&gt;&gt;<i> HS_PROVIDER=Coova
</I>&gt;&gt;<i> HS_PROVIDER_LINK=<A HREF="http://www.coova.org/">http://www.coova.org/</A>
</I>&gt;&gt;<i> HS_LOC_NAME=&quot;My HotSpot&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> /usr/local/etc/chilli/local.conf:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> proxylisten=195.19.214.216     # eth0 address
</I>&gt;&gt;<i> proxyport=1812
</I>&gt;&gt;<i> proxyclient=192.168.14.242    #  AP address
</I>&gt;&gt;<i> proxysecret=&lt;proxy secret&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Radius configuration.
</I>&gt;&gt;<i> --------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> /usr/local/etc/raddb/clients.conf:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # chilli hotspot
</I>&gt;&gt;<i> client 195.19.214.216 {
</I>&gt;&gt;<i>         secret      = &lt;chilli secret&gt;
</I>&gt;&gt;<i>         shortname   = Chilli
</I>&gt;&gt;<i>         nastype     = other
</I>&gt;&gt;<i> }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> /usr/local/etc/raddb/users:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> oreshkin Cleartext-Password := &quot;client password&quot;, Calling-Station-Id ==
</I>&gt;&gt;<i> &quot;00-16-EA-8A-DE-38&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> When a client is trying to authenticate through chilli I see on chilli
</I>&gt;&gt;<i> server in /var/log/messages:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> chilli.c: 3274: New DHCP request from MAC=00-16-EA-8A-DE-38
</I>&gt;&gt;<i> radius.c: 1703: Authenticator does not match request!
</I>&gt;&gt;<i> radius.c: 337: No such id in radius queue: id=12!
</I>&gt;&gt;<i> radius.c: 1698: Matching request was not found in queue: 12!
</I>&gt;&gt;<i> radius.c: 337: No such id in radius queue: id=12!
</I>&gt;&gt;<i> ....
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What do these messages mean ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On radius server in /usr/local/var/log/radius/radius.log I see
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  Auth: Login OK: [csd-notebook\\oreshkin] (from client Chilli port 15 cli
</I>&gt;&gt;<i> 00-16-EA-8A-DE-38 via TLS tunnel)
</I>&gt;&gt;<i> Auth: Login OK: [csd-notebook\\oreshkin] (from client Chilli port 15 cli
</I>&gt;&gt;<i> 00-16-EA-8A-DE-38)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> That is the radius server authenticates the client successfully however
</I>&gt;&gt;<i> chilli does not.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Coovachilli is taken from SVN and installed with the options:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ./configure --enable-chilliproxy --with-curl
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Also I've tried with additional parameter &quot;eapolenable&quot;  in local.conf but
</I>&gt;&gt;<i> with no difference.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What might be wrong ? What more parameters should I specify ?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Chilli mailing list
</I>&gt;&gt;<i> <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">Chilli at coova.org</A>
</I>&gt;&gt;<i> <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">http://lists.coova.org/cgi-bin/mailman/listinfo/chilli</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001236.html">[Chilli] chilli as proxy for 802.1X
</A></li>
	<LI>Next message: <A HREF="001238.html">[Chilli] MAC blacklist and other security measures
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1252">[ date ]</a>
              <a href="thread.html#1252">[ thread ]</a>
              <a href="subject.html#1252">[ subject ]</a>
              <a href="author.html#1252">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">More information about the Chilli
mailing list</a><br>
</body></html>
