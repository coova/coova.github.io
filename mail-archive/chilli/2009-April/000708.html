<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> Ah ha - Re: UAMALLOWED and HTTPS (to select.worldpay.com)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:chilli%40coova.org?Subject=Re%3A%20Ah%20ha%20-%20Re%3A%20UAMALLOWED%20and%20HTTPS%20%28to%20select.worldpay.com%29&In-Reply-To=%3C40106.149.5.32.200.1241015907.squirrel%40www.rivertowermail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000719.html">
   <LINK REL="Next"  HREF="000709.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Ah ha - Re: UAMALLOWED and HTTPS (to select.worldpay.com)</H1>
    <B>Derek C</B> 
    <A HREF="mailto:chilli%40coova.org?Subject=Re%3A%20Ah%20ha%20-%20Re%3A%20UAMALLOWED%20and%20HTTPS%20%28to%20select.worldpay.com%29&In-Reply-To=%3C40106.149.5.32.200.1241015907.squirrel%40www.rivertowermail.com%3E"
       TITLE="Ah ha - Re: UAMALLOWED and HTTPS (to select.worldpay.com)">derekchilli at hssl.ie
       </A><BR>
    <I>Wed Apr 29 14:38:27 UTC 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000719.html">UAMALLOWED and HTTPS (to select.worldpay.com)
</A></li>
        <LI>Next message: <A HREF="000709.html">Ah ha - Re: UAMALLOWED and HTTPS (to select.worldpay.com)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#708">[ date ]</a>
              <a href="thread.html#708">[ thread ]</a>
              <a href="subject.html#708">[ subject ]</a>
              <a href="author.html#708">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi again,

Ok: Now I realised something.  Its Worldpay that's doing the blocking when
traffic is routing via my Coova Chilli box (BTW Worldpay is a credit/debit
card payment gateway - a part of the Royal Bank of Scotland group).

I can add another site to the uamallowed directive and access their SSL
site fine (and &quot;telnet SITE 443&quot; works fine too).

What could it be that Worldpay is identifying with Coova Chilli traffic
and makes them drop it?

On my Coova Chilli AP I'm doing the usual NAT handling with &quot;iptables -t
nat -A POSTROUTING -o eth0 -j MASQUERADE&quot; and if I don't use Coova Chilli
and put an IP on the wifi AP interface then Worldpay does NOT block my
connection (i.e. it only happens when Coova Chilli is handling the IP DHCP
allocation).

Maybe its something with the masquerading not fully handling the IP
mapping - something that makes Worldpay reject the traffic due to, in
their opinion, IP spoofing?

Derek

On Wed, April 29, 2009 3:06 pm, Johan Meiring wrote:
&gt;<i> Derek C wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi Johan,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Below is the output of &quot;tcpdump -vvntttt -i ath0 dst 155.136.66.34&quot;
</I>&gt;&gt;<i> (where
</I>&gt;&gt;<i> that IP is select.worldpay.com).
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Your filter is of such a nature that you will only see outgoing traffic.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> tcpdump -vvntttt -i ath0 host 155.136.66.34 ^^^^
</I>&gt;<i> is better.
</I>&gt;<i>
</I>&gt;<i> Also you are filtering other traffic.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Best to use:
</I>&gt;<i> tcpdump -vvntttt -s 1500 -i ath0 (-s 1500 makes it capture the whole
</I>&gt;<i> packet, and you then get more info)
</I>&gt;<i>
</I>&gt;<i> If you feel the output is too long, use something like pastebin.com
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Johan Meiring
</I>&gt;<i> Amobia Communications
</I>&gt;<i> Tel: (0861) AMOBIA / (0861) 266242
</I>&gt;<i> Fax: (0861) AMOFAX / (0861) 266329
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ---------------------------------------------------------------------
</I>&gt;<i> To unsubscribe, e-mail: <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli-unsubscribe at coova.org</A>
</I>&gt;<i> For additional commands, e-mail: <A HREF="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">chilli-help at coova.org</A>
</I>&gt;<i> Wiki: <A HREF="http://coova.org/wiki/index.php/CoovaChilli">http://coova.org/wiki/index.php/CoovaChilli</A>
</I>&gt;<i> Forum: <A HREF="http://coova.org/phpBB3/viewforum.php?f=4">http://coova.org/phpBB3/viewforum.php?f=4</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
Derek C
In Ireland


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000719.html">UAMALLOWED and HTTPS (to select.worldpay.com)
</A></li>
	<LI>Next message: <A HREF="000709.html">Ah ha - Re: UAMALLOWED and HTTPS (to select.worldpay.com)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#708">[ date ]</a>
              <a href="thread.html#708">[ thread ]</a>
              <a href="subject.html#708">[ subject ]</a>
              <a href="author.html#708">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.coova.org/cgi-bin/mailman/listinfo/chilli">More information about the Chilli
mailing list</a><br>
</body></html>
